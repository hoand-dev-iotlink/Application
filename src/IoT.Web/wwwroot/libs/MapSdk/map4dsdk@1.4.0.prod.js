var map4d=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=77)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(11),r=n(9),o=n(48),a=n(19),s=n(7),l=function(){function t(){}return Object.defineProperty(t,"placeFontSize",{get:function(){return 12},enumerable:!0,configurable:!0}),Object.defineProperty(t,"iconRequestUrl",{get:function(){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/place/icon?option=0&type={t}&size={s}&key={k}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"userIconRequestUrl",{get:function(){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/place/icon?option=1&type={t}&size={s}&key={k}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseMapUrl",{get:function(){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/tile/v2/{z}/{x}/{y}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseModelRequestUrl",{get:function(){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/Model/objs/{s}?key={k}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseTextureRequestUrl",{get:function(){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/Model/images/{s}?key={k}"},enumerable:!0,configurable:!0}),t.getWeatherDataUrl=function(t,e){return"https://"+o.Env.apiPrefix+".map4d.vn/sdk/weather?lat="+t+"&lng="+e+"&key="+a.MapSettings.getAccessKey()},Object.defineProperty(t,"maxTiltIntersectWithScreen",{get:function(){return 90-c.fov*h.rad2Deg},enumerable:!0,configurable:!0}),t.none=-1,t.baseTileSize=256,t.minLatitude=-85.0511287798066,t.maxLatitude=85.0511287798066,t.maxLongitude=180,t.minLongitude=-180,t.maxDegrees=360,t.radiusEarthMeters=6378137,t.halfEarthCircumFerenceInMeter=t.radiusEarthMeters*Math.PI,t.earthCircumFerenceInMeter=2*t.halfEarthCircumFerenceInMeter,t.tileCacheSize=512,t.baseMapLowestOrder=Number.MIN_SAFE_INTEGER,t.buildingLayerOrder=0,t.userFeatureLayerOrder=Number.MAX_SAFE_INTEGER,t.pointGeoJsonWidth=32,t.pointGeoJsonHeight=32,t.placeSelectedIdPrefix="maplink-selected-place-",t.placeWidth=26,t.placeHeight=32,t.placeFontWeight="normal",t.placeMaxWidth=125,t.placeNumLine=3,t.placeAnchor=new s.Point(.5,1),t.placeLabelAnchor=new s.Point(1.1,.5),t.placeSelectedColor="#ff0000",t.placeDefaultColor="#6E9FB0",t.placeDefaultIcon="default",t.placeSelectedWidth=28,t.placeSelectedHeight=38,t.maxPlacePerTile=6,t.pointGeoJsonAnchor=[.5,1],t.infoWindowPadding=2,t.flingMinVelocity=-1e4,t.flingMaxVelocity=1e4,t.flingTimeConstant=150,t.flingSpeedMultiply=15,t.zoomSpeedMouseWheel=15,t.minDurationFlyTo=1e3,t.maxDurationFlyTo=13e3,t.maxBearingAngle=720,t.defaultMinZoom=3,t.defaultMinZoom3d=17,t.defaultMaxZoom=22,t.defaultMaxNativeZoom=19,t.tileExtend=4096,t.defaultAnimationDuration=300,t.defaultFlyZoom=17,t.defaultMap2dUrl="https://rtile"+o.Env.tileEnv+".map4d.vn/all/2d/{z}/{x}/{y}.png",t.defaultMap3dUrl="https://rtile"+o.Env.tileEnv+".map4d.vn/all/3d/{z}/{x}/{y}.png",t.minTilt=0,t.maxTilt2D=40,t.maxTilt3D=87,t.minTiltReduceFog=75,t.minTimeMoving=150,t.minTimeDoubleZoom=500,t.minTimeSpanTo=500,t.maxTimeSpanTo=4e3,t.skyboxMapBorderMinimum=.001,t.metersPerPixelAtLatitude=0,t.mapBackgroundColor2D="#f2efe9",t.mapBackgroundColor3D="#e1e1e1",t.mapBackgroundScaleRatio=2e4,t.clusterMaxPointCount=1e6,t.biasMatrix=new i.Matrix4(new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1])),t.FPS=20,t}();e.MapConstants=l;var u=function(){function t(){}return t.defaultSymbol="markerDefault",t.selectionSymbol="selectionIcon",t.placeSelectedSymbol="placeSelectedIcon",t}();e.SymbolConstants=u;var h=function(){function t(){}return t.rad2Deg=180/Math.PI,t.deg2Rad=Math.PI/180,t.epsilon=1e-6,t}();e.MathConstants=h;var c=function(){function t(){}return t.fov=30*h.deg2Rad,t.nearPlane=.1,t.farPlane=1e3,t.height=15.5,t}();e.CameraConstants=c;var f=function(){function t(){}return t.numTrianglesOnRoundCap=6,t.numTrianglesOnRoundJoin=5,t.numTrianglesPerCircle=4,t.polylineTextureWidth=16,t.polylineTextureHeight=8,t}();e.PolyConstants=f;var p=function(){function t(){}return t.rainFrequency=.004,t.rainParticleRotation=-25,t.snowFrequency=.004,t}();e.ParticleConstants=p;var d=function(){function t(){}return t.refreshTime=6e4,t.refreshDistance=1e5,t}();e.WeatherConstants=d;var g=function(){function t(){}return t.getSkyColor=function(e){return t.skyColors[e]},t.getFogColor=function(e){return t.fogColors[e]},t.getLightColor=function(e){return t.lightColors[e]},t.skyColors={Morning:r.Color.fromHex("cdf9ff"),Noon:r.Color.fromHex("0783f4"),AfterNoon:r.Color.fromHex("243a8b"),Evening:r.Color.fromHex("182863")},t.fogColors={Morning:r.Color.fromHex("FAD8C4"),Noon:r.Color.fromHex("FAFAFA"),AfterNoon:r.Color.fromHex("FAA899"),Evening:r.Color.fromHex("141c36")},t.lightColors={Morning:r.Color.fromHex("#DE8989"),Noon:r.Color.fromHex("#F8F8F8"),AfterNoon:r.Color.fromHex("#BE321A"),Evening:r.Color.fromHex("#1E0032")},t}();e.ColorConstants=g;var m=function(){function t(){}return t.morningTime=6,t.noonTime=12,t.afterNoonTime=16,t.eveningTime=18,t}();e.TimeConstants=m;var y=function(){function t(){}return Object.defineProperty(t,"fontSize",{get:function(){return 24},enumerable:!0,configurable:!0}),t.fontTextureWidth=1e3,t.fontTextureHeight=400,t}();e.FontConstant=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(12),o=n(7),a=n(2),s=n(17),l=n(6),u=function(){function t(){}return Object.defineProperty(t,"pixelScale",{get:function(){return t._pixelScale},set:function(e){t._pixelScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"resourceScale",{get:function(){return Math.round(t._pixelScale)},enumerable:!0,configurable:!0}),t.getTileSize=function(){return i.MapConstants.baseTileSize*t.pixelScale},t.extendOptions=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,r=e;i<r.length;i++){var o=r[i];for(var a in o)t[a]=o[a]}return t},t.pointToPixel=function(e){return new o.Point(e.x*t.pixelScale,e.y*t.pixelScale)},t.pixelToPoint=function(e){return new o.Point(e.x/t.pixelScale,e.y/t.pixelScale)},t.getTimePanTo=function(t,e,n){var o=t.distanceTo(e)/500;return o*=n<10?.01:n<14?.5:1.5,o=r.MathUtils.clamp(o,i.MapConstants.minTimeSpanTo,i.MapConstants.maxTimeSpanTo),Math.round(o)},t.getCameraPositionForLatLngBounds=function(t,e,n,i){var o=n.getScreenSize(),u=n.getZoom(),h=1<<u,c=l.ProjectionMercator.projectScale(t.getSouthwest(),h),f=l.ProjectionMercator.projectScale(t.getNortheast(),h),p=f.x-c.x,d=c.y-f.y;p=p<=0?1:p,d=d<=0?1:d;var g=Number.MAX_VALUE;if(p>0||d>0){var m=o.x/p,y=o.y/d;m-=(e.left+e.right)/p,y-=(e.top+e.bottom)/d,g=Math.min(m,y)}var v=u;g>0?v=r.MathUtils.clamp(u+Math.log2(g),i.getMinZoom(),i.getMaxZoom()):(console.warn("Cannot calculate zoom level for bounds. Vertical or horizontal padding is greater than map's height or width"),v=i.getMinZoom()),v=Math.floor(v);var b=Math.pow(2,v),_=c.add(f).multiply(.5),w=l.ProjectionMercator.unproject(_,h),M=l.ProjectionMercator.projectScale(w,b),x=M.add(o.multiply(.5)),A=M.add(o.multiply(-.5));return x=x.subtract(new a.Vector2(e.left,e.top)),A=A.add(new a.Vector2(e.right,e.bottom)),M=x.add(A).multiply(.5),new s.CameraPosition(l.ProjectionMercator.unproject(M,b),0,0,v)},t._pixelScale=1,t}();e.MapUtils=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0;return e>0&&(n=this.x/e,i=this.y/e),new t(n,i)},t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.rotate90=function(){return new t(this.y,-this.x)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.rotateByRadian=function(e){var n=Math.cos(e),i=Math.sin(e);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y)},t}();e.Vector2=i},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(161),r=n(162),o=n(94);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return u(this,t,e,n)}function u(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=f(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|d(e,n),r=(t=s(t,i)).write(e,n);r!==i&&(t=t.slice(0,r));return t}(t,e,n):function(t,e){if(l.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?s(t,0):f(t,e);if("Buffer"===e.type&&o(e.data))return f(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function c(t,e){if(h(e),t=s(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(t).length;default:if(i)return N(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function m(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:y(t,e,n,i,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):y(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function y(t,e,n,i,r){var o,a=1,s=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){var h=-1;for(o=n;o<s;o++)if(u(t,o)===u(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*a}else-1!==h&&(o-=o-h),h=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var c=!0,f=0;f<l;f++)if(u(t,o+f)!==u(e,f)){c=!1;break}if(c)return o}return-1}function v(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function b(t,e,n,i){return V(N(e,t.length-n),t,n,i)}function _(t,e,n,i){return V(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function w(t,e,n,i){return _(t,e,n,i)}function M(t,e,n,i){return V(Z(e),t,n,i)}function x(t,e,n,i){return V(function(t,e){for(var n,i,r,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(e,t.length-n),t,n,i)}function A(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function T(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var o,a,s,l,u=t[r],h=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=n)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(o=t[r+1]))&&(l=(31&u)<<6|63&o)>127&&(h=l);break;case 3:o=t[r+1],a=t[r+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:o=t[r+1],a=t[r+2],s=t[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),r+=c}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=S));return n}(i)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return u(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return function(t,e,n,i){return h(e),e<=0?s(t,e):void 0!==n?"string"==typeof i?s(t,e).fill(n,i):s(t,e).fill(n):s(t,e)}(null,t,e,n)},l.allocUnsafe=function(t){return c(null,t)},l.allocUnsafeSlow=function(t){return c(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=l.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var a=t[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):function(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return T(this,e,n);case"ascii":return E(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,i,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,r>>>=0,this===t)return 0;for(var o=r-i,a=n-e,s=Math.min(o,a),u=this.slice(i,r),h=t.slice(e,n),c=0;c<s;++c)if(u[c]!==h[c]){o=u[c],a=h[c];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},l.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return v(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return M(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function E(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function C(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function L(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=e;o<n;++o)r+=F(t[o]);return r}function P(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,i,r,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function R(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);r<o;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function k(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);r<o;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function D(t,e,n,i,r,o){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,i,o){return o||D(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function U(t,e,n,i,o){return o||D(t,0,n,8),r.write(t,e,n,i,52,8),n+8}l.prototype.slice=function(t,e){var n,i=this.length;if(t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},l.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||O(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);O(this,t,e,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,o=i-n;if(this===t&&n<e&&e<i)for(r=o-1;r>=0;--r)t[r+e]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},l.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=l.isBuffer(t)?t:N(new l(t,i).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function N(t,e){var n;e=e||1/0;for(var i=t.length,r=null,o=[],a=0;a<i;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Z(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(22))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(t,e){this.lat=t,this.lng=e}return t.prototype.equals=function(t){return this.lat==t.lat&&this.lng==t.lng},t.prototype.valid=function(){return isFinite(this.lat)&&Math.abs(this.lat)<=90},t.prototype.toString=function(){return"("+this.lat+", "+this.lng+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[1]),Number(e[0]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"lat"in e&&"lng"in e)return new t(Number(e.lat),Number(e.lng));throw new Error("`ILngLat` argument must be specified as a LngLat instance, an object {lat: <lat>, lng: <lng>}, or an array of [<lng>, <lat>]")},t.prototype.distanceTo=function(e){var n=t.convert(e),r=i.MathConstants.deg2Rad*this.lat,o=i.MathConstants.deg2Rad*this.lng,a=i.MathConstants.deg2Rad*n.lat,s=i.MathConstants.deg2Rad*n.lng,l=Math.sin((a-r)/2),u=Math.sin((s-o)/2);return 2*i.MapConstants.radiusEarthMeters*Math.asin(Math.sqrt(l*l+Math.cos(r)*Math.cos(a)*u*u))},t.prototype.normalize=function(){var e=this.lat>0?-1:1,n=(this.lat-90*e)%180+90*e;return e=this.lng>0?-1:1,new t(n,(this.lng-180*e)%380+180*e)},t.prototype.add=function(e){return new t(this.lat+e.lat,this.lng+e.lng).normalize()},t.prototype.subtract=function(e){return e?new t(this.lat-e.lat,this.lng-e.lng).normalize():this},t}();e.LatLng=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.RASTER=0]="RASTER",t[t.BUILDING=1]="BUILDING",t[t.LINE=2]="LINE",t[t.FILL=3]="FILL",t[t.CIRCLE=4]="CIRCLE",t[t.SYMBOL=5]="SYMBOL",t[t.ORDERED=6]="ORDERED",t[t.GEOJSON=7]="GEOJSON"}(e.LayerType||(e.LayerType={}));var i=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}();e.LayerId=i,e.compareLayerId=function(t,e){return t.order==e.order?t.id==e.id?0:t.id>e.id:t.order>e.order};var r=function(){function t(t,e,n,r){this.layerId=new i(t,e),this.layerType=n,this.tileManager=r}return t.prototype.getOrder=function(){return this.layerId.order},t.prototype.getLayerId=function(){return this.layerId.id},t.prototype.getLayerType=function(){return this.layerType},t.prototype.setOrder=function(t){this.layerId.order=t},t.prototype.setLayerRenderer=function(t){this.layerRenderer=t},t}();e.Layer=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4),o=n(0),a=n(12),s=n(1),l=function(){function t(){}return t.projectInternal=function(t,e){var n=a.MathUtils.clamp(t.lat,o.MapConstants.minLatitude,o.MapConstants.maxLatitude);return new i.Vector2(o.MapConstants.maxLongitude+t.lng,o.MapConstants.maxLongitude-o.MathConstants.rad2Deg*Math.log(Math.tan(Math.PI/4+n*Math.PI/o.MapConstants.maxDegrees))).multiply(e/o.MapConstants.maxDegrees)},t.worldSize=function(t){return t*s.MapUtils.getTileSize()},t.getMetersPerPixelAtLatitude=function(t,e){var n=Math.pow(2,e),i=a.MathUtils.clamp(t,o.MapConstants.minLatitude,o.MapConstants.maxLatitude);return Math.cos(i*o.MathConstants.deg2Rad)*Math.PI*2*o.MapConstants.radiusEarthMeters/this.worldSize(n)},t.convertToMeterFromLatLng=function(t){var e=a.MathUtils.clamp(t.lat,o.MapConstants.minLatitude,o.MapConstants.maxLatitude),n=t.lng,r=1-1e-15,s=a.MathUtils.clamp(Math.sin(o.MathConstants.deg2Rad*e),-r,r),l=o.MapConstants.radiusEarthMeters*n*o.MathConstants.deg2Rad,u=.5*o.MapConstants.radiusEarthMeters*Math.log((1+s)/(1-s));return new i.Vector2(l,u)},t.convertToLatLngFromMeter=function(t){var e=(2*Math.atan(Math.exp(t.y/o.MapConstants.radiusEarthMeters))-Math.PI/2)*o.MathConstants.rad2Deg,n=t.x*o.MathConstants.rad2Deg/o.MapConstants.radiusEarthMeters;return new r.LatLng(e,n)},t.projectScale=function(t,e){return this.projectInternal(t,this.worldSize(e))},t.projectZoom=function(t,e){return this.projectInternal(t,1<<e)},t.unproject=function(t,e){var n=t.multiply(o.MapConstants.maxDegrees/this.worldSize(e));return new r.LatLng(o.MapConstants.maxDegrees/Math.PI*Math.atan(Math.exp((o.MapConstants.maxLongitude-n.y)*o.MathConstants.deg2Rad))-90,n.x-o.MapConstants.maxLongitude)},t}();e.ProjectionMercator=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(78),r=function(){function t(t,e){if(null==t||null==e)throw Error("Parameters can not be null");this.x=t,this.y=e}return t.convertPointToMBPoint=function(t){return new i(t.x,t.y)},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},t.prototype.toString=function(){return"("+String(this.x)+","+String(this.y)+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"x"in e&&"y"in e)return new t(Number(e.x),Number(e.y));throw new Error("`IPoint` argument must be specified as a Point instance, an object {x: <x>, y: <y>}, or an array of [<x>, <y>]")},t}();e.Point=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(14),o=n(4),a=n(6),s=n(20),l=n(0),u=n(1),h=n(17),c=n(60),f=function(){function t(){}return t.lat=function(t,e){var n=Math.PI-2*Math.PI*e/Math.pow(2,t);return l.MathConstants.rad2Deg*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))},t.lon=function(t,e){return e/Math.pow(2,t)*l.MapConstants.maxDegrees-l.MapConstants.maxLongitude},t.screenCoordinateToNDC=function(t,e){var n=2*t.x/e.x-1,r=1-2*t.y/e.y;return new i.Vector2(n,r)},t.NDCCoordinateToScreen=function(t,e){var n=e.x*(1+t.x)/2,r=e.y*(1-t.y)/2;return new i.Vector2(n,r)},t.screenCoordinateToLatLng=function(t,e,n,i){return void 0===i&&(i=0),this.screenCoordinateToLatLngZoom(t,e,n,e.getZoom(),i)},t.screenCoordinateToLatLngZoom=function(e,n,s,u,f){if(void 0===f&&(f=0),n.getTilt()>l.MapConstants.maxTiltIntersectWithScreen){var p=this.screenCoordinateToLatLng(new i.Vector2(0,0),new h.CameraPosition(n.getTarget(),l.MapConstants.maxTiltIntersectWithScreen,n.getBearing(),n.getZoom()),s),d=this.latLngToScreenCoordinate(p,0,n,s).y/s.y*s.y;if(e.y<d)return new o.LatLng(1/0,1/0)}u<0&&(u=n.getZoom());var g=t.getElevationPixelFromMeter(f,n)*Math.sin(l.MathConstants.deg2Rad*-n.getTilt()),m=c.CameraUtils.calculateInverseViewProjectionMatrix(n,s.x,s.y),y=Math.pow(2,u),v=t.screenCoordinateToNDC(new i.Vector2(e.x,e.y-g),s),b=m.transform(new r.Vector3(v.x,v.y,-1),1),_=m.transform(new r.Vector3(v.x,v.y,1),1),w=_.z-b.z,M=b.x-(_.x-b.x)*b.z/w,x=b.y-(_.y-b.y)*b.z/w,A=n.getTarget(),T=Math.pow(2,u),S=a.ProjectionMercator.projectScale(A,T);return a.ProjectionMercator.unproject(new i.Vector2(M+S.x,S.y-x),y)},t.pixelCoordinateToCameraCoordinate=function(e,n){return t.pixelCoordinateToCameraCoordinateZoom(e,n,n.getZoom())},t.pixelCoordinateToCameraCoordinateZoom=function(t,e,n){var i=Math.pow(2,n),r=a.ProjectionMercator.worldSize(i),o=a.ProjectionMercator.projectScale(e.getTarget(),i);o.x=o.x-r/2,o.y=r/2-o.y;var s=t;return s.x=s.x-r/2,s.y=r/2-s.y,s.x-=o.x,s.y-=o.y,s},t.latLngToScreenCoordinate=function(t,e,n,i){return this.latLngToScreenCoordinateZoom(t,e,n,i,n.getZoom())},t.latLngToScreenCoordinateZoom=function(e,n,o,s,l){l<0&&(l=o.getZoom());var u=Math.pow(2,l),h=a.ProjectionMercator.projectScale(e,u),f=this.pixelCoordinateToCameraCoordinateZoom(h,o,l),p=t.getElevationPixelFromMeter(n,o),d=new r.Vector3(f.x,f.y,p),g=c.CameraUtils.calculateViewProjectionMatrix(o,s.x,s.y).transform(d,1),m=(g.x+1)*s.x/2,y=s.y-(g.y+1)*s.y/2;return new i.Vector2(m,y)},t.tileCoordinateToLatLngBounds=function(e){var n=e.getX(),i=e.getY(),r=e.getZoom(),a=new o.LatLng(t.lat(r,i+1),t.lon(r,n)),l=new o.LatLng(t.lat(r,i),t.lon(r,n+1));return new s.LatLngBounds(a,l)},t.pixelCoordinateToVectorTileCoordinate=function(t,e,n,r){var o=u.MapUtils.getTileSize()*r,a=t.x-e*o,s=t.y-n*o;return a=a/o-.5,s=.5-s/o,new i.Vector2(a,s)},t.getElevationPixelFromMeter=function(e,n){return e=Math.max(e,0),t.getPixelFromMeter(e,n.getTarget().lat,n.getZoom())},t.getPixelFromMeter=function(t,e,n){return t/a.ProjectionMercator.getMetersPerPixelAtLatitude(e,n)},t}();e.GeometryUtils=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),this.alpha=i,this._buffer=new Float32Array([t,e,n])}return t.prototype.rgbBuffer=function(){return this._buffer},t.prototype.buffer=function(){return new Float32Array([this.red,this.green,this.blue,this.alpha])},Object.defineProperty(t.prototype,"red",{get:function(){return this._buffer[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"green",{get:function(){return this._buffer[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blue",{get:function(){return this._buffer[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return"rgba("+255*this.red+","+255*this.green+","+255*this.blue+","+this.alpha+")"},enumerable:!0,configurable:!0}),t.fromHex=function(e){void 0===e&&(e="000000"),7!=e.length&&9!=e.length||(e=e.substring(1,e.length));var n=parseInt(e,16);return 6==e.length?new t((n>>16)/255,(n>>8&255)/255,(255&n)/255):new t((n>>24&255)/255,(n>>16&255)/255,(n>>8&255)/255,(255&n)/255)},t.fromInt=function(e){return void 0===e&&(e=0),e<0&&(e=0),new t((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)},t.fromVec3=function(e){return new t(e.x,e.y,e.z)},t.mix=function(e,n,i){return new t(e.red*i+n.red*(1-i),e.green*i+n.green*(1-i),e.blue*i+n.blue*(1-i),e.alpha*i+n.alpha*(1-i))},Object.defineProperty(t.prototype,"code",{get:function(){var t=function(t){var e=(255*t).toString(16);e=(e=1==e.length?"0"+e:e).length>2?e.substr(0,2):e};return"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha)},enumerable:!0,configurable:!0}),t.isValid=function(t){return/^#?([0-9A-Fa-f]){6,8}$/i.test(t)},t}();e.Color=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this.name=t,this.size=e,this.offset=n,this.stride=i}}();e.AttributeInfo=i;var r=function(){return function(t,e,n){this.name=t,this.type=e,this.value=n}}();e.UniformInfo=r;var o=function(){function t(t,e,n){this.gl=t,this.textureUnit=0,this.uniforms={},this.attributes={},this.program=t.createProgram(),this.fragmentShader=this.loadShader(t.FRAGMENT_SHADER,n),this.vertexShader=this.loadShader(t.VERTEX_SHADER,e),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||(console.log("Error linking shader program"),console.log(t.getProgramInfoLog(this.program))),this.loadAttributes(),this.loadUniforms()}return t.prototype.loadAttributes=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=0;n<e;++n){var i=t.getActiveAttrib(this.program,n).name;this.attributes[i]=t.getAttribLocation(this.program,i)}},t.prototype.loadUniforms=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=0;n<e;++n){var i=t.getActiveUniform(this.program,n).name;this.uniforms[i]=t.getUniformLocation(this.program,i)}},t.prototype.loadShader=function(t,e){var n=this.gl,i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS)||(console.log("Error loading shader"),console.log(e),console.log(n.getShaderInfoLog(i))),i},t.prototype.bind=function(){this.gl.useProgram(this.program),this.resetTextureUnit()},t.prototype.resetTextureUnit=function(){this.textureUnit=0},t.prototype.setAttributes=function(t){for(var e=this.gl,n=0,i=t;n<i.length;n++){var r=i[n],o=this.attributes[r.name];null!=o&&(e.enableVertexAttribArray(o),e.vertexAttribPointer(o,r.size,e.FLOAT,!1,4*r.stride,4*r.offset))}},t.prototype.setUniforms=function(t){for(var e=this.gl,n=0,i=t;n<i.length;n++){var r=i[n],o=this.uniforms[r.name];null!==o&&("matrix"==r.type&&r.value?e.uniformMatrix4fv(o,!1,r.value.buffer()):"texture"==r.type&&r.value?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,r.value.textureId),e.uniform1i(o,this.textureUnit),this.textureUnit+=1):"textureCube"==r.type&&r.value?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_CUBE_MAP,r.value.textureId),e.uniform1i(o,this.textureUnit),this.textureUnit+=1):"4fv"==r.type&&r.value?e.uniform4fv(o,r.value):"3fv"==r.type&&r.value?e.uniform3fv(o,r.value):"3f"==r.type&&r.value?e.uniform3f(o,r.value.x,r.value.y,r.value.z):"2fv"==r.type&&r.value?e.uniform2fv(o,r.value):"1f"==r.type?e.uniform1f(o,r.value):"1i"==r.type?e.uniform1i(o,r.value):console.error("Invalid uniform info type: "+r.type))}},t.prototype.disableAttributes=function(){for(var t in this.attributes)this.gl.disableVertexAttribArray(this.attributes[t])},t.prototype.destroy=function(){this.uniforms={},this.attributes={},this.gl.deleteProgram(this.program),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader)},t}();e.Shader=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),r=function(){function t(t){void 0===t&&(t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),this.data=t}return t.translate=function(e,n,i){return void 0===i&&(i=0),new t(new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,n,i,1]))},Object.defineProperty(t.prototype,"position",{get:function(){return new i.Vector3(this.data[12],this.data[13],this.data[14])},enumerable:!0,configurable:!0}),t.rotateX=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1]))},t.rotateY=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1]))},t.rotateZ=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1]))},t.scale=function(e,n,i){return null==n&&(n=e,i=e),new t(new Float32Array([e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1]))},t.prototype.concat=function(e){var n=new t(new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));if(null==e)return n;for(var i=0;i<4;++i)for(var r=0;r<4;++r)for(var o=0;o<4;++o)n.data[4*i+o]+=this.data[4*i+r]*e.data[4*r+o];return n},t.ortho=function(e,n,i,r,o,a){return void 0===o&&(o=-100),void 0===a&&(a=100),new t(new Float32Array([2/(n-e),0,0,0,0,2/(r-i),0,0,0,0,-2/(a-o),0,-(e+n)/(n-e),-(r+i)/(r-i),-(o+a)/(o-a),1]))},t.perspective=function(e,n,i,r){var o=Math.tan(e/2)*i,a=o*n;return t.frustum(-a,a,-o,o,i,r)},t.frustum=function(e,n,i,r,o,a){return void 0===o&&(o=-100),void 0===a&&(a=100),new t(new Float32Array([2*o/(n-e),0,0,0,0,2*o/(r-i),0,0,(n+e)/(n-e),(r+i)/(r-i),-(a+o)/(a-o),-1,0,0,-2*o*a/(a-o),0]))},t.prototype.transform=function(t,e){void 0===e&&(e=0);var n=this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12]*e,r=this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13]*e,o=this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]*e;return 0==(e=this.data[3]*t.x+this.data[7]*t.y+this.data[11]*t.z+this.data[15]*e)&&(e=1),new i.Vector3(n/e,r/e,o/e)},t.prototype.buffer=function(){return this.data},t.lookAt=function(e,n,r,o){void 0===r&&(r=1),void 0===o&&(o=new i.Vector3(0,0,1));var a=e.subtract(n).normalize(),s=o.cross(a).normalize(),l=a.cross(s).normalize(),u=new t(new Float32Array([s.x,l.x,a.x,0,s.y,l.y,a.y,0,s.z,l.z,a.z,0,0,0,0,1])),h=t.translate(-e.x,-e.y,-e.z),c=t.scale(r);return h.concat(u).concat(c)},t.prototype.inverse=function(){for(var e=this.data.slice(),n=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=0;i<4;++i){for(var r=i;r<4&&0==e[4*r+i];)++r;if(4==r||0==e[4*r+i])return console.log("Cannot calculate inverse, determinant is zero"),this;if(r!=i){var o=e.slice(4*i,4*(i+1)),a=e.slice(4*r,4*(r+1));e.set(a,4*i),e.set(o,4*r);var s=n.slice(4*i,4*(i+1)),l=n.slice(4*r,4*(r+1));n.set(l,4*i),n.set(s,4*r)}var u=e.slice(4*i,4*(i+1)),h=n.slice(4*i,4*(i+1));for(r=0;r<4;++r){a=e.slice(4*r,4*(r+1)),l=n.slice(4*r,4*(r+1));if(r!=i){if(0!=a[i]){for(var c=-a[i]/u[i],f=i;f<4;++f)a[f]=a[f]+c*u[f];e.set(a,4*r);for(f=0;f<4;++f)l[f]=l[f]+c*h[f];n.set(l,4*r)}}else{if(0==(c=u[i]))return console.log("Cannot calculate inverse, determinant is zero"),this;for(f=i;f<4;++f)a[f]=a[f]/c;e.set(a,4*r);for(f=0;f<4;++f)l[f]=l[f]/c;n.set(l,4*r)}}}return new t(n)},t}();e.Matrix4=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.clamp=function(t,e,n){return t<e?e:t>n?n:t},t.toRadians=function(t){return t*Math.PI/180},t.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t}();e.MathUtils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r,o,a=n(10),s=n(37),l=n(221),u=n(54),h=n(36),c=n(65),f=n(0),p=n(48);!function(t){t[t.SYMBOL_SHADER=0]="SYMBOL_SHADER",t[t.POLYLINE_SHADER=1]="POLYLINE_SHADER",t[t.FILL_SHADER=2]="FILL_SHADER",t[t.GEOJSON_SHADER=3]="GEOJSON_SHADER",t[t.RASTER_SHADER=4]="RASTER_SHADER",t[t.RASTER_WITH_SHADOW_SHADER=5]="RASTER_WITH_SHADOW_SHADER",t[t.RASTER_FOG_SHADER=6]="RASTER_FOG_SHADER",t[t.RASTER_3D_WITH_SHADOW_SHADER=7]="RASTER_3D_WITH_SHADOW_SHADER",t[t.CIRCLE_SHADER=8]="CIRCLE_SHADER",t[t.BUILDING_OUTLINING=9]="BUILDING_OUTLINING",t[t.BUILDING_SHADER=10]="BUILDING_SHADER",t[t.BUILDING_SELECTION_SHADER=11]="BUILDING_SELECTION_SHADER",t[t.DEBUG_SELECTION_SHADER=12]="DEBUG_SELECTION_SHADER",t[t.PARTICLE_SHADER=13]="PARTICLE_SHADER",t[t.SHADOW_MAPPING_SHADER=14]="SHADOW_MAPPING_SHADER",t[t.BUILDING_WITH_SHADOW_SHADER=15]="BUILDING_WITH_SHADOW_SHADER",t[t.SKY_SHARDER=16]="SKY_SHARDER",t[t.TEXT_LABEL_SHADER=17]="TEXT_LABEL_SHADER",t[t.TILE_DEBUG_SHADER=18]="TILE_DEBUG_SHADER"}(i=e.ShaderEnum||(e.ShaderEnum={})),function(t){t[t.SYMBOL_MODEL=0]="SYMBOL_MODEL",t[t.RASTER_MODEL=1]="RASTER_MODEL",t[t.CIRCLE_MODEL=2]="CIRCLE_MODEL",t[t.SKY_MODEL=3]="SKY_MODEL",t[t.SELECTION_DEBUG_MODEL=4]="SELECTION_DEBUG_MODEL",t[t.PARTICLE_QUAD_MODEL=5]="PARTICLE_QUAD_MODEL"}(r=e.ModelEnum||(e.ModelEnum={})),function(t){t[t.WHITE_TEXTURE=0]="WHITE_TEXTURE",t[t.RAIN_TEXTURE=1]="RAIN_TEXTURE",t[t.SNOW_TEXTURE=2]="SNOW_TEXTURE",t[t.WATER_DISPLACEMENT=3]="WATER_DISPLACEMENT",t[t.WATER_COLOR=4]="WATER_COLOR",t[t.POLYLINE_TEXTURE=5]="POLYLINE_TEXTURE"}(o=e.TextureEnum||(e.TextureEnum={}));var d=function(){function t(t){this.gl=t,this.shaders=new Map,this.models=new Map,this.textures=new Map,this.init()}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var n=this.instances.get(e);return n||(n=new this(t),this.instances.set(e,n)),n},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var n=this.instances.get(e);n&&(n.textures.forEach(function(t){return t.destroy()}),n.models.forEach(function(t){return t.destroy()}),n.shaders.forEach(function(t){return t.destroy()}),n.textures.clear(),n.models.clear(),n.shaders.clear(),this.instances.delete(e))}},t.prototype.createShader=function(t,e){return new a.Shader(this.gl,t,e)},t.prototype.createModel=function(t){var e=this.gl,n=new s.Model(e),i=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null);var r=[new a.AttributeInfo("a_position",3,0,5),new a.AttributeInfo("a_uv",2,3,5)];return n.numOfVertices=6,n.arrayBuffer=i,n.attributeInfos=r,n},t.prototype.init=function(){var t=this.createShader(l.ShaderSource.basicVS,l.ShaderSource.basicFS);this.shaders.set(i.RASTER_SHADER,t),this.shaders.set(i.RASTER_FOG_SHADER,this.createShader(l.ShaderSource.rasterFogVS,l.ShaderSource.rasterFogFS)),this.shaders.set(i.RASTER_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.raster3DWithShadowVS,l.ShaderSource.rasterWithShadowFS+l.ShaderSource.shadowFS)),this.shaders.set(i.RASTER_3D_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.raster3DWithShadowVS,l.ShaderSource.raster3DWithShadowFS+l.ShaderSource.shadowFS)),this.shaders.set(i.SYMBOL_SHADER,this.createShader(l.ShaderSource.markerVS,l.ShaderSource.markerFS)),this.shaders.set(i.POLYLINE_SHADER,this.createShader(l.ShaderSource.polylineVS,l.ShaderSource.polylineFS)),this.shaders.set(i.FILL_SHADER,this.createShader(l.ShaderSource.fillVS,l.ShaderSource.fillFS)),this.shaders.set(i.GEOJSON_SHADER,this.createShader(l.ShaderSource.geoJsonVS,l.ShaderSource.geoJsonFS)),this.shaders.set(i.CIRCLE_SHADER,this.createShader(l.ShaderSource.circleVS,l.ShaderSource.circleFS)),this.shaders.set(i.BUILDING_OUTLINING,this.createShader(l.ShaderSource.buildingVS,l.ShaderSource.buildingOutliningFS)),this.shaders.set(i.BUILDING_SHADER,this.createShader(l.ShaderSource.buildingVS,l.ShaderSource.buildingFS)),this.shaders.set(i.BUILDING_SELECTION_SHADER,this.createShader(l.ShaderSource.buildingSelectionVS,l.ShaderSource.buildingSelectionFS)),this.shaders.set(i.SKY_SHARDER,this.createShader(l.ShaderSource.skyVS,l.ShaderSource.skyFS)),this.shaders.set(i.DEBUG_SELECTION_SHADER,this.createShader(l.ShaderSource.debugSelectionVS,l.ShaderSource.debugSelectionFS)),this.shaders.set(i.PARTICLE_SHADER,t),this.shaders.set(i.SHADOW_MAPPING_SHADER,this.createShader(l.ShaderSource.shadowMappingVS,l.ShaderSource.shadowMappingFS)),this.shaders.set(i.TEXT_LABEL_SHADER,this.createShader(l.ShaderSource.textLabelVS,l.ShaderSource.textLabelFS)),this.shaders.set(i.BUILDING_WITH_SHADOW_SHADER,this.createShader(l.ShaderSource.buildingWithShadowVS,l.ShaderSource.buildingWithShadowFS+l.ShaderSource.shadowFS)),p.Env.isTileDebug&&this.shaders.set(i.TILE_DEBUG_SHADER,this.createShader(l.ShaderSource.tileDebugVS,l.ShaderSource.tileDebugFS));var e=new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,1,1,0,1,0,1,-1,0,1,1,-1,-1,0,0,1]),n=this.createModel(e),d=[],g=new u.CircleBuilderContext;g.addVertex=function(t){d.push(t.x,t.y)},u.buildCircle(g);var m=new s.Model(this.gl);m.init(d,[new a.AttributeInfo("a_extrude",2,0,2)],g.indices),this.models.set(r.RASTER_MODEL,n),this.models.set(r.SYMBOL_MODEL,n),this.models.set(r.SKY_MODEL,n),this.models.set(r.CIRCLE_MODEL,m),this.models.set(r.SELECTION_DEBUG_MODEL,n),this.models.set(r.PARTICLE_QUAD_MODEL,n);var y=new h.Texture(this.gl);this.textures.set(o.WHITE_TEXTURE,y);var v=new h.Texture(this.gl);v.loadImage(c.Images.get("rainTexture"),null),this.textures.set(o.RAIN_TEXTURE,v);var b=new h.Texture(this.gl);b.loadImage(c.Images.get("snowTexture"),null),this.textures.set(o.SNOW_TEXTURE,b);var _=new h.TextureFiltering(this.gl.LINEAR_MIPMAP_LINEAR,this.gl.LINEAR),w=new h.TextureWrapping(this.gl.REPEAT,this.gl.REPEAT),M=new h.TextureOptions(this.gl.TEXTURE_2D,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,_,w),x=new h.Texture(this.gl,M);x.loadImage(c.Images.waterDisplacement,null),this.textures.set(o.WATER_DISPLACEMENT,x);var A=new h.Texture(this.gl,M);A.loadImage(c.Images.waterColor,null),this.textures.set(o.WATER_COLOR,A);var T=new h.Texture(this.gl,M),S=new Uint8Array(this.createPolylineImageData(f.PolyConstants.polylineTextureWidth,f.PolyConstants.polylineTextureHeight));T.loadImageDataArray(S,f.PolyConstants.polylineTextureWidth,f.PolyConstants.polylineTextureHeight,this.gl.NEAREST),this.textures.set(o.POLYLINE_TEXTURE,T)},t.prototype.getShader=function(t){return this.shaders.get(t)},t.prototype.getModel=function(t){return this.models.get(t)},t.prototype.getTexture=function(t){return this.textures.get(t)},t.prototype.createPolylineImageData=function(t,e){for(var n=new Array(t*e*4).fill(0),i=0,r=0;r<e;++r)for(var o=0;o<t;++o)n[i]=o<t/2?0:255,n[i+1]=0,n[i+2]=0,n[i+3]=255,i+=4;return n},t.instances=null,t}();e.ResourceManager=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}return t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.buffer=function(){return new Float32Array([this.x,this.y,this.z])},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0,r=0;return e>0&&(n=this.x/e,i=this.y/e,r=this.z/e),new t(n,i,r)},t.prototype.set=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.rotate90=function(){return new t(this.y,-this.x,this.z)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y,e.z+this.z)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y,this.z-e.z):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y,e*this.z)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y+t.z*this.z},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}();e.Vector3=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon"}(e.GeometryType||(e.GeometryType={}));var i=function(){function t(t,e,n){this.properties=new Map,this.type=t,this.geometries=e,this.properties=n}return t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t.prototype.getProperties=function(){return this.properties},t}();e.GeometryTileFeature=i;var r=function(){function t(t){this.features=[],this.name=t}return t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeature=function(t){return this.features[t]},t.prototype.getName=function(){return this.name},t}();e.GeometryTileLayer=r;var o=function(){return function(){}}();e.GeometryTileData=o},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(t){i=a}}();var l,u=[],h=!1,c=-1;function f(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&p())}function p(){if(!h){var t=s(f);h=!0;for(var e=u.length;e;){for(l=u,u=[];++c<e;)l&&l[c].run();c=-1,e=u.length}l=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||h||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=function(){function t(t,e,n,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),void 0===r&&(r=null),this.target=null==t?null:i.LatLng.convert(t),this.tilt=e,this.bearing=n,this.zoom=r}return t.prototype.setTarget=function(t){this.target=i.LatLng.convert(t)},t.prototype.setTilt=function(t){this.tilt=t},t.prototype.setBearing=function(t){this.bearing=t,Math.abs(Math.abs(this.bearing)%180-90)<.1&&(this.bearing+=.2)},t.prototype.setZoom=function(t){this.zoom=t},t.prototype.getTarget=function(){return this.target},t.prototype.getTilt=function(){return this.tilt},t.prototype.getBearing=function(){return this.bearing},t.prototype.getZoom=function(){return this.zoom},t.convert=function(e){return e instanceof t?e:new t(e.target,e.tilt,e.bearing,e.zoom)},t}();e.CameraPosition=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.RASTER=0]="RASTER",t[t.ANNOTAION=1]="ANNOTAION",t[t.VECTOR=2]="VECTOR"}(e.Kind||(e.Kind={}));var i=function(){function t(t,e,n){this.rasterLoaded=!1,this.dataLoaded=!1,this.kind=t,this.tileCoordinate=e,this.gl=n}return t.prototype.isRenderable=function(){return this.rasterLoaded||this.dataLoaded},t.prototype.isFinishedLoading=function(){return this.rasterLoaded&&this.dataLoaded},t.prototype.getKind=function(){return this.kind},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t}();e.Tile=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(49),o=function(){function t(e){this.minZoom=i.MapConstants.defaultMinZoom,this.maxZoom=i.MapConstants.defaultMaxZoom,this.maxNativeZoom=i.MapConstants.defaultMaxNativeZoom,this._3dMode=!1,this._objectsEnabled=!0,this._placesEnabled=!0,this._filterPlaceTypes=[],this._dataLayerMinZoom=i.MapConstants.defaultMinZoom,this._dataLayerMaxZoom=i.MapConstants.defaultMaxZoom,this.switchMode=r.SwitchMode.Manual,this.mapModeChangedObserver=e,this.tile2dUrl=i.MapConstants.defaultMap2dUrl,this.map2dUrl=i.MapConstants.baseMapUrl+"?mode=2d&key="+t.getAccessKey(),this.tile3dUrl=i.MapConstants.defaultMap3dUrl,this.map3dUrl=i.MapConstants.baseMapUrl+"?mode=3d&key="+t.getAccessKey()}return t.prototype.setTileUrl=function(t,e){void 0===e&&(e=!1),null==t&&(t=e?i.MapConstants.defaultMap3dUrl:i.MapConstants.defaultMap2dUrl),e?this.tile3dUrl=t:this.tile2dUrl=t},t.prototype.getTileUrl=function(t){return t?this.tile3dUrl:this.tile2dUrl},t.prototype.setMinZoom=function(t){this.minZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.setMaxZoom=function(t){this.maxZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.getMapUrl=function(){return this._3dMode?this.map3dUrl:this.map2dUrl},t.prototype.getPreferMaxTilt=function(){if(this.is3dMode())return i.MapConstants.maxTilt3D;switch(this.switchMode){case r.SwitchMode.Auto:case r.SwitchMode.Auto2DTo3D:return i.MapConstants.maxTilt3D}return i.MapConstants.maxTilt2D},t.prototype.getPreferMinZoom=function(){var t=this.minZoom,e=0;switch(this.switchMode){case r.SwitchMode.Auto:case r.SwitchMode.Auto3DTo2D:t=this.minZoom>i.MapConstants.defaultMinZoom?this.minZoom:i.MapConstants.defaultMinZoom;break;default:e=this.is3dMode()?i.MapConstants.defaultMinZoom3d:i.MapConstants.defaultMinZoom,t=this.minZoom>e?this.minZoom:e}return t},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinTilt=function(){return i.MapConstants.minTilt},t.prototype.getMaxTilt=function(){return this._3dMode?i.MapConstants.maxTilt3D:i.MapConstants.maxTilt2D},t.prototype.getMaxNativeZoom=function(){return this.maxNativeZoom},t.prototype.setDate=function(t){this.date=t},t.prototype.getDate=function(){return this.date||new Date},t.prototype.setMaxNativeZoom=function(t){this.maxNativeZoom=t},t.getAccessKey=function(){return this.accessKey},t.setAccessKey=function(t){this.accessKey=t},t.prototype.enable3dMode=function(t){return t!=this._3dMode&&(this._3dMode=t,this.mapModeChangedObserver.onMapModeChanged(),!0)},t.prototype.is3dMode=function(){return this._3dMode},t.prototype.setSwitchMode=function(t){this.switchMode=t},t.prototype.getSwitchMode=function(){return this.switchMode},Object.defineProperty(t.prototype,"objectsEnabled",{get:function(){return this._objectsEnabled},set:function(t){this._objectsEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placesEnabled",{get:function(){return this._placesEnabled},set:function(t){this._placesEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterPlaceTypes",{get:function(){return this._filterPlaceTypes},set:function(t){this._filterPlaceTypes=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLayerMinZoom",{get:function(){return this._dataLayerMinZoom},set:function(t){this._dataLayerMinZoom=t,this._dataLayerMinZoom>this._dataLayerMaxZoom&&(this._dataLayerMinZoom+=this._dataLayerMaxZoom,this._dataLayerMaxZoom=this._dataLayerMinZoom-this._dataLayerMaxZoom,this._dataLayerMinZoom-=this._dataLayerMaxZoom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataLayerMaxZoom",{get:function(){return this._dataLayerMaxZoom},set:function(t){this._dataLayerMaxZoom=t,this._dataLayerMinZoom>this._dataLayerMaxZoom&&(this._dataLayerMinZoom+=this._dataLayerMaxZoom,this._dataLayerMaxZoom=this._dataLayerMinZoom-this._dataLayerMaxZoom,this._dataLayerMinZoom-=this._dataLayerMaxZoom)},enumerable:!0,configurable:!0}),t.accessKey="__ACCESS_KEY__",t}();e.MapSettings=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(0),o=function(){function t(t,e){if(t&&(e?(this.southwest=t instanceof i.LatLng?new i.LatLng(t.lat,t.lng):i.LatLng.convert(t),this.northeast=e instanceof i.LatLng?new i.LatLng(e.lat,e.lng):i.LatLng.convert(e)):4===t.length?(this.southwest=i.LatLng.convert([t[1],t[0]]),this.northeast=i.LatLng.convert([t[3],t[2]])):(this.southwest=t[0]instanceof i.LatLng?new i.LatLng(t[0].lat,t[0].lng):i.LatLng.convert(t[0]),this.northeast=t[1]instanceof i.LatLng?new i.LatLng(t[1].lat,t[1].lng):i.LatLng.convert(t[1]))),this.southwest&&this.northeast&&(this.southwest.lat>this.northeast.lat||this.southwest.lng>this.northeast.lng)){var n=this.southwest,r=this.northeast;this.southwest=new i.LatLng(Math.min(n.lat,r.lat),Math.min(n.lng,r.lng)),this.northeast=new i.LatLng(Math.max(n.lat,r.lat),Math.max(n.lng,r.lng))}}return t.prototype.extend=function(t){var e=i.LatLng.convert(t);return this.southwest&&this.northeast?(this.southwest=new i.LatLng(Math.min(e.lat,this.southwest.lat),Math.min(this.southwest.lng,e.lng)),this.northeast=new i.LatLng(Math.max(e.lat,this.northeast.lat),Math.max(this.northeast.lng,e.lng))):(this.southwest=new i.LatLng(e.lat,e.lng),this.northeast=new i.LatLng(e.lat,e.lng)),this},t.prototype.getCenter=function(){return this.northeast&&this.southwest?new i.LatLng((this.northeast.lat+this.southwest.lat)/2,(this.northeast.lng+this.southwest.lng)/2):new i.LatLng(0,0)},t.prototype.getNortheast=function(){return this.northeast||i.LatLng.convert([r.MapConstants.maxLongitude,r.MapConstants.maxLatitude])},t.prototype.getSouthwest=function(){return this.southwest||i.LatLng.convert([r.MapConstants.minLongitude,r.MapConstants.minLatitude])},t.world=function(){return new t([r.MapConstants.minLongitude,r.MapConstants.minLatitude],[r.MapConstants.maxLongitude,r.MapConstants.maxLatitude])},t.convert=function(e){return e instanceof t?e:new t(e)},t}();e.LatLngBounds=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(36),r=n(65),o=n(25),a=n(0),s=n(19),l=function(){function t(t){this.gl=t,this.textures=new Map,this.acquire("markerClusterIcon"),this.acquire(a.SymbolConstants.placeSelectedSymbol)}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var n=this.instances.get(e);return n||(n=new this(t),this.instances.set(e,n)),n},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var n=this.instances.get(e);n&&(n.textures.forEach(function(t){return t.destroy()}),this.instances.delete(e))}},t.prototype.setRequestRender=function(t){this.requestRender=t},t.prototype.acquire=function(t,e){var n=this;void 0===e&&(e=!0);var l=t;if(null==t)return console.error("Url should not be null"),null;this.gl||console.error("Please initialize SymbolResourceManager before using it");var u=this.textures.get(t);return"iconDefault"==l&&(t=o.UrlUtils.getIconRequestUrl(a.MapConstants.iconRequestUrl,"default",s.MapSettings.getAccessKey())),null!=u?(e&&u.retain(),u):((u=new i.Texture(this.gl)).loadImage(o.UrlUtils.isUrlRequest(t)?t:r.Images.get(t),function(){n.requestRender()}),u.retain(),"iconDefault"==l?this.textures.set(l,u):this.textures.set(t,u),u)},t.prototype.release=function(t){if(null!=t){this.gl||console.error("Please initialize SymbolResourceManager before using it");var e=this.textures.get(t);null!=e&&(e.release(),e.reference<=0&&this.textures.delete(t))}else console.error("Url should not be null")},t.instances=null,t}();e.SymbolResourceManager=l},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(t,i){var r=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,a=String(t).replace(r,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),l=i[n];n<o;l=i[++n])g(l)||!_(l)?a+=" "+l:a+=" "+s(l);return a},e.deprecate=function(n,r){if(v(t.process))return function(){return e.deprecate(n,r).apply(this,arguments)};if(!0===i.noDeprecation)return n;var o=!1;return function(){if(!o){if(i.throwDeprecation)throw new Error(r);i.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),d(n)?i.showHidden=n:n&&e._extend(i,n),v(i.showHidden)&&(i.showHidden=!1),v(i.depth)&&(i.depth=2),v(i.colors)&&(i.colors=!1),v(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),h(i,t,i.depth)}function l(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function u(t,e){return t}function h(t,n,i){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return y(r)||(r=h(t,r,i)),r}var o=function(t,e){if(v(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(m(e))return t.stylize(""+e,"number");if(d(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),M(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(x(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(M(n))return c(n)}var u,_="",A=!1,T=["{","}"];(p(n)&&(A=!0,T=["[","]"]),x(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),M(n)&&(_=" "+c(n)),0!==a.length||A&&0!=n.length?i<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=A?function(t,e,n,i,r){for(var o=[],a=0,s=e.length;a<s;++a)E(e,String(a))?o.push(f(t,e,n,i,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,n,i,r,!0))}),o}(t,n,i,s,a):a.map(function(e){return f(t,n,i,s,e,A)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,_,T)):T[0]+_+T[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,i,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),E(i,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=g(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),v(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return"number"==typeof t}function y(t){return"string"==typeof t}function v(t){return void 0===t}function b(t){return _(t)&&"[object RegExp]"===A(t)}function _(t){return"object"==typeof t&&null!==t}function w(t){return _(t)&&"[object Date]"===A(t)}function M(t){return _(t)&&("[object Error]"===A(t)||t instanceof Error)}function x(t){return"function"==typeof t}function A(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(v(o)&&(o=i.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(o)){var n=i.pid;a[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,i)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=v,e.isRegExp=b,e.isObject=_,e.isDate=w,e.isError=M,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(170);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),S[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(28),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,n(22),n(16))},function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(t[i]=n[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){var e,n,i,r,o,a;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(a=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)o=t[e],a.set(o,r),r+=o.length;return a}},a={arraySet:function(t,e,n,i,r){for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(i)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),r=n(1),o=function(){function t(){}return t.getTileUrl=function(t,e,n,i){for(var r=0,o=0,a="";o<t.length;)if("{"==t[o]){switch(a+=t.substring(r,o),t[o+1]){case"x":a+=e.toString();break;case"y":a+=n.toString();break;case"z":a+=i.toString();break;default:console.log("Invalid map url pattern: "+t)}r=o+=3}else++o;return a+=t.substr(r)},t.getBuildingDataUrl=function(t,e,n){for(var i=0,r=0,o="";r<t.length;)if("{"==t[r]){switch(o+=t.substring(i,r),t[r+1]){case"s":o+=e;break;case"k":o+=n;break;default:console.log("Invalid Model url pattern: "+t)}i=r+=3}else++r;return o+=t.substr(i)},t.getIconRequestUrl=function(t,e,n){for(var o=0,a=0,s="";a<t.length;)if("{"==t[a]){switch(s+=t.substring(o,a),t[a+1]){case"t":s+=e;break;case"k":s+=n;break;case"s":s+=i.MathUtils.clamp(r.MapUtils.resourceScale,1,3)+"x";break;default:console.log("Invalid Model url pattern: "+t)}o=a+=3}else++a;return s+=t.substr(o)},t.isUrlRequest=function(t){return t.startsWith("http")||t.startsWith("./")||t.startsWith("/")||t.startsWith("blob:")},t}();e.UrlUtils=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),o=function(t){function e(e,n,i,r){var o=t.call(this,n,i,r)||this;return o.id=e,o}return i(e,t),e.prototype.getId=function(){return this.id},e}(r.GeometryTileFeature);e.VectorTileFeature=o;var a=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.addFeature=function(t,e,n,i){void 0===i&&(i=new Map),this.features.push(new o(t,e,n,i))},e}(r.GeometryTileLayer);e.VectorTileLayer=a;var s=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return i(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new a(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(r.GeometryTileData);e.VectorTileData=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(7),o=function(){function t(e){var n={};i.MapUtils.extendOptions(n,t.defaultMarkerLabelOptions,e);for(var o=0,a=n;o<a.length;o++){if(null==a[o])throw Error("Parameters can not be null")}this.fontWeight="normal"!=n.fontWeight&&"bold"!=n.fontWeight?"normal":n.fontWeight,this.color=n.color,this.fontSize=n.fontSize*i.MapUtils.pixelScale,this.maxWidth=n.maxWidth*i.MapUtils.pixelScale,this.line=n.line,this.text=n.text,this.halo=n.halo,this.haloColor=n.haloColor,this.anchor=r.Point.convert(n.anchor);var s={};i.MapUtils.extendOptions(s,t.defaultMarginOptions,n.margin),this.marginOptions=s}return t.prototype.getColor=function(){return this.color},t.prototype.getFontWeight=function(){return this.fontWeight},t.prototype.getFontSize=function(){return this.fontSize},t.prototype.getMaxWidth=function(){return this.maxWidth},t.prototype.getLine=function(){return this.line},t.prototype.getText=function(){return this.text},t.prototype.hasHalo=function(){return this.halo},t.prototype.getHaloColor=function(){return this.haloColor},t.prototype.getAnchor=function(){return this.anchor},t.prototype.getMargin=function(){return this.marginOptions},t.defaultMarkerLabelOptions={text:"",color:"#000000",fontWeight:"normal",fontSize:13,maxWidth:200,line:1,halo:!0,haloColor:"#ffffff",anchor:new r.Point(.5,.5),margin:{top:0,bottom:0,left:0,right:0}},t.defaultMarginOptions={top:0,bottom:0,left:0,right:0},t}();e.MarkerLabel=o},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var i=n(57),r=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=c;var o=n(45);o.inherits=n(28);var a=n(96),s=n(69);o.inherits(c,a);for(var l=r(s.prototype),u=0;u<l.length;u++){var h=l[u];c.prototype[h]||(c.prototype[h]=s.prototype[h])}function c(t){if(!(this instanceof c))return new c(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||i.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),c.prototype._destroy=function(t,e){this.push(null),this.end(),i.nextTick(e,t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.mapState=t,this.layer=e,this.selectionCode=0}return t.prototype.renderSelection=function(){},t.prototype.renderShadowMapping=function(){},t.prototype.getRenderTiles=function(){return this.layer.tileManager.getRenderTiles()},t.prototype.getVisibleTiles=function(){return this.layer.tileManager.getVisibleTiles()},t.prototype.getSelectionCode=function(){return this.selectionCode++,(this.selectionCode<t.MIN_SELECTION_CODE||this.selectionCode>t.MAX_SELECTION_CODE)&&(this.selectionCode=t.MIN_SELECTION_CODE),this.selectionCode},t.prototype.resetSelectionCode=function(){this.selectionCode=0},t.MIN_SELECTION_CODE=1,t.MAX_SELECTION_CODE=16777215,t}();e.LayerRenderer=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Texture=0]="Texture",t[t.Extrude=1]="Extrude",t[t.External=2]="External",t[t.ExternalExtrude=3]="ExternalExtrude"}(e.BuildingType||(e.BuildingType={}))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),o=n(38),a=n(1),s=n(7),l=n(0),u=function(t){function e(n){var i=t.call(this)||this,o={};if(a.MapUtils.extendOptions(o,e.defaultMarkerOptions,n),i.position=r.LatLng.convert(o.position),i.anchor=s.Point.convert(o.anchor),i.labelAnchor=s.Point.convert(o.labelAnchor),i.visible=o.visible,i.icon=o.icon,i.elevation=o.elevation,i.title=o.title,i.snippet=o.snippet,i.windowAnchor=o.windowAnchor,i.zIndex=o.zIndex,i.label=o.label,i.draggable=o.draggable,i.iconView=o.iconView,i.userInteractionEnabled=o.userInteractionEnabled,i.rotation=o.rotation,null==i.position||null==i.anchor||null==i.windowAnchor||null==i.visible||null==i.elevation||null==i.zIndex||null==i.draggable)throw Error("Parameters can not be null");return i}return i(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.map.mapView.hideInfoWindow(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setInfoWindow=function(t){t!==this.infoWindow&&(this.infoWindow=t)},e.prototype.setInfoContents=function(t){t!==this.infoContents&&(this.infoContents=t)},e.prototype.setIcon=function(t){this.getIconView()?console.warn("Icon view markers has the priority over other markers"):(null==t&&(t=l.SymbolConstants.defaultSymbol),t!==this.icon&&(this.icon=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)))},e.prototype.setTitle=function(t){this.title!==t&&(this.title=t,null!=this.map&&this.map.mapView.updateInfoContents(this.id))},e.prototype.setSnippet=function(t){this.snippet!==t&&(this.snippet=t,null!=this.map&&this.map.mapView.updateInfoContents(this.id))},e.prototype.setLabel=function(t){this.label!==t&&(this.label=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setWindowAnchor=function(t){if(null!=t){var e=s.Point.convert(t);this.windowAnchor.equals(e)||(this.windowAnchor=e)}else console.warn("Parameter anchor can not be null")},e.prototype.setPosition=function(t){if(null!=t){var e=r.LatLng.convert(t);this.position.equals(e)||(this.position=e,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))}else console.warn("Parameter position can not be null")},e.prototype.setVisible=function(t){null!=t?this.visible!==t&&(this.visible=t,null!=this.map&&(t||this.isInfoWindowShown()&&this.map.mapView.hideInfoWindow(this.id),this.map.mapView.updateAnnotation(this.id))):console.warn("Parameter visible can not be null")},e.prototype.setAnchor=function(t){if(null!=t){var e=s.Point.convert(t);this.anchor.equals(e)||(this.anchor=e,null!=this.map&&this.map.mapView.updateAnnotation(this.id))}else console.warn("Parameter anchor can not be null")},e.prototype.setLabelAnchor=function(t){if(null!=t){var e=s.Point.convert(t);this.labelAnchor.equals(e)||(this.labelAnchor=e,null!=this.map&&this.map.mapView.updateAnnotation(this.id))}else console.warn("Parameter labelAnchor can not be null")},e.prototype.setDraggable=function(t){null!=t?this.draggable=t:console.warn("Parameter draggable can not be null")},e.prototype.getTitle=function(){return this.title},e.prototype.getSnippet=function(){return this.snippet},e.prototype.getWindowAnchor=function(){return null==this.windowAnchor?null:new s.Point(this.windowAnchor.x,this.windowAnchor.y)},e.prototype.getPosition=function(){return this.position},e.prototype.isVisible=function(){return this.visible},e.prototype.getAnchor=function(){return null==this.anchor?null:new s.Point(this.anchor.x,this.anchor.y)},e.prototype.getLabelAnchor=function(){return null==this.labelAnchor?null:new s.Point(this.labelAnchor.x,this.labelAnchor.y)},e.prototype.getIcon=function(){return this.icon},e.prototype.getLabel=function(){return this.label},e.prototype.isDraggable=function(){return this.draggable},e.prototype.getInfoWindow=function(){return this.infoWindow},e.prototype.getInfoContents=function(){return this.infoContents},e.prototype.isInfoWindowShown=function(){return null!=this.map&&this.map.mapView.isInfoWindowShown(this.id)},e.prototype.showInfoWindow=function(){null!=this.map&&this.visible&&!this.isInfoWindowShown()&&this.map.mapView.showInfoWindow(this.id)},e.prototype.hideInfoWindow=function(){null!=this.map&&this.isInfoWindowShown()&&this.map.mapView.hideInfoWindow(this.id)},e.prototype.getIconView=function(){return this.iconView},e.prototype.setIconView=function(t){this.iconView!==t&&(this.iconView=t,null!=this.map&&this.map.mapView.updateInfoContents(this.id))},e.prototype.getRotation=function(){return this.rotation},e.prototype.setRotation=function(t){null!=t?this.rotation!==t&&(this.rotation=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter rotation can not be null")},e.defaultMarkerOptions={visible:!0,anchor:new s.Point(.5,1),labelAnchor:new s.Point(.5,.5),icon:l.SymbolConstants.defaultSymbol,elevation:0,rotation:0,windowAnchor:new s.Point(.5,0),zIndex:0,draggable:!1,iconView:null,userInteractionEnabled:!0},e}(o.Annotation);e.Marker=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(4),a=n(38),s=n(1);!function(t){t.Solid="solid",t.Dotted="dotted"}(r=e.PolylineStyle||(e.PolylineStyle={}));var l=function(t){function e(n){var i=t.call(this)||this,a={};s.MapUtils.extendOptions(a,e.defaultPolylineOptions,n);for(var l=0,u=a;l<u.length;l++){if(null==u[l])throw Error("Parameters can not be null")}return i.path=a.path.map(function(t){return o.LatLng.convert(t)}),i.strokeWidth=a.strokeWidth,i.strokeColor=a.strokeColor,i.strokeOpacity=a.strokeOpacity,i.visible=a.visible,i.closed=a.closed,i.draggable=a.draggable,i.elevation=a.elevation,i.zIndex=a.zIndex,a.style!=r.Dotted&&a.style!=r.Solid&&(console.warn("Wrong style options for Polyline. Only use 'dotted' or 'solid'."),a.style=r.Solid),i.style=a.style,i.userInteractionEnabled=a.userInteractionEnabled,i}return i(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setClosed=function(t){null!=t?this.closed!=t&&(this.closed=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter closed can not be null")},e.prototype.setPath=function(t){null==t||t.length<2?console.warn("Parameter path size must be greater than 1"):(this.path=t.map(function(t){return o.LatLng.convert(t)}),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))},e.prototype.setStrokeWidth=function(t){null!=t?this.strokeWidth!=t&&(this.strokeWidth=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeWidth can not be null")},e.prototype.setStrokeColor=function(t){null!=t?this.strokeColor!=t&&(this.strokeColor=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeColor can not be null")},e.prototype.setStrokeOpacity=function(t){null!=t?this.strokeOpacity!=t&&(this.strokeOpacity=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeOpacity can not be null")},e.prototype.setVisible=function(t){null!=t?this.visible!=t&&(this.visible=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.setStyle=function(t){null!=t?(t!=r.Dotted&&t!=r.Solid&&(console.warn("Wrong style options for Polyline. Only use 'dotted' or 'solid'."),t=r.Solid),this.style!=t&&(this.style=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id))):console.warn("Parameter style can not be null")},e.prototype.getPath=function(){return(this.path||[]).slice()},e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.getStrokeOpacity=function(){return this.strokeOpacity},e.prototype.isVisible=function(){return this.visible},e.prototype.isClosed=function(){return this.closed},e.prototype.isDraggable=function(){return this.draggable},e.prototype.getStyle=function(){return this.style},e.prototype.setDraggable=function(t){null!=t?this.draggable=t:console.warn("Parameter draggable can not be null")},e.defaultPolylineOptions={strokeWidth:0,strokeColor:"#0000ff",strokeOpacity:1,visible:!0,closed:!1,draggable:!1,zIndex:0,elevation:0,style:"solid",userInteractionEnabled:!0},e}(a.Annotation);e.Polyline=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(1),o=n(0),a=function(){function t(t,e,n,i){void 0===i&&(i=!1),this.x=t,this.y=e,this.zoom=n,this.mode3D=i&&this.getZoom()>=o.MapConstants.defaultMinZoom3d}return t.fromLatLng=function(e,n,o){var a=i.ProjectionMercator.projectScale(e,Math.pow(2,n)).multiply(1/r.MapUtils.getTileSize());return new t(Math.floor(a.x),Math.floor(a.y),n,o)},t.prototype.parent=function(){return new t(this.x/2,this.y/2,this.zoom-1,this.mode3D)},t.prototype.children=function(){var e=this.zoom+1,n=2*this.x,i=2*this.y;return[new t(n,i,e,this.mode3D),new t(n,i+1,e,this.mode3D),new t(n+1,i,e,this.mode3D),new t(n+1,i+1,e,this.mode3D)]},t.prototype.set3DMode=function(t){this.mode3D=t&&this.getZoom()>=o.MapConstants.defaultMinZoom3d},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZoom=function(){return this.zoom},t.prototype.is3DMode=function(){return this.mode3D},t.prototype.equal=function(t){return null!=t&&(this.x==t.x&&this.y==t.y&&this.zoom==t.zoom&&this.mode3D==t.mode3D)},t.prototype.notEqual=function(t){return null!=t&&(this.x!=t.x||this.y!=t.y||this.zoom!=t.zoom||this.mode3D!=t.mode3D)},t.prototype.lessThan=function(t){return null!=t&&(this.x==t.x?this.y==t.y?this.zoom==t.zoom?this.mode3D<t.mode3D:this.zoom<t.zoom:this.y<t.y:this.x<t.x)},t.prototype.isChildOf=function(t){return this.mode3D==t.mode3D&&null!=t&&(0==t.zoom||t.zoom<this.zoom&&t.x==this.x>>this.zoom-t.zoom&&t.y==this.y>>this.zoom-t.zoom)},t.prototype.toString=function(){return this.getZoom()+"/"+this.getX()+"/"+this.getY()+"/"+(this.mode3D?"1":"0")},t}();e.TileCoordinate=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(83);!function(t){t[t.RasterTile=0]="RasterTile",t[t.TileData=1]="TileData",t[t.Model=2]="Model",t[t.Texture=3]="Texture",t[t.Json=4]="Json",t[t.MAX=5]="MAX"}(e.Resource||(e.Resource={}));var r=function(){return function(t){this.method="GET",this.params=null,this.id=i.UUID.generate(),this.type=t}}();e.RequestTask=r;var o=function(){return function(t){this.id=t,this.success=!1,this.data=null}}();e.ResponseTask=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(63),o=n(9),a=function(){return function(t,e){this.min=t,this.mag=e}}();e.TextureFiltering=a;var s=function(){return function(t,e){this.wraps=t,this.wrapt=e}}();e.TextureWrapping=s;var l=function(){return function(t,e,n,i,r,o){this.target=t,this.internalFormat=e,this.format=n,this.type=i,this.filtering=r,this.wrapping=o}}();e.TextureOptions=l;var u=function(t){function e(e,n){void 0===n&&(n=null);var i=t.call(this)||this;return i.gl=e,i.options=n,null==n&&i.initDefaultTextureOptions(),i.isLoaded=!1,i.init(),i}return i(e,t),e.prototype.initDefaultTextureOptions=function(){var t=this.gl,e=new a(t.LINEAR_MIPMAP_LINEAR,t.LINEAR),n=new s(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE);this.options=new l(t.TEXTURE_2D,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e,n)},e.prototype.init=function(){var t=this.gl;this.textureId=t.createTexture(),this.loadColor(o.Color.fromHex("FFFFFF"))},e.prototype.bind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.textureId)},e.prototype.unbind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)},e.prototype.loadColor=function(t){var e=this.gl;if(this.width=1,this.height=1,null!=this.textureId){e.bindTexture(e.TEXTURE_2D,this.textureId);var n=new Uint8Array([255*t.red,255*t.green,255*t.blue,255*t.alpha]);e.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,n),e.texParameteri(this.options.target,e.TEXTURE_WRAP_S,this.options.wrapping.wraps),e.texParameteri(this.options.target,e.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.applyFilter(),e.bindTexture(e.TEXTURE_2D,null)}},e.prototype.loadImageFromArrayBuffer=function(t,e,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=null);var o=this.gl;this.width=e,this.height=n,null!=this.textureId&&(o.bindTexture(o.TEXTURE_2D,this.textureId),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,i?1:0),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,new ImageData(new Uint8ClampedArray(t),e,n)),this.applyFilter(),o.bindTexture(o.TEXTURE_2D,null),this.isLoaded=!0,r&&r())},e.prototype.loadImage=function(t,e){var n=this;if(void 0===e&&(e=null),null==t)return console.warn("loadImageFromUrl: URL is null"),void(e&&e());var i=this.gl,r=new Image;r.crossOrigin="*",r.src=t,r.onload=function(){n.width=r.width,n.height=r.height,null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),n.applyFilter(),i.bindTexture(i.TEXTURE_2D,null),n.isLoaded=!0),e&&e()}},e.prototype.loadImageDataArray=function(t,e,n,i,r){void 0===r&&(r=null);var o=this.gl;this.width=e,this.height=n,null!=this.textureId&&(o.bindTexture(o.TEXTURE_2D,this.textureId),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e,n,0,o.RGBA,o.UNSIGNED_BYTE,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,i),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,i),o.bindTexture(o.TEXTURE_2D,null),this.isLoaded=!0),r&&r()},e.prototype.destroy=function(){this.textureId&&(this.gl.deleteTexture(this.textureId),this.textureId=null)},e.prototype.applyFilter=function(t){void 0===t&&(t=!0);var e=this.gl;if(e.texParameteri(this.options.target,e.TEXTURE_MAG_FILTER,this.options.filtering.mag),this.isPowerOf2(this.width)&&this.isPowerOf2(this.height)&&t)e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,this.options.filtering.min),e.generateMipmap(this.options.target);else{var n=this.options.filtering.min;n==e.LINEAR_MIPMAP_LINEAR||n==e.LINEAR_MIPMAP_NEAREST?n=e.LINEAR:n!=e.NEAREST_MIPMAP_LINEAR&&n!=e.NEAREST_MIPMAP_NEAREST||(n=e.NEAREST),e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,n)}},e.prototype.initFrameBufferTexture=function(t,e){var n=this.gl;this.width=t,this.height=e,this.textureId=n.createTexture(),n.bindTexture(this.options.target,this.textureId),n.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null),n.texParameteri(this.options.target,n.TEXTURE_WRAP_S,this.options.wrapping.wraps),n.texParameteri(this.options.target,n.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.applyFilter(!1),n.bindTexture(n.TEXTURE_2D,null),this.isLoaded=!0},e.prototype.isPowerOf2=function(t){return 0==(t&t-1)},e}(r.ResourceReference);e.Texture=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),o=function(t){function e(e,n,i,o,a){void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null);var s=t.call(this)||this;if(s.gl=e,s.attributeInfos=[],s.uniformInfos=[],n){s.numOfVertices=n.length;for(var l=[],u=0,h=n;u<h.length;u++)for(var c=h[u],f=0,p=i;f<p.length;f++)for(var d=0,g=c[_=p[f]];d<g.length;d++){var m=g[d];l.push(m)}s.arrayBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.arrayBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(l),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);for(var y=n[0],v=0,b=0;b<i.length;++b){var _=i[b],w=o[b],M=y[_].length,x=new r.AttributeInfo(w,M,v,0);s.attributeInfos.push(x),v+=M}for(var A=0,T=s.attributeInfos;A<T.length;A++){(x=T[A]).stride=v}null!=a&&s.setIndices(a)}return s}return i(e,t),e.prototype.init=function(t,e,n){if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),null!=this.gl&&null!=t&&null!=n&&null!=e){var i=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.setIndices(n),this.arrayBuffer=i,this.numOfVertices=n.length,this.attributeInfos=e}else console.log("GL or data or dicies is missing")},e.prototype.init3dObjectFormArrayBuffer=function(t){if(void 0===t&&(t=null),null!=this.gl){var e=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.arrayBuffer=e;this.numOfVertices=t.byteLength/4/8,this.attributeInfos=[new r.AttributeInfo("a_position",3,0,8),new r.AttributeInfo("a_uv",2,3,8),new r.AttributeInfo("a_normal",3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},e.prototype.init3dObject=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=this.gl){var n=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.arrayBuffer=n;null!=e?this.setIndices(e):this.numOfVertices=t.length/8,this.attributeInfos=[new r.AttributeInfo("a_position",3,0,8),new r.AttributeInfo("a_uv",2,3,8),new r.AttributeInfo("a_normal",3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},e.prototype.setIndices=function(t){if(t){var e=this.gl;this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.numOfVertices=t.length}},e.prototype.bind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.arrayBuffer),this.indexBuffer&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},e.prototype.unbind=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.indexBuffer&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null)},e.prototype.render=function(t){this.indexBuffer?this.gl.drawElements(t,this.numOfVertices,this.gl.UNSIGNED_SHORT,0):this.numOfVertices>0&&this.gl.drawArrays(t,0,this.numOfVertices)},e.prototype.renderPartial=function(t,e,n){this.indexBuffer?this.gl.drawElements(t,n,this.gl.UNSIGNED_SHORT,2*e):this.numOfVertices>0&&this.gl.drawArrays(t,e,n)},e.prototype.setUniform=function(t){this.uniformInfos.push(t)},e.prototype.destroy=function(){this.arrayBuffer&&(this.gl.deleteBuffer(this.arrayBuffer),this.arrayBuffer=null),this.indexBuffer&&(this.gl.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.attributeInfos=[],this.uniformInfos=[]},e.prototype.setHighestModelPosition=function(t){this.highestModelPosition=t},e.prototype.getHighestModelPosition=function(){return this.highestModelPosition},Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},set:function(t){this._maxX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this._maxY},set:function(t){this._maxY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxZ",{get:function(){return this._maxZ},set:function(t){this._maxZ=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},set:function(t){this._minX=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return this._minY},set:function(t){this._minY=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minZ",{get:function(){return this._minZ},set:function(t){this._minZ=t},enumerable:!0,configurable:!0}),e}(n(63).ResourceReference);e.Model=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.id=null,this.map=null,this.zIndex=0,this.bringFrontBuilding=!1}return t.prototype.getId=function(){return this.id},t.prototype.getMap=function(){return this.map},t.prototype.getUserData=function(){return this.userData},t.prototype.getZIndex=function(){return this.zIndex},t.prototype.setUserData=function(t){this.userData=t},t.prototype.setZIndex=function(t){null!=t?t!=Number.MAX_SAFE_INTEGER&&t!=Number.MIN_SAFE_INTEGER?t!=this.zIndex&&(null!=this.map&&this.map.mapView.updateAnnotationZIndex(this.id,this.zIndex,t),this.zIndex=t):console.warn("zIndex value is not allowed!!!"):console.warn("Parameter index can not be null")},t.prototype.getElevation=function(){return this.elevation},t.prototype.setElevation=function(t){null!=t?this.elevation!==t&&(this.elevation=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter elevation can not be null")},t.prototype.isUserInteractionEnabled=function(){return this.userInteractionEnabled},t.prototype.setUserInteractionEnabled=function(t){this.userInteractionEnabled=t},t}();e.Annotation=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.cameraWillChange=0]="cameraWillChange",t[t.cameraChanging=1]="cameraChanging",t[t.idle=2]="idle",t[t.hover=3]="hover",t[t.click=4]="click",t[t.dblClick=5]="dblClick",t[t.drag=6]="drag",t[t.dragEnd=7]="dragEnd",t[t.dragStart=8]="dragStart",t[t.mouseMove=9]="mouseMove",t[t.mouseOut=10]="mouseOut",t[t.mouseOver=11]="mouseOver",t[t.projectionChanged=12]="projectionChanged",t[t.rightClick=13]="rightClick",t[t.tilesLoaded=14]="tilesLoaded",t[t.modeChanged=15]="modeChanged",t[t.longClick=16]="longClick",t[t.boundsChanged=17]="boundsChanged"}(e.MapEvent||(e.MapEvent={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(17),o=n(1),a=n(80),s=n(14),l=n(6),u=n(2),h=n(9),c=n(31),f=n(7),p=n(81),d=function(){function t(e){var n=this;if(this.coordinates=[],null!=e){var r={};if(o.MapUtils.extendOptions(r,t.defaultMapObjectOptions,e),this.id=r.id,null==this.id)throw Error("Id can not be null");if(this.name=r.name,this.scale=r.scale,this.bearing=r.bearing,this.elevation=r.elevation,this.height=r.height,this.obj=r.obj,this.texture=r.texture,this.draggable=r.draggable,r.location&&(this.location=i.LatLng.convert(r.location)),!this.obj)if(r.coordinates.length>=2){var a=0,s=0;if(r.coordinates.forEach(function(t){var e=i.LatLng.convert(t);n.coordinates.push(e),a+=e.lat,s+=e.lng}),a/=this.coordinates.length,s/=this.coordinates.length,this.location=new i.LatLng(a,s),r.location){var l=i.LatLng.convert(r.location),u=l.lng-this.location.lng,h=l.lat-this.location.lat;this.location=l;var c=[];this.coordinates.forEach(function(t){c.push(new i.LatLng(t.lat+h,t.lng+u))}),this.coordinates=c}}else console.warn("Coordinates size must be greater than 2");this.onModelLoaded=null}}return t.prototype.initWithBuilding=function(t){this.id=t.getId(),this.name=t.getName(),this.places=t.getPlaces(),this.scale=t.getScale().x,this.bearing=t.getBearing(),this.location=t.getLocation(),this.elevation=t.getElevation(),this.height=t.getHeight(),this.camera=t.getCamera(),this.types=t.getTypes(),this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.startDate=new Date(t.getStartDate()),this.endDate=new Date(t.getEndDate());var e=t.getTextureData();this.texture=e?{data:e}:t.getTextureName();var n=t.getObjData();this.obj=n?{data:n}:t.getObjName(),this.coordinates=t.getCoordinates(),this.draggable=t.isDraggable()},t.prototype.getId=function(){return this.id},t.prototype.getName=function(){return this.name},t.prototype.getPlaces=function(){return(this.places||[]).slice()},t.prototype.getScale=function(){return this.scale},t.prototype.getBearing=function(){return this.bearing},t.prototype.getLocation=function(){return this.location},t.prototype.getElevation=function(){return this.elevation},t.prototype.getHeight=function(){return this.height},t.prototype.getCamera=function(){return null==this.camera?null:new r.CameraPosition(this.camera.getTarget(),this.camera.getTilt(),this.camera.getBearing(),this.camera.getZoom())},t.prototype.getTypes=function(){return(this.types||[]).slice()},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getStartDate=function(){return null!=this.startDate?new Date(this.startDate):null},t.prototype.getEndDate=function(){return new Date(this.endDate)},t.prototype.getTexture=function(){return null==this.texture?null:"string"==typeof this.texture?this.texture:{reuseId:this.texture.reuseId,data:this.texture.data}},t.prototype.getObj=function(){return null==this.obj?null:"string"==typeof this.obj?this.obj:{reuseId:this.obj.reuseId,data:this.obj.data}},t.prototype.getCoordinates=function(){return(this.coordinates||[]).slice()},t.prototype.isDraggable=function(){return this.draggable},t.prototype.getMap=function(){return this.map},t.prototype.setMap=function(t){t&&!this.obj&&this.coordinates.length<=2?console.error("Cannot add object to the map without any model information"):!t||0!=this.coordinates.length||this.location?this.map!==t&&(null!=this.map&&this.map.mapView.removeMapObject(this.id),this.map=t,null!=this.map&&this.map.mapView.addMapObject(this)):console.error("Cannot add object to the map without knowing object's position")},t.prototype.setLocation=function(t){if(null!=t){var e=i.LatLng.convert(t);if(null==this.location||!e.equals(this.location))if(null!=this.map){this.map.mapView.getCustomBuildingManager().updateMapObjectLocation(this.id,e);var n=this.map.mapView.getBuildingResourceManager().getBuilding(this.id);n&&this.map.mapView.getBuildingIconSelectionManager().updateBuilding(n),this.map.mapView.dirty=!0}else this.location=new i.LatLng(e.lat,e.lng)}else console.warn("Parameter location can not be null")},t.prototype.setScale=function(t){if(null!=t){if(t<=0)console.warn("Parameter scale can not be less than 0");else if(t!=this.scale&&(this.scale=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager().getBuilding(this.id);if(e){var n=e.getBuildingType();n==c.BuildingType.ExternalExtrude||n==c.BuildingType.Extrude?e.setScale(new s.Vector3(t,t,t*this.height)):(e.setScale(new s.Vector3(t,t,t)),this.map.mapView.getBuildingResourceManager().updateBuildingHeight(e)),this.map.mapView.getCustomBuildingManager().updateMapObjectScale(this.id),this.map.mapView.getBuildingIconSelectionManager().updateBuilding(e),this.map.mapView.dirty=!0}}}else console.warn("Parameter scale can not be null")},t.prototype.setTexture=function(t){if(null!=t){if(this.texture!==t&&(this.texture=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);null!=n&&(n.getBuildingType()!=c.BuildingType.ExternalExtrude&&n.getBuildingType()!=c.BuildingType.Extrude||"string"==typeof t&&h.Color.isValid(t)?("string"==typeof this.texture?h.Color.isValid(this.texture)?e.setColor(this.id,this.texture):e.setTextureName(this.id,this.texture):e.setTextureData(this.id,this.texture),e.setBuildingLayerDirty(),this.map.mapView.dirty=!0,this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)):console.warn("Extrude Building only support hex color"))}}else console.warn("Texture data could not be null")},t.prototype.setObj=function(t){if(null!=t){if(this.obj!==t){if(null==this.map)return this.obj=t,void(this.coordinates=[]);var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);if(null!=n){var i=this.map;this.setMap(null),this.obj=t,this.coordinates=[],n.getBuildingType()!=c.BuildingType.ExternalExtrude&&n.getBuildingType()!=c.BuildingType.Extrude||n.setBuildingType(c.BuildingType.Texture),this.setMap(i),e.setBuildingLayerDirty(),this.map.mapView.dirty=!0}}}else console.warn("Model data could not be null")},t.prototype.setElevation=function(t){if(null!=t){if(t!=this.elevation&&(this.elevation=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);n&&(n.setElevation(t),this.map.mapView.getBuildingIconSelectionManager().updateBuilding(n),e.setBuildingLayerDirty(),this.map.mapView.dirty=!0),this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)}}else console.warn("Parameter elevation can not be null")},t.prototype.setHeight=function(t){if(null!=t)if(null!=this.coordinates&&0!=this.coordinates.length){if(this.height=t,null!=this.map&&!this.obj){var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);if(n){n.setHeight(this.height);var i=n.getScale().x;n.setScale(new s.Vector3(i,i,i*this.height)),this.map.mapView.getBuildingIconSelectionManager().updateBuilding(n),e.setBuildingLayerDirty(),this.map.mapView.dirty=!0}this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)}}else console.warn("Object with Obj model is unsupported this action");else console.warn("Parameter height can not be null")},t.prototype.setBearing=function(t){if(null!=t){if(t!=this.bearing&&(this.bearing=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);n&&(n.setBearing(this.bearing),e.setBuildingLayerDirty(),this.map.mapView.dirty=!0),this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)}}else console.warn("Parameter bearing can not be null")},t.prototype.setName=function(t){if(null!=t){if(this.name!=t&&(this.name=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager(),n=e.getBuilding(this.id);n&&(n.setName(this.name),e.setBuildingLayerDirty(),this.map.mapView.getBuildingIconSelectionManager().updateBuilding(n),this.map.mapView.dirty=!0),this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)}}else console.warn("Parameter name can not be null")},t.prototype.setCoordinates=function(t){var e=this;if(null==t||t.length<=2)console.warn("Coordinates size must be greater than 2");else{var n=0,r=0;this.coordinates=[],t.forEach(function(t){var o=i.LatLng.convert(t);e.coordinates.push(o),n+=o.lat,r+=o.lng}),n/=this.coordinates.length,r/=this.coordinates.length,this.location=new i.LatLng(n,r);var o=!1;if(this.obj&&(this.obj=null,o=!0),null!=this.map){var a=this.map.mapView.getBuildingResourceManager(),s=a.getBuilding(this.id);if(null!=s){var u=[],h=[],d=l.ProjectionMercator.convertToMeterFromLatLng(this.location);t.forEach(function(t){var e=i.LatLng.convert(t),n=l.ProjectionMercator.convertToMeterFromLatLng(e);h.push(new f.Point(n.x-d.x,d.y-n.y))}),u.push(h);var g=p.BuildingExtrudeUtils.extrudePolygon(u,1);if(a.setCoordinates(this.id,this.coordinates,g),o){var m=this.map;this.setMap(null),s.getBuildingType()!=c.BuildingType.ExternalExtrude&&s.getBuildingType()!=c.BuildingType.Extrude&&s.setBuildingType(c.BuildingType.ExternalExtrude),this.setMap(m)}else this.map.mapView.getCustomBuildingManager().updateMapObjectCoordinates(this.id,this.coordinates),s&&this.map.mapView.getBuildingIconSelectionManager().updateBuilding(s),this.map.mapView.dirty=!0}else console.warn("Can not find this building to setCoordinates !")}}},t.prototype.setDraggable=function(t){if(null!=t){if(this.draggable!==t&&(this.draggable=t,null!=this.map)){var e=this.map.mapView.getBuildingResourceManager().getBuilding(this.id);e&&e.setDraggable(t),this.map.mapView.getCustomBuildingManager().updateBuildingDataForTiles(this.id)}}else console.warn("Parameter draggable can not be null")},t.prototype.getTileCovers=function(t,e){if(e){if(!this.map)return console.warn("This Object was not added to Map or it is not referenced to Object in Map"),void e([]);var n=this.map.mapView.getCustomBuildingManager(),i=n.getMapObjects().get(this.id),r=function(){for(var r=[],o=0;o<t.length;++o){var s=a.tiles(n.createFeatureData(i),{min_zoom:t[o],max_zoom:t[o]});s&&s.forEach(function(t){r.push({x:t[0],y:t[1],z:t[2]})})}e(r)};i.hasBounds?(r(),this.onModelLoaded=null):this.onModelLoaded=r}},t.prototype.getTransformedCoordinates=function(){return console.warn("This function is deprecated and will be removed in the future. \n    Please use method getBoundsCoordinates(completion: Function) instead."),this.getCoverCoordinates()},t.prototype.getCoverCoordinates=function(){var t=this,e=l.ProjectionMercator.convertToMeterFromLatLng(this.location),n=[],i=this.bearing*Math.PI/180;return this.coordinates.forEach(function(r){var o=l.ProjectionMercator.convertToMeterFromLatLng(r);if(o.x-=e.x,o.y-=e.y,0!=i){var a=o.x,s=o.y;o.x=(a*Math.cos(i)-s*Math.sin(i))*t.scale,o.y=(a*Math.sin(i)+s*Math.cos(i))*t.scale}else o.x=o.x*t.scale,o.y=o.y*t.scale;var h=l.ProjectionMercator.convertToLatLngFromMeter(new u.Vector2(e.x+o.x,e.y+o.y));n.push(h)}),n},t.prototype.getBoundsCoordinates=function(t){if(t){if(!this.map)return console.warn("This Object was not added to Map or it is not referenced to Object in Map"),t([]),null;var e=this.map.mapView.getCustomBuildingManager(),n=e.getMapObjects().get(this.id),i=function(){var i=e.getBoundsCoordinates(n);t(i)};n.hasBounds?(i(),this.onModelLoaded=null):this.onModelLoaded=i}},t.defaultMapObjectOptions={name:"Unknown name",scale:1,bearing:0,elevation:0,height:1,obj:null,texture:null,coordinates:[],draggable:!1},t}();e.MapObject=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.create=function(t,e,n){var i=window.document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i},t.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)},t}();e.DOMUtils=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),r=n(5),o=n(34),a=n(144),s=n(61),l=n(62),u=n(145),h=n(8),c=n(6),f=n(15),p=n(1),d=n(55),g=n(50),m=n(32),y=n(52),v=n(146),b=n(33),_=n(147),w=n(7),M=n(148),x=n(153),A=n(154),T=n(89),S=n(0),E=function(){function t(t,e){this.idCounter=0,this._symbolVisibleIds=[],this.map=t,this.tileManager=e,this.circleTree=i(),this.symbolTree=i(),this.tiles=new Map,this.circleAnnotations=new Map,this.symbolAnnotations=new Map,this.shapeAnnotations=new Map,this._iconViewMarkerManager=new A.IconViewMarkerManager(this.map),this.infoWindowManager=new x.InfoWindowManager(this.map,this.symbolAnnotations),this.dirty=!1}return t.prototype.update=function(){var t=this;this._iconViewMarkerManager.update(),this.dirty&&(this._symbolVisibleIds=[],this.tiles.forEach(function(e){var n=t.getTileData(e.getTileCoordinate());t.updateRenderTile(n,e),e.setData(n)}),this.dirty=!1),this.infoWindowManager.render(this._symbolVisibleIds)},t.prototype.addTile=function(t){var e=t.getTileCoordinate(),n=this.getTileData(e);this.updateRenderTile(n,t),t.setData(n),this.tiles.set(e.toString(),t)},t.prototype.removeTile=function(e){var n=this,i=e.getTileData();if(null!=i){var o=i.getLayerIds(),a=e.getTileCoordinate().toString();o.forEach(function(e){var i=n.map.getLayer(e);if(null!=i){var o=i.getLayerType();if(o==r.LayerType.LINE)i.removeRenderTile(a);else if(o==r.LayerType.FILL){i.removeRenderTile(a)}else if(o==r.LayerType.CIRCLE){i.removeRenderTile(a)}else if(o==r.LayerType.SYMBOL){var s=i,l=n._symbolVisibleIds.findIndex(function(n){return t.pointLayerId+n==e});-1!=l&&n._symbolVisibleIds.splice(l,1),s.removeRenderTile(a)}}})}this.tiles.delete(e.getTileCoordinate().toString())},t.prototype.getTileData=function(e){var n=this;if(0==this.symbolAnnotations.size&&0==this.shapeAnnotations.size&&0==this.circleAnnotations.size)return null;var i=new a.AnnotationTileData;this.shapeAnnotations.forEach(function(t){t.updateTileData(e,i,n.map.mapState.getMaxNativeZoom())});var r=h.GeometryUtils.tileCoordinateToLatLngBounds(e),o={minX:r.getSouthwest().lng,minY:r.getSouthwest().lat,maxX:r.getNortheast().lng,maxY:r.getNortheast().lat};return this.circleTree.search(o).forEach(function(t){return i.addLayer(t.layerId)}),this.symbolTree.search(o).forEach(function(e){if(e.symbolAnnotation.isVisible()){var r=t.pointLayerId+e.id;i.addLayer(r),n._symbolVisibleIds.push(e.id),e.updateLayer(n.map),null==n.map.getLayer(r)&&console.error("Symbol layer id should not be null: "+r)}}),i},t.prototype.addAnnotation=function(t){this.dirty=!0;var e=this.idCounter++;return this.idCounter<0&&(this.idCounter=0),this.addAnnotationInternal(e,t),e},t.prototype.addAnnotationInternal=function(e,n){if(n instanceof m.Marker){var i=n;if(i.getIconView()){this._iconViewMarkerManager.add(e,i);a=t.pointLayerId+e;this.map.createLayer(a,r.LayerType.SYMBOL,S.MapConstants.buildingLayerOrder+i.getZIndex())}else{var o=new M.SymbolAnnotationData(this.map.gl,e,i);this.symbolTree.insert(o),this.symbolAnnotations.set(e,o);var a=t.pointLayerId+e;this.map.createLayer(a,r.LayerType.SYMBOL,S.MapConstants.buildingLayerOrder+i.getZIndex())}}else if(n instanceof b.Polyline){var s=new _.PolylineAnnotationData(e,n);s.updateLayer(this.map),this.shapeAnnotations.set(e,s)}else if(n instanceof y.Polygon){var l=new v.PolygonAnnotationData(e,n);l.updateLayer(this.map),this.shapeAnnotations.set(e,l)}else if(n instanceof g.Circle){var h=new u.CircleAnnotationData(e,n);h.updateLayer(this.map),this.circleAnnotations.set(e,h),this.circleTree.insert(h)}},t.prototype.hideInfoWindow=function(t){this.infoWindowManager.hideInfoWindow(t)},t.prototype.isInfoWindowShown=function(t){return this.infoWindowManager.isInfoWindowShown(t)},t.prototype.showInfoWindow=function(t){this.infoWindowManager.showInfoWindow(t)},t.prototype.updateInfoContents=function(t){this.infoWindowManager.updateInfoContents(t)},t.prototype.updateAnnotationZIndex=function(e,n,i){var r=this.symbolAnnotations.get(e);if(r){var o=t.pointLayerId+r.id,a=this.map.getLayer(o);if(!a)return void console.warn("Symbol layer should not be null");this.map.mapRenderer.removeLayer(o,n),a.setOrder(i),this.map.mapRenderer.addLayer(a)}else if(this.shapeAnnotations.has(e)){o=t.annotationLayerId+e.toString();var s=this.map.getLayer(o);if(!s)return void console.warn("Shape layer should not be null");this.map.mapRenderer.removeLayer(o,n),s.setOrder(i),this.map.mapRenderer.addLayer(s)}else if(this.circleAnnotations.has(e)){o=t.annotationLayerId+e.toString();var l=this.map.getLayer(o);if(!l)return void console.warn("Circle layer should not be null");this.map.mapRenderer.removeLayer(o,n),l.setOrder(i),this.map.mapRenderer.addLayer(l)}},t.prototype.updateAnnotation=function(e,n){var i=this.symbolAnnotations.get(e);if(this._iconViewMarkerManager.getIconViewMarkers().get(e)&&this._iconViewMarkerManager.updateIconView(e),i){if(n&&(this.symbolTree.remove(i),i.updateAnnotationData(),this.symbolTree.insert(i)),!i.symbolAnnotation.isVisible()||n){var r=this.map.getLayer(t.pointLayerId+i.id);if(r)r.clearRenderTiles()}this.dirty=!0}else if(this.shapeAnnotations.has(e)){var o=this.shapeAnnotations.get(e);if(n){var a=t.annotationLayerId+e.toString();o.reloadLayout(),this.tiles.forEach(function(t){return t.removeLayerData(a)}),this.dirty=!0}o.updateLayer(this.map)}else if(this.circleAnnotations.has(e)){var s=this.circleAnnotations.get(e);s.updateLayer(this.map),n&&(s.updateBounds(),this.circleTree.remove(s),this.circleTree.insert(s),this.dirty=!0)}},t.prototype.removeAnnotation=function(e){this.dirty=!0;var n=this.symbolAnnotations.get(e),i=this._iconViewMarkerManager.getIconViewMarkers().get(e);if(n||i){var r=S.MapConstants.buildingLayerOrder;i?(r+=i.getZIndex(),this._iconViewMarkerManager.remove(e)):(r+=n.symbolAnnotation.getZIndex(),this.symbolTree.remove(n),this.symbolAnnotations.delete(e),n.destroy());var o=t.pointLayerId+e,a=this.map.getLayer(o);if(a){var s=a;s.textLabelData&&s.textLabelData.destroy()}this.map.removeLayer(o,r)}else if(this.shapeAnnotations.has(e)){var l=this.shapeAnnotations.get(e).getAnnotation().getZIndex();this.shapeAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),l)}else if(this.circleAnnotations.has(e)){var u=this.circleAnnotations.get(e).getAnnotation().getZIndex();this.circleTree.remove(this.circleAnnotations.get(e)),this.circleAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),u)}},t.prototype.updateRenderTile=function(t,e){var n=this;if(null!=t){var i=e.getTileCoordinate(),o=i.toString();t.getLayerIds().forEach(function(t){var a=n.map.getLayer(t);if(null!=a){var u=a.getLayerType(),h=new s.RenderTile(l.UnwrappedTileCoordinate.createWithXYZoom(i.getX(),i.getY(),i.getZoom()),e);if(u==r.LayerType.LINE)a.addRenderTile(o,h);else if(u==r.LayerType.FILL){a.addRenderTile(o,h)}else if(u==r.LayerType.CIRCLE){a.addRenderTile(o,h)}else if(u==r.LayerType.SYMBOL){a.addRenderTile(o,h)}}})}},t.prototype.queryMapObjectAndAnnotation=function(e){var n=this,i=this.queryAnnotations(e),r=this.map.mapState,a=h.GeometryUtils.screenCoordinateToLatLng(e,r.cameraPosition,r.getScreenSize()),s=null,l=null;if(a.valid()){var u=o.TileCoordinate.fromLatLng(a,r.getZoom(),r.is3dMode()),f=1,p=r.getMaxNativeZoom();if(r.getZoom()>p&&(u=o.TileCoordinate.fromLatLng(a,r.getMaxNativeZoom(),r.is3dMode()),f=Math.pow(2,Math.round(r.getZoom())-p)),this.tiles.has(u.toString()))if(null!=(s=this.tiles.get(u.toString()).getTileData())&&0!=s.getLayerIds().length){var d=r.scale,g=u.getX(),y=u.getY();l=h.GeometryUtils.pixelCoordinateToVectorTileCoordinate(c.ProjectionMercator.projectScale(a,d),g,y,f)}}i.frontBuildingAnnotations.sort(function(e,n){var i=e instanceof m.Marker?t.pointLayerId+e.getId():t.annotationLayerId+e.getId(),r=n instanceof m.Marker?t.pointLayerId+n.getId():t.annotationLayerId+n.getId();return i>r?-1:r>i?1:0});var v=this.checkCollisionAnnotations(e,l,a,i.frontBuildingAnnotations,s);if(v)return v;var b=[];if(this._iconViewMarkerManager.getIconViewMarkers().forEach(function(t){t.isUserInteractionEnabled()&&n.checkCollisionIconViewMarker(e,t)&&b.push(t)}),0!=b.length){if(b.length>1){for(var _=0,w=b[0].getZIndex(),M=1;M<b.length;++M)b[M].getZIndex()>w&&(w=b[M].getZIndex(),_=M);return b[_]}return b[0]}if(r.is3dMode()){var x=this.map.queryBuildingInfo(e);if(null!=x)return x}return i.belowBuildingAnnotations.sort(function(e,n){var i=e instanceof m.Marker?t.pointLayerId+e.getId():t.annotationLayerId+e.getId(),r=n instanceof m.Marker?t.pointLayerId+n.getId():t.annotationLayerId+n.getId();return i>r?-1:r>i?1:0}),this.checkCollisionAnnotations(e,l,a,i.belowBuildingAnnotations,s)},t.prototype.queryAnnotations=function(t){var e=this,n=[],i=[];if(null==t)return{frontBuildingAnnotations:n,belowBuildingAnnotations:i};this.tileManager.getVisibleTiles().forEach(function(t){var r=t.getTileCoordinate(),o=h.GeometryUtils.tileCoordinateToLatLngBounds(r),a={minX:o.getSouthwest().lng,minY:o.getSouthwest().lat,maxX:o.getNortheast().lng,maxY:o.getNortheast().lat};e.symbolTree.search(a).forEach(function(t){var e=t.symbolAnnotation;e.getZIndex()>S.MapConstants.buildingLayerOrder?n.push(e):i.push(e)})});var r=this.map.mapState,s=h.GeometryUtils.screenCoordinateToLatLng(t,r.cameraPosition,r.getScreenSize());if(s.valid()){var l=r.getMaxNativeZoom(),u=r.getZoom(),c=o.TileCoordinate.fromLatLng(s,u>l?l:u,r.is3dMode());if(this.tiles.has(c.toString())){var p=this.tiles.get(c.toString()).getTileData();if(null!=p&&0!=p.getLayerIds().length)for(var d=p.getLayerIds(),g=p.getLayerIds().length,m=0;m<g;++m){var y=d[m],v=p.getLayer(y);if(null!=v)for(var b=0;b<v.featureCount();++b){var _=v.getFeature(b);if(_ instanceof a.AnnotationTileFeature&&_.getType()!=f.GeometryType.Point){var w=_.id,M=this.shapeAnnotations.get(w).getAnnotation();M&&M.getZIndex()>S.MapConstants.buildingLayerOrder?n.push(M):M&&i.push(M)}}}var x=h.GeometryUtils.tileCoordinateToLatLngBounds(c),A={minX:x.getSouthwest().lng,minY:x.getSouthwest().lat,maxX:x.getNortheast().lng,maxY:x.getNortheast().lat},T=this.circleTree.search(A);for(m=0;m<T.length;++m){var E=T[m].getAnnotation();E.getZIndex()>S.MapConstants.buildingLayerOrder?n.push(E):i.push(E)}}}return{frontBuildingAnnotations:n.filter(function(t){return t.isUserInteractionEnabled()}),belowBuildingAnnotations:i.filter(function(t){return t.isUserInteractionEnabled()})}},t.prototype.clearShapeIndexer=function(){this.shapeAnnotations.forEach(function(t){t.clearIndex()})},t.prototype.checkCollisionAnnotations=function(e,n,i,r,o){for(var a=p.MapUtils.getTileSize(),s=this.map.mapState,l=0;l<r.length;++l){if(r[l]instanceof m.Marker){var u=r[l];if(null==u.getId())continue;var h=this.symbolAnnotations.get(u.getId());if(null==h)continue;if(d.CollisionUtils.pointIntersectsSymbol(new w.Point(e.x,e.y),u.getPosition(),u.getElevation(),h.width,h.height,u.getAnchor(),s))return r[l]}if(i.valid())if(r[l]instanceof b.Polyline){if(null==n||null==o)continue;var f=t.annotationLayerId+r[l].getId();if(null==(A=o.getLayer(f)))continue;for(var v=function(t){var e=A.getFeature(t).getGeometries().geometryCoordinates,i=_.map.getLayer(f);if(null==i)return"continue";var o=i.getStrokeWidth()/2;s.getZoom()>s.getMaxNativeZoom()&&(o/=Math.pow(2,Math.round(s.getZoom())-s.getMaxNativeZoom()));var u=[];return e.forEach(function(t){var e=[];t.forEach(function(t){return e.push(new w.Point(t[0],t[1]))}),u.push(e)}),d.CollisionUtils.pointIntersectsBufferedMultiLine(new w.Point(n.x,n.y),u,o/a)?{value:r[l]}:void 0},_=this,M=0;M<A.featureCount();++M){var x=v(M);if("object"==typeof x)return x.value}}else if(r[l]instanceof y.Polygon){if(null==n||null==o)continue;var A;f=t.annotationLayerId+r[l].getId();if(null==(A=o.getLayer(f)))continue;for(M=0;M<A.featureCount();++M){for(var T=A.getFeature(M).getGeometries().geometryCoordinates,S=!1,E=function(t){var e=[];if(T[t].forEach(function(t){return e.push(new w.Point(t[0],t[1]))}),0==t){if(!(S=d.CollisionUtils.polygonIntersectsPolygon([new w.Point(n.x,n.y)],e)))return"break"}else if(d.CollisionUtils.polygonIntersectsPolygon([new w.Point(n.x,n.y)],e))return S=!1,"break"},C=0;C<T.length;++C){if("break"===E(C))break}if(S)return r[l]}}else if(r[l]instanceof g.Circle){var L=r[l],P=L.getCenter(),I=L.getRadius(),O=s.getScale(),R=I/c.ProjectionMercator.getMetersPerPixelAtLatitude(s.getCamera().getTarget().lat,s.getZoom()),k=c.ProjectionMercator.projectScale(P,O),D=c.ProjectionMercator.projectScale(i,O);if(d.CollisionUtils.pointIntersectsCircle(new w.Point(D.x,D.y),new w.Point(k.x,k.y),R))return r[l]}}return null},t.prototype.checkCollisionIconViewMarker=function(t,e){var n=this.map.latLngToScreenCoordinate(e.getPosition(),e.getElevation());n.x/=p.MapUtils.pixelScale,n.y/=p.MapUtils.pixelScale;var i=this._iconViewMarkerManager.getIconViewsHTML().get(e.getId()),r=document.getElementById(""+i.id),o=r.clientWidth%2?r.clientWidth+1:r.clientWidth,a=r.clientHeight%2?r.clientHeight+1:r.clientHeight,s=n.x+(.5-e.getAnchor().x)*o,l=n.y+(.5-e.getAnchor().y)*a,u=new T.Box(new w.Point(s,l),new w.Point(s+o,l+a));return d.CollisionUtils.pointIntersectsBox(new w.Point(t.x,t.y),u)},t.annotationLayerId="1.maplink.annotation.layer.",t.pointLayerId="3.maplink.annotation.points.",t}();e.AnnotationManager=E},function(t,e,n){"use strict";t.exports=r,t.exports.default=r;var i=n(143);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=y(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],l(r,t.leaf?i(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,r,o){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=r||(a=e+Math.ceil((n-e)/r/2)*r,i(t,a,e,n,o),s.push(e,a,a,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!m(t,e))return n;for(var r,o,a,s,l=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],m(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):g(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],m(t,a=e.leaf?n(o):o)){if(e.leaf||g(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,a,s=this.data,l=this.toBBox(t),u=[],h=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=h.pop(),a=!0),s.leaf&&-1!==(r=o(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;a||s.leaf||!g(s,l)?i?(n++,s=i.children[n],a=!1):s=null:(u.push(s),h.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return a(r=y(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=y([])).leaf=!1,r.height=i;var l,u,h,c,f=Math.ceil(o/s),p=f*Math.ceil(Math.sqrt(s));for(v(t,e,n,p,this.compareMinX),l=e;l<=n;l+=p)for(v(t,l,h=Math.min(l+p-1,n),f,this.compareMinY),u=l;u<=h;u+=f)c=Math.min(u+f-1,h),r.children.push(this._build(t,u,c,i-1));return a(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,l,u,h,f;i.push(e),!e.leaf&&i.length-1!==n;){for(h=f=1/0,r=0,o=e.children.length;r<o;r++)l=c(a=e.children[r]),(u=p(t,a)-l)<f?(f=u,h=l<h?l:h,s=a):u===f&&l<h&&(h=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),l(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=y(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,a,l,u,h,f;for(u=h=1/0,i=e;i<=n-e;i++)a=d(r=s(t,0,i,this.toBBox),o=s(t,i,n,this.toBBox)),l=c(r)+c(o),a<u?(u=a,f=i,h=l<h?l:h):a===u&&l<h&&(h=l,f=i);return f},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,a=this.toBBox,u=s(t,0,e,a),h=s(t,n-e,n,a),c=f(u)+f(h);for(r=e;r<n-e;r++)o=t.children[r],l(u,t.leaf?a(o):o),c+=f(u);for(r=n-e-1;r>=e;r--)o=t.children[r],l(h,t.leaf?a(o):o),c+=f(h);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(66),r=n(92),o=function(){function t(t){this.gl=t,this.textLabels=new Map}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var n=this.instances.get(e);return n||(n=new this(t),this.instances.set(e,n)),n},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var n=this.instances.get(e);n&&(n.textLabels.forEach(function(t){return t.destroy()}),this.instances.delete(e))}},t.prototype.acquire=function(t){var e=this.markerLabelToString(t),n=this.textLabels.get(e);if(null!=n)return n.model.retain(),n;var o=i.TextLabelFactory.getInstance(this.gl).createText(new r.TextLabel(t.getText(),t.getFontSize()),t.getFontWeight(),t.getMaxWidth(),t.getLine());return this.textLabels.set(e,o),o},t.prototype.release=function(t){this.gl||console.error("Please initialize SymbolResourceManager before using it");var e=this.markerLabelToString(t),n=this.textLabels.get(e);null!=n&&(n.model.release(),n.model.reference<=0&&this.textLabels.delete(e))},t.prototype.markerLabelToString=function(t){return t.getText()+" "+t.getFontSize()+" "+t.getFontWeight()+" "+t.getMaxWidth()+" "+t.getLine()},t.instances=null,t}();e.TextLabelResourceManager=o},function(t,e,n){(function(t){function n(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===n(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===n(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===n(t)},e.isError=function(t){return"[object Error]"===n(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(t){var i=n(3).Buffer,r=n(56).Transform,o=n(183),a=n(23),s=n(70).ok,l=n(3).kMaxLength,u="Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var h=Object.keys(o),c=0;c<h.length;c++){var f=h[c];f.match(/^Z/)&&Object.defineProperty(e,f,{enumerable:!0,value:o[f],writable:!1})}for(var p={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},d=Object.keys(p),g=0;g<d.length;g++){var m=d[g];p[p[m]]=m}function y(t,e,n){var r=[],o=0;function a(){for(var e;null!==(e=t.read());)r.push(e),o+=e.length;t.once("readable",a)}function s(){var e,a=null;o>=l?a=new RangeError(u):e=i.concat(r,o),r=[],t.close(),n(a,e)}t.on("error",function(e){t.removeListener("end",s),t.removeListener("readable",a),n(e)}),t.on("end",s),t.end(e),a()}function v(t,e){if("string"==typeof e&&(e=i.from(e)),!i.isBuffer(e))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return t._processChunk(e,n)}function b(t){if(!(this instanceof b))return new b(t);E.call(this,t,o.DEFLATE)}function _(t){if(!(this instanceof _))return new _(t);E.call(this,t,o.INFLATE)}function w(t){if(!(this instanceof w))return new w(t);E.call(this,t,o.GZIP)}function M(t){if(!(this instanceof M))return new M(t);E.call(this,t,o.GUNZIP)}function x(t){if(!(this instanceof x))return new x(t);E.call(this,t,o.DEFLATERAW)}function A(t){if(!(this instanceof A))return new A(t);E.call(this,t,o.INFLATERAW)}function T(t){if(!(this instanceof T))return new T(t);E.call(this,t,o.UNZIP)}function S(t){return t===o.Z_NO_FLUSH||t===o.Z_PARTIAL_FLUSH||t===o.Z_SYNC_FLUSH||t===o.Z_FULL_FLUSH||t===o.Z_FINISH||t===o.Z_BLOCK}function E(t,n){var a=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,r.call(this,t),t.flush&&!S(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!S(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:o.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!i.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(n);var s=this;this._hadError=!1,this._handle.onerror=function(t,n){C(s),s._hadError=!0;var i=new Error(t);i.errno=n,i.code=e.codes[n],s.emit("error",i)};var l=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(l=t.level);var u=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(u=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,l,t.memLevel||e.Z_DEFAULT_MEMLEVEL,u,t.dictionary),this._buffer=i.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!a._handle},configurable:!0,enumerable:!0})}function C(e,n){n&&t.nextTick(n),e._handle&&(e._handle.close(),e._handle=null)}function L(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(p),writable:!1}),e.Deflate=b,e.Inflate=_,e.Gzip=w,e.Gunzip=M,e.DeflateRaw=x,e.InflateRaw=A,e.Unzip=T,e.createDeflate=function(t){return new b(t)},e.createInflate=function(t){return new _(t)},e.createDeflateRaw=function(t){return new x(t)},e.createInflateRaw=function(t){return new A(t)},e.createGzip=function(t){return new w(t)},e.createGunzip=function(t){return new M(t)},e.createUnzip=function(t){return new T(t)},e.deflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new b(e),t,n)},e.deflateSync=function(t,e){return v(new b(e),t)},e.gzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new w(e),t,n)},e.gzipSync=function(t,e){return v(new w(e),t)},e.deflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new x(e),t,n)},e.deflateRawSync=function(t,e){return v(new x(e),t)},e.unzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new T(e),t,n)},e.unzipSync=function(t,e){return v(new T(e),t)},e.inflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new _(e),t,n)},e.inflateSync=function(t,e){return v(new _(e),t)},e.gunzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new M(e),t,n)},e.gunzipSync=function(t,e){return v(new M(e),t)},e.inflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new A(e),t,n)},e.inflateRawSync=function(t,e){return v(new A(e),t)},a.inherits(E,r),E.prototype.params=function(n,i,r){if(n<e.Z_MIN_LEVEL||n>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+n);if(i!=e.Z_FILTERED&&i!=e.Z_HUFFMAN_ONLY&&i!=e.Z_RLE&&i!=e.Z_FIXED&&i!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+i);if(this._level!==n||this._strategy!==i){var a=this;this.flush(o.Z_SYNC_FLUSH,function(){s(a._handle,"zlib binding closed"),a._handle.params(n,i),a._hadError||(a._level=n,a._strategy=i,r&&r())})}else t.nextTick(r)},E.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},E.prototype._flush=function(t){this._transform(i.alloc(0),"",t)},E.prototype.flush=function(e,n){var r=this,a=this._writableState;("function"==typeof e||void 0===e&&!n)&&(n=e,e=o.Z_FULL_FLUSH),a.ended?n&&t.nextTick(n):a.ending?n&&this.once("end",n):a.needDrain?n&&this.once("drain",function(){return r.flush(e,n)}):(this._flushFlag=e,this.write(i.alloc(0),"",n))},E.prototype.close=function(e){C(this,e),t.nextTick(L,this)},E.prototype._transform=function(t,e,n){var r,a=this._writableState,s=(a.ending||a.ended)&&(!t||a.length===t.length);return null===t||i.isBuffer(t)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,t.length>=a.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(t,r,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},E.prototype._processChunk=function(t,e,n){var r=t&&t.length,o=this._chunkSize-this._offset,a=0,h=this,c="function"==typeof n;if(!c){var f,p=[],d=0;this.on("error",function(t){f=t}),s(this._handle,"zlib binding closed");do{var g=this._handle.writeSync(e,t,a,r,this._buffer,this._offset,o)}while(!this._hadError&&v(g[0],g[1]));if(this._hadError)throw f;if(d>=l)throw C(this),new RangeError(u);var m=i.concat(p,d);return C(this),m}s(this._handle,"zlib binding closed");var y=this._handle.write(e,t,a,r,this._buffer,this._offset,o);function v(l,u){if(this&&(this.buffer=null,this.callback=null),!h._hadError){var f=o-u;if(s(f>=0,"have should not go down"),f>0){var g=h._buffer.slice(h._offset,h._offset+f);h._offset+=f,c?h.push(g):(p.push(g),d+=g.length)}if((0===u||h._offset>=h._chunkSize)&&(o=h._chunkSize,h._offset=0,h._buffer=i.allocUnsafe(h._chunkSize)),0===u){if(a+=r-l,r=l,!c)return!0;var m=h._handle.write(e,t,a,r,h._buffer,h._offset,h._chunkSize);return m.callback=v,void(m.buffer=t)}if(!c)return!1;n()}}y.buffer=t,y.callback=v},a.inherits(b,E),a.inherits(_,E),a.inherits(w,E),a.inherits(M,E),a.inherits(x,E),a.inherits(A,E),a.inherits(T,E)}).call(this,n(16))},function(t,e,n){"use strict";t.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return Object.defineProperty(t,"apiPrefix",{get:function(){return"api"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"tileEnv",{get:function(){return"api"==this.apiPrefix?"":"api-dev"==this.apiPrefix?"-dev":"-test"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDebug",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isTileDebug",{get:function(){return this.isDebug&&!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sdkVersion",{get:function(){return"1.4.0"},enumerable:!0,configurable:!0}),t}();e.Env=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Auto2DTo3D=0]="Auto2DTo3D",t[t.Auto3DTo2D=1]="Auto3DTo2D",t[t.Auto=2]="Auto",t[t.Manual=3]="Manual"}(e.SwitchMode||(e.SwitchMode={}))},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),o=n(1),a=function(t){function e(n){var i=t.call(this)||this,a={};o.MapUtils.extendOptions(a,e.defaultCircleOptions,n);for(var s=0,l=a;s<l.length;s++){if(null==l[s])throw Error("Parameters can not be null")}return i.center=r.LatLng.convert(a.center),i.radius=a.radius,i.fillColor=a.fillColor,i.fillOpacity=a.fillOpacity,i.visible=a.visible,i.strokeColor=a.strokeColor,i.strokeWidth=a.strokeWidth,i.draggable=a.draggable,i.zIndex=a.zIndex,i.elevation=a.elevation,i.userInteractionEnabled=a.userInteractionEnabled,i}return i(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setCenter=function(t){if(null!=t){var e=r.LatLng.convert(t);this.center.equals(e)||(this.center=e,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0))}else console.warn("Parameter center can not be null")},e.prototype.setRadius=function(t){null!=t?this.radius!=t&&(this.radius=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter radius can not be null")},e.prototype.setFillColor=function(t){null!=t?this.fillColor!=t&&(this.fillColor=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillColor can not be null")},e.prototype.setFillOpacity=function(t){null!=t?this.fillOpacity!=t&&(this.fillOpacity=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillOpacity can not be null")},e.prototype.setStrokeColor=function(t){null!=t?this.strokeColor!=t&&(this.strokeColor=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeColor can not be null")},e.prototype.setStrokeWidth=function(t){null!=t?this.strokeWidth!=t&&(this.strokeWidth=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter strokeWidth can not be null")},e.prototype.setVisible=function(t){null!=t?this.visible!==t&&(this.visible=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.setDraggable=function(t){null!=t?this.draggable=t:console.warn("Parameter draggable can not be null")},e.prototype.getCenter=function(){return this.center},e.prototype.getRadius=function(){return this.radius},e.prototype.getFillColor=function(){return this.fillColor},e.prototype.getFillOpacity=function(){return this.fillOpacity},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.isVisible=function(){return this.visible},e.prototype.isDraggable=function(){return this.draggable},e.defaultCircleOptions={radius:0,fillColor:"#0000ff",fillOpacity:1,visible:!0,strokeColor:"#00ff00",strokeWidth:0,draggable:!1,zIndex:0,elevation:0,userInteractionEnabled:!0},e}(n(38).Annotation);e.Circle=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(){function t(t,e,n){this.width=t,this.height=e,this.url=n}return t.prototype.clone=function(){return new t(this.width,this.height,this.url)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getUrl=function(){return null==this.url?null:this.url.replace("@1x","@"+i.MapUtils.resourceScale+"x")},t}();e.Icon=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(4),o=n(38),a=n(1),s=function(t){function e(n){var i=t.call(this)||this,o={};a.MapUtils.extendOptions(o,e.defaultPolygonOptions,n);for(var s=0,l=o;s<l.length;s++){if(null==l[s])throw Error("Parameters can not be null")}return i.paths=o.paths.map(function(t){return t.map(function(t){return r.LatLng.convert(t)})}),i.fillColor=o.fillColor,i.fillOpacity=o.fillOpacity,i.strokeColor=o.strokeColor,i.strokeWidth=o.strokeWidth,i.visible=o.visible,i.draggable=o.draggable,i.zIndex=o.zIndex,i.elevation=o.elevation,i.userInteractionEnabled=o.userInteractionEnabled,i}return i(e,t),e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeAnnotation(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addAnnotation(this)))},e.prototype.setPaths=function(t){null!=t?(this.paths=t.map(function(t){return t.map(function(t){return r.LatLng.convert(t)})}),null!=this.map&&this.map.mapView.updateAnnotation(this.id,!0)):console.warn("Parameter paths can not be null")},e.prototype.setFillColor=function(t){null!=t?this.fillColor!=t&&(this.fillColor=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillColor can not be null")},e.prototype.setFillOpacity=function(t){null!=t?this.fillOpacity!=t&&(this.fillOpacity=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter fillOpacity can not be null")},e.prototype.setStrokeColor=function(t){this.strokeColor!=t&&(this.strokeColor=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setStrokeWidth=function(t){this.strokeWidth!=t&&(this.strokeWidth=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id))},e.prototype.setVisible=function(t){null!=t?this.visible!==t&&(this.visible=t,null!=this.map&&this.map.mapView.updateAnnotation(this.id)):console.warn("Parameter visible can not be null")},e.prototype.getPaths=function(){return(this.paths||[]).slice()},e.prototype.getFillColor=function(){return this.fillColor},e.prototype.getFillOpacity=function(){return this.fillOpacity},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.isVisible=function(){return this.visible},e.prototype.setDraggable=function(t){null!=t?this.draggable=t:console.warn("Parameter draggable can not be null")},e.prototype.isDraggable=function(){return this.draggable},e.defaultPolygonOptions={fillColor:"#0000ff",fillOpacity:1,visible:!0,strokeColor:"#ff0000",strokeWidth:1,draggable:!1,zIndex:0,elevation:0,userInteractionEnabled:!0},e}(o.Annotation);e.Polygon=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.layerType=t}return t.prototype.getType=function(){return this.layerType},t}();e.LayerData=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r,o=n(2),a=n(0),s=n(82),l=n(12);!function(t){t[t.Butt=0]="Butt",t[t.Square=1]="Square",t[t.Round=2]="Round"}(i=e.LineCapType||(e.LineCapType={})),function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round"}(r=e.LineJoinType||(e.LineJoinType={}));var u=function(){return function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}}();e.CircleBuilderContext=u,e.buildCircle=function(t){var e=a.PolyConstants.numTrianglesPerCircle,n=2*Math.PI;t.addVertex(new o.Vector2(0,0));for(var i=0;i<e;++i)t.addVertex(new o.Vector2(Math.cos(i*n/e),Math.sin(i*n/e)).normalize()),0!=i&&(t.indices.push(0),t.indices.push(0+i),t.indices.push(0+i+1));t.indices.push(0),t.indices.push(e),t.indices.push(1)};var h=function(){function t(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}return t.prototype.clear=function(){this.indices=[]},t}();e.PolygonBuilderContext=h,e.buildPolygon=function(t,e){var n=[],i=[];t.forEach(function(t,r){0!=r&&i.push(n.length/2),t.forEach(function(t){n.push((t.x+.5)*a.MapConstants.tileExtend),n.push((.5-t.y)*a.MapConstants.tileExtend),e.addVertex(t)})}),e.indices=s.default(n,i)};var c=function(){function t(t,e,n,o,a){void 0===t&&(t=function(t,e){}),void 0===e&&(e=i.Butt),void 0===n&&(n=r.Bevel),void 0===o&&(o=!1),void 0===a&&(a=3),this.indices=[],this.addVertex=t,this.lineCapType=e,this.lineJoinType=n,this.closedPolyline=o,this.miterLimit=a,this.numVertices=0}return t.prototype.buildPolyLine=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=null),this.buildPolyLineSegment(t,e,n)},t.prototype.clear=function(){this.indices=[],this.numVertices=0},t.prototype.buildPolyLineSegment=function(t,e,n){void 0===n&&(n=null);var i=0,s=this.closedPolyline?t.length+2:t.length,u=t.length,h=s-0;if(!(h<2)){var c,f,p,d=t[0],g=t[1];f=new o.Vector2(g.y-d.y,d.x-g.x).normalize(),this.closedPolyline||this.addCap(d,f,!0),this.addPolyLineVertex(d,f,new o.Vector2(0,1)),this.addPolyLineVertex(d,f.multiply(-1),new o.Vector2(0,0));for(var m=1;m<h-1;++m){var y=(m+0+1)%u;if(i+=l.MathUtils.distance(d,g),(d=g)!=(g=t[y])){c=f,f=new o.Vector2(g.y-d.y,d.x-g.x).normalize();var v=1;0==(p=c.add(f)).x&&0==p.y?p=new o.Vector2(c.y-f.y,f.x-c.x):v=2/p.dot(p),p=p.multiply(v);var b=this.lineJoinType==r.Bevel;p.length>this.miterLimit&&(b=!0,p=p.multiply(this.miterLimit/p.length));var _=i;if(this.lineJoinType!=r.Miter||b){var w=b||this.lineJoinType==r.Bevel?1:a.PolyConstants.numTrianglesOnRoundJoin;f.x*c.y-f.y*c.x>0?(this.addPolyLineVertex(d,p,new o.Vector2(_,1)),this.addPolyLineVertex(d,c.multiply(-1),new o.Vector2(_,0)),this.addIndices(),this.addFan(d,c.multiply(-1),f.multiply(-1),p,new o.Vector2(_,0),new o.Vector2(_,0),new o.Vector2(_,1),w),this.addPolyLineVertex(d,p,new o.Vector2(_,1)),this.addPolyLineVertex(d,f.multiply(-1),new o.Vector2(_,0))):(this.addPolyLineVertex(d,c,new o.Vector2(_,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(_,0)),this.addIndices(),this.addFan(d,c,f,p.multiply(-1),new o.Vector2(_,1),new o.Vector2(_,1),new o.Vector2(_,0),w),this.addPolyLineVertex(d,f,new o.Vector2(_,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(_,0)))}else this.addPolyLineVertex(d,p,new o.Vector2(_,1)),this.addPolyLineVertex(d,p.multiply(-1),new o.Vector2(_,0)),this.addIndices()}}i+=l.MathUtils.distance(d,g),n||(n=1,console.error("lineWidth value pass into buildPolyLineSegment is invalid !"));var M=n*a.PolyConstants.polylineTextureWidth/a.PolyConstants.polylineTextureHeight;i=Math.floor(i/M)*M,this.addPolyLineVertex(g,f,new o.Vector2(i,1)),this.addPolyLineVertex(g,f.multiply(-1),new o.Vector2(i,0)),this.addIndices(),this.closedPolyline||this.addCap(g,f,!1),e&&e()}},t.prototype.addCap=function(t,e,n){var r=n?0:1;switch(this.lineCapType){case i.Butt:break;case i.Square:var s=new o.Vector2(-e.y,e.x);this.addPolyLineVertex(t,e.add(s),new o.Vector2(r,0)),this.addPolyLineVertex(t,e.multiply(-1).add(s),new o.Vector2(r,0)),n||this.addIndices();break;case i.Round:var l=e,u=e.multiply(-1),h=new o.Vector2(0,0),c=new o.Vector2(r,1),f=new o.Vector2(r,0),p=new o.Vector2(r,.5);n&&(l=l.multiply(-1),u=u.multiply(-1),c.y=0,f.y=1),this.addFan(t,l,u,h,c,f,p,a.PolyConstants.numTrianglesOnRoundCap);break;default:console.log("Invalid line cap type")}},t.prototype.addPolyLineVertex=function(t,e,n){++this.numVertices,this.addVertex(t,e,n)},t.prototype.addIndices=function(){this.indices.push(this.numVertices-4),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-1)},t.prototype.addFan=function(t,e,n,i,r,a,s,l){var u=e.x*n.y-e.y*n.x,h=Math.atan2(u,e.dot(n)),c=this.numVertices;this.addPolyLineVertex(t,i,s),this.addPolyLineVertex(t,e,r);for(var f=e,p=0;p<l;p++){var d=(p+1)/l;f=e.rotateByRadian(h*d);var g=new o.Vector2(0,0);g=r.multiply(1-d).add(a.multiply(d)),this.addPolyLineVertex(t,f,g),this.indices.push(c),this.indices.push(c+p+(h>0?1:2)),this.indices.push(c+p+(h>0?2:1))}},t}();e.PolylineBuilderContext=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(89),r=n(7),o=n(8),a=n(2),s=function(){function t(){}return t.pointIntersectsSymbol=function(e,n,s,l,u,h,c){s=c.is3dMode()?s:0;var f=o.GeometryUtils.latLngToScreenCoordinate(n,s,c.cameraPosition,c.getScreenSize()),p=new a.Vector2(f.x+(.5-h.x)*l,f.y+(.5-h.y)*u),d=new i.Box(new r.Point(p.x-l/2,p.y-u/2),new r.Point(p.x+l/2,p.y+u/2));return t.pointIntersectsBox(new r.Point(e.x,e.y),d)},t.pointIntersectsBox=function(t,e){return t.x<=e.max.x&&t.y<=e.max.y&&t.x>=e.min.x&&t.y>=e.min.y},t.polygonIntersectsPolygon=function(e,n){for(var i=0;i<e.length;i++)if(t.polygonContainsPoint(n,e[i]))return!0;for(i=0;i<n.length;i++)if(t.polygonContainsPoint(e,n[i]))return!0;return!!t.lineIntersectsLine(e,n)},t.multiPolygonIntersectsBufferedPoint=function(e,n,i){for(var r=0;r<e.length;r++){var o=e[r];if(t.polygonContainsPoint(o,n))return!0;if(t.pointIntersectsBufferedLine(n,o,i))return!0}return!1},t.multiPolygonIntersectsBufferedMultiPoint=function(e,n,i){for(var r=0;r<n.length;r++)for(var o=n[r],a=0;a<o.length;a++)if(t.multiPolygonIntersectsBufferedPoint(e,o[a],i))return!0;return!1},t.multiPolygonIntersectsMultiPolygon=function(e,n){if(1===e.length&&1===e[0].length)return t.multiPolygonContainsPoint(n,e[0][0]);for(var i=0;i<n.length;i++)for(var r=n[i],o=0;o<r.length;o++)if(t.multiPolygonContainsPoint(e,r[o]))return!0;for(var a=0;a<e.length;a++){for(var s=e[a],l=0;l<s.length;l++)if(t.multiPolygonContainsPoint(n,s[l]))return!0;for(var u=0;u<n.length;u++)if(t.lineIntersectsLine(s,n[u]))return!0}return!1},t.multiPolygonIntersectsBufferedMultiLine=function(e,n,i){for(var r=0;r<n.length;r++)for(var o=n[r],a=0;a<e.length;a++){var s=e[a];if(s.length>=3)for(var l=0;l<o.length;l++)if(t.polygonContainsPoint(s,o[l]))return!0;if(t.lineIntersectsBufferedLine(s,o,i))return!0}return!1},t.lineIntersectsBufferedLine=function(e,n,i){if(e.length>1){if(t.lineIntersectsLine(e,n))return!0;for(var r=0;r<n.length;r++)if(t.pointIntersectsBufferedLine(n[r],e,i))return!0}for(var o=0;o<e.length;o++)if(t.pointIntersectsBufferedLine(e[o],n,i))return!0;return!1},t.lineIntersectsLine=function(e,n){if(0===e.length||0===n.length)return!1;for(var i=0;i<e.length-1;i++)for(var r=e[i],o=e[i+1],a=0;a<n.length-1;a++){var s=n[a],l=n[a+1];if(t.lineSegmentIntersectsLineSegment(r,o,s,l))return!0}return!1},t.lineSegmentIntersectsLineSegment=function(e,n,i,r){return t.isCounterClockwise(e,i,r)!==t.isCounterClockwise(n,i,r)&&t.isCounterClockwise(e,n,i)!==t.isCounterClockwise(e,n,r)},t.pointIntersectsBufferedMultiLine=function(e,n,i){return n.some(function(n){return t.pointIntersectsBufferedLine(e,n,i)})},t.pointIntersectsBufferedLine=function(e,n,i){var o=i*i,a=r.Point.convertPointToMBPoint(e);if(1===n.length)return a.distSqr(n[0])<o;for(var s=1;s<n.length;s++){var l=n[s-1],u=n[s];if(t.distToSegmentSquared(e,l,u)<o)return!0}return!1},t.pointIntersectsCircle=function(t,e,n){return r.Point.convertPointToMBPoint(t).distSqr(e)<=n*n},t.multiPolygonContainsPoint=function(t,e){for(var n,i,r,o=!1,a=0;a<t.length;a++)for(var s=0,l=(n=t[a]).length-1;s<n.length;l=s++)i=n[s],r=n[l],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(o=!o);return o},t.polygonContainsPoint=function(t,e){for(var n=!1,i=0,r=t.length-1;i<t.length;r=i++){var o=t[i],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(n=!n)}return n},t.isCounterClockwise=function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)},t.distToSegmentSquared=function(t,e,n){var i=r.Point.convertPointToMBPoint(e),o=r.Point.convertPointToMBPoint(n),a=r.Point.convertPointToMBPoint(t),s=i.distSqr(o);if(0===s)return a.distSqr(i);var l=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return l<0?a.distSqr(i):l>1?a.distSqr(o):a.distSqr(o.sub(i)._mult(l)._add(i))},t}();e.CollisionUtils=s},function(t,e,n){t.exports=r;var i=n(67).EventEmitter;function r(){i.call(this)}n(28)(r,i),r.Readable=n(68),r.Writable=n(178),r.Duplex=n(179),r.Transform=n(180),r.PassThrough=n(181),r.Stream=r,r.prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",l));var a=!1;function s(){a||(a=!0,t.end())}function l(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(h(),0===i.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",r),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",l),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),t.removeListener("close",h)}return n.on("error",u),t.on("error",u),n.on("end",h),n.on("close",h),t.on("close",h),t.emit("pipe",n),t}},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,i,r){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,i)});case 4:return e.nextTick(function(){t.call(null,n,i,r)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(16))},function(t,e,n){var i=n(3),r=i.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return r(t,e,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=i:(o(i,e),e.Buffer=a),o(r,a),a.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return r(t,e,n)},a.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var i=r(t);return void 0!==e?"string"==typeof n?i.fill(e,n):i.fill(e):i.fill(0),i},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_LEFT=2]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=3]="BOTTOM_RIGHT"}(e.ControlOptions||(e.ControlOptions={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(0),o=n(11),a=n(14),s=function(){function t(){}return t.calculateViewMatrix=function(t,e){var n=i.MapUtils.getTileSize(),s=r.CameraConstants.height*Math.tan(r.CameraConstants.fov/2)*n/e/(n/2),l=t.getBearing(),u=o.Matrix4.rotateX(t.getTilt()).transform(new a.Vector3(0,0,r.CameraConstants.height),0),h=o.Matrix4.rotateZ(-l).transform(u,0);u=o.Matrix4.rotateX(t.getTilt()).transform(new a.Vector3(0,1,0),0);var c=o.Matrix4.rotateZ(-l).transform(u,0),f=o.Matrix4.lookAt(h,new a.Vector3(0,0,0),1,c);return f=o.Matrix4.scale(s,s,s).concat(f)},t.calculateProjectionMatrix=function(t,e){return o.Matrix4.perspective(r.CameraConstants.fov,t/e,r.CameraConstants.nearPlane,r.CameraConstants.farPlane)},t.calculateOrthoProjectionMatrix=function(t,e){return o.Matrix4.ortho(0,t,e,0)},t.calculateViewProjectionMatrix=function(e,n,i){var r=t.calculateViewMatrix(e,i),o=t.calculateProjectionMatrix(n,i);return r.concat(o)},t.calculateInverseViewProjectionMatrix=function(t,e,n){return this.calculateViewProjectionMatrix(t,e,n).inverse()},t}();e.CameraUtils=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this.unwrappedTileCoordinate=t,this.tile=e}return t.prototype.clone=function(){return new t(this.unwrappedTileCoordinate,this.tile)},t.prototype.getTile=function(){return this.tile},t.prototype.getUnwrappedTileCoordinate=function(){return this.unwrappedTileCoordinate},t}();e.RenderTile=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(34),r=n(6),o=n(2),a=n(1),s=function(){function t(){}return t.createWithXYZoom=function(e,n,r,o){void 0===o&&(o=!1);var a=new t;return a.wrap=(e<0?e-(1<<r)+1:e)/(1<<r)>>0,a.tileCoordinate=new i.TileCoordinate(e&(1<<r)-1,n<0?0:Math.min(n,(1<<r)-1),r,o),a},t.createWithWrapAndTileCoordinate=function(e,n){var i=new t;return i.wrap=e,i.tileCoordinate=n,i},t.fromLatLng=function(e,n){var i=r.ProjectionMercator.projectScale(e,Math.pow(2,n)).multiply(1/a.MapUtils.getTileSize());return t.createWithXYZoom(Math.floor(i.x),Math.floor(i.y),n)},t.prototype.toVec2=function(){var t=this.tileCoordinate.getX()+this.wrap*(1<<this.tileCoordinate.getZoom());return new o.Vector2(t,this.tileCoordinate.getY())},t.prototype.parent=function(){var e=this.tileCoordinate.zoom-1,n=this.tileCoordinate.x/2>>0,r=this.tileCoordinate.y/2>>0;return t.createWithWrapAndTileCoordinate(this.wrap,new i.TileCoordinate(n,r,e,this.tileCoordinate.is3DMode()))},t.prototype.children=function(){var e=this.tileCoordinate.zoom+1,n=2*this.tileCoordinate.x,r=2*this.tileCoordinate.y;return[t.createWithWrapAndTileCoordinate(this.wrap,new i.TileCoordinate(n,r,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new i.TileCoordinate(n,r+1,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new i.TileCoordinate(n+1,r,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new i.TileCoordinate(n+1,r+1,e,this.tileCoordinate.is3DMode()))]},t.prototype.getWrap=function(){return this.wrap},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.equal=function(t){return this.wrap==t.getWrap()&&this.tileCoordinate.equal(t.getTileCoordinate())},t.prototype.notEqual=function(t){return this.wrap!=t.getWrap()},t.prototype.lessThan=function(t){return this.wrap==t.getWrap()?this.tileCoordinate.lessThan(t.getTileCoordinate()):this.wrap<t.getWrap()},t}();e.UnwrappedTileCoordinate=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this._reference=0}return t.prototype.retain=function(){++this._reference},t.prototype.release=function(){--this._reference,this._reference<=0&&this.destroy()},Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!0,configurable:!0}),t}();e.ResourceReference=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this._start=t,this._length=e}return Object.defineProperty(t.prototype,"start",{get:function(){return this._start},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),t}();e.Range=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(12),o=function(){function t(){}return t.get=function(t){return(this.images[t]||[null,null,null])[r.MathUtils.clamp(i.MapUtils.resourceScale,1,3)-1]},t.markerDefault="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiODVkZWE1ZC0yYWNlLWExNDktYmI5MS01NjVjNGY5ZDdkZTAiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2MwZmJlYS1iODZjLTQwMDItYjcxOC1iYTI3M2MzMmY5NTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjgzYzBmYmVhLWI4NmMtNDAwMi1iNzE4LWJhMjczYzMyZjk1OCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjQ6NTMrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6UtMbgAAAC9UlEQVRYhcWXTYtcRRSGn7equ5OQheDCqBBcmJWoIEIMBoKMI6Kg/gFxI8YvBDWgLiKJ+UAiYsCFro0LxY2I4EdiJgYC0Y0wGDELESMEiVmIMmqc7qrXRZvEHqu67+0W5kAt+pzT5336nqrTt2Sb1bSwqupApxY4f+dmDCQlQgANAkEiw5zQPZJvN94EWgP+A8IZQjqBwxGZw9ngmMkZZOg7s3Hhq+YABbsV2C8xD47DxumfkK4AX0MOW4AdwDFgJ3ByUtGmLXiaoOMWdwNxQq4Mc4gjwDP/B8BzMceDgvVNSC9RwPqYw2vA87MAzHWIL017Tgx0iHuBO6YB6EnsB9ZOqX8RoxvQAWBdKVrdhClwXzRbqmXRr8BHOH8vsQl0F3BlKVfS5rXuzAMfNgaQfe/lXb4ihk8NiA9G8uJFX8Y3Cb0ruKEILO4vAVRbEOGWSmiQc3gcWFzh/zo6PQL8WaG+reSuAhhtrIQWbX0RknEaPqFOyvRSJmROYp8q63NtyT9uEJVj5pfQzQOl4QcHkQiAGPT6Dsvxt3Lj6Jac407Bz0WvuBmoPZ2rJW6sxH5qBWD720roKjL7+O8v6sV+91VgQ7Ee+qbkr7bADguSH6iEHzJcL3gdOA9sMDwMzFfrZZ1oBRCUDkP4ndoIFluNtmKwKl2/bEvgj4s6Y750WvbxSZWbmK0F4HQrgBxEChwE0qwAcn4zkIuxMXMADEcNn82o/6VD+NyhLDXp39BZPjCDeN/k3cCFWkKT94Fjtg5NJW/eAj4Zl1IF6CZfWtHpRSqDpK6tc3/lNfuW0zqWU4/l1GsHsMJ+NH6hJcAe4MykvDav5YfA7zUStz4A3miSO+YYji4Nz8Wz4B8m1PwO9KQMvdAfWa0AKnZWicds1Xb1hZzDU8DZpgWnuRl9atg7nBSjZrSLCbu+MUDOsbiSApiXbb09Im7eAV5pIw7tbkajejk8oZCvQ2yzOZpz3P4vmMY2y+V0KZvthvdNeBRYmqaIVvt6/je+DyExBbNQBQAAAABJRU5ErkJggg==",t.markerDefault2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0MDZjOWM2Yy1jZDdjLWIyNDQtYTU3Mi0zNjQzOTllOWJkMTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiMDNkZGZjNC1kNTE4LTQxN2YtYjUzNi0zZDJjOGUyZjY3ODEiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmIwM2RkZmM0LWQ1MTgtNDE3Zi1iNTM2LTNkMmM4ZTJmNjc4MSIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjU6NDUrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Dm+KFAAAHV0lEQVR4nOWbXYxdVRXHf/91zp1pwUpDiDHSgKjBD2wVqdaPxAcVAkF84MUYCn4gNBGMogajoIEoMSRWsUpiLdqYEE0UtGnqR9FGCkUxRopofbCxEFpREpT2QdqZe87++3DbMm1n7pmz77lTE/6TlcmcWWvtdf77c+29j2zzQkbZ1uBfl5x/zN9FLSKVWEaIKfcpXFLPIDYEBQWCsyrqVYEukPRqo3OEXwK86LDqAeA/wBOyd1naqUgPW9pb9YEiEYi6hokiqMo+0Z8gDEbUqjlYV2hGfC//zc5uCcjAEsGlkt9veEtJvOwINeKE1rcEWAassPQ+AKf4h8QjwhsN2xkQ1BnGSUBZSKslXRew8sirZnS4M23OLEKXQbHL9jrw94CqiyCjCyezYFUZsTWkjZrx8iPDnCe0vhexzfitXbjsmACrVHwixDbBu7r1fQzeiXWfUnycEVtxlwQssrUhXNwBOrVDv3NhSdTFOg26w6JcJx2NAV4MbDBc0Y2/VriSQUVeAxxsazw6ASJA6+2T8vIAWL4CSMCHgbqN7chdwNZn0qAWTiqEr8Tc0NZuJAKiKt+uVHxxFB9dwUAh3bY4ehe2sRuFgKWyvgEsxIA3X0yEWCtYLIHUbJBNgOpiDbAy135cECxf1Cs+ODkJk5PN+pkE6KWRYk2e7fihFDdMT7N0aqpZtzUBURVEVVwEnJMR22x4DtgPPAv8twuHgnN7lJf35jHJtSagrwDrQzmBzYRhh/A1dV28se/eMuFlJFaAr7X181H9l9LqSauRgdYE9Or0esEFeWEB5gBmjeX3GO4CdjOo+eeAPaANti7FfBSPlPm9qRKvalJqTUCJVwIvzonI5pmUdDHwHWBoDzV8N6V4by4JgtP61G9u0mtNQKVYnhMQgMWXQQ+3MPmd8S1ZZQGTxPlNeu1nASuPALMzkr8dJJSMhuTIlklhXCRSsN7wx6wypfOaVFoTIHFWTiyGnyKmCOMAmGOVYhNORDr6e1r25pwyEWc3qbRPhswZc8U+DCEf0/SFCXw0czGQZJBP4Mb495FTKJzRpNCeADGP9dUJSHVV/PP4h/XAH+FETUGCWffMBPtCKdG+xTbGmtMC+jmVocKLjzczg8o2CYav3U/BWU2g36TQfhAUBzICCVMvr6g5IoOfCqtGEgJk47qmJFHMFPt1zDloDEXjFNqaAMO+tjYCElxyKNUcSjVTqaafEiBOPJcxqaypi4Gksobw5W3LPBzr0006GdOgd2cEQqniwkUTeoMxiyaCU4renPrldI9qShycAietUoqLWscJCP+tSad9C3DxWE4w4NOKVNxZKua9f1BKpxZ18S0yNz2dikebdDLSYT8CTLe3A1nvWBzlDwMNzSQNFGjZ4ijvEcrdc6gs/7lJKSMX6D8me29eTABcFnX8GrgaOH2W/58OXt2L4lfAxfnFaB/okSat1tNg4P21/FvQK/MCA8MrjO8qFF8AHgU/CfRDOjeiWG7UuIJrLMN+wEn7m/RaEzClSWRvCnnknWDB2TBjuerDTzuArXuHJhyH0T4XMGAeAEbpBuPG45Ie0jxerzUBk55i0tPPREr3ZoU2ZgionDYf9PS/p4ZvOQA5+wERVBHUwQ/o6Ii6YxzCxcbCBeGiUbn9nmAE/QiS9Afjn2WFOEYY7g/iTz2V9Jq3BDPGAJ4fpgzfZHAm9/8CG92pSByRJrQmoEg6KmE9aPNQVqhjgM0OYGsbm1EPR6cFa0f00R2krzKPFHgmurggsQWzrQM/o8HcD7Qek1oTkOTjpU7yLbRkvmNUlm+HVA+GpJkyHDn7AbPJDsymtr66gq3v2/zShuOlCa2XwmU9+1LV8q2Id4NmS3DGiQO2vmbnXXbJyQZnlZ6rXUrekBXFCEjWOlt/zbXP6AIaJrcDjTl4h9gN+vooDtovhSnnFKxnSb6ZhVkc9VOK65307ChOWnecXtNgbzZPU94tdFVuUPOB8d3I980n5R2GsVyVlf058N/H4RvA8HhCN/voSdIQacBYCJhI9VPYNzrrbnQjbPNZ6uIp1QVN0oRxXZYmnH4ip41d+60dGyv3flxTUM1DmjCW6/IGSpta6fOV4m0yr+3I8V/6aeJTfXqzfWuQhbG1AACjp22voeE2yDxR2fokcGDoRHycNKH9pmiLw2EnATzoSF+R8m56HEGyvmTHth59yg43osbaAp6vhXQbpC25fgxbGCyyjvF7UlrAZE5rTlSJuK4KrZDc7oaJ2ZMcHwN10Y1OwFhbwEwYPWl8Le2O1Q4aXY+1dywTKt3nAkMF2Aq+qUVxNxn9om2MbTDWQfAEJKhhbah+jYKrh6na2pBS3JFf2PywYF1gBoz5tGHO+4KWH07WjYxnJXkMMrbFR+kER0fmA+CrwLPdNtljxweM9o9eUvM548LMArOhZnelYnUKbRIsHTz0/qm06CN9957oaqXXhJPRBYDDn81a26l1zdGHSWtsbV/IOBbi2+E5Mbgixz3Gt4YF5kcLHsML/fP5/wG9iVkz0V9YmwAAAABJRU5ErkJggg==",t.myPosition="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gkbBDgFfaxCbgAAB0JJREFUWMOV122MHVd5B/DfOTNz7+7e3bUNduzYKDgkJqYiNkENsopaAYKELwiVEkAExIcWaBWpVUVIQFQJQhWUpIX2Q5F4kxAKLyIIVMGHBiMECFAgQHCCxOaNoCQOcbxgx3vv7r1zZ+b0w8yudzc0kEe6Gs3c8zz/55z/83aC7XJ9okbAguCVkl8IHlPom1cayMxL+shAUGGCNbkVpaFcJWiMBHOSgAYfCVvg2rdrEi/pTBSYYoSv4W3mlHZhN/qCptNN21wPm55TwRks+wsjP+5WZyixEz/D7aFT+uAmWxNBKUl6ggv0PVdjtnMrbQL6Y5J3cE+KTgkqsfu6LjeH7vU8frAgqfWtuVhtUaPpDIVnAa5zOGK/ZEHmNxpjE0EjdeQJ3p/aZaE7/hWLCgc7juvtoHkUFmfEXibkUQiok7Q2lYalZlo/jRqIoqnKQ3ZYUQtIGnJF52eDYEbhBZJ848u6hcBcT6xKze9/5JyHlU6qVdgrOmomHDY7NyMbTzXNVjcajVzmYmP3S8YqLJOrNqByled34BvqAVkmNBPN8KfOXf5yO275L3+zf9FF8z27Y5CNK2fvO+3em467857vOxMu1s9nZHUtbfIjSfpqBy16SG5qluAfU8vJvAOS/ZuiXAgMcnF4Wnn5IYPb3+7dz9vhVbOFvTEoNm8xJZPVqdP3LfvaO2/3lZ//ysr8BfqjSrPJiyTIBY9b8JgkBO9LMI9DHRkbMl+Iwwet/sd1rnjXlW4a9BwKpEklnDyneWqiidg5K+6bF/u5lJKwOvXAp+/yoX/+b3fPX2puOD2/KYQuIx7AKPizxOs9X7Kvi9wARSZMTyv/8x2O/v3LfLSfuxDNN5f4/N3C8YeEs2fa2Ni7mz8/IL35CNcelRAnld9+8idu/KfPO1Hs1tsUnAk9yaPmnAxuTH28SFhPjPbo00Rz5CKDH/6DT8/3HEZz4x3ird8lleiTdRp1ZaNKvPc13PJaDeKwtPSyT/jbX500DoWwOSAElcxSVJizjc+5QvQbk8+9yTWDogW/4X/FW+4gRIpB+6yb9hcz8lmKOW79Fjfe0ebVoHD4f671LvcYDXpb6G0DsjKIaoubo77IhNFY/eK/tOvS5/jrELjthHDrcXqDlqBpbUt4N4mqoU5ks/z7d/nGkhAC+xa9YvfL7RyVmjxuKdeNrHVgdkvg9URL1v71KscW+i4YV3z1nlal6cD+P2kSIaMp+eLdTBsW+g584S1ene42WpzZGuSmFmLL5vkTmC0EJ4wv2+Ny9E8NNXedbEl6JvB1qZvW4rceEh49q0F+4aKLPGzay7ZU1STTi+KW9iALglOamdxOOLumeXyZLP/THEiJPOP3Z3hq0qbffN9uJ1WbKNhwIW6v3AlasJr22KVn14VSx/L6eQcy1R+2EbUNZ0OqRnJANiwtw2Jf3LWLqm7T849JDG1a7t/TFigYV87aK9Zp23aDKgomNjlX1pKL9Z445xFUF+0Ur75EMiGLf5oDply5X9o7L2Jy32n3OmpmbWp7JZhEteFmA+fGmnCFwbVf9u2ViZNF5K1XEHukugN4BvDYcfDGI8zkDEtP/stxd7rM7LDcUpLJrEXBSBLXqasaadATl3/o7BPnfC8lXndYuv4V1GtkgTxudSQEiqy1UI7aavi2o1JKPPg7X//l950ZzMq2zQoBK1E7/W2hYVRqHDF4/W0+NZpaQvzo1Zr3XsV0lWqNpm4pySKpYTpqnzdcfb4Uj6aW3vFVX3FQf3W6bfdBKRplXvXBWi0X7LJpAioK8dSj1i7c44GXXOhYHi2+5lLNoX1MAyulMDxHM2XnIq97sfRvr5WuO3a+GX32Ljd/7rhHih2K+jx80s5ey+70u+ADCQYah7YPI+vt+OPXueKdV7pprnAohLYdPzHUnF3TNNjRFw8sdu2YsFo+Yzumze4HMAxu7gaSVc+T29/N+GGd20EuDp80eelhC595sze98LneMFfYE4L+FovJdG3q1GNP+c41t/nkvfcbze/R2zaQEETR48ZOthDvSTrIwoxLsNB5uBEpWSbUY3X6tcmRv7LrQ1c5dtkel8/kdjZJPSwt/3bFIzd8yfF7fuCpeNQg9sVtIxlEjRWFBwWVmuDvUnvlaAvyjNoLJT3bLh4xMFOIa2N1WrLmhLFTGjkOyBzUm3mpQd4TV8unDaXre6+sWZIbQzsTXt/V2SjIJGMLCpd0M8J27hSZMN8TZwshC0LqUrespXNjTdU8bSxfvxNNNB42Y0Xdfd0o8R9I7ZKmc6I2o3ZQ2qDj2dyINgNHRMmKsV+rTfS6i0nEx9ZvRr1OJZNUqI3xoMwFanu7FdWzAA7oaYyxrO9JPaUoKLZRC37ZqZXO35IylWMeF9yPJ7rsWP/3D53G+vdcUmk8qnS/fR5TKq1iJDndrTpxXmmrvH9T7y07SpKokKvMyyxIZtV6oqJzvZYpVYaSEYYmpk5LLhOMpQ1CPrwV8v8Ate8QCQydph8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDktMjdUMDQ6NTY6MDUtMDQ6MDCDT2HeAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTA5LTI3VDA0OjU2OjA1LTA0OjAw8hLZYgAAAABJRU5ErkJggg==",t.myPosition2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAACxLAAAsSwGlPZapAAAAB3RJTUUH4gkUBQweFUICFAAAD9RJREFUeNrVm3twXNV5wH/fuXd19ykJS3bAGNvIBhsD5U0gODhuHm1pSwLptBATpsFkOpOhbcqAY3AypdO4Ce6YtgmZTFsa2gKFdlJC0pLQhkDBuJDyKAzG2MYP2RgDlmTL2l3trvbec/rHOXd3ZWTprmwX8s1odHV1zznf63znex1hunCHgQgoAhVgBiAIeQwjQAfgIYwSIGSBHIY0kELhAx4G5WYzQIQhRKghVDGMIoyiqQEGATSgEARDCAiQcj93yLTImN6oWw34gGqgLngYUu5Zk8fQjSEPpLFfx2AO+304Lq04hUAVQxHDIdKUMBiKQICgHCNwDF/bPjntjbjdWClo97eHoB0hHaQYowehB8g69rR+HRM81ZqHf6da5ioDBxAGEUI0VjcUpjFKAX+WnKzkX95iLFnaySVeDHwMJ2LodXIw7ivTNoMnZ4q0MKMK7EcxgCEkxOpYBagDvcCfJFt66q/uMFDD7nfBSr2EoQNQzEQxG6vmkSP8WBE9GTMU4DlG7CNikAKGIkLgtCECDgB/Mzk6/lSrUXO/PUAjgCFHGsM8oMsRXXeEH2/icWsYt2YK6MOjhwr9KKqECL6zR7OSTTYxrDHNpSzf7V6L6HHE+9Cwxe8nGMBHCIHd5BmichhmBvjmxGiqI06raSp1DTgfQ8gpGBa4cR8E4nE4hBgEwwJGmMM8rD1QNC3HJIPHwx8Zq1jxwK3ARxCGOBXDTJrq/kEEA6QQBgjYxZA7iGOIgHXjUX8vbwLsfo9lfDYwRN8vAPE43OoYeqnSRw/CGLHxtmfUBAOacKuxnl3B/bwLFOiDY0e8pyClEE8h4mYzBiKNqWtMpI9ufgdNTZjFTg5gpR8f0i1HZPPpdmMlngfKDfM3B+HkoyFegMBHsilUXWPKFSJ9kJAiETXnJKVR5PHUCfi5DJ6vkEodXQsxZjqLjmfCPmq8iYcwG8OA+69zlprHoAYyQNW5tZpeYPZ0iRegEKA0UNpLdWwbNd2Fmn0hnb9yMSf2nUChENAhAsMVaruGKf10E4NvPc+IKqH1QoL8HNICFGtMRy/i7XASaSpEDPI2wqBz2cZpwBpj1aNC7MpkEM6g6e23xfdcgBKg/DIlo+HGG+j7wnlcuqCXSzoDFnZ49HiKXAtjdaQpj0UMjVTZvvMAz9/zEhu/94/sVArJnE3OaBitT5MRgsbjdYQKGtgL9AB3CdLw9ADeAeYCNRYDnbR51Ckgl8Ub3cFoVER/bw1Lrzid356ZY6kSgonZ1SKIFtCG6kCZjd/fxAM33clz/gz8zDwy5QrtmgnrJ8AhtrKV24CHsL5rCMIaYw3eQbfvhVnA/LaIN+D7SN5Hhp/m0C03s/jWj/HlWXmWt3wSARiDGBBjxs8tglG409wu7MVDB8o8fecT3LX+LrZ0L6OrFGLCENPGxoydpX6E/YBwIoa3QFhl7FKW/BSGJVhPIJnqG0ilkHQdU3yF8hPf4drLT+UWT8iaZlCktEYQ8KZAOjJ2hFI2qBLnkUSa0oZ+7lr+JR4snEuumkLq9baYYG2CYjPWNoAHwq3GBjgW0dnAnMTSd8R7VXTtIPU31nHbghlcC2gDRsCLNCiB+Mg7VIVtg9A/bJ8ButMwpwuWzILOoCkyre2xaSAS59e9McQDZ6xmXaobP0qj2mBCvBX2IezF2MSKcFtD0D6GM9uRvuchfogJh6jvXs83T+7k12JkjUE0VuK1EP59C/zzq/B0P+wvgqnTDKt9u+qsAiybD9edC796OnR4ViMUdosYqxHeWyP8ZN7NrPZ7SYU+EkWJDbW4VTcDY/bFahNL/0RgHgmPPQHyAar4PxTfuI81C3u4zhhCEXzt0FECP9oCa/4TNu0BMWBSVvW8Fq0wxql+BFIHo+DsubD2k/Cbi606xfPFa+wY4oGF1/P1wkUUSrXGJ8m0QNiD8A4gCh9DgGCzeonj+UIGr/gUhzbczTULe7jOQBQTrwTqEdz4CHz672DTXvAy4GVBfLtAZCDU9idygaf49hsVwKtvwpX3wI0/sBqkxDJCBN9AtKCHFRu+zTXFpxnpzOIl1IFY2D3kEDowHkvvAE0nhpMg2TmbSaHKe6jetpLTPn8R65QQCIg2iBIYKMMV/wA/fBH8jJW4NiQSkzYWQ88HLwUvvgFP7oErz4B8h/2/Esuv2V1c6M/k6cc2sD/TS0eYbCsYoIMxRggZUy7s7SSh0yNOFRkh+vLH+ENf0ek0WJRANYSr7oONWyBVgDAh4YdDrCGpAvz3Vrj6fqhFbhvY3RT5ivzvLeMmKug2sjFxRqkbQDEKCAUSqn82QJU3Ub73Vi6emeeXcdY+dtr/4EewcatFvB61T/jhUI/sXM9sgd//oaPANPwE86E8n3joKywdfYVSLpgs8h8nQw3k+Q9QpElj/aIp1V/c4gBXnMkKt6F0fNQ9shn+9lnwcseG+FYmeDk79w8227Uiu1U0wPJF/BamrSysjXw+RUahyJIkN4iN6kbfonrTdZzam+My91p5CsYi+PrPLAZHEcEdEWL38E8ft2s5h0oB9Ob46E2/S195L9XAT+waeRiyCkOudY3JIJNCsZ3a5y7gMiVkDETaJkp5dCu8uAe8junt+alAG/AC+N89VgsAtLa2QAnpa87jUrZRy6YSbQOLoZBVMGGQMiHUNYYCasEMLmy8dPx+8BVAN8/24wHiUH940/i1AU7r5cN0443pthQwrZBGnmRS1D0FpQpR94V0FgIWOj6KJ9alfaofSDmH5jhBZFMcPNVv1/SsYyQAhYAF3RdQKFWIvKl1IA78UspOOTWkFMJBwqvPorfDsykF7Zi2ZcC6t9YuHz8GxAHMu0UbT7hXAtDh0fvZs+jlIGFKJbYDflxhmRJtTyGUiOZ1k/eUzbXG3H/zEFB3Ejne9NuYjv5h987h4CkK82dQoEjkJWOAscMSnhwiQBXdnSFgfMmE4So2ufD/kC8WF87EkWQLMRQ66KCGbgMPlcRijl9pAhEfT6m3zZw2IS47JyM8QBXHbBhJi+Z0uw6Ao0nhJgXjovru9HjaATNcoUYa1QYeRtGs+04KkT0Cvf4DFCNNEWyMDjC/m8YJcDx3QRxFkoJTutw7h0OkKe0+SIk8XpTsKBQgUq6oOCXUNYYT8P91E4NjEYNuBgNwei98qJCUlUfLAZs4WTzTvlIOh7GIwYdfY5Bu/HpyX6Cu0I0EyKSDIg35DN7wixSLNXbE3I8MdKVtJic+CY4XxCfAsvl2zch6LwZgpMr24RcYyWdtGm4KiP2eMYVQnfJzBx0KYZjojSF+Pm4q4OqzOG5xQGMpF8hee874tQF2HOAFiug2fAAw1BSaUffnlANH62hOJ3joJZ7VhqqA57K3XLUEzpsLUc3lC44xKIFoDM6fC7++yL1TNhTXhsqDL7GRhQSVZMWTGMOyIkU5qR2ohZjcHNJ3/z07B8tscK91ZGwC82ufoOmaHWOI44CvfdwlSy2ZGmCwxMa772dX9mTStTCxEoYYRhU+VQxVmDqKagQMAk9u5fvuUXkuX3fVEvjipRCVIeVNNVtySHl2zi9eCp9Z4iJDZdc2wI9f45/A+gEJqbeNVnWqypXFSiRMiZVr6Ow55K+5k2feLfE4Lj0VOyHf/jQsXQz14rFhQsqzc31kEXzrSvvOERoBMlDiiS/8OT/PnUVuNFkR1VoSoUhgH0AxTMKUmIm5lEH99VPcHWpKruBjtIHAg4evswjXizbamI5NUAK+2DkuWwyPfB7SvssMuzRcqBn5y//ir+jCi5OpCcCmxAyHEFDUgTFKwCgJtgFApYbuWkj2j9ez5bl+1jvG6Dh1PTMHj6+ElZdDWAE95ghSVnpyBKzEfeMpOyaswcpl8LOVds445R6nwp7r5y++sZ4tnfPJJDR+OBrLBJRQINzuCiMRJyLMJWFZrFEYeZ7i9vv46oIZrJioMPJvW2DNT+HVPSA6YWFE4Ky5sPZTcOURCiPbh7j/tOtZO43CSAphN8YWRoTVjaEdwBJsfrCt0lg0RL2/WRoLXZa4URobi+CxbXD/yzaZsb+IrT+1lMbElcYunw+/80vwG4sg8Ccuje0b4SfzbmG1N2NapbE6wmvx6rY8HrkObMMcbIG07eJofZjw9TtZddoMVjih6kZxVDUnG6nB5v2w95ALo7Fe3bxuWNRrn2OtiK29qzcKoHYc4MHTVvGN4ARS0yyO7gX2YX1II3zVtPrwKfRRlMdfpvzkd7n2o/O42SVNYts07fK4FT4qMpQ39LN++Zd4sHDOUZTHhc2IK49HsRG0RTFBU0fzNu20xgjU65iKj3RfQmH5DTzwlUdZMVDmKYe8JyBKESkhMgYdGUxcF2ypDxpt0EqIlLISd2PV/jJPrn6Uzy1fyQPdH6ZQ8dsmPj763sZQRyN0WTHbBgkf23b8GeBbwEIWYfuA22+RyeBVdlMJDxB+ZzWXfPZMVszMcZkS0hMMmaxFpjZQ5pkfb+NfbljLM14BlV1Atjw67RaZEU5iCw8DS51uBfHCNxsYxnYDWpQyqGk2SQHZFEoEKq9S1gZzw/X03XgBl/XN4KLDmqQaN0YaTVI1tu8Y4rl7X+LZe+5lpwjkziVvsE7YNPxse+4rXsdQAccODayVlulWuU6xyIXGml6Evna1oBUKgXVVS3upqu3UdB518sV0fvJMek/tJt+dITAGimOM7TpA8bFNDO57gRF1CK1Pt21yCtsmN80o00rfsBMYBNdJbmj0CY5vlKxjGyUr7lTQnIJMv1cwXiDwkUwKFWpMeZRIDxNSIqLqnJcARQFPdePnsngphYweq0ZJeIuQvSiEHgzDjOsZfm+rbAnbNZbGPnf8wrbK+sAgPrug5W7RYVdq3kvQ6vjgAoaAUxDK9GEvonzQm6Vj4lMYBonYQQ7bBxkHZoddrHqv7x+HRAY4AesuVNnpumyT+wfvL/EDjLCTc8GZPUvX6HsHHFmacfeYwdqFV4H5zHE2Ib4N9kHRhlhnFfA2r/Mm52CP9hjDOydG1Z90yljWRaAPEPaiqcAH8MqMzfDsAoZYjFBx2Lt64pFgauRXmVZvwN4bgjSG+dh+4vdLG1qlfgjFbqDaOMbjL9ZNjtbU8f8wzVZacf2VEVV8tiLsonl7a8rU+jEkXLB7vY5hFz7bON8RH2AISNjz0u7FyTzNS3Ka+FKSj2Ym9pJa3Gt0PC9OCrbLcxDhHRThOIc6boFKeHu0PQRXmfHdBLG6NS9f9GKYAQ0391hfnR3FMITHECnq7labje2k5at17YWI7cMaQ6NE6jskahiy2MbrMfJAl2u/O/rL09YlG6ZGiarravIblzhj2w93Ty9QmB7c4VznOk07bFxa5SD2+o0gpAjwyAJZd30+QBp3z2MbZNs1DSGGOh5VNKNoygg199amaorYC9vxTbB4/Tak3gr/B00sppUy/FK+AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA5LTIwVDA1OjEyOjMwLTA0OjAwxqW7kgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wOS0yMFQwNToxMjozMC0wNDowMLf4Ay4AAAAASUVORK5CYII=",t.logoIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAABACAYAAADs8xAxAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAExpJREFUeNrsnft/U0UWwOfy2T8gP7qvGoSVxQdNcVVQsAnykGcTBBZwgYSHSAGbilBBsA3CKuWRFmhRHuZWUdwKJFBogSq5fIAVQUlQHsui2xT39WP29yWz59zcxLTk3sxNbtpuM+fzCbk09zEzd75zzpw5MyOQXpTpO/5sppSYYzFqjcEBjVEif1NCYrEYfOMxjcBh5IuaMRLhwqUfitCTD5u967IJILMDdGUAlxUYMyFosQR86SGEY6L8nUr3YvQcfAcubB4f5q+PC4eQUeY2fg3A0QXwcf4EHZGh0wkhuaecc4/SMBzWX35ngshfIxcOoYrMe/8qwlcta70kYF0gjFCEKUavwW8R/H83CC3wMcFhKfzfAn82pUAo3+O/MRqFczyh2ol1/HVy4RAq4twfRjOzGmBxk/u0HJUAuiY4lA67R0T03Ld0Q7vlHiWoUe0AoVmBMA42lQF2fbdtMu87cilsCF0fXEOt56MyJKjSkhCKqLEOrXgqYsRzRqw9bYf7VvyXEqsCoawdAdK6W9snV/JXy6UgIVwkfusG2Lypmg/+CcB35cfLfhfJRwaGV7WhZ9WHXlYFQtSMYfjYbnunRvkr5lIwEC5u+s4nO15+0nzYV3N9+PLwQE9kZNjq1hp4brUCIfY7w3DoulM3lXtRufR/CJd8dN0H0MmeTwVCCf5xiEtKelQTPfb6SStoQ7889BGTzdMogGj7oX4aB5FL/4Vw6cEbXoDPHVMcJNj3+2Bhsau3MjT0tRPoRcVGwRKLe1ChIaC2H3aWcRC59D8Il31yE81PX0wZdgAIxQPOYa7eztSQyhYTJCmIQxyxuHkqa8SOXRxELv0IwvJDNy1yRY9RkwKhuH/B466+krEh7hb0zoZiiagcBJESW2eDnYPIpX9AuPzQLajg1KL0AcPwse2f/zhzH3C690sTSYawETQdzWkiZqT4YD5p+qJmjG54Blccx4YilIi8uQemKXpNf2x0cBALWIqW+U3w5QcbCc2kOARU+YeSys69M/JSPx5Y2GyBL68hEK749JYb0p4YiojCd8neeY9FWK6dtfMrE4BXHQ9h0xU7isMOldLGsZKetA569ZicVqpE2KBpCgVtu7uHg1iwEJb7/VAH7CoQ2gBCKU8QWuEr2P3vA/TeaGXzbRMRhOoUjD2sAM7eddkJXx2CQNxwD5POR2MrEhy9vt0/+s0zzNf+sLMMw9lSCxWupcGiV45YeHUsSAABPgSw78iALK5xxyuyLNJ7Lz3KFLM5p+GKD4D1AYCmHNNsB8XYMXLdaWaIcLyw259M0PoFi5ZyEAtJfr08YIYvX19Lly4IX/3srwhQRVIJghZkuW5u49c+qPROA9NtArCCT69lA7FjV1kEzhfvBxE04pLDHMTCcYBgPTT9X0OoqPGkFmyc80hG2/kP731TA7A685B2GcQnqk6ZGF9AugYDrw3+evFnHMT+boYuD7ihDlj7Ytp0QQgwlSVNPIE0ZTofpzJBxqvzmH4E0c+kDXfbsd8aUIP5F4uaOYj9VMwrAuY818OegdB95A5oDSHRoY02zh4qMlzWE/a3tWRNG5umpVSt4ZA1ouJC5tL/xEf6oBmakJ/pNEUTkjEoe/7ekJMSao67fvMu2MplbBQ6Gx2BonJ/VOWFJEC0/fuDWXkZvqg4cgfHQhF0izz8QggOu4Qbfv/bSKZrF4vfWil6iCnFaCAMPAj7FhVLuaZpRt0ltAQwPda4h14ewpHTFXj92bzH/j6z7owZ60kMp6QRkgiqCH+z5QXJiPsPXHnMTXBSeZ7zoQw/WFK7a/CJQF2KGAYhmKLFlCb/c47h/AqaXc6jWbRaZsvqVnt46ySWGRsSUXdRZwVi1cmOIFVmb8Qrcvx4e9kgG/5eefR7p7zCAKQTyoWklguOUZV/eksSKKlsmDO0yzNf/ui6Ob4yAfSp0xSm80AYgamHc+qadAbLz6q/hBUT35Gqu75s20URfvccX/1sZMqW85AGsiCRt2Q+CW06ta70vgZwrOesF4MwqHJiLN7o4MWV594eFx69vh2noFUjfOmeXVLVhjAG4CrPtdpJkWwq0kMrjwHg+TNDoZ6YFQVgT1Nnq5VzsL55oD5JRvQJLd0qsqo494fN3c7XI/XZXASFXcZ46rVM/cwsTFNrus8q//em1/zfBxVzyKzhNAIgaLD80M2kWb304HU8DhFtr7JJedmhBftCTOn9/a6vTPDxQisZJJnHyxD+jqm1F2qU9KfLp1mjvqQ9H8d6aXzQ2qpRJjiM5IRPR/HqVncezNBojgC6U96PKUPdwPrkVztPB4RCosCiu2cNiTBUyuy0ICWRLK+1MtLKYuZgYYWg4Jy5vCilorOWBZqZ3mWf3LQsPXjDqbMfg0tH+ufvvap5Pq52B4nCNOmt1Ah6hRHag8bzpXew3Dtsdasu/wJGSmmUPXrKwzkAiGnx6rTY7Go+kmwG61kSX5xl/vDe2UJofvz1kyyFouf+vhxB1GsNYDytX8jOoWXOCJdA8N7ZWihGOTayvY8T3m8NUz/w1eMJMzFtHbvb6KjJAcAakv2Yd/aaEEwqc54rXyogkXxW+rt7HHrv78tZI+qHKVtZoPbDnIYrNX11nEyHFq1+9PWTGfMwQNuKcOUAoJXkoY85IIuKYYTnEO3xgFIgnoQnCVrqztZ1z0VS+p2i8rsnRzhzFV+OwxeYF0f9i78RwGwciAte6bgWy6Bkv3MY+nAGQkXUChM0z3//6n0Qz224YspgTuL7wPuiI6lE+XYxmu65CObNoTyzBKwABzxTzECippUwqOK4qhmKARuduc2gqdaRH5tyLGa66c9qzv4D+yJ2z/O/FFlSIQjCfwwySew0Xlj1UDqOltWjkh3ltnXPyYHt498OWhXvVm+34GIOwxaid/rgZOu7c+bD2JjUrGy+HSGZzU7XvvmPJ9/LAecwvKZy4Qeyb8mt0WB2b7DcGpoB8+U4WjkyXSMnTqu94CZppt8Y0Ag7Lm4eL6VJS2B4VVs9wBZUSbP5kVUnrTe337+0JQAoD8qrOOXDkQZ7LmaoVaMeyvlR8YAG4Focn9Z0zOBL821o/zG4/sxdc0/WbCHh3aMEPXDJSvXC5nPmCZskfAlBoW8A6MqhsqVdfnHXrCEitPxa2j2wd95joopZVq+n36HhOcbn245orP96fM2oOkKIx+AydVzYNE5Vy17dMjGsaBKVekMXqNQnNTM0Kggk1wnnWt53m9YQhPKbQ9UcrRnzSxyYxQTi3hChtac672stdjgGJx8A55YyJPiczgyaEhMbJ7973qxUXt3mXx4W/s0FQPl6KDstV7jGuKagGhboW1is1XfuUm4vNcqmqFpZeg67R2R01besGVVjVHcA3rN4XgPAJIi1CGJ6s52maZgHu1tqNDSVJ7I75xUVrLlYSQqIomqfcOPYX4kKiLJmWtsaCVWd7MilD6T3hUWwxZ3y7nlcNjEENq+Z6B8vZHpm0TK/uYcARDmW4fdOtR/e/8OjAYPKWO09Rj+rGCHqyEs9MUb03EdkcV497G6xaMSGSh277TlvkQCa1GJAfuo1HTObxheJKZ4jfGBodcvfUrRi0nRigVPfWqMC8YA5iqaEU9GKQeh7BnTCzPpMcw8ByAJK2KBGLFP/W8+ziUHnpzeR3h7HfJ8QRsrQ9IPqv111IrUe+jS6Azm/x58vajZpaDjm/Kid2yVsbfOEInFtW2dqpqpXHfuhDNfdiMViYaUCm1Y03zZrDdiLiy3RBftCCIWd6eVSUkq6jr3gshd+peXwsnGceVaHcqI1QzyrUQCS7fZBkTzBq0csBnUZekvCKqagDMaQyhbsRmkpBt/AFQF5aROlP5VYyULtGm/RksNRPOvHfTNtGcrQkO7PfbGj70x8UHzjZCQVRHlZiW4Vw0oyuF4hr/WMEJpI+sFPBB5jFVliSaXw1kmsLVJxTwDYh0Stz/fg/0n6TTleazWg0YrmYFVllLTjhO9ONmPgbrfKKJhTCMvonPnw5RKJcZxJKyMWlpnQgj7vnb2AANQyI/X2+Q2pcKUb2vXdR70v1mMLdf3rgKrJaX5gYTNzI6EEfLNBiFI7ZaBIqKo9zRT7h2u70BwDZRkArLtaO5HJLHgwvshPWgD/eaBfAqjViltm1l/SA0SpQelh1kwla1qdar/9ZfuUHt1igVLVcrTnmnfNiJmt0x4SVTq2pvJPbzkzPfHg0uFowuZzmzJsodi1oCCkG18S/75/Zn8FkHxc/mRYA0SmEKyptRcsxKA1gjD4YvT6dlbtUaHS8Eq9UJRSLmWoaMxq3RDKzoWyQYnhi64FQdXjFLuA+MoTaUxbQzRgGD62b7a8wNQiQufcnKbVEu/um9FvAUwRNc+xc0bdJU24ptVeMBFjV0jA95DR2TZ8TRs8U7CkB1lo6oUyPKZhkrKUj1fNpGea1LvDMVisPHqHdHsZ1vJDN60siz19Uv47cU7DFWLgy5QAQMdX70xgNknSTO4UO98vCABlzzFV12S+F+suFYO95TlSObJLeZZtvYgbsPqM6g+mwj9qfTtOWHZd3Dw+kvrDE1Wn4FnUS7HBpKrmdbJRue2dKpEsFrEuWuZXm2Zmg4ZZUmnI1KYvOZX+nqv7THrl7z4tM5x5Zr13+m/EisN/7QISzn8j8WDVjHJo+ZPi7F2XcbZ0rut9iPDidMEzcOUxXBbCSVMBfO/FggBQbgSXPylBI6g1ZOSGsnFP3/GlRAk9R2K0WF7yAuHL37oQWCk7Rq47g5ExYdw9C58Zw6UoqECIyoMFgdTf2Da5xzd/BbiiAJRHQ4vL+YFzworpmohUyugA0zWfsH7Gw937iJZXPr7BPEH005VPYUWwaXRyM0nl+U3jdMMjdC048e6e6QUDYIpngcVJZpX7LYK8oJe5h1KW6G+6GZw20vVtk2t6qwgBxDqSuT9qUfLiJIweaN2TepXA48oUO68a10Jhvb751afjwbm4J4Q+kFzSxrG6w4+6zbAW7zY6Cg9AtERWPCXvwZFvb3UeBX0Ajj6QDkyDocMj2cysJ7tnD0UYROW/8g43iz/8jtnEPOwegVtZQ4WgLJnBCPiSs57nRb3pxF2ZAF9v0gRtsBckgCmWCJp+GAUS0XlplOgNRdToTmQDIDbc3/WCGZrOLCXxGR6SUXkfkG1iGuYMdaXcFPpc+uacHa0cGRawZaaaIEJlEWyfV+vfFm1IPKg3sQOO2LG7sAFMyJ9WPh2G7gBOoGWFQVL6/deMeL4SXsjUEKDWho/n2tZJJd9undRnNDiCCB/Mg4ewWRYRJc9NOTlm0smeuY+4lh68QRT717lI/Jbo2an36KpnovZtFzFxwTT2cxj6Jrb2DVbdha/s1JtwAIl/21WWbwBt2ZpYKtey5LmSpHdwZazc0CWQA5tn1l/yKM6aMiWWMnXNTExb0/E1o+QGcMqW86JK669XqxJlKtPAZ988E392VwcG3g8tJYxtFa/V5g0+tfLTE5Bd88DC5rpkGcbzYE65D36OwXmyFaGMFdrSNEy5y5KPruMe8c5s96zHsShln3l7Yn9CXALi1JulujvhQ187IS9rr+xZL96pn8Y1YC/IWM9ZXIvVmmbdUdu5tzPPJywkGWDETfbNeyzVNHU6D4R1jQdCaxttWTOqy3ocuOjt+E2SU899HsXV1oSkVuUAcikcCFGU/eqTIC7YF9I9MH/ijdGuLp1XSn3jNgaZ3LzDVrea4n1AOcpCvF03lQPIpbAgRMH+YMo+gM75e6/qBrF17XNwj5QhEEKDYNqYta4pXtNqSvQrcfmEv+yYwgHkUpgQoviwP6gsW4ehUvPe+8ap9x6n1pViZzcBEjpZ/M9Xf5F2CKSkqi0+E18xQW9un8wB5FLYEKKIiy2pZqXvpT1f6wbx9HqrmAKiRW0fwvjuq3ET9Po2DiAXDmFSmpaUuFIWcvXNbbyiG8QzG2wijbt0cbzIan3r8y7m7VNvnPIpeyaK17ZO4gBy4RB2l4+WDv+pj0iJb87uy7pB/PytMRhUnAhzc45e3y7fY8Ta0z4iCHgshmoncgD7niQCmbt/orxo7rPm8i9zG7/24SyG+Bggdf1p5dOi3nuAFsSNLIMxSkxwH+kepVY4Fi+/M4EDyIVDyCJzGq7gmqLygH4sRl0617yUBdcnuUdJCO6BIIpf/pEDyIWbo8xyaPmTXfqImWZ0q0i1snkkB5AL14TZyqydX8kaEdeBpDHqOPraSKbofNtbn/twyONejIrZzCnkwoVDmCKgBUPyLOoYjWIsoX/VM6pBs2M9Z3GcEPqCFPuEorRxLAeQCzdHDRD0doaVNUWDZdsupg1NG78xmIwFRROUA8iFa0IDZbr3S1zqPohTaFAjwrEtMW1GBnCThFtHB+Hv8DsRv6gZwwHkwiE0HMTtf0YvJ055wWlHMognqkaHX9h8TgaUKiZo+1scQC4cwryJfdvFn/p8oBHhG2fb+0A7ygCe2WDjAHLhEOZblEm9iYm48qTeWCwmnl5v5QBy4RD2lEzZct5Ekl5QIrate44DyKUg5H8CDADSKKddjJo7vAAAAABJRU5ErkJggg==",t.rainTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAACACAYAAAAhzrj3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFZSURBVHgBrVNBbsNACATiQ2+2f5D+pP8/tS9JD5UaKTZTYCG2ayenrKJ4BMMA4zXRi87l9/bhT6mAdNRhG5lo4v+pjNCTSJflNJXOVDqWugBDtBiI+qVq1SuroF0fYMZt3A7mf9cCb7tUA1pAdik7P9fpfYmcCsx0RH4AJJYwoLbTM/KUAMKD2AFBh/WobVaxB2/KOyeLMERVl5TOyg96yckLvEUIKsZGdtfl1IuLzdCxkY3XGYeJU9DcQmtBFhHi1CFwjLLp5TMd2sJIMorD/htCh8H9SpnNOony9BAoQU7AbaBMSUXunEjRLlUAcL/nUZhtUZY+dGxtIwebkyzlIaWgbu0FzgdjKK3LXVEbOS5IRMzhc7iRNG6XwQdzY9rdiE35PnPtnqEgr/bSSsX9xr3qbNH2mqyAWwvADLew2TD63XPkE8bqbUKmdRVRpkzs27F/lJ9G/PoD4CKlP3uMsAAAAAAASUVORK5CYII=",t.snowTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH1SURBVHgBpVPtbtswDDxSst0m6pqkzZphzSPs9x6/L7CH2I8NSLAldmAj8ZfEUW6dtR3WPxUgWCbE4/GOAt656HVARGIsLQpcWoskxvoe3WyGWo8NEcl/ATTZVhXmkjTz4NkxJZmmI1jbcEBFGXIH5ArSjzl2PHwTSY7AkjOsuja7BftrIX+hVwS9bwLLAUe52lGSaqHtCGJH2iVw3XVYSefviXDHoLkPYcocRM/H4JHrN7PSYVM1reb8ju2MDFI0WFDfL0H0USD3Aloy0VUQAQMlQSYBGhVqp0mi9RB3PQBEwSiFA9MHrbIIgqXyWuu+4YEi7UAsCDgJSyGcuQK4OANEtQMpC0I20NbKGl4QeB0GVySqXZChS41nyjSjxg4ODQWc0xrooyPE4Gc2KX0VhF9aR13/9+ephaJP01nTwddMqvVjf7tHCOUm2Ks2pfhwAofaGGr7Ft1zgPrm06zS64fhcpCJJmgtOtAAoiYRtrr3YD4wbLkrvtfnQYo2avatP2LNxn8OPqxAZmEIF0EZkPBRtcjZYGPY/Cyb6sedc7/ONsbDw4PkX76eUus1ZKhRFkVQwYIXUgNqa+TQe9kZbzaavB9H+p9R3lbVYpK4mWE4r2rHRo1IyyYpqaty59yLUX7zMTW2Sqdw8vSYThpvXz+md68/1R4Na0qbii0AAAAASUVORK5CYII=",t.selectionIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAANVJREFUeNpiYcAB/jMwCAApAwbqgAeMQEySDqADHID4P5VwAy57mBgGGAy4A1jwxRsQN1LJngMMgxUM3ij4D8mC/VSyZyEwGy4gNQ2AygEHKjng4JDMBR+omHofjOaC0Ww4mg1Hs+FoNsQFGP9TL6WTnQhB2W0+lKY3aIQVOgpAvJ+KrWBC+Px/bE1+oGABHSxvINQfMIC6kD6+xuOQfrr5mkDv6D7dfI2rjwjE68mwvJ+q+QVoYAAQvyfC4vs0K1ugoYEvu/b/p0d5As2u76nha4AAAwAVTG0xZ5O+UAAAAABJRU5ErkJggg==",t.selectionIcon2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATVJREFUeNrsmNsNgkAQRVdjAZRgCZZACZRgCZSgFVCCJVACJUgHlIAd4JDgh37sJiuPWeacZMIX0bl3s5cZ5yIYnGukBmXVxPRydMZBAARAAAQAAACrHCJngYs8MmW9vKSZdpVfYhjiQwgBEAABdsIp8r1WYS+tAwAAYBpkGuRLEAEQAAEQgGkQAAAAwL8PkDGykmdptP/7Z77PpTqFM/5S9ZyWOl9LjkzqYaD5W2jbU0j1Jlz3iJApXXvFVhW7+ysTPw3jvZb/uwC9TMcnOdeHOTfX4+VhxnWPCNrjcl7XPRdkZcb1BOJyedcDp6E247qiuNzOdY8I5xXiUo/rG8SlPtcDH0+dGdcXjMt0XJ85LtN0faa4TN91jxBXz2nod+V6IC5/dw31bl0PxOXoerHl/3gLMABFnyPWKue8swAAAABJRU5ErkJggg==",t.waterColor="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAxgDGAAD/4QBuRXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAEAAAExAAIAAAAHAAAAModpAAQAAAABAAAAOgAAAABHb29nbGUAAAADkAAABwAAAAQwMjIwoAIABAAAAAEAAAQAoAMABAAAAAEAAAQAAAAAAAAA/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8Aq281jqSlrqOa1DKJHmRjI0an5WfD4G0ttwS4wTjpxTrcrDaJGguVi2b0mdHeNASR/q1KbEYbScsSR3YYqmVXSruCY2ptZGlKxho0Jcgf8888/exvbjBIAO0ip/ESx3UtvdKIRdTO6qqxSLgL8xYBWbIAYDOThQByBkf18fxH1stv6/r9CebTbGC1t4YZFuLqVg0ciRFVQcAKxJBAY55J3DGeRUOn3sdzA1uEhuNvDPEGWSMZAVw3VlySCACcEZU4wLFnZODcK+nrJJnDtHJ+72PlVJ54YMQu7pkjjjBbFpD6ld/ZoIJmuP3hlMcpjZZPulScn5mIGGK5LOEx0Id0tQUujf5EMd/NbakzNaO8rgedDLKfmGCVKkDdwMnOScEc96Lu1gin2wxuzOVZ0d2lXJOEX7rAE9cqME5HAGKdYn7RZwq0dvapasoZjt3oT/y0OeFVs7WPzYKrwOtOsGs7S9bzI4boRXCNloVhwd3O9wB8rZ+6NxcEcEDNGtrD21Q9fJnna3m+xWrx4fzLeIt9nJPIIUEE4GAQcAEE7jVS71a1uLzdawW0iqRjbuXcW4Gec5GMgKdoJGfaRPssQaE26zPMXWM20pK7mOVBQKoTAP3VJBIXg4wZrqNJbXc9wblFkZXlS2+WPpgfMqkcZIU9xnAJJpavQa0d9f6/r+mNtEkS5VYZptPkkDOss0iqjx43EluobpgA88DHI3Mi1JZrRbVZJIYZDh3Cny5SF4+UdZCQTlRtBJwDkkM0+4gtpfIuLGZZ5Sku+3mO5ScbcADqDztIIbG35eadJPbWkLNH5izSFYjunCKqMPm5H3GODlPmBDE4ANF+ouXW1iCW4ivNLhuPscz3VvKEnu1UsHyMopPIViFcjdjdhucCnw/6AY5Iri5juLoNJsUld43fxc5PIYcgY6nA5Fprm61pY0+0SXU74MK53CIg4wGPAjx2LBRk9Qc1XxapaiO6sZIZJGLLcrKGRiu4MiEgAg4+7kkFV6cgzsVvp/X/AAwX7/Y9f8pbO03eZh5xKyKCSMkMv3QMYAxgAYHHJmSQNb/YIreFZlTEcaqXXBJYsrMSMkYJKgEgDGTkEs57ePT7e4WXNwrmBCkMTxFivdgfm4OChRg316Nmt7fUIGnjaOaZCu9J43lIbgZUbSGDAHA6oMkYIxVegvJ/ruR6hLuZG+d7iNRvmWLll+YljlQQOoO4lsngkcmS5DWcj7FtY0uASoB+ZF64U5IU9QVPzAcdzkgaXTokvIlikjUAbvMSdixxgEMfmwVBGSMEjAOKdp4uYA0PzSLICcMnyudrESDbjoMNu/3s7sEUblaWC8VrhZv7SurmSS5k3Exnc2Hzk5wynjsxU4AAIUg0W8IaRIbdtTby9hBkjEi7Rgb0A5CEhuMFs9Bxmi1bT3smVoFkvLeIgbAd1yqg5yAcbfmALHOAgxnoIWFzZyrELKS3hG4kSKVVIz7sAzAryGUrxnvzVGS10CK7WRXRXWbadvmwptSNc53Daudo+XuGwQOSCKkljhdFkktYWh2gq0VvIinJwVIHLYH93nPBBzgRyqbQpCtm11DIjbFWVgznnEgAySgBIDAkhlPXoVlWO1eOaS4kaFZGxdGItsAwCDvUFsdQxIOT0DEipNdOg6WW1v8AVXjd5LWOQDPzmcqPu7wpxtU+xJ4wSBwGLfRm2+ymaR/ulQS8aqWyDtKnCgqRwuQccgdDJLHZ2yW/ltZhY5iqkrtkGACMxKd2CCBuIGSD3BFPnsobuBplt5vKt9zP5SNthGWbcx6BiflBJYngHnhlp0C68xi6e0tii/uZAp3FvPLB04BztIHqeNuBkn2ih0+Z08na1ywZTEUQlUAZSHz/ABk9cqSMY4PGRtNE4guBE1xHdYa2iuEeGSUM7KzDa2BhgRsBwTk+9T3Wn3F5rEkMPmIsm9LiCC4iaTduIwxADZI28MvLMR1OQ+aK3JlJ7EeqJNPqreY1rIHmzKd0eUcAZUbOdu0bQM4AHUHmnO7fZ/OQLC0OIgFZ2LxnJXB65yOhAXkEgnJqbRNQmE6ltgkLeXvlgMnyspB35+XI4wpBB/DDRyfZgsjx2truRQjPcAAwMMDiNc8cZCcgYyNmBVdCbO/KDztLazLaySSqjqzXJyDFKFYqyfvApDjA+cEDHAHBZwnub2OeWxa1t7iSM+dHC58yYKWz1Ax8vcllIB5wTTY4fssKKq2txbqm1wshX58DOR1yDyQDt5I44IZawtLdrCkf7vcxUPg2zNtbBG0g45XqSmfUDFSVyrcfBNeXDru8+5jaQLGdm7yT2K91c5A5IU89jVeT7Qlj+8VbOYqrpIy/Z2dScDGQpG3155HHAyJtMlvNKXzI47tbgNuX7K/mJxwEC8o3zZJBB4AxtojuPKkDFb5VlKglTlpFOS3y8KT7ZyO2RwDUfXSwx5Xm8PSNbLdQrGwkmldT5cOQwKIWJK7sZw3zEISNoOKfa2VxBZoiFcybjGBIFWQZB3Bmf7pcH5QuSSfmA5qS6kuryJZZWWWHIFsCqyIxAxjy88ALnG7GCGxu6mO6sVm+YxwzRxj5pElUyBAGOEy2CMdzub5RjPOTXdi6WP/Z",t.waterDisplacement="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QB6RXhpZgAATU0AKgAAAAgABgEyAAIAAAAUAAAAVgMBAAUAAAABAAAAagMDAAEAAAABAAAAAFEQAAEAAAABAQAAAFERAAQAAAABAAAOxFESAAQAAAABAAAOxAAAAAAyMDE2OjAzOjAxIDE0OjQ4OjQxAAABhqAAALGP/9sAQwACAQECAQECAgICAgICAgMFAwMDAwMGBAQDBQcGBwcHBgcHCAkLCQgICggHBwoNCgoLDAwMDAcJDg8NDA4LDAwM/9sAQwECAgIDAwMGAwMGDAgHCAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+ydT1KC9mSN9Jjjk2bSxtBD8wPIDF2Y9fUH2rodP0a1k0f8Ad587y8YlYNIy4+6fMIL49CCO1Z2paPJpitHOtky9YUjkyW9cAkCT1+Vgw9DWeNfXRr2F5FnhaSQBDI6D8NoB/nnHrX9McvtIpUn/AME8aNRu7vf5/wBfkVLzw3dRMscl1Z2cbr+6keMwxnHQEFyrfQfl2rQ1Dwk+u6VHILuZY3UK5t38xVcdwrsY3U9f4SMfdFXvEsFjqlzHdLb6bHNMMsY4ysjYPXCBg30wD3zRNd2B0rao/eSSBZYtzxEt6lWXn9fr6V7eo1GSvf0X9f15kLmkm7trvZW9NfxZR8Lx6boj/Ym1SG+mRdqtMu1g3qoV+pzztYfSs/xX4SaWcTDazLysRhYoM84BYl1z7fhUN3eNDen7LZ26wg4VwUkAbjsGYj6HA4rodLsbl0F1qFvulHR0lXao9D+8GPxzW8pSpS9tzb+mr9P6sT7r91PT5GZpMkcnkx3H2hWVdokLkSwt2+ZArkc/xDmrF1oraa63NpZ+bau20kRRyLv94nw34ghvwqwfCx8RagsxeObqmDgSoByCrgHocdd3tWtcwXGoab9nW5jWbdtkMtyhSTB/i4B/z2rnqVknp810NFZaX09dP0+/qY+pmPXNNjt1t5rD7LIGimgKjGOuRIBuHP8As1NqvmwWNvPdW9tewSKAZHdtrYPVtudv5/XFZtvpdnp2tXQvNOjhlU7mUKC2f72NxyPqMcde1aen+Jb0XaxpJpqqoOFa58uYn0KkgFSB/CO/cU5KyXJqt9+/ncmXL119P87sl8S+KNL07QLf/iW2MawrxKk4AUZ65GMdQTuGOh3VH4VtZNTg2rCjq6FljRkmZl6gjEh+vANVbiFb3VJJLTdDcW4LbYZHbcMfdYfMGA54VWwOlc/a6iNLLzG3hgulbCidTGjk85+XC4PuqGqp4e9Nxhvvrd7/AD/EKmrXMtF6v8G7GzrFhqWu6r9nj0+MfYmBDkxqwGeQ5BLL19wav+K9P1LU9IjhhhbdGpUMkat5R77mZiMfX8jTdC063uLb7ZHY2slwoLgWkqzNF6nGTlDnOBgjuDVW43Sah532aG4kYhGikmETk/7Oflz6dQfapU25JRt7vl1/8Ct/XYOa/vO1vT81zWKfhqDXLfTFiZlSOE8mJmGD3xsK49Ry34U3VdRmTWLVbpTOZn28rJ+8PY55DN6gjPsa2oLv7FdyI26wmUHcrzLD5v1AA/MA9OtSaHfz6lDNHDJp14khMbKt0sgmPbO8jOOxySOme1VKs+Z1Gl+W4dLN/JO1vnr/AF1JNLum0tI/Ml+2KYynmSSmNw3+6Cef90kVJd6Ot7b+Y0eG/hD2fAz6Oxzn35PoKoyeM7mXUJFkgdfMBEVwqhot3+8SQPpwaRPGV74ft/Nn1WxluPMEbQEgOB7MDjB/2tv41z+xq35o2u/x/Cy/AvbRL5L/AIb/ACLyeHppLH9z9neSFAQZGPmJ6cqFk/At+HamHwt/b2lb/ssPXafnilUnrxHKoP5HPvWH4k8aJrUESxR+TOTyh/duuOePmG78WGap6XfPqAVpYlV921pHk3K3cEgjJ6f3m7810Rw1bl5m7O/9dVch2UrP/NfddEd74eW31TyRY6bDNGNqPJbC1DEHPyPgluvQPmtS1F9ZTxySWyyLsz88K3Bx3G5trH6HcK0b6aK40+SOzvNLiuM/JAJzAWb1UOAGJ/unJPY1Ssn1C1tWN9Da2824ZdZwytj64I/E/nVe2c42dvnv62K95SXfzf4tP/IsXlgviqIQhrRWVMxyFcLxyPlY7W+gAx6Vinw+kl2rtNrEbY2b7S3dFhcf7zMrqfQ4x2IrVLNqlttt4fJmk+WRY+VcjvuCDr2OMD1pbHxG9nKqtqVjbSsceXMwfLj+FsYYN6EKQaIyqRTUfu/pP+vVk8zfW/6+S0b+46BfB0msbpoNPaFYCAokRQvP8LH5yp9OMe4rM8T+CJL2D/VrFMybVUw/cYdjk5H549DV/QL++0e1ulhhije3BwIZ9zYxzjqdvP3T05qnpfiDUNSka5m06SZN2wGQeWc+m4NjB91I9cV59OdaMnJSVlt3/MJSWza9E/8AgmLB4Vvr/RltZF+xx2WAxilaRV5zz91k9QfnpsjXekCGGFpLpJTtkZFyJT2b5WZS3qAAT/dNdVpelwnXHvPtf9nzxo37hpY8zZ/hKHn8VIz71kNqB82Z7X7OI5H8p1ZolMh7HbMAD7Ec9t3auqOJlJtaNb+V356+ofZsmv0Xz1uLqevx3NhDBJbzWgjxgrC4UnPcMoQg56EKR61V1GWe8s2WztWn4A2OHj49yMlf0HvT2mNhbTedbI0ajLRuNxX/AGsAkbc+gI96XTNej0uNZhb2csgH3FkjBIP+yWDAe2PwFXFcqvBfiGm1799Vb7x2jaOraHH5mmafCY1wrxyNJIh+of8A9COP5VDBpF01/Gps/PyQzQiEM8g9Rlto9emfbvWx4cuo5L6a6Vpo7iNGbajGRDx3wx4B7YPtik0Vv7eguGa0to5geNw8kyHruxv2t9NqmsXWlFyb/q/q/wBRylzW5vz/AM2f/9k=",t.markerClusterIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RUU4OTlGRUY0QUMyMTFFOUFCNTE4NjMzMDg3QUZCNkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RUU4OTlGRjA0QUMyMTFFOUFCNTE4NjMzMDg3QUZCNkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFRTg5OUZFRDRBQzIxMUU5QUI1MTg2MzMwODdBRkI2QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFRTg5OUZFRTRBQzIxMUU5QUI1MTg2MzMwODdBRkI2QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvdO35oAABUCSURBVHjaxFsLlF1Ved773MfcmcmdSTJ5kBd5kRfkAUHBpBY0gIAVTYtWpFSgqVjsaqkKtFhIkaWyWqWlXW21rtJW0FopSwTkoRhFJUAxII9AjCTkSTLMTF7zvO/d77//t+fsuZnJTJJJPGv9c88995x99v/6/n///x5jRuFoAjXw/FugPwPV89qDIAeqGGPLIHwm8D0FqgPV43sW1xtxniYlKnqfled2g+aDMqDloPWgqaAEaBzIHufcj+v5MaAC6K9AvwLdDzoNdCNoKcYugs4wJtkCxsBQ0ipFRoViB5mE458KrpXxWcT4xVeMKeVxrQc/3YnfnwXN4Hv/GtQL6v5NCOBvQFtATxnlag3GuwSn0Fga2qnDpTR/kvdYz7QNuT18Eo73OqGo34AM5GnyGyDzHRDOzbiewoUkhXAT6K2TJQDRfAl0Cmf7EYxzJcx6AZhuUMaTLmbcDcNw7eHCW2qecXx1YROE8SI+b4BwzseFD9Py9pxIAdTT7z4JetMop58C4/Pg7mQ8UWva7nCNu31gog8TT+j3ivg7pGUngNKKD9YOIpFAGN4q8g8Z0/dxCOIyXHs/LqwF7QcdGG0BjCHj14DuAWGy0WcAXvUqlwQ1Ltp2oamLP3fAfBsxWQipAPW5T+Da0/i5kfyJbePc3ofzBbQc3JfEc+nxEGxaxw8FKe/xMikDf/IvAAYewfmNxCNxidbREMAYOjGkbOaCvqEmX/en+KlZUdvaQDkuVloe1/uA8EUR3GoM8wGAOdTWtBkWcwhjJGNfF1S3i1RIMA7TtRfYhmhS/hJ+n6+u3uDUyqLACvp5wJcCrKHni3j+THx/J+gvGS32HasAhPnP0KT+C3Q77n8PND4HoWucasXZGNEdLUACQze+lK2GuvEAyomIBGPHx6AYDfFuEYaYdgVWUdpqTOdMY9pgYh0iUN7TaNXqbChwq2G2vBFCAEj2/AWuwUoNFGU+dwRsOKIArgedrYyb38WkId3GbNVaTeQGakDCVh4X+hjCZJLTnOJkhuYauUFwwdSY9SBAWXFqTSKE3Tg/RO2LRWS8RZiBbtH7TSgBkaIs4LiM7ls+WgE0U4LX4j4kH2Ma1ChsEKrkKFoNwxK3m0HT8X0yMTIE8gHvtTFzfhJeo26QUOm/SgQQQeyiZVuFjwHv8mP3bocFIWxWbjiCBSSHi0dlTToSdYrOEdHXT6gXJz1OTXI2aDpuqCdTjsxE1Iwwm8NJL8bM7YRWYaIuq6brYLYWUks3qFbrmfwlbJwY+flOwfdx+N7qVBCdOM+4QDmYYIR5pGbh8wWNMkMeiSMJYA0zLqBr5RzIIqMTSFE2XUzAJuGti5ihpikgMceIJt0HTbTifAee3yUTz0GLnzbm4DTcBx8vdkIY0FL7QlyfqhpuBwbs34brkEQKL01bxZwKx5c5jKWRinDEGgpW358A80Xc1I20vPAzXPgY6PGhTPFIAsgGeb3YHoClbqxezjkFpVNBc8QfbQxgCQ7cIz4L7bZeh8eBIeM+oPdPw02TYZIpAUWMHYmV7VWLKEFIe/FsG77vwrvbGQUm4paZnJLleywtK09L2EpmxmBiPY9C8ML0StBtR8gShw2Ddcy5WzkDAGME7SQwowVOzd6DoAc6iQKi6R2c7Hw8ey5mPqNRzVq0mQrCl7M14UxwBUIpvA1hQCgbMIeNsJocLGIapD27Tt2sQjCMOEYbGH+lHffB4twd+OEK0K0q3ONLhLJc9Py5OCCoDaaHGLt0rGqmGGR/B5mHiF8uw/ULxIusuo4NQl347v48IowEdiAMdSDz/ClQ/bm7wfB0uJzTd/tUW1Lv7m8b8ypWi62/hYufIIjsH4a3xEgEUOAsACjmTHX0AvLw3iVA4IyGPPl5JybxulV5/R5IMtNJNdlsCO4lq0mPAGnBrx14QxTcJ1jSDIQ7fRVcCAO+jR/foFdmra40e7AS3fwkmH8XnpFsEIlWdfBRXwzV0adeBp0FLdxizDx5H/1wgaQMDIUSuwX5E0Rz8dV2hrEurmIPErzEQsY6LSGM0Uy7quH6QFgRwe8gLnwfn7+wKuAp+LLtQeDNebj3lmFMflRWg41U7R+bqo1nToMmkOmtwNdVTpG5wBQ5RQa30jXeklBIyxPglLyhRdYuOEcwqIZU0azUDSbjHIHBzLMqlCLBL03lPoMv6/4Hpv93ILinW3sMq8HksQighwCTVQHkvgyEv14toYWTi+iXb+HzaacmK4Ujcc9zaCHjnQ4h4ayTIfUAFfgifvu5RuBqRnke7p9jCbJ0s/mQ6jMIn3sl67p5BP4+qgWRDBcbRY5zMYAJafNqWMdCavEFfD5uVdMfc4oJc2ni1g4Rl3n0WcWUdfhEVluNKIAA89s0wB3Ao4dfwjsAeqX36LK8qpiTeoj5IE6buzirz0IIEMitmPiVQMVx+FwN+kVFExPnyY2QKppevwn6JExk7HPGXITz27HqW1mvRRjzACPTMR9L+DmXC5+jPRK0hLW0f2R4Y9vUfz9VUZ93AfOVEQqgUvNd8vovgOEZ/4jxkS1Gl+NdXw3CzDEf1/HzMhYR5Fh0lMJYRE28T+07WmfMnZIC12i84o5C+zWWIJ9lrB8eeAfkLKDxPdCHRqEqXHUqOJdFCLEXMKFfzRRYjnkjEMYtDPyIXYknkINgwm1e48fK9BBUQKz9EsJN9lRaQP0I+ZQs9rxB0UYTnQw+m+C/GUg2CVCxlxJ1vqDL4f7jnUyG/LGCQhI//IExl2CSW45X4zXar9RYwgGEujVQXDROo1AVkAc7ZlDBcghQ/i0FJpZ6EXi8UAzI6SpLAEvCjfhuC3Lu9CaMCyCbgPQyi+wqfZkWLc3VoMtp9ovo/yKoO/TZB0bL7IcSAMd+5nlkhoJbd9cIYBrnI8diWslqzdCqkefzUDD4qkOYyhbFYyuaSk7AoFMrKoQpYCp1ua67L8S1d2ORsVSu34t7ofHMeyG0u4gbciA3Nz825hrc03q0SH+UAvAgKjXDm1Zp0VS02X/Mi5lOQPsNN2qGORW4NOkmzSNE2ac45W9yknl3MkgKSqcjbI3XtHSs5OlpTUszfwggQgI0H+ld09eR+iJrOQBzasUyuRlCOd8dnvuP6hGUzBpPgXLuNOa7wJ6t72e5HinmOOTYaaScXQ9oRjqDCVgGwtqzStNwwyp2dY5JRrIEl5ciodLH4ypsOajs9EjlJaWYeBZWW4U1SEhw7X5IcKKrdsPMMPnNqByOafZiAPY84NHu12Dh90GrUNTcsvLxE3aUJvmSvdVljFApqFzbsFfnl6Ml5tv1Jq7xy7VOp/nOeK7/kwmV8CQGjwk19b7R5ZpLZW8FsnCC6019RN32ukiNQJotsuB6Gde2M1EV5v0aQuoIfSauO9rIxXX26rp8I7T+jFpF2samLJYgy9YMFyYVZmlSBc6z+ttsYxNwJ8L8a/J3UdACqyWwXvWA6oLJ1wf7qLgwZ0vxWn9dM6o1WayuKnfpjXXBb2Vag9T5k8GE8qwFVJeybpDJnsBDmjITqYBDrt+Iq4rMkOFy4DbVtnztINEg+b1Nxb03f4i200z5Ezaubhxgw6LOnPyjQtOWue33JXaW4cQ6UvbwfqwbdjlsB5NKTV/ODaycO2d+s4etYczW7D8wg6Cz/36YAOBIrjuQA0dJ/FArY73vCyzDKSAKLuRq2uDuJLiBxy8x9fEBmDsWXQru8DrkYBY/oAgpFQs7hz14rt2rAtilaJoP/YqgkuRSPE83OdHM+8hUZAElyVjvtV7hfEq+5knmKyEoep6Tga/LwNLBTZL5XFCDT6xRv8pLwwEPNtm4RFjHStQBX7c/8RavXSnQZmbCyaBJmmMHqoE5gH+mRAUmgmZuf4x0AYAkqeW8b31blWSW5e62wJ9SLAN01LTjTxgsBL1DKfzuZB6SDt4rgLiPUSl08SIbOil2rfqbCmUXx8VqjV3KTI9p5hfe1+S0btdm4l6fvED2RbWzan4y4p9PtF5hqUyKpnU2btWLYA6w3pgMkp68iQuy/S39KPANP/fEd0D/FCcXvhWe5eceZlO+oXEqLUR2sO11gyDw6BpA9ZCsdB3PZ7nY1MXM29lr6K89ipVvwJz/TQdIesCW62IKZRsDW9XfscpLX6va7qKbyO/iU9KV3W7V59N0lay2CKoW8PQQEx4t7r1gN+oC1JyOCy1E/og49Gsyn7Xx9Rx89UB3nA32p/7Ro+oCpVBlWF7WfRRSdNqESHKhJCnnVGSK+79nzCYbg6e4wnLZtQH6KmibHYjWo31I1vcvRsH4LPp0JdLGw9tfMWZLTjvWGb/Ag6/0vQ5c+Cz4iuJeYjXFj76jai/68ObilNdyE0KOJi73tMgeH4SDDdykIEzLBglxD6kGvWq0Htgd7B1yxwn5/fuIKHSsxM0TOL/A6SKs5EMxTHQD5z05eG/lWSjy85hnUSNG/2ZMeTZq0KdLfuUU5M3y0376VIrVndSV8LlOSPq7xjxv9ZkksULaYh90ujv2NjY7qpsj3TEKomYbjpz/K06+AlqBL+d4pYmWN8H07zfmxZuwQs2oC5Rp7j0roaxb4LIJ5inkU1w/H8ky7lt6c9EGqSXXz7K62su9AAnmB6dAdNMx0nNE4joXh5l3gy6WZgboNqcRw4fXEdcKXM2uM6tWeLf0BEAzQZdS8GXOcw++PI4JZnJa/yx798NcO5bAba7WBo0NurSll8BPQlBjG+gqvZ7iYscFq6leAl0T9+8mF+P7fN2w1MqtMS1BP/A0Tu4HRl1C4vRMTmiktQIbtJJljC+CvoExFtvqfq3q0luUIeFPsOohTOC1FcYsTWrJy/cXe9iTLDN586tFMf/edSKAWTg7X3dQuKUKKCkXL2lFGL2MDi1WfxdNZ7jikqZnF67N8g1MH5rY85MO7k+4QUNePMkGKGyHDhki+BdB/w36e6OYI9Z1idUyXY5RSBj9EehnzAdmkPmIEUB0K/3JJrqxT/6KMN8ePFhJXslE+j/x0qt04Log9qfIaIfVpuVMlpdKbF9LYfYlWs5qDpVju3u51AhBz7OP8bDRHe8SMmdbFVKKzHrr2FnRrS6vi/CYeU7gNp95QQrsQ/BP8fuTTqvyswLXiZiw7WSqXBeU0kSZOUn2ZGJ2CcvcwtFCaPwPlIn6Gm0ctFoLWOy09FQOzHnzP+BF8IOVq7VZ08zVmHcpMVWpHW6BebTebcwbyDMaF6oAkjW7zt5ii1xWd1K1necbqnZge1ymu47RQOZ7BneRlhmx+hiR2q26RCoolhR+CX6+iTHEN5OvslHwXhVzGU/nrtBymN/YKAM23gMgwRu2XxVvWS1T0vNPxT1Q0/8R+T/EzVN5Mh9Re4sw+93fhoYfAcEMtubC6ka8H+nM6dAJy2z+pwLnkuY7nsD39WRukRk4nxI1L8w3eub9Vr3XwN/v4x5p6HzE1wM8Wkna96gKIMWlsDeEDECv+M9wA9hT/YehFf7XR/Wll/OfOpxmaBI2L2YDKcOJCSWkYAmwKojT/nwI9LsGv0/XOoMPr1EAzLL6ewwnv2a367TAjaoLHABHK3Kb7bfrDrSGmtCTf1Zb79XmyW1+YdBGNPsgHRQOWH6HAl6SSYiFvabnYHJf1z18qaUKclHgw+NIYsYbrX4mKEgpmkin6cf/AVnvHCQcZtjlgeQKKZ3GBGpfMGU3sq51a6Er/NCaVa3PtSqYEj9lDq1YpGyC6ZXh2s2JGMvE9EsAvu4noEjpbt1H9EzUTkJ6f7vxYsBn5Wy6AtPdaBpumapb3ztmxaHFm1+F4XIyv2+lxnZww0MRL1uPmbevN3GHIjwma0SyyMCmMFpIyv0UPp+CXW9BLt+IELwsE2d6ZYY7x+03v4LpFJbBgiLlrX/bLfyzB8LvOx3n/wt6cqgdIkv4lKjgXs0Gm4ItshFfdpD1glMJUln/fz4mBpxDzBMOMrES+bYhie+7w8QZ0oAyr5pw4gwkWk5jfCebMw1s+7Ww+FGkaQvzeWRjO/7dmDeRLFSyWqFO+UIPLaMbK8Hux3HtxqBhOug2OZnYu4zmmXCF4vIYfEIh+Crwfm5uyhCpo6DsJNvnJHcQRJeosgcT7PocsWaoA8tMdx5CXVbBVhieyfjexFDmTT7JqvTmkm7MjCC4sUligo1Day+03/VDzP0idoh3DbdH6BxCuCANzCa6Qv24kXl9xcb9hByzrRS7y7Mj1VbJxbmOTFa2w/4S5r1t/Qj2HiE+N8ASz3aKA75E74IN00XysY15QQNL9r5Q47fR9iKZ6LpHMU16Hv1FhCPuEnuemYds6fojDAgJd1+lozfagf8r0EBzE6VKAtNe1p2hQumgztAJwXQ3jiAHrldXKLEXOT5eumtDE5LYGymudFDDzcF6xG/Srm59QMjrQl5TliXtlkGYH9QFQn+U1O9ctWmHAQrL9QUpO3AnZ4IoLybZdSuEcAiuAbDJlXRiGdy8T6IC8trilmGqnUVFTjHX+jHa+RHrKWKMvVD3ppsR4jCnrqyGOJ/i9vcNOac+MfuvgXnJn4H81X/yMkcjgL0s9UZcK0hwh/8WYWuVJcpsIuw3ECfq5b+/gIqdsN19WJq2S1EFwboDz3bKNtaDzFIGO8Th72Resor7DjCHPZ9G9ggT3o0Y2yX/nYakozmteUdtnbAMrfd8FNYmQpRdIY+ReXe0AghBUbDgUlZHsDIpgqHSGfrSpI33AFfX2UiJ0xN0ckn4c34BogGe6RaE3k/HPTTEu8rEgBvUXyWc7cdYh2AJBaSSGai7CczXpwM3tHHhpYB5diNJ64WQHVy3+n9OPxpmDT7iktVCAsa5zHbAWOJq3S/QYOIVpPNF0WBifS9A+9eCv1dH+C5B6z+RpR/Gb4iru75Y44LwVvUaCK4PK7I+IHzpGiLml7lEHMk2vxEdHbQG8dELNVly8MciEKi4hDXDAFQdY381LGKlmYcmXKGm4zqURt5UaJfdpw1jFGjD/0C1Ns5Aezap1nMvY+jfwYWHjO6vffpEFublX0S+xq1xYg0PYlKIhSkw2AgGWzCzKficKstUAOGYlfh9LRddwx0TucdnnpaZJX+YXNH9S54mYfwsUt7UGxj3TBYf7uWOsZN2zKYQJLRczxT6YTX/RFn/QbK6ExyfGdnDs4ypnBlBHrCCTL2uriWRQMpw4yoqkOQO3eJWxSXR9ve5De5Yjv8XYAA3ZoF+5F8SWQAAAABJRU5ErkJggg==",t.placeSelectedIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAmCAYAAADX7PtfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAN9WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOS0xMVQxNjo1ODoyOCswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDplOGQ2NGY4ZC1iMjUzLWE3NDQtYjQ2My03Y2JmYjYzZTE2ZDMiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo5MTBiMDBiNi03MDhjLTVkNGYtOTc4Yy1kOWUyZTg3Mzg5ZjUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMzY1MzI0Mi01NWYzLTZkNDctODM3ZS00NDg1NWJhM2VlZGEiIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjMzY1MzI0Mi01NWYzLTZkNDctODM3ZS00NDg1NWJhM2VlZGEiIHN0RXZ0OndoZW49IjIwMTktMDktMTFUMTY6NTg6MjgrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZThkNjRmOGQtYjI1My1hNzQ0LWI0NjMtN2NiZmI2M2UxNmQzIiBzdEV2dDp3aGVuPSIyMDE5LTA5LTExVDE2OjU4OjI4KzA3OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDxwaG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDxyZGY6QmFnPiA8cmRmOmxpPjAwRDE1MTRCMThFMkIxRjUwNjRGMTZCODA5NUZCNDU4PC9yZGY6bGk+IDxyZGY6bGk+QUQ0RkRCQUU0Q0YyQURFODg2RkExNTFFMjJDRDE5NUM8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6MGIwOWQ0ZTUtMGYzZS1iOTQ0LWJmZTMtNGJjZTczMDQyMDcwPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjFjMzlkZDBlLTg0ZGUtNmI0OC05Zjc2LTYzMzZkZjYyZWI5NDwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyNWJkYjU4ZS05NWEyLTc4NDgtYmIzNC0wNjgzZjkyNWEwNmI8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6MjY4YjIxZmQtZWJmZi05ZTQwLTljMjktMjc1NWE2NGQ3YWUyPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjM0NzY4OTNlLThlYTUtN2I0MC05NDk2LTY0MGY2Y2M3NDc3NzwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDo1YmNjZjM2Zi03OTBmLTRjNDgtYjQwOS02MWM4MGU5ODdkZTg8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6NWU1NmM3OTktOTdlOS0wZTQ4LWFlZDAtYzFlMjI0Y2JiN2VhPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjZmOGE1Y2RlLTc3ZTAtMjc0NC1iNjE3LWVlMjA1ZTMwY2RlMTwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDo3NGIzYjNmMC01YzVlLWU5NDQtOWUyMS0wMWMxZGRjNzZjZDk8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ODc3ZTIwOGMtZWQyNS1mNTRiLWEzNWItMWY2MmNhOTQ2ZWQwPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjhiNzQyZjNlLWI2OGEtODE0YS05N2NiLWEwZWMwOTVjNjFhNjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDphYTg5M2Q0MC0wNDc2LTYwNDQtYTc0OC03MGFhNTc0N2RmYTA8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YjIwMmEwYzgtZmJiMC0xZDQ4LWFhYTYtZTA5NzQ3MjBlOTM2PC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmIyOTQ0MjQ0LWY1ZDItNWY0NS04M2M2LWRhYjhhZGEzN2E2ZjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjODcxMTc5Yy0xMTA1LTBmNGMtODdkMy04MzEwYzczOTVhYTk8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ZDIyNDM3YjAtZmE2Zi1iYzQyLTliNDItMTIyOTI2ZTc0MTI5PC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmQ3NTBlOWUwLTQ5OTgtMjI0ZC04OGFiLTFmOTQ2ZWUzZTNhMjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGYwYWI1MS02MmMxLTI5NGMtYjIzMi0wYzVjNDQwNjI5ZGQ8L3JkZjpsaT4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6ZGFkMzE3ZTUtNThiNy02MTQyLTkxMTEtNmZhZDYyNjBmZmQyPC9yZGY6bGk+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmRlNDE1ZWFiLTgwZWYtMTA0My05NDMxLTgxOTBjZjFiZGNmYjwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDpmNDU3NDRhOS1mMjEwLWQxNGItOWU3My1lNDc2OTJlMTc3ZTY8L3JkZjpsaT4gPHJkZjpsaT54bXAuZGlkOjBkNjI2MGYwLTE3NmEtODA0NS1iZjdiLTEzMDhmYmQ4NzAxNDwvcmRmOmxpPiA8cmRmOmxpPnhtcC5kaWQ6ODNmMWNmMzAtMDg1Ny03ZTQzLWEwZDgtMjgwODU4YWRjNGIzPC9yZGY6bGk+IDxyZGY6bGk+eG1wLmRpZDpBNTdBRUFFRERGQzNFOTExQkY1OEI3MUE5MzYzQzI2NDwvcmRmOmxpPiA8cmRmOmxpPnhtcC5kaWQ6Y2JhYjFlZTktZTU1ZC00ODRhLTgzYTctNzBlYTg2N2I5MmNlPC9yZGY6bGk+IDxyZGY6bGk+eG1wLmRpZDpmMmNhNzBjZS0yYmY0LWQzNDQtOTM3Mi00ZjdiY2RhNTA5ODY8L3JkZjpsaT4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5i29DLAAACcklEQVRYhb3XTYhNYRzH8c8ZrxvFgmRhNSWJLKRQQ5ISZcFEjQWDskAWEkqTSQmLycZiihULRqIslPeMhLyssBjCwoZCrDCuxTlnHPeec55zjfGrZ3Ge53f/3/v8z/88L1GtVvM/NRreL5sf8s3GGizGDExK+j/hBe7gEh6VBZl87UEMLNFCHEZbwfjUpC3BAdzDftwqCthS0D8Ox9GfwiomfgFuoBfjqwIn4Ap2Iko7oxxjgSJsxXVMDAHHEl0Up2i4Wih+r2PLgN3Ulv4DWKo2HC0CzsXuv49dmPQdmJcH7Maokog1nEY7piWtPemrlZRVCw6lD+lnMR2rArCDScvqfNIG0KV4msvRioF0hitLzHAmB5bVwcRTpEi8cAyldEWJmbjaQgp52rLAOQHz3QrAkGdWFjilQsDhakoWOCZgXlQhYMjTkgW+qR+tK/LVFYAhz5ss8Gb9aF3JdojLvkhdiadMt/n9HfZhS4k5SoK2iqsxLZBF4pl1NP7HBp3NAq/iOWYGoBuS1qyeibetoZSmK8lIqTth/LGW9uHhCMDu41z6kAX+xDYM/kPYYBJzqOjr98PHOBaOU3n/P4Kn2Y68I0ZXvalRlU44T+TURR7wG9qJPleJWjDbz1ibxAoCYYBap0pTabDU0IlXee4iIFxATxjYoJ7kt7kqA8I+cVlXVT/2lhlCwG9Yj48VYB+wDt+HA4TXytdZ4ve2Ce9CwaoAid/JqZLxXlyuEqgqEHbJ2TfxUhPn2WaAX7DZn9/BIDbi60gAiS8oJzPPJ8SVWVnNAmGPuDjeiu+CTSl0Ic3TR2zHD02kMlX0v+/4f5PSYekXCqB9cPeXO3gAAAAASUVORK5CYII=",t.images={markerDefault:[t.markerDefault,t.markerDefault2x,t.markerDefault2x],placeSelectedIcon:[t.placeSelectedIcon,t.placeSelectedIcon,t.placeSelectedIcon],myPosition:[t.myPosition,t.myPosition2x,t.myPosition2x],logoIcon:[t.logoIcon,t.logoIcon,t.logoIcon],rainTexture:[t.rainTexture,t.rainTexture,t.rainTexture],snowTexture:[t.snowTexture,t.snowTexture,t.snowTexture],selectionIcon:[t.selectionIcon,t.selectionIcon2x,t.selectionIcon2x],markerClusterIcon:[t.markerClusterIcon,t.markerClusterIcon,t.markerClusterIcon]},t}();e.Images=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(149),r=n(37),o=n(10),a=n(150),s=n(151),l=n(0),u=n(7),h={" ":6,"!":6,'"':9,"#":15,$:13,"%":19,"&":17,"'":5,"(":7,")":7,"*":13,"+":13,",":5,"-":7,".":6,"/":8,0:13,1:13,2:13,3:13,4:13,5:13,6:13,7:13,8:13,9:13,":":6,";":6,"<":13,"=":13,">":13,"?":10,"@":21,A:15,B:15,C:17,D:17,E:13,F:12,G:17,H:17,I:6,J:6,K:16,L:12,M:21,N:18,O:18,P:16,Q:18,R:18,S:13,T:16,U:17,V:17,W:22,X:16,Y:13,Z:13,"[":7,"\\":8,"]":7,"^":13,_:10,"`":13,a:13,b:14,c:11,d:14,e:13,f:8,g:13,h:14,i:6,j:6,k:12,l:6,m:22,n:14,o:14,p:14,q:14,r:9,s:11,t:8,u:14,v:12,w:18,x:12,y:12,z:11,"{":9,"|":13,"}":9,"~":13,"":6,"":6,"":13,"":13,"":13,"":13,"":13,"":12,"":13,"":19,"":8,"":11,"":13,"":7,"":19,"":12,"":10,"":13,"":8,"":8,"":13,"":14,"":15,"":6,"":5,"":8,"":9,"":11,"":18,"":18,"":18,"":10,"":15,"":15,"":15,"":15,"":15,"":15,"":20,"":15,"":13,"":13,"":16,"":13,"":6,"":6,"":6,"":6,"":17,"":18,"":18,"":18,"":18,"":18,"":18,"":13,"":18,"":17,"":17,"":17,"":17,"":13,"":14,"":14,"":13,"":13,"":13,"":13,"":13,"":13,"":20,"":11,"":13,"":13,"":13,"":13,"":6,"":6,"":6,"":6,"":14,"":14,"":14,"":14,"":14,"":14,"":14,"":13,"":14,"":14,"":14,"":14,"":14,"":12,"":14,"":12,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":11,"":15,"":11,"":15,"":11,"":15,"":11,"":17,"":14,"":17,"":14,"":13,"":13,"":13,"":13,"":13,"":13,"":13,"":13,"":13,"":13,"":17,"":13,"":17,"":13,"":17,"":13,"":17,"":13,"":17,"":14,"":17,"":14,"":6,"":6,"":6,"":6,"":6,"":6,"":6,"":6,"":6,"":6,"":13,"":12,"":6,"":6,"":14,"":12,"":12,"":12,"":6,"":12,"":6,"":12,"":6,"":12,"":7,"":12,"":6,"":18,"":14,"":18,"":14,"":18,"":14,"":16,"":18,"":14,"":18,"":14,"":18,"":14,"":18,"":14,"":22,"":22,"":14,"":9,"":14,"":9,"":14,"":9,"":13,"":11,"":13,"":11,"":13,"":11,"":13,"":11,"":13,"":8,"":13,"":8,"":13,"":8,"":17,"":14,"":17,"":14,"":17,"":14,"":17,"":14,"":17,"":14,"":17,"":14,"":22,"":18,"":13,"":12,"":13,"":13,"":11,"":13,"":11,"":13,"":11,"":7,"":13,"":21,"":14,"":21,"":15,"":6,"":15,"":13,"":20,"":20,"":18,"":14,"":13,"":11,"":13,"":8,"":6,"":4,"":14,"":14,"":14,"":14,"":6,"":13,"":4,"":14,"":13,"":8,"":0,"":0,"":0,"":0,"":0,"":0,"":13,"":13,"":15,"":6,"":14,"":19,"":8,"":19,"":16,"":19,"":8,"":15,"":15,"":12,"":13,"":13,"":13,"":17,"":18,"":6,"":14,"":14,"":21,"":18,"":13,"":18,"":17,"":14,"":13,"":13,"":13,"":19,"":13,"":19,"":18,"":6,"":13,"":14,"":11,"":14,"":8,"":14,"":14,"":15,"":12,"":13,"":11,"":11,"":14,"":14,"":8,"":12,"":12,"":14,"":13,"":11,"":14,"":15,"":14,"":11,"":14,"":11,"":14,"":17,"":13,"":18,"":18,"":8,"":14,"":14,"":14,"":18,"":14,"":13,"":20,"":13,"":13,"":17,"":12,"":15,"":13,"":6,"":6,"":6,"":22,"":22,"":17,"":14,"":18,"":14,"":17,"":15,"":14,"":15,"":12,"":16,"":13,"":20,"":13,"":18,"":18,"":14,"":16,"":21,"":17,"":18,"":17,"":14,"":15,"":13,"":14,"":19,"":13,"":17,"":16,"":24,"":24,"":16,"":20,"":15,"":15,"":25,"":15,"":13,"":14,"":13,"":10,"":13,"":13,"":17,"":11,"":15,"":15,"":12,"":13,"":17,"":15,"":14,"":14,"":14,"":11,"":11,"":12,"":17,"":12,"":15,"":14,"":21,"":21,"":16,"":18,"":14,"":11,"":19,"":13,"":13,"":13,"":14,"":10,"":11,"":11,"":6,"":6,"":6,"":20,"":21,"":14,"":12,"":15,"":12,"":14,"":24,"":19,"":16,"":15,"":22,"":17,"":16,"":13,"":22,"":18,"":17,"":15,"":23,"":20,"":13,"":11,"":19,"":18,"":18,"":14,"":15,"":12,"":15,"":12,"":29,"":25,"":19,"":15,"":23,"":19,"":23,"":19,"":15,"":11,"":14,"":13,"":13,"":13,"":13,"":23,"":22,"":18,"":15,"":14,"":14,"":14,"":14,"":12,"":10,"":12,"":10,"":15,"":12,"":21,"":18,"":13,"":11,"":15,"":13,"":14,"":12,"":14,"":12,"":16,"":14,"":17,"":15,"":19,"":17,"":25,"":20,"":18,"":15,"":15,"":11,"":13,"":11,"":13,"":12,"":13,"":12,"":14,"":13,"":20,"":17,"":16,"":14,"":16,"":14,"":16,"":14,"":20,"":15,"":20,"":15,"":6,"":20,"":17,"":16,"":13,"":16,"":13,"":17,"":14,"":17,"":15,"":16,"":14,"":21,"":17,"":6,"":15,"":13,"":15,"":13,"":20,"":20,"":13,"":13,"":17,"":13,"":17,"":13,"":20,"":17,"":13,"":11,"":14,"":11,"":18,"":15,"":18,"":15,"":18,"":14,"":18,"":14,"":18,"":14,"":15,"":11,"":14,"":12,"":14,"":12,"":14,"":12,"":16,"":14,"":12,"":10,"":20,"":18,"":12,"":10,"":14,"":12,"":13,"":12,"":14,"":14,"":21,"":21,"":21,"":19,"":15,"":12,"":23,"":20,"":24,"":21,"":18,"":15,"":17,"":15,"":14,"":11,"":16,"":13,"":15,"":13,"":21,"":22,"":22,"":18,"":22,"":18,"":22,"":18,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":15,"":13,"":13,"":13,"":13,"":13,"":13,"":13,"":16,"":13,"":16,"":13,"":16,"":13,"":16,"":13,"":16,"":13,"":6,"":6,"":6,"":6,"":18,"":14,"":18,"":14,"":18,"":14,"":18,"":14,"":18,"":14,"":18,"":14,"":18,"":14,"":21,"":16,"":21,"":16,"":21,"":16,"":21,"":16,"":21,"":16,"":17,"":14,"":17,"":14,"":18,"":15,"":21,"":15,"":21,"":15,"":21,"":15,"":21,"":15,"":13,"":12,"":13,"":12,"":13,"":12,"":13,"":12,"":18,"":12,"":24,"":12,"":24,"":8,"":6,"":4,"":13,"":6,"":4,"":2,"":0,"":12,"":24,"":24,"":9,"":4,"":4,"":5,"":4,"":8,"":8,"":9,"":12,"":12,"":9,"":18,"":28,"":5,"":9,"":7,"":7,"":11,"":3,"":8,"":8,"":8,"":8,"":8,"":8,"":8,"":9,"":13,"":13,"":18,"":14,"":14,"":19,"":12,"":24,"":19,"":18,"":18,"":14,"":18,"":18,"":18,"":18,"":13,"":13,"":17,"":15,"":13,"":13,"":16,"":9,"":13,"":13,"":13,"":13,"":14,"":16,"":14,"":14,"":22,"":22,"\ufeff":0,"":24,"":24},c=function(){function t(t){this.gl=t,this._font=new Map,this.init()}return t.getInstance=function(t){var e=t.id;null==this.instances&&(this.instances=new Map);var n=this.instances.get(e);return n||(n=new this(t),this.instances.set(e,n)),n},t.releaseInstance=function(t){var e=t.id;if(null!=this.instances){var n=this.instances.get(e);n&&(n._font.forEach(function(t){return t.destroy()}),n._font.clear(),this.instances.delete(e))}},t.prototype.init=function(){var t=new s.FontSDF(this.gl,l.FontConstant.fontSize,.14,"Arial",300);this._font.set("normal",t);var e=new s.FontSDF(this.gl,l.FontConstant.fontSize,.14,"Arial",600);this._font.set("bold",e)},t.prototype.createCurvedText=function(t,e,n,s){if(null==n||n.length<2)return this.createText(t,e,200,1);var c=this._font.get(e);if(!c)return console.error("Can not find this Font to create text: "+t.text),null;var f=this.gl,p=[],d=t.text,g=t.size,m=c.fontSize,y=g/m,v={x:0,y:0},b=c.tinySDFGenerator.buffer,_=m+2*b,w=m+2*b,M=m/2+b,x=1;n.forEach(function(t){t.x/=s,t.y/=s}),n=i(n);for(var A=new u.Point(n[x].x-n[x-1].x,n[x].y-n[x-1].y),T=0,S=Math.sqrt(Math.pow(A.x,2)+Math.pow(A.y,2)),E=(A.y>=0?1:-1)*Math.acos(A.x/S),C=new u.Point(0,0),L=0;L<d.length;L++){var P=d[L],I=c.metrics[P];if(I){var O=h[P],R=O*y;for(T+=R;T>=S+R/3&&x<n.length-1;)C.x+=Math.cos(E)*S,C.y+=Math.sin(E)*S,v.x=" "==P?C.x:C.x+R/2,v.y=C.y,++x,A=new u.Point(n[x].x-n[x-1].x,n[x].y-n[x-1].y),T=O*y,S=Math.sqrt(Math.pow(A.x,2)+Math.pow(A.y,2)),E=(A.y>=0?1:-1)*Math.acos(A.x/S);var k=I.x,D=I.y;if(_>0&&w>0){var B=new u.Point(v.x+(0-b)*y,v.y-M*y),U=new u.Point(v.x+(0-b)*y,v.y+(w-M)*y),j=new u.Point(v.x+(0-b+_)*y,v.y-M*y),F=new u.Point(v.x+(0-b+_)*y,v.y+(w-M)*y),N=(B.x-C.x)*Math.cos(E)-(B.y-C.y)*Math.sin(E)+C.x,Z=(B.x-C.x)*Math.sin(E)+(B.y-C.y)*Math.cos(E)+C.y,V=(U.x-C.x)*Math.cos(E)-(U.y-C.y)*Math.sin(E)+C.x,z=(U.x-C.x)*Math.sin(E)+(U.y-C.y)*Math.cos(E)+C.y,W=(j.x-C.x)*Math.cos(E)-(j.y-C.y)*Math.sin(E)+C.x,Y=(j.x-C.x)*Math.sin(E)+(j.y-C.y)*Math.cos(E)+C.y,G=(F.x-C.x)*Math.cos(E)-(F.y-C.y)*Math.sin(E)+C.x,H=(F.x-C.x)*Math.sin(E)+(F.y-C.y)*Math.cos(E)+C.y;p.push(N,Z,k,D+w,W,Y,k+_,D+w,V,z,k,D,W,Y,k+_,D+w,V,z,k,D,G,H,k+_,D),v.x+=O*y}}}var X=new r.Model(f),J=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,J),f.bufferData(f.ARRAY_BUFFER,new Float32Array(p),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),X.arrayBuffer=J,X.numOfVertices=p.length/4,X.attributeInfos=[new o.AttributeInfo("a_position",2,0,4),new o.AttributeInfo("a_uv",2,2,4)],X.retain(),new a.TextLabelData(t.text,c,g,_,w,l.MapConstants.none,X)},t.prototype.createText=function(t,e,n,i){var s=this._font.get(e);if(!s)return console.error("Can not find this Font to create text: "+t.text),null;var l=this.gl,u=[],h=t.text,c=t.size,f=this.measureTextLabelLength(t),p=!1,d=!0,g=Math.ceil(f/n);(0==i||i>g)&&(i>0&&(d=!1,p=!0),i=g);var m=n,y=n;1==i&&f<n&&(y=f,d&&(m=f),p=!0);for(var v={x:0-m/2,y:c/2-c*i/2},b="",_=1,w=0;w<h.length;w++){var M=h[w];b+=M;var x=!1;if(" "==M){for(var A="",T=w+1;" "!=h[T]&&T<h.length;)A+=h[T],++T;var S=this.measureTextLength(b+A,c);if(_==i&&m<S&&m-S<3*this.measureTextLength(".",c)&&!p){this.drawGlyph(".",v,s,c,m,u,!1),this.drawGlyph(".",v,s,c,m,u,!1),this.drawGlyph(".",v,s,c,m,u,!1);break}S>m&&(b="",x=!0,++_)}this.drawGlyph(M,v,s,c,m,u,x)}var E=new r.Model(l),C=l.createBuffer();return l.bindBuffer(l.ARRAY_BUFFER,C),l.bufferData(l.ARRAY_BUFFER,new Float32Array(u),l.STATIC_DRAW),l.bindBuffer(l.ARRAY_BUFFER,null),E.arrayBuffer=C,E.numOfVertices=u.length/4,E.attributeInfos=[new o.AttributeInfo("a_position",2,0,4),new o.AttributeInfo("a_uv",2,2,4)],E.retain(),new a.TextLabelData(t.text,s,c,y,_*c,m,E)},t.prototype.drawGlyph=function(t,e,n,i,r,o,a){var s=n.metrics[t];if(s){var l=n.fontSize,u=i/l,c=n.tinySDFGenerator.buffer,f=l+2*c,p=l+2*c,d=l/2+c,g=h[t],m=s.x,y=s.y;if(f>0&&p>0){var v=e.x+(0-c)*u,b=e.x+(0-c+f)*u,_=e.y-d*u,w=e.y+(p-d)*u;o.push(v,_,m,y,b,_,m+f,y,v,w,m,y+p,b,_,m+f,y,v,w,m,y+p,b,w,m+f,y+p)}e.x=e.x+g*u,a&&(e.y+=i,e.x=0-r/2)}},t.prototype.measureTextLabelLength=function(t){for(var e=0,n=t.size,i=t.text,r=n/l.FontConstant.fontSize,o=0;o<i.length;o++){e+=h[i[o]]*r}return e},t.prototype.measureTextLength=function(t,e){for(var n=0,i=e/l.FontConstant.fontSize,r=0;r<t.length;r++){n+=h[t[r]]*i}return n},t.instances=null,t}();e.TextLabelFactory=c},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,a,s,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(o(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(r(n))for(s=Array.prototype.slice.call(arguments,1),a=(u=n.slice()).length,l=0;l<a;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(t,e){var a;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?r(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,r(this._events[t])&&!this._events[t].warned&&(a=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[t].length>a&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){if(!i(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var n,o,a,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(n=this._events[t]).length,o=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(r(n)){for(s=a;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){(e=t.exports=n(96)).Stream=e,e.Readable=e,e.Writable=n(69),e.Duplex=n(29),e.Transform=n(100),e.PassThrough=n(177)},function(t,e,n){"use strict";(function(e,i,r){var o=n(57);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var i=t.entry;t.entry=null;for(;i;){var r=i.callback;e.pendingcb--,r(n),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=v;var s,l=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?i:o.nextTick;v.WritableState=y;var u=n(45);u.inherits=n(28);var h={deprecate:n(176)},c=n(97),f=n(58).Buffer,p=r.Uint8Array||function(){};var d,g=n(98);function m(){}function y(t,e){s=s||n(29),t=t||{};var i=e instanceof s;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,u=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(u||0===u)?u:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,i=n.sync,r=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,i,r){--e.pendingcb,n?(o.nextTick(r,i),o.nextTick(A,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(r(i),t._writableState.errorEmitted=!0,t.emit("error",i),A(t,e))}(t,n,i,e,r);else{var a=M(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),i?l(_,t,n,a,r):_(t,n,a,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function v(t){if(s=s||n(29),!(d.call(v,this)||this instanceof s))return new v(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),c.call(this)}function b(t,e,n,i,r,o,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(r,e.onwrite):t._write(r,o,e.onwrite),e.sync=!1}function _(t,e,n,i){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,i(),A(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var i=e.bufferedRequestCount,r=new Array(i),o=e.corkedRequestsFree;o.entry=n;for(var s=0,l=!0;n;)r[s]=n,n.isBuf||(l=!1),n=n.next,s+=1;r.allBuffers=l,b(t,e,!0,e.length,r,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,h=n.encoding,c=n.callback;if(b(t,e,!1,e.objectMode?1:u.length,u,h,c),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function M(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function x(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),A(t,e)})}function A(t,e){var n=M(e);return n&&(!function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,o.nextTick(x,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}u.inherits(v,c),y.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(y.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!d.call(this,t)||this===v&&(t&&t._writableState instanceof y)}})):d=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,n){var i=this._writableState,r=!1,a=!i.objectMode&&function(t){return f.isBuffer(t)||t instanceof p}(t);return a&&!f.isBuffer(t)&&(t=function(t){return f.from(t)}(t)),"function"==typeof e&&(n=e,e=null),a?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=m),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),o.nextTick(e,n)}(this,n):(a||function(t,e,n,i){var r=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(t.emit("error",a),o.nextTick(i,a),r=!1),r}(this,i,t,n))&&(i.pendingcb++,r=function(t,e,n,i,r,o){if(!n){var a=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=f.from(e,n));return e}(e,i,r);i!==a&&(n=!0,r="buffer",i=a)}var s=e.objectMode?1:i.length;e.length+=s;var l=e.length<e.highWaterMark;l||(e.needDrain=!0);if(e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,s,i,r,o);return l}(this,i,a,t,e,n)),r},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,e,n){e.ending=!0,A(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,i,n)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(16),n(174).setImmediate,n(22))},function(t,e,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function i(t,e){if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0}function r(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var o=n(23),a=Object.prototype.hasOwnProperty,s=Array.prototype.slice,l="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function h(t){return!r(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var c=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(o.isFunction(t)){if(l)return t.name;var e=t.toString().match(f);return e&&e[1]}}function d(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(l||!o.isFunction(t))return o.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function m(t,e,n,i,r){throw new c.AssertionError({message:n,actual:t,expected:e,operator:i,stackStartFunction:r})}function y(t,e){t||m(t,!0,e,"==",c.ok)}function v(t,e,n,a){if(t===e)return!0;if(r(t)&&r(e))return 0===i(t,e);if(o.isDate(t)&&o.isDate(e))return t.getTime()===e.getTime();if(o.isRegExp(t)&&o.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(h(t)&&h(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(r(t)!==r(e))return!1;var l=(a=a||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===a.expected.indexOf(e)||(a.actual.push(t),a.expected.push(e),function(t,e,n,i){if(null===t||void 0===t||null===e||void 0===e)return!1;if(o.isPrimitive(t)||o.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var r=b(t),a=b(e);if(r&&!a||!r&&a)return!1;if(r)return t=s.call(t),e=s.call(e),v(t,e,n);var l,u,h=M(t),c=M(e);if(h.length!==c.length)return!1;for(h.sort(),c.sort(),u=h.length-1;u>=0;u--)if(h[u]!==c[u])return!1;for(u=h.length-1;u>=0;u--)if(l=h[u],!v(t[l],e[l],n,i))return!1;return!0}(t,e,n,a))}return n?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function _(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,i){var r;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(i=n,n=null),r=function(t){var e;try{t()}catch(t){e=t}return e}(e),i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),t&&!r&&m(r,n,"Missing expected exception"+i);var a="string"==typeof i,s=!t&&o.isError(r),l=!t&&r&&!n;if((s&&a&&_(r,n)||l)&&m(r,n,"Got unwanted exception"+i),t&&r&&n&&!_(r,n)||!t&&r)throw r}c.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return d(g(t.actual),128)+" "+t.operator+" "+d(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var i=n.stack,r=p(e),o=i.indexOf("\n"+r);if(o>=0){var a=i.indexOf("\n",o+1);i=i.substring(a+1)}this.stack=i}}},o.inherits(c.AssertionError,Error),c.fail=m,c.ok=y,c.equal=function(t,e,n){t!=e&&m(t,e,n,"==",c.equal)},c.notEqual=function(t,e,n){t==e&&m(t,e,n,"!=",c.notEqual)},c.deepEqual=function(t,e,n){v(t,e,!1)||m(t,e,n,"deepEqual",c.deepEqual)},c.deepStrictEqual=function(t,e,n){v(t,e,!0)||m(t,e,n,"deepStrictEqual",c.deepStrictEqual)},c.notDeepEqual=function(t,e,n){v(t,e,!1)&&m(t,e,n,"notDeepEqual",c.notDeepEqual)},c.notDeepStrictEqual=function t(e,n,i){v(e,n,!0)&&m(e,n,i,"notDeepStrictEqual",t)},c.strictEqual=function(t,e,n){t!==e&&m(t,e,n,"===",c.strictEqual)},c.notStrictEqual=function(t,e,n){t===e&&m(t,e,n,"!==",c.notStrictEqual)},c.throws=function(t,e,n){w(!0,t,e,n)},c.doesNotThrow=function(t,e,n){w(!1,t,e,n)},c.ifError=function(t){if(t)throw t};var M=Object.keys||function(t){var e=[];for(var n in t)a.call(t,n)&&e.push(n);return e}}).call(this,n(22))},function(t,e,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(t,e,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(t,e,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(14),o=n(216),a=function(){function t(){}return t.loadModel=function(t,e){if(void 0===e&&(e=!1),0==t.length)return null;for(var n=t.split("\n").map(function(t){return t.trim().toLowerCase().split(" ").filter(function(t){return""!==t})}),a=[new r.Vector3],s=[new r.Vector3],l=[new i.Vector2],u=[],h=null,c=[],f=-1,p=null,d=Number.MAX_VALUE,g=Number.MAX_VALUE,m=Number.MAX_VALUE,y=Number.MIN_VALUE,v=Number.MIN_VALUE,b=Number.MIN_VALUE,_=0,w=n;_<w.length;_++){var M=w[_],x=M[0];if("v"==x){var A=+M[1]||0,T=+M[2]||0,S=+M[3]||0,E=new r.Vector3(A,T,S);a.push(E),T>f&&(f=T,p=E),d=Math.min(d,A),y=Math.max(y,A),g=Math.min(g,S),v=Math.max(v,S),m=Math.min(m,T),b=Math.max(b,T)}else if("vn"==x){A=+M[1]||0,T=+M[2]||0,S=+M[3]||0;s.push(new r.Vector3(A,T,S))}else if("vt"==x){A=+M[1]||0,T=+M[2]||0;l.push(new i.Vector2(A,T))}else if("f"==x)for(var C=0;C<3;C++){var L=M[C+1].split("/"),P=(E=a[+L[0]||0],l[+L[1]||0]),I=s[+L[2]||0];h||(h=new o.ModelGeometry,u.push(h)),c.push(E.x),c.push(E.y),c.push(E.z),c.push(P.x),c.push(P.y),c.push(I.x),c.push(I.y),c.push(I.z),h.numberOfVertices++}}return u[0].data=e?new Float32Array(c).buffer:c,u[0].highestPosition=p,u[0].minX=d,u[0].minY=g,u[0].minZ=m,u[0].maxX=y,u[0].maxY=v,u[0].maxZ=b,u},t}();e.ObjModelLoader=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Live=0]="Live",t[t.Morning=1]="Morning",t[t.Noon=2]="Noon",t[t.AfterNoon=3]="AfterNoon",t[t.Evening=4]="Evening",t[t.None=5]="None"}(e.TimeEffect||(e.TimeEffect={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4);!function(t){var e=function(){function t(t){if(null==t)throw new Error("Parameter coordinate can not be null");this._coordinate=i.LatLng.convert(t)}return t.prototype.get=function(){return this._coordinate},t.prototype.forEachLatLng=function(t){this._coordinate&&t(this._coordinate)},t.prototype.getType=function(){return"Point"},t}();t.Point=e;var n=function(){function t(t){if(null==t)throw new Error("Parameter coordinates can not be null");this._coordinates=t.map(function(t){return i.LatLng.convert(t)})}return t.prototype.forEachLatLng=function(t){this._coordinates&&this._coordinates.forEach(function(e){return t(e)})},t.prototype.getType=function(){return"MultiPoint"},t.prototype.getArray=function(){return this._coordinates},t.prototype.getAt=function(t){return this._coordinates[t]},t.prototype.getLength=function(){return this._coordinates.length},t}();t.MultiPoint=n;var r=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t.map(function(t){return i.LatLng.convert(t)})}return t.prototype.forEachLatLng=function(t){this._elements&&this._elements.forEach(function(e){return t(e)})},t.prototype.getType=function(){return"LineString"},t}();t.LineString=r;var o=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t.map(function(t){return i.LatLng.convert(t)})}return Object.defineProperty(t.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),t}();t.LinearRing=o;var a=function(){function t(t){if(null==t)throw new Error("Parameter element can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach(function(e){e.elements.forEach(function(e){return t(e)})})},t.prototype.getArray=function(){return this._elements},t.prototype.getAt=function(t){return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"Polygon"},t}();t.Polygon=a;var s=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach(function(e){return e.forEachLatLng(t)})},t.prototype.getAt=function(t){if(t<0||t>=this._elements.length)throw new Error("Index out of size");return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"MultiPolygon"},t}();t.MultiPolygon=s;var l=function(){function t(t){if(null==t)throw new Error("Parameter elements can not be null");this._elements=t}return t.prototype.forEachLatLng=function(t){this._elements.forEach(function(e){return e.forEachLatLng(t)})},t.prototype.getAt=function(t){if(t<0||t>=this._elements.length)throw new Error("Index out of size");return this._elements[t]},t.prototype.getLength=function(){return this._elements.length},t.prototype.getType=function(){return"MultiLineString"},t}();t.MultiLineString=l;var u=function(){function t(t,e,n){this._id=t,this._geometry=e,this._properties=n}return t.prototype.getId=function(){return this._id},t.prototype.getGeometry=function(){return this._geometry},t.prototype.getProperties=function(){return this._properties},t}();t.Feature=u}(e.Data||(e.Data={}));var r=function(){function t(t){this._mapView=t}return t.prototype.addGeoJson=function(t){return this._mapView.getGeoJsonManager().addGeoJson(t)},t.prototype.add=function(t){return this._mapView.getGeoJsonManager().addFeature(t)},t.prototype.remove=function(t){return this._mapView.getGeoJsonManager().removeFeature(t)},t.prototype.clear=function(){return this._mapView.getGeoJsonManager().removeAllFeatures()},t.prototype.addListener=function(t,e){return this._mapView.addGeoJsonListener(t,e)},t.prototype.setMinZoom=function(t){if(null==t)throw Error("Parameter can not be null");this._mapView.setDataLayerMinZoom(t)},t.prototype.setMaxZoom=function(t){if(null==t)throw Error("Parameter can not be null");this._mapView.setDataLayerMaxZoom(t)},t.prototype.getMinZoom=function(){return this._mapView.getDataLayerMinZoom()},t.prototype.getMaxZoom=function(){return this._mapView.getDataLayerMaxZoom()},t}();e.MapData=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(17);e.CameraPosition=i.CameraPosition;var r=n(50);e.Circle=r.Circle;var o=n(51);e.Icon=o.Icon;var a=n(4);e.LatLng=a.LatLng;var s=n(20);e.LatLngBounds=s.LatLngBounds;var l=n(121);e.Map=l.Map4D;var u=n(39);e.MapEvent=u.MapEvent;var h=n(40);e.MapObject=h.MapObject;var c=n(267);e.MapObjectData=c.MapObjectData;var f=n(268);e.MapsEventListener=f.MapsEventListener;var p=n(32);e.Marker=p.Marker;var d=n(269);e.MarkerClusterer=d.MarkerClusterer;var g=n(27);e.MarkerLabel=g.MarkerLabel;var m=n(7);e.Point=m.Point;var y=n(52);e.Polygon=y.Polygon;var v=n(33);e.Polyline=v.Polyline;var b=n(270);e.Projection=b.Projection;var _=n(49);e.SwitchMode=_.SwitchMode;var w=n(271);e.TileArea=w.TileArea;var M=n(75);e.TimeEffect=M.TimeEffect;var x=n(119);e.Weather=x.Weather;var A=n(76);e.Data=A.Data,e.MapData=A.MapData;var T=n(272);e.Measure=T.Measure;var S=n(274);e.CoordinateTransformer=S.CoordinateTransformer;var E=n(116);e.Place=E.Place;var C=n(275);e.AnimationOptions=C.AnimationOptions;var L=n(276);e.CircleOptions=L.CircleOptions;var P=n(59);e.ControlOptions=P.ControlOptions;var I=n(277);e.EventOptions=I.EventOptions;var O=n(278);e.MapObjectOptions=O.MapObjectOptions;var R=n(279);e.MapOptions=R.MapOptions;var k=n(280);e.MarkerClusterOptions=k.MarkerClusterOptions;var D=n(281);e.MarkerLabelOptions=D.MarkerLabelOptions;var B=n(282);e.MarkerOptions=B.MarkerOptions;var U=n(283);e.PaddingOptions=U.PaddingOptions;var j=n(284);e.PolygonOptions=j.PolygonOptions;var F=n(285);e.PolylineOptions=F.PolylineOptions;var N=n(286);e.TileAreaOptions=N.TileAreaOptions;var Z=n(287);e.PlaceOptions=Z.PlaceOptions},function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}t.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.x+n*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=r,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4),o=n(126),a=n(6),s=n(8),l=n(12),u=n(0),h=n(127),c=n(7),f=n(1),p=function(){return function(){}}();e.CameraAnimationOptions=p;var d=function(){return function(){this.anchor=null,this.target=null,this.zoom=null,this.tilt=null,this.bearing=null}}();function g(t,e,n,i){var r=new o.UnitBezier(t,e,n,i);return function(t){return r.solve(t,u.MathConstants.epsilon)}}e.CameraOptions=d,e.bezier=g,e.defaultEasing=g(0,0,.25,1);var m=function(){function t(t,e,n){this.onUpdateTransitions=null,this.mapState=t,this.cameraAnimationObserver=e,this.mapSettings=n,this.flingTracker=new h.FlingTracker(u.MapConstants.flingTimeConstant,e)}return t.prototype.moveBy=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=new d,o=this.mapState.getTarget(),s=a.ProjectionMercator.getMetersPerPixelAtLatitude(u.MapConstants.metersPerPixelAtLatitude,this.mapState.getZoom()),l=new i.Vector2(t.x,t.y).multiply(s);l=l.rotateBy(-this.mapState.cameraPosition.getBearing()),r.target=a.ProjectionMercator.convertToLatLngFromMeter(a.ProjectionMercator.convertToMeterFromLatLng(o).add(l)),null==e?e=new p:null==e.duration&&(e.duration=f.MapUtils.getTimePanTo(this.mapState.getTarget(),r.target,this.mapState.getZoom())),e.gesture=n,this.mapState.gesture=n,this.mapState.movingTo=!0,this.easeTo(r,e)},t.prototype.moveTo=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1),null==e&&(e=new p),e.gesture=n,this.mapState.gesture=n,t.zoom<u.MapConstants.defaultMinZoom3d&&this.mapState.enable3dMode(!1),this.mapState.movingTo=!0,this.easeTo(t,e)},t.prototype.zoom=function(t,e,n){this.mapState.startedZoom=!0,this.flingTracker.stopFling(),n.duration||(n.duration=u.MapConstants.defaultAnimationDuration);var i=new d;i.zoom=t,i.anchor=e,this.easeTo(i,n)},t.prototype.isAnimated=function(){return this.mapState.panning||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.flyingTo},t.prototype.moveByVelocity=function(t){this.flingTracker.startFling(t.x,t.y)},t.prototype.setTilt=function(t,e){void 0===e&&(e=!1);var n=new d,i=new p;i.gesture=e,this.mapState.gesture=e,t=l.MathUtils.clamp(t,this.mapSettings.getMinTilt(),this.mapSettings.getMaxTilt()),n.tilt=t,this.mapState.tilting=!0,this.easeTo(n,i)},t.prototype.setBearing=function(t,e,n){void 0===n&&(n=!1);var i=new d,r=new p;r.gesture=n,this.mapState.gesture=n,i.bearing=t,e&&e>0&&(r.duration=1e3*e),this.mapState.bearing=!0,this.easeTo(i,r)},t.prototype.easeTo=function(t,e){var n=this,i=this.mapState.getZoom(),o=null!=t.zoom?t.zoom:this.mapState.getZoom(),l=this.mapState.getBearing(),h=this.mapState.getTilt(),c=this.mapState.getTarget(),f=t.bearing,p=t.tilt,d=null!=t.target?t.target:this.mapState.getTarget(),g=t.anchor,m=new r.LatLng(0,0);g&&((m=s.GeometryUtils.screenCoordinateToLatLng(g,this.mapState.cameraPosition,this.mapState.getScreenSize())).valid()||(m=this.mapState.getCamera().getTarget())),this.mapState.zoomIn=o>i&&o-i>u.MathConstants.epsilon,this.mapState.zoomOut=i>o&&i-o>u.MathConstants.epsilon,this.mapState.panning=c!=d;this.startTransition(e,function(t){var e=i*(1-t)+o*t;if(null!=f){var u=(l+(f-l)*t)%360;n.mapState.setBearing(u)}if(null!=p){var y=h+(p-h)*t;n.mapState.setTilt(y)}var v=c.lat*(1-t)+d.lat*t,b=c.lng*(1-t)+d.lng*t,_=new r.LatLng(v,b);if(n.mapState.setZoom(e),n.mapState.setTarget(_),g){var w=Math.pow(2,e),M=a.ProjectionMercator.projectScale(n.mapState.getTarget(),w),x=a.ProjectionMercator.projectScale(m,w),A=s.GeometryUtils.screenCoordinateToLatLng(g,n.mapState.cameraPosition,n.mapState.getScreenSize());A.valid()||(A=n.mapState.getTarget());var T=a.ProjectionMercator.projectScale(A,Math.pow(2,e));n.mapState.setTarget(a.ProjectionMercator.unproject(M.add(x).subtract(T),w))}})},t.prototype.startTransition=function(t,n){var i=this,r=t.duration?t.duration:0,o=t.easing?t.easing:e.defaultEasing,a=0!=r;this.transitionStart=Date.now(),this.transitionDuration=r,this.mapState.isWillChange()||(this.mapState.willChange=!0,this.cameraAnimationObserver.notifyCameraWillChange(t.gesture)),this.onUpdateTransitions=function(e){var r=a?(e-i.transitionStart)/i.transitionDuration:1;return n(r>=1?1:o(r)),i.cameraAnimationObserver.notifyCameraIsChanging(),!(r<1)&&((i.mapState.isZoomIn()||i.mapState.isZoomOut()||(i.mapState.isMoving()||i.mapState.isBearing()||i.mapState.isTilting())&&!i.mapState.isGesture()||i.mapState.isFlyingTo()||i.mapState.isBearing()&&null!=t.duration)&&i.cameraAnimationObserver.notifyCameraDidChange(),!0)},a||(this.updateTransitions(),this.onUpdateTransitions=null)},t.prototype.stopAnimation=function(){this.mapState.isBearing()&&(this.mapState.bearing=!1,this.onUpdateTransitions=null,this.mapState.isWillChange()&&this.cameraAnimationObserver.notifyCameraDidChange()),this.mapState.gesture=!1},t.prototype.updateTransitions=function(){if(null!=this.onUpdateTransitions){var t=Date.now(),e=this.onUpdateTransitions;this.onUpdateTransitions=null,e&&e(t)?(this.mapState.zoomIn=!1,this.mapState.zoomOut=!1,this.mapState.panning=!1,this.mapState.flyingTo=!1,this.mapState.movingTo=!1,this.mapState.bearing=!1,this.mapState.tilting=!1,e=null,this.onUpdateTransitions=null):null==this.onUpdateTransitions&&(this.onUpdateTransitions=e)}else this.flingTracker.isFlingInProgress()&&this.flingTracker.trackMovement()&&this.moveBy(new c.Point(this.flingTracker.dx,this.flingTracker.dy),null,!0)},t.prototype.flyTo=function(t,e){var n=this;if(this.flingTracker.stopFling(),!this.isAnimated()){var r=this.mapState.getZoom(),o=t.target,s=r;null!=t.zoom&&(s=l.MathUtils.clamp(+t.zoom,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()));var h=this.mapState.getTarget(),c=a.ProjectionMercator.projectScale(h,this.mapState.getScale()),f=a.ProjectionMercator.projectScale(o,this.mapState.getScale()),p=Math.max(this.mapState.getScreenSize().x,this.mapState.getScreenSize().y),d=p/Math.pow(2,s-r),g=Math.hypot(f.x-c.x,f.y-c.y),m=1.42;if(null!=e.minZoom){var y=l.MathUtils.clamp(Math.min(e.minZoom,r,s),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),v=p/Math.pow(2,y-r);m=Math.sqrt(v/g*2)}var b=m*m,_=function(t){var e=(d*d-p*p+(t?-1:1)*b*b*g*g)/(2*(t?d:p)*b*g);return Math.log(Math.sqrt(e*e+1)-e)},w=_(0),M=function(t){return R(w)/R(w+m*t)},x=function(t){return p*(R(w)*function(t){return O(t)/R(t)}(w+m*t)-O(w))/b/g},A=(_(1)-w)/m;if(Math.abs(g)<u.MathConstants.epsilon||!isFinite(A)){if(Math.abs(p-d)<u.MathConstants.epsilon)return this.easeTo(t,e);var T=d<p?-1:1;A=Math.abs(Math.log(d/p))/m,x=function(){return 0},M=function(t){return Math.exp(T*m*t)}}if(null!=e.duration)e.duration=+e.duration;else{var S=null!=e.velocity?+e.velocity/m:1.2;e.duration=1e3*A/S}e.duration>u.MapConstants.maxDurationFlyTo&&(e.duration=u.MapConstants.maxDurationFlyTo);var E=this.mapState.getScale(),C=this.mapState.getBearing(),L=this.mapState.getTilt(),P=t.bearing,I=t.tilt;this.mapState.flyingTo=!0,s<u.MapConstants.defaultMinZoom3d&&this.mapState.enable3dMode(!1),this.startTransition(e,function(t){var e=function(t){var e=t*A,o=1===t?1:x(e),h=new i.Vector2(c.x*(1-o)+f.x*o,c.y*(1-o)+f.y*o),p=1/M(e),d=1===t?s:r+Math.log(p)/Math.LN2;return d=l.MathUtils.clamp(d,n.mapSettings.getPreferMinZoom(),n.mapSettings.getMaxZoom()),Math.abs(t-1)<u.MathConstants.epsilon&&(d=s),d!=d&&(d=s),{target:a.ProjectionMercator.unproject(h,E),zoom:d}}(t);if(n.mapState.setZoom(e.zoom),n.mapState.setTarget(e.target),null!=P){var o=(C+(P-C)*t)%360;n.mapState.setBearing(o)}if(null!=I){var h=L+(I-L)*t;n.mapState.setTilt(h)}})}function O(t){return(Math.exp(t)-Math.exp(-t))/2}function R(t){return(Math.exp(t)+Math.exp(-t))/2}},t}();e.CameraAnimation=m},function(t,e,n){"use strict";var i=n(130);function r(t){return{type:"Feature",geometry:i.tileToGeoJSON(t),properties:{}}}function o(t,e){var n,r,o=t.coordinates,s=e.max_zoom,c={},f=[];if("Point"===t.type)return[i.pointToTile(o[0],o[1],s)];if("MultiPoint"===t.type)for(n=0;n<o.length;n++)c[h((r=i.pointToTile(o[n][0],o[n][1],s))[0],r[1],r[2])]=!0;else if("LineString"===t.type)l(c,o,s);else if("MultiLineString"===t.type)for(n=0;n<o.length;n++)l(c,o[n],s);else if("Polygon"===t.type)a(c,f,o,s);else{if("MultiPolygon"!==t.type)throw new Error("Geometry type not implemented");for(n=0;n<o.length;n++)a(c,f,o[n],s)}if(e.min_zoom!==s){var p=f.length;for(u(c,f),n=0;n<p;n++){var d=f[n];c[h(d[0],d[1],d[2])]=!0}return function(t,e,n){for(var i=[],r=n.max_zoom;r>n.min_zoom;r--){for(var o={},a=[],s=0;s<e.length;s++){var l=e[s];if(l[0]%2==0&&l[1]%2==0){var u=h(l[0]+1,l[1],r),c=h(l[0],l[1]+1,r),f=h(l[0]+1,l[1]+1,r);if(t[u]&&t[c]&&t[f]){t[h(l[0],l[1],l[2])]=!1,t[u]=!1,t[c]=!1,t[f]=!1;var p=[l[0]/2,l[1]/2,r-1];r-1===n.min_zoom?i.push(p):(o[h(l[0]/2,l[1]/2,r-1)]=!0,a.push(p))}}}for(s=0;s<e.length;s++)l=e[s],t[h(l[0],l[1],l[2])]&&i.push(l);t=o,e=a}return i}(c,f,e)}return u(c,f),f}function a(t,e,n,i){for(var r=[],o=0;o<n.length;o++){var a=[];l(t,n[o],i,a);for(var u=0,c=a.length,f=c-1;u<c;f=u++){var p=(u+1)%c,d=a[u][1];(d>a[f][1]||d>a[p][1])&&(d<a[f][1]||d<a[p][1])&&d!==a[p][1]&&r.push(a[u])}}for(r.sort(s),o=0;o<r.length;o+=2){d=r[o][1];for(var g=r[o][0]+1;g<r[o+1][0];g++){t[h(g,d,i)]||e.push([g,d,i])}}}function s(t,e){return t[1]-e[1]||t[0]-e[0]}function l(t,e,n,r){for(var o,a,s=0;s<e.length-1;s++){var l=i.pointToTileFraction(e[s][0],e[s][1],n),u=i.pointToTileFraction(e[s+1][0],e[s+1][1],n),c=l[0],f=l[1],p=u[0]-c,d=u[1]-f;if(0!==d||0!==p){var g=p>0?1:-1,m=d>0?1:-1,y=Math.floor(c),v=Math.floor(f),b=0===p?1/0:Math.abs(((p>0?1:0)+y-c)/p),_=0===d?1/0:Math.abs(((d>0?1:0)+v-f)/d),w=Math.abs(g/p),M=Math.abs(m/d);for(y===o&&v===a||(t[h(y,v,n)]=!0,r&&v!==a&&r.push([y,v]),o=y,a=v);b<1||_<1;)b<_?(b+=w,y+=g):(_+=M,v+=m),t[h(y,v,n)]=!0,r&&v!==a&&r.push([y,v]),o=y,a=v}}r&&v===r[0][1]&&r.pop()}function u(t,e){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(c(+n[i]))}function h(t,e,n){return 32*(2*(1<<n)*e+t)+n}function c(t){var e=t%32,n=2*(1<<e),i=(t-e)/32,r=i%n;return[r,(i-r)/n%n,e]}e.geojson=function(t,e){return{type:"FeatureCollection",features:o(t,e).map(r)}},e.tiles=o,e.indexes=function(t,e){return o(t,e).map(i.tileToQuadkey)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(82),r=n(14),o=function(){function t(){}return t.extrudePolygon=function(e,n){if(!(0==e.length||e[0].length<=2)){var o=[],a=[];t.convertToClockwise(e[0]);var s=[];e[0].forEach(function(t){s.push(t.x),s.push(t.y)});var l=i.default(s),u=e[0],h=u.length,c=h;l.length;6*(c-0)*1,2*(2*(c-0));for(var f=0,p=0;p<u.length;++p)o.push([u[p].x,n,u[p].y,0,0,0,0,0]);for(p=0;p<l.length;++p)a.push(f+l[p]);var d=c-0,g=2*d;f=o.length;for(var m=0;m<2;++m){var y=0==m?n:0;for(p=0;p<d;++p)for(var v=0;v<2;++v){var b=(p+v)%d+0;o.push([u[b].x,y,u[b].y,0,0,0,0,0])}}for(p=0;p<d;++p)for(var _=0;_<6;++_){v=(t.quadToTriangle[_][0]+2*p)%g;var w=t.quadToTriangle[_][1]+1;a.push((w-1)*g+v+f)}for(var M=0;M<a.length;){var x=a[M++],A=a[M++],T=a[M++],S=new r.Vector3(o[x][0],o[x][1],o[x][2]),E=new r.Vector3(o[A][0],o[A][1],o[A][2]),C=new r.Vector3(o[T][0],o[T][1],o[T][2]),L=E.subtract(S);w=C.subtract(E).cross(L);o[x][5]=o[x][5]+w.x,o[x][6]=o[x][6]+w.y,o[x][7]=o[x][7]+w.z,o[A][5]=o[A][5]+w.x,o[A][6]=o[A][6]+w.y,o[A][7]=o[A][7]+w.z,o[T][5]=o[T][5]+w.x,o[T][6]=o[T][6]+w.y,o[T][7]=o[T][7]+w.z}for(p=0;p<o.length;++p){var P=new r.Vector3(o[p][5],o[p][6],o[p][7]);P=P.normalize(),o[p][5]=P.x,o[p][6]=P.y,o[p][7]=P.z}return{vertices:o,indices:a}}},t.convertToClockwise=function(e){t.calculatePolygonArea(e)>0&&t.reversePoints(e)},t.calculatePolygonArea=function(t){var e=t.length;if(!(e<3)){for(var n=0,i=0,r=e-1;i<e;){var o=t[r].x,a=t[r].y,s=t[i].x,l=t[i].y;r=i,i+=1,n+=o*l-s*a}return n}},t.reversePoints=function(t){for(var e=t.length,n=e/2,i=0;i<n;++i){var r=t[i];t[i]=t[e-i-1],t[e-i-1]=r}},t.quadToTriangle=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]],t}();e.BuildingExtrudeUtils=o},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,s,l,u,h,p,d,m=e&&e.length,y=m?e[0]*n:t.length,v=r(t,0,y,n,!0),b=[];if(!v||v.next===v.prev)return b;if(m&&(v=function(t,e,n,i){var a,s,l,u,h,p=[];for(a=0,s=e.length;a<s;a++)l=e[a]*i,u=a<s-1?e[a+1]*i:t.length,(h=r(t,l,u,i,!1))===h.next&&(h.steiner=!0),p.push(g(h));for(p.sort(c),a=0;a<p.length;a++)f(p[a],n),n=o(n,n.next);return n}(t,e,v,n)),t.length>80*n){i=l=t[0],s=u=t[1];for(var _=n;_<y;_+=n)h=t[_],p=t[_+1],h<i&&(i=h),p<s&&(s=p),h>l&&(l=h),p>u&&(u=p);d=0!==(d=Math.max(l-i,u-s))?1/d:0}return a(v,b,n,i,s,d),b}function r(t,e,n,i,r){var o,a;if(r===C(t,e,n,i)>0)for(o=e;o<n;o+=i)a=T(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=T(o,t[o],t[o+1],a);return a&&b(a,a.next)&&(S(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!b(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function a(t,e,n,i,r,c,f){if(t){!f&&c&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,l,u=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(a>1)}(r)}(t,i,r,c);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,c?l(t,i,r,c):s(t))e.push(p.i/n),e.push(t.i/n),e.push(g.i/n),S(t),t=g.next,m=g.next;else if((t=g)===m){f?1===f?a(t=u(o(t),e,n),e,n,i,r,c,2):2===f&&h(t,e,n,i,r,c):a(o(t),e,n,i,r,c,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(v(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(m(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&v(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(t,e,n,i){var r=t.prev,o=t,a=t.next;if(v(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,l=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,u=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,c=d(s,l,e,n,i),f=d(u,h,e,n,i),p=t.prevZ,g=t.nextZ;p&&p.z>=c&&g&&g.z<=f;){if(p!==t.prev&&p!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,g!==t.prev&&g!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;p&&p.z>=c;){if(p!==t.prev&&p!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=f;){if(g!==t.prev&&g!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function u(t,e,n){var i=t;do{var r=i.prev,a=i.next.next;!b(r,a)&&_(r,i,i.next,a)&&x(r,a)&&x(a,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(a.i/n),S(i),S(i.next),i=t=a),i=i.next}while(i!==t);return o(i)}function h(t,e,n,i,r,s){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&y(l,u)){var h=A(l,u);return l=o(l,l.next),h=o(h,h.next),a(l,e,n,i,r,s),void a(h,e,n,i,r,s)}u=u.next}l=l.next}while(l!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n;var l,u=n,h=n.x,c=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=h&&r!==i.x&&m(o<c?r:a,o,h,c,o<c?a:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),x(i,t)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&p(n,i)))&&(n=i,f=l)),i=i.next}while(i!==u);return n}(t,e)){var n=A(e,t);o(e,e.next),o(n,n.next)}}function p(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function m(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,i){var r=M(v(t,e,n)),o=M(v(t,e,i)),a=M(v(n,i,t)),s=M(v(n,i,e));return r!==o&&a!==s||(!(0!==r||!w(t,n,e))||(!(0!==o||!w(t,i,e))||(!(0!==a||!w(n,t,i))||!(0!==s||!w(n,e,i)))))}function w(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function M(t){return t>0?1:t<0?-1:0}function x(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function A(t,e){var n=new E(t.i,t.x,t.y),i=new E(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function T(t,e,n,i){var r=new E(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(C(t,0,o,n));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,h=s<l-1?e[s+1]*n:t.length;a-=Math.abs(C(t,u,h,n))}var c=0;for(s=0;s<i.length;s+=3){var f=i[s]*n,p=i[s+1]*n,d=i[s+2]*n;c+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.generate=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)+this.count++},t.count=0,t}();e.UUID=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.setModel=function(t){this.model=t},e.prototype.setTexture=function(t){this.texture=t},e.prototype.getModel=function(){return this.model},e.prototype.getTexture=function(){return this.texture},e.prototype.hasTexture=function(){return null!=this.texture},e.prototype.getModelMatrix=function(){return this.modelMatrix},e.prototype.getMvpMatrix=function(){return this.mvpMatrix},e}(n(63).ResourceReference);e.Object3D=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(18),o=n(36),a=n(139),s=function(t){function e(e,n){var i=t.call(this,r.Kind.RASTER,e,n)||this;return i.buildings=[],i.places=[],i.initialized=!1,i}return i(e,t),e.prototype.init=function(t,e){var n=this;if(t){var i=new o.Texture(this.gl);i.loadImageFromArrayBuffer(t.data.data,t.data.width,t.data.height,!1,function(){n.rasterLoaded=!0,e()}),this.rasterLayerData=new a.RasterLayerData(i),this.initialized=!0}else e()},e.prototype.isInitialized=function(){return this.initialized},e.prototype.addPlaces=function(t){this.places=t},e.prototype.getPlaces=function(){return this.places},e.prototype.getTexture=function(){return this.rasterLayerData?this.rasterLayerData.texture:null},e.prototype.addBuildings=function(t){this.buildings=t},e.prototype.getBuildings=function(){return this.buildings},e.prototype.setVectorTile=function(t){this.vectorTile=t},e.prototype.getVectorTile=function(){return this.vectorTile},e.prototype.destroy=function(){this.rasterLayerData&&this.rasterLayerData.destroy()},e}(r.Tile);e.RasterTile=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(87),o=n(18),a=function(t){function e(e,n){return t.call(this,o.Kind.VECTOR,e,n)||this}return i(e,t),e.prototype.destroy=function(){this.layerDatas.forEach(function(t){return t.destroy()})},e}(r.GeometryTile);e.VectorTile=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(18),o=n(5),a=n(88),s=n(142),l=n(42),u=n(155),h=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r.gl=i,r.layerDatas=new Map,r.tileData=null,r}return i(e,t),e.prototype.getTexture=function(){return null},e.prototype.init=function(t,e){},e.prototype.setData=function(t){var e=this;this.tileData=t,null!=t&&t.getLayerIds().forEach(function(t){t.startsWith(l.AnnotationManager.pointLayerId)&&e.removeLayerData(t)})},e.prototype.hasData=function(t){return null!=this.tileData&&null!=this.tileData.getLayer(t)},e.prototype.removeLayerData=function(t){var e=this.layerDatas.get(t);e&&(e.destroy(),this.layerDatas.delete(t))},e.prototype.getLayerData=function(t,e,n){if(void 0===n&&(n=null),!this.layerDatas.has(t)){var i=this.tileData.getLayer(t);if(null==i)return console.error("getLayerData not reachable"),null;switch(e){case o.LayerType.LINE:var r=new a.LineLayerData(i,this.gl,n);return this.layerDatas.set(t,r),this.layerDatas.get(t);case o.LayerType.FILL:var l=new s.FillLayerData(i,this.gl);return this.layerDatas.set(t,l),this.layerDatas.get(t);case o.LayerType.GEOJSON:var h=new u.GeoJsonLayerData(i,this.gl);return this.layerDatas.set(t,h),this.layerDatas.get(t);default:return console.error("getLayerData not reachable"),null}}return this.layerDatas.get(t)},e.prototype.getTileData=function(){return this.tileData},e}(r.Tile);e.GeometryTile=h},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(53),o=n(37),a=n(15),s=n(5),l=n(54),u=n(1),h=n(2),c=n(10),f=n(9),p=n(64),d=n(26),g=function(t){function e(e,n,i){void 0===i&&(i=null);var r=t.call(this,s.LayerType.LINE)||this;return r.gl=n,r.linePartials=[],r.lineLayerProperties=[],r.buildPolyline(e,i),r.initializeProperties(e),r}return i(e,t),e.prototype.getLinePartials=function(){return this.linePartials},e.prototype.getModel=function(){return this.lineModel},e.prototype.getLineLayerDataProperties=function(){return this.lineLayerProperties},e.prototype.initializeProperties=function(t){if(t instanceof d.VectorTileLayer)for(var n=t.featureCount(),i=0;i<n;++i){var r=t.getFeature(i).getProperties();if(r){var o=r.get("stroke")||"#000000",a=r.has("stroke-opacity")?r.get("stroke-opacity"):1,s=f.Color.fromHex(o);s.alpha=a;var l=r.has("stroke-width")?r.get("stroke-width"):e.defaultStrokeWidth;l*=u.MapUtils.pixelScale,this.lineLayerProperties.push({strokeColor:s,strokeWidth:l})}else this.lineLayerProperties.push({strokeColor:e.defaultStrokeColor,strokeWidth:e.defaultStrokeWidth*u.MapUtils.pixelScale})}},e.prototype.buildPolyline=function(t,e){void 0===e&&(e=null);var n=[],i=new l.PolylineBuilderContext;i.addVertex=function(t,e,i){n.push(t.x,t.y,e.x,e.y,i.x,i.y)},i.lineCapType=l.LineCapType.Butt,i.lineJoinType=l.LineJoinType.Round;for(var r=u.MapUtils.getTileSize(),s=t.featureCount(),f=0;f<s;++f){var d=t.getFeature(f);if(d.getType()!=a.GeometryType.LineString)return void console.warn("Invalid geometry type: "+d.getType());for(var g=d.getGeometries().geometryCoordinates,m=i.indices.length,y=0;y<g.length;++y){for(var v=[],b=0;b<g[y].length;++b){var _=new h.Vector2(g[y][b][0],g[y][b][1]);_.x=_.x*r,_.y=_.y*r,v.push(_)}i.buildPolyLine(v,null,e)}var w=i.indices.length-m;this.linePartials.push(new p.Range(m,w))}this.lineModel=new o.Model(this.gl),this.lineModel.init(n,[new c.AttributeInfo("a_position",2,0,6),new c.AttributeInfo("a_extrude",2,2,6),new c.AttributeInfo("a_uv",2,4,6)],i.indices)},e.prototype.destroy=function(){this.lineModel&&this.lineModel.destroy()},e.defaultStrokeWidth=5,e.defaultStrokeColor=f.Color.fromHex("#000000"),e}(r.LayerData);e.LineLayerData=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(78),r=function(){function t(t,e){this._min=new i(t.x,t.y),this._max=new i(e.x,e.y)}return Object.defineProperty(t.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),t}();e.Box=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(120),r=n(0),o=n(91),a=n(42),s=function(){function t(t){this.id=t,this.layerId=a.AnnotationManager.annotationLayerId+t.toString()}return t.prototype.reloadLayout=function(){this.geoJsonIndexer=null},t.prototype.updateTileData=function(t,e,n){var a=this;if(!this.geoJsonIndexer){var s={maxZoom:n,buffer:0,extent:r.MapConstants.tileExtend,tolerance:4};this.geoJsonIndexer=i.default(this.getFeatures(),s)}var l=this.geoJsonIndexer.getTile(t.getZoom(),t.getX(),t.getY());if(null!=l&&0!==l.features.length){var u=e.addLayer(this.layerId);l.features.forEach(function(t){var e=t.type,n=new o.GeometryCollection(t.geometry);u.addFeature(a.id,e,n)})}},t.prototype.getLayerId=function(){return this.layerId},t.prototype.clearIndex=function(){this.geoJsonIndexer=null},t}();e.ShapeAnnotationData=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(){return function(t){this.geometryCoordinates=[],this.geometryCoordinates=t}}();e.GeometryCoordinates=o;var a=function(t){function e(e){var n=t.call(this,e)||this;return n.normalizeGeometryCoordinates(),n}return i(e,t),e.prototype.normalizeGeometryCoordinates=function(){for(var t=[],e=0;e<this.geometryCoordinates.length;++e){for(var n=[],i=0;i<this.geometryCoordinates[e].length;++i)n.push([this.geometryCoordinates[e][i][0]/r.MapConstants.tileExtend-.5,.5-this.geometryCoordinates[e][i][1]/r.MapConstants.tileExtend]);t.push(n)}this.geometryCoordinates=t},e}(o);e.GeometryCollection=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){this._text=t,this._size=e}return Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"text: "+this._text+" size: "+this._size},t}();e.TextLabel=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(7),o=n(8),a=n(0),s=function(){function t(t,e){this.content=t,this.windowAnchor=e}return t.prototype.getContent=function(){return this.content},t.prototype.getPosition=function(t,e,n,s,l,u){if(null==this.content)return null;e=u.is3dMode()?e:0;var h=o.GeometryUtils.latLngToScreenCoordinate(t,e,u.cameraPosition,u.getScreenSize());h.x/=i.MapUtils.pixelScale,h.y/=i.MapUtils.pixelScale,h.x-=this.content.offsetWidth/2,h.y-=this.content.offsetHeight;var c=n/i.MapUtils.pixelScale,f=s/i.MapUtils.pixelScale,p=this.windowAnchor||new r.Point(.5,.5);return h.x+=(.5-l.x)*c-(.5-p.x)*c,h.y+=(.5-l.y)*f-(.5-p.y)*f-a.MapConstants.infoWindowPadding,new r.Point(h.x,h.y)},t.prototype.getPositionBySymbolAnnotationData=function(t,e){var n=t.symbolAnnotation;return this.getPosition(n.getPosition(),n.getElevation(),t.width,t.height,n.getAnchor(),e)},t.prototype.setContent=function(t){this.content=t},t}();e.InfoWindow=s},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";var i=n(163),r=n(166);t.exports=function t(e){if(!e)return null;if(e instanceof ArrayBuffer)return e;if("string"==typeof e)return i(e);if(ArrayBuffer.isView(e))return e.byteOffset?e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):e.buffer;var n;if(e.buffer||e.data||e._data)return n=t(e.buffer||e.data||e._data);if(Array.isArray(e))for(var o=0;o<e.length;o++)if(null!=e[o].length){e=r(e);break}return(n=new Uint8Array(e)).length?n.buffer:null}},function(t,e,n){"use strict";(function(e,i){var r=n(57);t.exports=b;var o,a=n(94);b.ReadableState=v;n(67).EventEmitter;var s=function(t,e){return t.listeners(e).length},l=n(97),u=n(58).Buffer,h=e.Uint8Array||function(){};var c=n(45);c.inherits=n(28);var f=n(171),p=void 0;p=f&&f.debuglog?f.debuglog("stream"):function(){};var d,g=n(172),m=n(98);c.inherits(b,l);var y=["error","close","destroy","pause","resume"];function v(t,e){o=o||n(29),t=t||{};var i=e instanceof o;this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(99).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function b(t){if(o=o||n(29),!(this instanceof b))return new b(t);this._readableState=new v(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function _(t,e,n,i,r){var o,a=t._readableState;null===e?(a.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,A(t)}(t,a)):(r||(o=function(t,e){var n;(function(t){return u.isBuffer(t)||t instanceof h})(e)||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(a,e)),o?t.emit("error",o):a.objectMode||e&&e.length>0?("string"==typeof e||a.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),i?a.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):w(t,a,e,!0):a.ended?t.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(e=a.decoder.write(e),a.objectMode||0!==e.length?w(t,a,e,!1):S(t,a)):w(t,a,e,!1))):i||(a.reading=!1));return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(a)}function w(t,e,n,i){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&A(t)),S(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=m.destroy,b.prototype._undestroy=m.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof t&&((e=e||i.defaultEncoding)!==i.encoding&&(t=u.from(t,e),e=""),n=!0),_(this,t,e,!1,n)},b.prototype.unshift=function(t){return _(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return d||(d=n(99).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var M=8388608;function x(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=M?t=M:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function A(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(T,t):T(t))}function T(t){p("emit readable"),t.emit("readable"),P(t)}function S(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(E,t,e))}function E(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function C(t){p("readable nexttick read 0"),t.read(0)}function L(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),P(t),e.flowing&&!e.reading&&t.read(0)}function P(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function I(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var i;t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):i=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,i=1,r=n.data;t-=r.length;for(;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?r+=o:r+=o.slice(0,t),0===(t-=a)){a===o.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(a));break}++i}return e.length-=i,r}(t,e):function(t,e){var n=u.allocUnsafe(t),i=e.head,r=1;i.data.copy(n),t-=i.data.length;for(;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0===(t-=a)){a===o.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=o.slice(a));break}++r}return e.length-=r,n}(t,e);return i}(t,e.buffer,e.decoder),n);var n}function O(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,r.nextTick(R,e,t))}function R(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function k(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}b.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?O(this):A(this),null;if(0===(t=x(t,e))&&e.ended)return 0===e.length&&O(this),null;var i,r=e.needReadable;return p("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",r=!0),e.ended||e.reading?p("reading or ended",r=!1):r&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=x(n,e))),null===(i=t>0?I(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&O(this)),null!==i&&this.emit("data",i),i},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var l=(!e||!1!==e.end)&&t!==i.stdout&&t!==i.stderr?h:b;function u(e,i){p("onunpipe"),e===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,p("cleanup"),t.removeListener("close",y),t.removeListener("finish",v),t.removeListener("drain",c),t.removeListener("error",m),t.removeListener("unpipe",u),n.removeListener("end",h),n.removeListener("end",b),n.removeListener("data",g),f=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||c())}function h(){p("onend"),t.end()}o.endEmitted?r.nextTick(l):n.once("end",l),t.on("unpipe",u);var c=function(t){return function(){var e=t._readableState;p("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,P(t))}}(n);t.on("drain",c);var f=!1;var d=!1;function g(e){p("ondata"),d=!1,!1!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||o.pipesCount>1&&-1!==k(o.pipes,t))&&!f&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function m(e){p("onerror",e),b(),t.removeListener("error",m),0===s(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",v),b()}function v(){p("onfinish"),t.removeListener("close",y),b()}function b(){p("unpipe"),n.unpipe(t)}return n.on("data",g),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",m),t.once("close",y),t.once("finish",v),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n),this);if(!t){var i=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<r;o++)i[o].emit("unpipe",this,n);return this}var a=k(e.pipes,t);return-1===a?this:(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n),this)},b.prototype.on=function(t,e){var n=l.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&A(this):r.nextTick(C,this))}return n},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var t=this._readableState;return t.flowing||(p("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(L,t,e))}(this,t)),this},b.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,n=this._readableState,i=!1;for(var r in t.on("end",function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(r){(p("wrapped data"),n.decoder&&(r=n.decoder.write(r)),!n.objectMode||null!==r&&void 0!==r)&&((n.objectMode||r&&r.length)&&(e.push(r)||(i=!0,t.pause())))}),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));for(var o=0;o<y.length;o++)t.on(y[o],this.emit.bind(this,y[o]));return this._read=function(e){p("wrapped _read",e),i&&(i=!1,t.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=I}).call(this,n(22),n(16))},function(t,e,n){t.exports=n(67).EventEmitter},function(t,e,n){"use strict";var i=n(57);function r(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||i.nextTick(r,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(i.nextTick(r,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";var i=n(58).Buffer,r=i.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(i.isEncoding===r||!r(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=u,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=h,this.end=c,e=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,""}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function f(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}e.StringDecoder=o,o.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"":e},o.prototype.text=function(t,e){var n=function(t,e,n){var i=e.length-1;if(i<n)return 0;var r=a(e[i]);if(r>=0)return r>0&&(t.lastNeed=r-1),r;if(--i<n||-2===r)return 0;if((r=a(e[i]))>=0)return r>0&&(t.lastNeed=r-2),r;if(--i<n||-2===r)return 0;if((r=a(e[i]))>=0)return r>0&&(2===r?r=0:t.lastNeed=r-3),r;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var i=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=o;var i=n(29),r=n(45);function o(t){if(!(this instanceof o))return new o(t);i.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),i(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){s(t,e,n)}):s(this,null,null)}function s(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}r.inherits=n(28),r.inherits(o,i),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,i.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;i.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){"use strict";var i,r=n(24),o=n(184),a=n(102),s=n(103),l=n(72),u=0,h=1,c=3,f=4,p=5,d=0,g=1,m=-2,y=-3,v=-5,b=-1,_=1,w=2,M=3,x=4,A=0,T=2,S=8,E=9,C=15,L=8,P=286,I=30,O=19,R=2*P+1,k=15,D=3,B=258,U=B+D+1,j=32,F=42,N=69,Z=73,V=91,z=103,W=113,Y=666,G=1,H=2,X=3,J=4,q=3;function Q(t,e){return t.msg=l[e],e}function K(t){return(t<<1)-(t>4?9:0)}function $(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(r.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function et(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function it(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e,n,i){var o=t.avail_in;return o>i&&(o=i),0===o?0:(t.avail_in-=o,r.arraySet(e,t.input,t.next_in,o,n),1===t.state.wrap?t.adler=a(t.adler,e,o,n):2===t.state.wrap&&(t.adler=s(t.adler,e,o,n)),t.next_in+=o,t.total_in+=o,o)}function ot(t,e){var n,i,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-U?t.strstart-(t.w_size-U):0,u=t.window,h=t.w_mask,c=t.prev,f=t.strstart+B,p=u[o+a-1],d=u[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(u[(n=e)+a]===d&&u[n+a-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<f);if(i=B-(f-o),o=f-B,i>a){if(t.match_start=e,a=i,i>=s)break;p=u[o+a-1],d=u[o+a]}}}while((e=c[e&h])>l&&0!=--r);return a<=t.lookahead?a:t.lookahead}function at(t){var e,n,i,o,a,s=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-U)){r.arraySet(t.window,t.window,s,s,0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=s?i-s:0}while(--n);e=n=s;do{i=t.prev[--e],t.prev[e]=i>=s?i-s:0}while(--n);o+=s}if(0===t.strm.avail_in)break;if(n=rt(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=D)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+D-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<D)););}while(t.lookahead<U&&0!==t.strm.avail_in)}function st(t,e){for(var n,i;;){if(t.lookahead<U){if(at(t),t.lookahead<U&&e===u)return G;if(0===t.lookahead)break}if(n=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-U&&(t.match_length=ot(t,n)),t.match_length>=D)if(i=o._tr_tally(t,t.strstart-t.match_start,t.match_length-D),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=D){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(et(t,!1),0===t.strm.avail_out))return G}return t.insert=t.strstart<D-1?t.strstart:D-1,e===f?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?G:H}function lt(t,e){for(var n,i,r;;){if(t.lookahead<U){if(at(t),t.lookahead<U&&e===u)return G;if(0===t.lookahead)break}if(n=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=D-1,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-U&&(t.match_length=ot(t,n),t.match_length<=5&&(t.strategy===_||t.match_length===D&&t.strstart-t.match_start>4096)&&(t.match_length=D-1)),t.prev_length>=D&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-D,i=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-D),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=D-1,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return G}else if(t.match_available){if((i=o._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return G}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<D-1?t.strstart:D-1,e===f?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?G:H}function ut(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function ht(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=T,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?F:W,t.adler=2===e.wrap?0:1,e.last_flush=u,o._tr_init(e),d):Q(t,m)}function ct(t){var e=ht(t);return e===d&&function(t){t.window_size=2*t.w_size,$(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=D-1,t.match_available=0,t.ins_h=0}(t.state),e}function ft(t,e,n,i,o,a){if(!t)return m;var s=1;if(e===b&&(e=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),o<1||o>E||n!==S||i<8||i>15||e<0||e>9||a<0||a>x)return Q(t,m);8===i&&(i=9);var l=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*R),this.dyn_dtree=new r.Buf16(2*(2*I+1)),this.bl_tree=new r.Buf16(2*(2*O+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(k+1),this.heap=new r.Buf16(2*P+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*P+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return t.state=l,l.strm=t,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+D-1)/D),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=n,ct(t)}i=[new ut(0,0,0,0,function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&e===u)return G;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,et(t,!1),0===t.strm.avail_out))return G;if(t.strstart-t.block_start>=t.w_size-U&&(et(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?X:J):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),G)}),new ut(4,4,8,4,st),new ut(4,5,16,8,st),new ut(4,6,32,32,st),new ut(4,4,16,16,lt),new ut(8,16,32,32,lt),new ut(8,16,128,128,lt),new ut(8,32,128,256,lt),new ut(32,128,258,1024,lt),new ut(32,258,258,4096,lt)],e.deflateInit=function(t,e){return ft(t,e,S,C,L,A)},e.deflateInit2=ft,e.deflateReset=ct,e.deflateResetKeep=ht,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?m:(t.state.gzhead=e,d):m},e.deflate=function(t,e){var n,r,a,l;if(!t||!t.state||e>p||e<0)return t?Q(t,m):m;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===Y&&e!==f)return Q(t,0===t.avail_out?v:m);if(r.strm=t,n=r.last_flush,r.last_flush=e,r.status===F)if(2===r.wrap)t.adler=0,nt(r,31),nt(r,139),nt(r,8),r.gzhead?(nt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),nt(r,255&r.gzhead.time),nt(r,r.gzhead.time>>8&255),nt(r,r.gzhead.time>>16&255),nt(r,r.gzhead.time>>24&255),nt(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),nt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(nt(r,255&r.gzhead.extra.length),nt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=s(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=N):(nt(r,0),nt(r,0),nt(r,0),nt(r,0),nt(r,0),nt(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),nt(r,q),r.status=W);else{var y=S+(r.w_bits-8<<4)<<8;y|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(y|=j),y+=31-y%31,r.status=W,it(r,y),0!==r.strstart&&(it(r,t.adler>>>16),it(r,65535&t.adler)),t.adler=1}if(r.status===N)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending!==r.pending_buf_size));)nt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=Z)}else r.status=Z;if(r.status===Z)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,nt(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=V)}else r.status=V;if(r.status===V)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),tt(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,nt(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=s(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=z)}else r.status=z;if(r.status===z&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&tt(t),r.pending+2<=r.pending_buf_size&&(nt(r,255&t.adler),nt(r,t.adler>>8&255),t.adler=0,r.status=W)):r.status=W),0!==r.pending){if(tt(t),0===t.avail_out)return r.last_flush=-1,d}else if(0===t.avail_in&&K(e)<=K(n)&&e!==f)return Q(t,v);if(r.status===Y&&0!==t.avail_in)return Q(t,v);if(0!==t.avail_in||0!==r.lookahead||e!==u&&r.status!==Y){var b=r.strategy===w?function(t,e){for(var n;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(e===u)return G;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(et(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?G:H}(r,e):r.strategy===M?function(t,e){for(var n,i,r,a,s=t.window;;){if(t.lookahead<=B){if(at(t),t.lookahead<=B&&e===u)return G;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=D&&t.strstart>0&&(i=s[r=t.strstart-1])===s[++r]&&i===s[++r]&&i===s[++r]){a=t.strstart+B;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<a);t.match_length=B-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=D?(n=o._tr_tally(t,1,t.match_length-D),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(et(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===f?(et(t,!0),0===t.strm.avail_out?X:J):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?G:H}(r,e):i[r.level].func(r,e);if(b!==X&&b!==J||(r.status=Y),b===G||b===X)return 0===t.avail_out&&(r.last_flush=-1),d;if(b===H&&(e===h?o._tr_align(r):e!==p&&(o._tr_stored_block(r,0,0,!1),e===c&&($(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),tt(t),0===t.avail_out))return r.last_flush=-1,d}return e!==f?d:r.wrap<=0?g:(2===r.wrap?(nt(r,255&t.adler),nt(r,t.adler>>8&255),nt(r,t.adler>>16&255),nt(r,t.adler>>24&255),nt(r,255&t.total_in),nt(r,t.total_in>>8&255),nt(r,t.total_in>>16&255),nt(r,t.total_in>>24&255)):(it(r,t.adler>>>16),it(r,65535&t.adler)),tt(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?d:g)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==F&&e!==N&&e!==Z&&e!==V&&e!==z&&e!==W&&e!==Y?Q(t,m):(t.state=null,e===W?Q(t,y):d):m},e.deflateSetDictionary=function(t,e){var n,i,o,s,l,u,h,c,f=e.length;if(!t||!t.state)return m;if(2===(s=(n=t.state).wrap)||1===s&&n.status!==F||n.lookahead)return m;for(1===s&&(t.adler=a(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&($(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new r.Buf8(n.w_size),r.arraySet(c,e,f-n.w_size,n.w_size,0),e=c,f=n.w_size),l=t.avail_in,u=t.next_in,h=t.input,t.avail_in=f,t.next_in=0,t.input=e,at(n);n.lookahead>=D;){i=n.strstart,o=n.lookahead-(D-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+D-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--o);n.strstart=i,n.lookahead=D-1,at(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=D-1,n.match_available=0,t.next_in=u,t.input=h,t.avail_in=l,n.wrap=s,d},e.deflateInfo="pako deflate (from Nodeca project)"},function(t,e,n){"use strict";t.exports=function(t,e,n,i){for(var r=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(r=r+e[i++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0}},function(t,e,n){"use strict";var i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,e,n,r){var o=i,a=r+n;t^=-1;for(var s=r;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},function(t,e,n){"use strict";var i=n(24),r=n(102),o=n(103),a=n(185),s=n(186),l=0,u=1,h=2,c=4,f=5,p=6,d=0,g=1,m=2,y=-2,v=-3,b=-4,_=-5,w=8,M=1,x=2,A=3,T=4,S=5,E=6,C=7,L=8,P=9,I=10,O=11,R=12,k=13,D=14,B=15,U=16,j=17,F=18,N=19,Z=20,V=21,z=22,W=23,Y=24,G=25,H=26,X=27,J=28,q=29,Q=30,K=31,$=32,tt=852,et=592,nt=15;function it(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=M,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(tt),e.distcode=e.distdyn=new i.Buf32(et),e.sane=1,e.back=-1,d):y}function ot(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,rt(t)):y}function at(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?y:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,ot(t))):y}function st(t,e){var n,r;return t?(r=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},t.state=r,r.window=null,(n=at(t,e))!==d&&(t.state=null),n):y}var lt,ut,ht=!0;function ct(t){if(ht){var e;for(lt=new i.Buf32(512),ut=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(u,t.lens,0,288,lt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(h,t.lens,0,32,ut,0,t.work,{bits:5}),ht=!1}t.lencode=lt,t.lenbits=9,t.distcode=ut,t.distbits=5}function ft(t,e,n,r){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),r>=a.wsize?(i.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((o=a.wsize-a.wnext)>r&&(o=r),i.arraySet(a.window,e,n-r,o,a.wnext),(r-=o)?(i.arraySet(a.window,e,n-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}e.inflateReset=ot,e.inflateReset2=at,e.inflateResetKeep=rt,e.inflateInit=function(t){return st(t,nt)},e.inflateInit2=st,e.inflate=function(t,e){var n,tt,et,nt,rt,ot,at,st,lt,ut,ht,pt,dt,gt,mt,yt,vt,bt,_t,wt,Mt,xt,At,Tt,St=0,Et=new i.Buf8(4),Ct=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return y;(n=t.state).mode===R&&(n.mode=k),rt=t.next_out,et=t.output,at=t.avail_out,nt=t.next_in,tt=t.input,ot=t.avail_in,st=n.hold,lt=n.bits,ut=ot,ht=at,xt=d;t:for(;;)switch(n.mode){case M:if(0===n.wrap){n.mode=k;break}for(;lt<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(2&n.wrap&&35615===st){n.check=0,Et[0]=255&st,Et[1]=st>>>8&255,n.check=o(n.check,Et,2,0),st=0,lt=0,n.mode=x;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&st)<<8)+(st>>8))%31){t.msg="incorrect header check",n.mode=Q;break}if((15&st)!==w){t.msg="unknown compression method",n.mode=Q;break}if(lt-=4,Mt=8+(15&(st>>>=4)),0===n.wbits)n.wbits=Mt;else if(Mt>n.wbits){t.msg="invalid window size",n.mode=Q;break}n.dmax=1<<Mt,t.adler=n.check=1,n.mode=512&st?I:R,st=0,lt=0;break;case x:for(;lt<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(n.flags=st,(255&n.flags)!==w){t.msg="unknown compression method",n.mode=Q;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=Q;break}n.head&&(n.head.text=st>>8&1),512&n.flags&&(Et[0]=255&st,Et[1]=st>>>8&255,n.check=o(n.check,Et,2,0)),st=0,lt=0,n.mode=A;case A:for(;lt<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.head&&(n.head.time=st),512&n.flags&&(Et[0]=255&st,Et[1]=st>>>8&255,Et[2]=st>>>16&255,Et[3]=st>>>24&255,n.check=o(n.check,Et,4,0)),st=0,lt=0,n.mode=T;case T:for(;lt<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.head&&(n.head.xflags=255&st,n.head.os=st>>8),512&n.flags&&(Et[0]=255&st,Et[1]=st>>>8&255,n.check=o(n.check,Et,2,0)),st=0,lt=0,n.mode=S;case S:if(1024&n.flags){for(;lt<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.length=st,n.head&&(n.head.extra_len=st),512&n.flags&&(Et[0]=255&st,Et[1]=st>>>8&255,n.check=o(n.check,Et,2,0)),st=0,lt=0}else n.head&&(n.head.extra=null);n.mode=E;case E:if(1024&n.flags&&((pt=n.length)>ot&&(pt=ot),pt&&(n.head&&(Mt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,tt,nt,pt,Mt)),512&n.flags&&(n.check=o(n.check,tt,pt,nt)),ot-=pt,nt+=pt,n.length-=pt),n.length))break t;n.length=0,n.mode=C;case C:if(2048&n.flags){if(0===ot)break t;pt=0;do{Mt=tt[nt+pt++],n.head&&Mt&&n.length<65536&&(n.head.name+=String.fromCharCode(Mt))}while(Mt&&pt<ot);if(512&n.flags&&(n.check=o(n.check,tt,pt,nt)),ot-=pt,nt+=pt,Mt)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=L;case L:if(4096&n.flags){if(0===ot)break t;pt=0;do{Mt=tt[nt+pt++],n.head&&Mt&&n.length<65536&&(n.head.comment+=String.fromCharCode(Mt))}while(Mt&&pt<ot);if(512&n.flags&&(n.check=o(n.check,tt,pt,nt)),ot-=pt,nt+=pt,Mt)break t}else n.head&&(n.head.comment=null);n.mode=P;case P:if(512&n.flags){for(;lt<16;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(st!==(65535&n.check)){t.msg="header crc mismatch",n.mode=Q;break}st=0,lt=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=R;break;case I:for(;lt<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}t.adler=n.check=it(st),st=0,lt=0,n.mode=O;case O:if(0===n.havedict)return t.next_out=rt,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=lt,m;t.adler=n.check=1,n.mode=R;case R:if(e===f||e===p)break t;case k:if(n.last){st>>>=7&lt,lt-=7&lt,n.mode=X;break}for(;lt<3;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}switch(n.last=1&st,lt-=1,3&(st>>>=1)){case 0:n.mode=D;break;case 1:if(ct(n),n.mode=Z,e===p){st>>>=2,lt-=2;break t}break;case 2:n.mode=j;break;case 3:t.msg="invalid block type",n.mode=Q}st>>>=2,lt-=2;break;case D:for(st>>>=7&lt,lt-=7&lt;lt<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if((65535&st)!=(st>>>16^65535)){t.msg="invalid stored block lengths",n.mode=Q;break}if(n.length=65535&st,st=0,lt=0,n.mode=B,e===p)break t;case B:n.mode=U;case U:if(pt=n.length){if(pt>ot&&(pt=ot),pt>at&&(pt=at),0===pt)break t;i.arraySet(et,tt,nt,pt,rt),ot-=pt,nt+=pt,at-=pt,rt+=pt,n.length-=pt;break}n.mode=R;break;case j:for(;lt<14;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(n.nlen=257+(31&st),st>>>=5,lt-=5,n.ndist=1+(31&st),st>>>=5,lt-=5,n.ncode=4+(15&st),st>>>=4,lt-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=Q;break}n.have=0,n.mode=F;case F:for(;n.have<n.ncode;){for(;lt<3;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.lens[Ct[n.have++]]=7&st,st>>>=3,lt-=3}for(;n.have<19;)n.lens[Ct[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,At={bits:n.lenbits},xt=s(l,n.lens,0,19,n.lencode,0,n.work,At),n.lenbits=At.bits,xt){t.msg="invalid code lengths set",n.mode=Q;break}n.have=0,n.mode=N;case N:for(;n.have<n.nlen+n.ndist;){for(;yt=(St=n.lencode[st&(1<<n.lenbits)-1])>>>16&255,vt=65535&St,!((mt=St>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(vt<16)st>>>=mt,lt-=mt,n.lens[n.have++]=vt;else{if(16===vt){for(Tt=mt+2;lt<Tt;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(st>>>=mt,lt-=mt,0===n.have){t.msg="invalid bit length repeat",n.mode=Q;break}Mt=n.lens[n.have-1],pt=3+(3&st),st>>>=2,lt-=2}else if(17===vt){for(Tt=mt+3;lt<Tt;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}lt-=mt,Mt=0,pt=3+(7&(st>>>=mt)),st>>>=3,lt-=3}else{for(Tt=mt+7;lt<Tt;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}lt-=mt,Mt=0,pt=11+(127&(st>>>=mt)),st>>>=7,lt-=7}if(n.have+pt>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=Q;break}for(;pt--;)n.lens[n.have++]=Mt}}if(n.mode===Q)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=Q;break}if(n.lenbits=9,At={bits:n.lenbits},xt=s(u,n.lens,0,n.nlen,n.lencode,0,n.work,At),n.lenbits=At.bits,xt){t.msg="invalid literal/lengths set",n.mode=Q;break}if(n.distbits=6,n.distcode=n.distdyn,At={bits:n.distbits},xt=s(h,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,At),n.distbits=At.bits,xt){t.msg="invalid distances set",n.mode=Q;break}if(n.mode=Z,e===p)break t;case Z:n.mode=V;case V:if(ot>=6&&at>=258){t.next_out=rt,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=lt,a(t,ht),rt=t.next_out,et=t.output,at=t.avail_out,nt=t.next_in,tt=t.input,ot=t.avail_in,st=n.hold,lt=n.bits,n.mode===R&&(n.back=-1);break}for(n.back=0;yt=(St=n.lencode[st&(1<<n.lenbits)-1])>>>16&255,vt=65535&St,!((mt=St>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(yt&&0==(240&yt)){for(bt=mt,_t=yt,wt=vt;yt=(St=n.lencode[wt+((st&(1<<bt+_t)-1)>>bt)])>>>16&255,vt=65535&St,!(bt+(mt=St>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}st>>>=bt,lt-=bt,n.back+=bt}if(st>>>=mt,lt-=mt,n.back+=mt,n.length=vt,0===yt){n.mode=H;break}if(32&yt){n.back=-1,n.mode=R;break}if(64&yt){t.msg="invalid literal/length code",n.mode=Q;break}n.extra=15&yt,n.mode=z;case z:if(n.extra){for(Tt=n.extra;lt<Tt;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.length+=st&(1<<n.extra)-1,st>>>=n.extra,lt-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=W;case W:for(;yt=(St=n.distcode[st&(1<<n.distbits)-1])>>>16&255,vt=65535&St,!((mt=St>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(0==(240&yt)){for(bt=mt,_t=yt,wt=vt;yt=(St=n.distcode[wt+((st&(1<<bt+_t)-1)>>bt)])>>>16&255,vt=65535&St,!(bt+(mt=St>>>24)<=lt);){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}st>>>=bt,lt-=bt,n.back+=bt}if(st>>>=mt,lt-=mt,n.back+=mt,64&yt){t.msg="invalid distance code",n.mode=Q;break}n.offset=vt,n.extra=15&yt,n.mode=Y;case Y:if(n.extra){for(Tt=n.extra;lt<Tt;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}n.offset+=st&(1<<n.extra)-1,st>>>=n.extra,lt-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=Q;break}n.mode=G;case G:if(0===at)break t;if(pt=ht-at,n.offset>pt){if((pt=n.offset-pt)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=Q;break}pt>n.wnext?(pt-=n.wnext,dt=n.wsize-pt):dt=n.wnext-pt,pt>n.length&&(pt=n.length),gt=n.window}else gt=et,dt=rt-n.offset,pt=n.length;pt>at&&(pt=at),at-=pt,n.length-=pt;do{et[rt++]=gt[dt++]}while(--pt);0===n.length&&(n.mode=V);break;case H:if(0===at)break t;et[rt++]=n.length,at--,n.mode=V;break;case X:if(n.wrap){for(;lt<32;){if(0===ot)break t;ot--,st|=tt[nt++]<<lt,lt+=8}if(ht-=at,t.total_out+=ht,n.total+=ht,ht&&(t.adler=n.check=n.flags?o(n.check,et,ht,rt-ht):r(n.check,et,ht,rt-ht)),ht=at,(n.flags?st:it(st))!==n.check){t.msg="incorrect data check",n.mode=Q;break}st=0,lt=0}n.mode=J;case J:if(n.wrap&&n.flags){for(;lt<32;){if(0===ot)break t;ot--,st+=tt[nt++]<<lt,lt+=8}if(st!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=Q;break}st=0,lt=0}n.mode=q;case q:xt=g;break t;case Q:xt=v;break t;case K:return b;case $:default:return y}return t.next_out=rt,t.avail_out=at,t.next_in=nt,t.avail_in=ot,n.hold=st,n.bits=lt,(n.wsize||ht!==t.avail_out&&n.mode<Q&&(n.mode<X||e!==c))&&ft(t,t.output,t.next_out,ht-t.avail_out)?(n.mode=K,b):(ut-=t.avail_in,ht-=t.avail_out,t.total_in+=ut,t.total_out+=ht,n.total+=ht,n.wrap&&ht&&(t.adler=n.check=n.flags?o(n.check,et,ht,t.next_out-ht):r(n.check,et,ht,t.next_out-ht)),t.data_type=n.bits+(n.last?64:0)+(n.mode===R?128:0)+(n.mode===Z||n.mode===B?256:0),(0===ut&&0===ht||e===c)&&xt===d&&(xt=_),xt)},e.inflateEnd=function(t){if(!t||!t.state)return y;var e=t.state;return e.window&&(e.window=null),t.state=null,d},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?y:(n.head=e,e.done=!1,d):y},e.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&n.mode!==O?y:n.mode===O&&r(1,e,i,0)!==n.check?v:ft(t,e,i,i)?(n.mode=K,b):(n.havedict=1,d):y},e.inflateInfo="pako inflate (from Nodeca project)"},function(t,e,n){"use strict";(function(e,i){var r=n(23),o=n(56),a=t.exports=function(){o.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(a,o),a.prototype.read=function(t,n){this._reads.push({length:Math.abs(t),allowLess:t<0,func:n}),e.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},a.prototype.write=function(t,e){return this.writable?(n=i.isBuffer(t)?t:new i(t,e||this._encoding),this._buffers.push(n),this._buffered+=n.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var n},a.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},a.prototype.destroySoon=a.prototype.end,a.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},a.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},a.prototype._processReadAllowingLess=function(t){this._reads.shift();var e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},a.prototype._processRead=function(t){this._reads.shift();for(var e=0,n=0,r=new i(t.length);e<t.length;){var o=this._buffers[n++],a=Math.min(o.length,t.length-e);o.copy(r,e,0,a),e+=a,a!==o.length&&(this._buffers[--n]=o.slice(a))}n>0&&this._buffers.splice(0,n),this._buffered-=t.length,t.func.call(this,r)},a.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else{if(!(this._buffered>=t.length))break;this._processRead(t)}}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}}).call(this,n(16),n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(107),r=n(108);function o(t,e,n){var i=t*e;return 8!==n&&(i=Math.ceil(i/(8/n))),i}var a=t.exports=function(t,e){var n=t.width,r=t.height,a=t.interlace,s=t.bpp,l=t.depth;if(this.read=e.read,this.write=e.write,this.complete=e.complete,this._imageIndex=0,this._images=[],a)for(var u=i.getImagePasses(n,r),h=0;h<u.length;h++)this._images.push({byteWidth:o(u[h].width,s,l),height:u[h].height,lineIndex:0});else this._images.push({byteWidth:o(n,s,l),height:r,lineIndex:0});this._xComparison=8===l?s:16===l?2*s:1};a.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},a.prototype._unFilterType1=function(t,e,n){for(var i=this._xComparison,r=i-1,o=0;o<n;o++){var a=t[1+o],s=o>r?e[o-i]:0;e[o]=a+s}},a.prototype._unFilterType2=function(t,e,n){for(var i=this._lastLine,r=0;r<n;r++){var o=t[1+r],a=i?i[r]:0;e[r]=o+a}},a.prototype._unFilterType3=function(t,e,n){for(var i=this._xComparison,r=i-1,o=this._lastLine,a=0;a<n;a++){var s=t[1+a],l=o?o[a]:0,u=a>r?e[a-i]:0,h=Math.floor((u+l)/2);e[a]=s+h}},a.prototype._unFilterType4=function(t,e,n){for(var i=this._xComparison,o=i-1,a=this._lastLine,s=0;s<n;s++){var l=t[1+s],u=a?a[s]:0,h=s>o?e[s-i]:0,c=s>o&&a?a[s-i]:0,f=r(h,u,c);e[s]=l+f}},a.prototype._reverseFilterLine=function(t){var n,i=t[0],r=this._images[this._imageIndex],o=r.byteWidth;if(0===i)n=t.slice(1,o+1);else switch(n=new e(o),i){case 1:this._unFilterType1(t,n,o);break;case 2:this._unFilterType2(t,n,o);break;case 3:this._unFilterType3(t,n,o);break;case 4:this._unFilterType4(t,n,o);break;default:throw new Error("Unrecognised filter type - "+i)}this.write(n),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=n,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];e.getImagePasses=function(t,e){for(var n=[],r=t%8,o=e%8,a=(t-r)/8,s=(e-o)/8,l=0;l<i.length;l++){for(var u=i[l],h=a*u.x.length,c=s*u.y.length,f=0;f<u.x.length&&u.x[f]<r;f++)h++;for(f=0;f<u.y.length&&u.y[f]<o;f++)c++;h>0&&c>0&&n.push({width:h,height:c,index:l})}return n},e.getInterlaceIterator=function(t){return function(e,n,r){var o=e%i[r].x.length,a=(e-o)/i[r].x.length*8+i[r].x[o],s=n%i[r].y.length;return 4*a+((n-s)/i[r].y.length*8+i[r].y[s])*t*4}}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i=t+e-n,r=Math.abs(i-t),o=Math.abs(i-e),a=Math.abs(i-n);return r<=o&&r<=a?t:o<=a?e:n}},function(t,e,n){"use strict";(function(e){var i=n(47),r=n(110),o=t.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[i.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[i.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[i.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[i.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[i.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[i.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};o.prototype.start=function(){this.read(i.PNG_SIGNATURE.length,this._parseSignature.bind(this))},o.prototype._parseSignature=function(t){for(var e=i.PNG_SIGNATURE,n=0;n<e.length;n++)if(t[n]!==e[n])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},o.prototype._parseChunkBegin=function(t){for(var n=t.readUInt32BE(0),o=t.readUInt32BE(4),a="",s=4;s<8;s++)a+=String.fromCharCode(t[s]);var l=Boolean(32&t[4]);if(this._hasIHDR||o===i.TYPE_IHDR){if(this._crc=new r,this._crc.write(new e(a)),this._chunks[o])return this._chunks[o](n);l?this.read(n+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+a))}else this.error(new Error("Expected IHDR on beggining"))},o.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},o.prototype._parseChunkEnd=function(t){var e=t.readInt32BE(0),n=this._crc.crc32();this._options.checkCRC&&n!==e?this.error(new Error("Crc error - "+e+" - "+n)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},o.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},o.prototype._parseIHDR=function(t){this._crc.write(t);var e=t.readUInt32BE(0),n=t.readUInt32BE(4),r=t[8],o=t[9],a=t[10],s=t[11],l=t[12];if(8===r||4===r||2===r||1===r||16===r)if(o in i.COLORTYPE_TO_BPP_MAP)if(0===a)if(0===s)if(0===l||1===l){this._colorType=o;var u=i.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:n,depth:r,interlace:Boolean(l),palette:Boolean(o&i.COLORTYPE_PALETTE),color:Boolean(o&i.COLORTYPE_COLOR),alpha:Boolean(o&i.COLORTYPE_ALPHA),bpp:u,colorType:o}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+r))},o.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},o.prototype._parsePLTE=function(t){this._crc.write(t);for(var e=Math.floor(t.length/3),n=0;n<e;n++)this._palette.push([t[3*n],t[3*n+1],t[3*n+2],255]);this.palette(this._palette),this._handleChunkEnd()},o.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},o.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===i.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===i.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===i.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},o.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},o.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/i.GAMMA_DIVISION),this._handleChunkEnd()},o.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},o.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===i.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(e);var n=t-e.length;n>0?this._handleIDAT(n):this._handleChunkEnd()},o.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},o.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=[];!function(){for(var t=0;t<256;t++){for(var e=t,n=0;n<8;n++)1&e?e=3988292384^e>>>1:e>>>=1;i[t]=e}}();var r=t.exports=function(){this._crc=-1};r.prototype.write=function(t){for(var e=0;e<t.length;e++)this._crc=i[255&(this._crc^t[e])]^this._crc>>>8;return!0},r.prototype.crc32=function(){return-1^this._crc},r.crc32=function(t){for(var e=-1,n=0;n<t.length;n++)e=i[255&(e^t[n])]^e>>>8;return-1^e}},function(t,e,n){"use strict";(function(t){var i=n(107),r=[function(){},function(t,e,n,i){if(i===e.length)throw new Error("Ran out of data");var r=e[i];t[n]=r,t[n+1]=r,t[n+2]=r,t[n+3]=255},function(t,e,n,i){if(i+1>=e.length)throw new Error("Ran out of data");var r=e[i];t[n]=r,t[n+1]=r,t[n+2]=r,t[n+3]=e[i+1]},function(t,e,n,i){if(i+2>=e.length)throw new Error("Ran out of data");t[n]=e[i],t[n+1]=e[i+1],t[n+2]=e[i+2],t[n+3]=255},function(t,e,n,i){if(i+3>=e.length)throw new Error("Ran out of data");t[n]=e[i],t[n+1]=e[i+1],t[n+2]=e[i+2],t[n+3]=e[i+3]}],o=[function(){},function(t,e,n,i){var r=e[0];t[n]=r,t[n+1]=r,t[n+2]=r,t[n+3]=i},function(t,e,n){var i=e[0];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=e[1]},function(t,e,n,i){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=i},function(t,e,n){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3]}];function a(t,e,n,i,o,a){for(var s=t.width,l=t.height,u=t.index,h=0;h<l;h++)for(var c=0;c<s;c++){var f=n(c,h,u);r[i](e,o,f,a),a+=i}return a}function s(t,e,n,i,r,a){for(var s=t.width,l=t.height,u=t.index,h=0;h<l;h++){for(var c=0;c<s;c++){var f=r.get(i),p=n(c,h,u);o[i](e,f,p,a)}r.resetAfterLine()}}e.dataToBitMap=function(e,n){var r,o=n.width,l=n.height,u=n.depth,h=n.bpp,c=n.interlace;if(8!==u)var f=function(t,e){var n=[],i=0;function r(){if(i===t.length)throw new Error("Ran out of data");var r,o,a,s,l,u,h,c,f=t[i];switch(i++,e){default:throw new Error("unrecognised depth");case 16:h=t[i],i++,n.push((f<<8)+h);break;case 4:h=15&f,c=f>>4,n.push(c,h);break;case 2:l=3&f,u=f>>2&3,h=f>>4&3,c=f>>6&3,n.push(c,h,u,l);break;case 1:r=1&f,o=f>>1&1,a=f>>2&1,s=f>>3&1,l=f>>4&1,u=f>>5&1,h=f>>6&1,c=f>>7&1,n.push(c,h,u,l,s,a,o,r)}}return{get:function(t){for(;n.length<t;)r();var e=n.slice(0,t);return n=n.slice(t),e},resetAfterLine:function(){n.length=0},end:function(){if(i!==t.length)throw new Error("extra data found")}}}(e,u);r=u<=8?new t(o*l*4):new Uint16Array(o*l*4);var p,d,g=Math.pow(2,u)-1,m=0;if(c)p=i.getImagePasses(o,l),d=i.getInterlaceIterator(o,l);else{var y=0;d=function(){var t=y;return y+=4,t},p=[{width:o,height:l}]}for(var v=0;v<p.length;v++)8===u?m=a(p[v],r,d,h,e,m):s(p[v],r,d,h,f,g);if(8===u){if(m!==e.length)throw new Error("extra data found")}else f.end();return r}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){t.exports=function(t,n){var i=n.depth,r=n.width,o=n.height,a=n.colorType,s=n.transColor,l=n.palette,u=t;return 3===a?function(t,e,n,i,r){for(var o=0,a=0;a<i;a++)for(var s=0;s<n;s++){var l=r[t[o]];if(!l)throw new Error("index "+t[o]+" not in palette");for(var u=0;u<4;u++)e[o+u]=l[u];o+=4}}(t,u,r,o,l):(s&&function(t,e,n,i,r){for(var o=0,a=0;a<i;a++)for(var s=0;s<n;s++){var l=!1;if(1===r.length?r[0]===t[o]&&(l=!0):r[0]===t[o]&&r[1]===t[o+1]&&r[2]===t[o+2]&&(l=!0),l)for(var u=0;u<4;u++)e[o+u]=0;o+=4}}(t,u,r,o,s),8!==i&&(16===i&&(u=new e(r*o*4)),function(t,e,n,i,r){for(var o=Math.pow(2,r)-1,a=0,s=0;s<i;s++)for(var l=0;l<n;l++){for(var u=0;u<4;u++)e[a+u]=Math.floor(255*t[a+u]/o+.5);a+=4}}(t,u,r,o,i))),u}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(47),r=n(110),o=n(189),a=n(190),s=n(46),l=t.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||s.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:i.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:i.COLORTYPE_COLOR_ALPHA,-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(t.colorType))throw new Error("option color type:"+t.colorType+" is not supported at present");if(-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw new Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw new Error("option bit depth:"+t.bitDepth+" is not supported at present")};l.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},l.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},l.prototype.filterData=function(t,e,n){var r=o(t,e,n,this._options),s=i.COLORTYPE_TO_BPP_MAP[this._options.colorType];return a(r,e,n,this._options,s)},l.prototype._packChunk=function(t,n){var i=n?n.length:0,o=new e(i+12);return o.writeUInt32BE(i,0),o.writeUInt32BE(t,4),n&&n.copy(o,8),o.writeInt32BE(r.crc32(o.slice(4,o.length-4)),o.length-4),o},l.prototype.packGAMA=function(t){var n=new e(4);return n.writeUInt32BE(Math.floor(t*i.GAMMA_DIVISION),0),this._packChunk(i.TYPE_gAMA,n)},l.prototype.packIHDR=function(t,n){var r=new e(13);return r.writeUInt32BE(t,0),r.writeUInt32BE(n,4),r[8]=this._options.bitDepth,r[9]=this._options.colorType,r[10]=0,r[11]=0,r[12]=0,this._packChunk(i.TYPE_IHDR,r)},l.prototype.packIDAT=function(t){return this._packChunk(i.TYPE_IDAT,t)},l.prototype.packIEND=function(){return this._packChunk(i.TYPE_IEND,null)}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=t.exports=function(t){this._buffer=t,this._reads=[]};i.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},i.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var t=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=t.length||t.allowLess))break;this._reads.shift();var e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},function(t,e,n){"use strict";var i=n(24),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new i.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var n="",a=0;a<e;a++)n+=String.fromCharCode(t[a]);return n}a[254]=a[254]=1,e.string2buf=function(t){var e,n,r,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new i.Buf8(l),a=0,o=0;a<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?e[a++]=n:n<2048?(e[a++]=192|n>>>6,e[a++]=128|63&n):n<65536?(e[a++]=224|n>>>12,e[a++]=128|n>>>6&63,e[a++]=128|63&n):(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63,e[a++]=128|n>>>6&63,e[a++]=128|63&n);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new i.Buf8(t.length),n=0,r=e.length;n<r;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,i,r,o,s=e||t.length,u=new Array(2*s);for(i=0,n=0;n<s;)if((r=t[n++])<128)u[i++]=r;else if((o=a[r])>4)u[i++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<s;)r=r<<6|63&t[n++],o--;o>1?u[i++]=65533:r<65536?u[i++]=r:(r-=65536,u[i++]=55296|r>>10&1023,u[i++]=56320|1023&r)}return l(u,i)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+a[t[n]]>e?n:e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(1),o=n(26),a=n(15),s=function(){function t(e){var n={};r.MapUtils.extendOptions(n,t.defaultPlaceOptions,e);for(var o=0,a=n;o<a.length;o++){if(null==a[o])throw Error("Parameters can not be null")}this.id=n.id,this.url=n.url,this.location=i.LatLng.convert(n.location),this.name=n.name}return t.prototype.getId=function(){return this.id},t.prototype.getName=function(){return this.name},t.prototype.getLocation=function(){return this.location},t.prototype.getMap=function(){return this.map},t.prototype.setMap=function(t){if(this.map!==t&&(null!=this.map&&this.map.mapView.removeFeature(this.id),this.map=t,null!=this.map)){var e=new Map;e.set("lat",this.location.lat),e.set("lng",this.location.lng),e.set("url",this.url),e.set("name",this.name);var n=new o.VectorTileFeature(this.id,a.GeometryType.Point,null,e);this.map.mapView.addFeature(n)}},t.defaultPlaceOptions={name:"Default icon name",url:"iconDefault"},t}();e.Place=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(36),r=function(){function t(t,e,n){this.gl=t,this.width=e,this.height=n,this.isReady=!1,this.init()}return t.prototype.init=function(){var t=this.gl,e=new i.TextureFiltering(t.NEAREST,t.NEAREST),n=new i.TextureWrapping(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE),r=new i.TextureOptions(t.TEXTURE_2D,t.RGB,t.RGB,t.UNSIGNED_BYTE,e,n);this.colorTexture=new i.Texture(t,r),this.colorTexture.initFrameBufferTexture(this.width||1,this.height||1),this.depthBuffer=this.gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width||1,this.height||1),t.bindRenderbuffer(t.RENDERBUFFER,null),this.frameBufferId=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBufferId),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.textureId,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if(o!=t.FRAMEBUFFER_COMPLETE){switch(o){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:console.warn("FRAMEBUFFER_UNSUPPORTED");break;default:console.warn("Unknown framebuffer issue")}return t.bindFramebuffer(t.FRAMEBUFFER,null),!1}return this.isReady=!0,t.bindFramebuffer(t.FRAMEBUFFER,null),!0},t.prototype.bind=function(){this.isReady&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.frameBufferId)},t.prototype.unbind=function(){this.isReady&&this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)},t.prototype.drawDebug=function(){},t.prototype.destroy=function(){this.gl&&(this.colorTexture&&this.colorTexture.destroy(),this.gl.deleteRenderbuffer(this.depthBuffer),this.gl.deleteFramebuffer(this.frameBufferId),this.colorTexture=null,this.depthBuffer=null,this.frameBufferId=null)},t}();e.FrameBuffer=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(245),o=n(10),a=n(13),s=n(11),l=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._shader=n,o._particleTexture=i,o._gl=e,o}return i(e,t),e.prototype.render=function(t){var e=a.ResourceManager.getInstance(this._gl).getModel(a.ModelEnum.PARTICLE_QUAD_MODEL),n=t.getOrthoProjectionMatrix();this._shader.bind(),e.bind(),this._shader.setAttributes(e.attributeInfos),this._shader.setUniforms([new o.UniformInfo("u_texture","texture",this._particleTexture)]);for(var i=this._activeParticlesFirst;i;i=i.next){var r=i.position,l=i.scale,u=i.rotation,h=s.Matrix4.translate(r.x,r.y,0),c=s.Matrix4.scale(this._particleTexture.width*l,this._particleTexture.height*l,1);h=s.Matrix4.rotateZ(u).concat(h);var f=(h=c.concat(h)).concat(n);this._shader.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",f)]),e.render(this._gl.TRIANGLES)}e.unbind()},e}(r.ParticleSystem);e.ParticleSystemQuad=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Rainy=0]="Rainy",t[t.Snowy=1]="Snowy",t[t.Sunny=2]="Sunny",t[t.Cloudy=3]="Cloudy",t[t.Live=4]="Live",t[t.None=5]="None"}(e.Weather||(e.Weather={}))},function(t,e,n){"use strict";function i(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return(a=t-n)*a+(s=e-i)*s}function r(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)o(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)o(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)o(t,e[i][r])}(r),r}function o(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function a(t,e,n,i){if(e.geometry){var o=e.geometry.coordinates,h=e.geometry.type,c=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),f=[],p=e.id;if(n.promoteId?p=e.properties[n.promoteId]:n.generateId&&(p=i||0),"Point"===h)s(o,f);else if("MultiPoint"===h)for(var d=0;d<o.length;d++)s(o[d],f);else if("LineString"===h)l(o,f,c,!1);else if("MultiLineString"===h){if(n.lineMetrics){for(d=0;d<o.length;d++)f=[],l(o[d],f,c,!1),t.push(r(p,"LineString",f,e.properties));return}u(o,f,c,!1)}else if("Polygon"===h)u(o,f,c,!0);else{if("MultiPolygon"!==h){if("GeometryCollection"===h){for(d=0;d<e.geometry.geometries.length;d++)a(t,{id:p,geometry:e.geometry.geometries[d],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(d=0;d<o.length;d++){var g=[];u(o[d],g,c,!0),f.push(g)}}t.push(r(p,h,f,e.properties))}}function s(t,e){e.push(h(t[0])),e.push(c(t[1])),e.push(0)}function l(t,e,n,r){for(var o,a,s=0,l=0;l<t.length;l++){var u=h(t[l][0]),f=c(t[l][1]);e.push(u),e.push(f),e.push(0),l>0&&(s+=r?(o*f-u*a)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(f-a,2))),o=u,a=f}var p=e.length-3;e[2]=1,function t(e,n,r,o){for(var a,s=o,l=r-n>>1,u=r-n,h=e[n],c=e[n+1],f=e[r],p=e[r+1],d=n+3;d<r;d+=3){var g=i(e[d],e[d+1],h,c,f,p);if(g>s)a=d,s=g;else if(g===s){var m=Math.abs(d-l);m<u&&(a=d,u=m)}}s>o&&(a-n>3&&t(e,n,a,o),e[a+2]=s,r-a>3&&t(e,a,r,o))}(e,0,p,n),e[p+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function u(t,e,n,i){for(var r=0;r<t.length;r++){var o=[];l(t[r],o,n,i),e.push(o)}}function h(t){return t/360+.5}function c(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function f(t,e,n,i,o,a,s,l){if(i/=e,a>=(n/=e)&&s<i)return t;if(s<n||a>=i)return null;for(var u=[],h=0;h<t.length;h++){var c=t[h],f=c.geometry,g=c.type,y=0===o?c.minX:c.minY,v=0===o?c.maxX:c.maxY;if(y>=n&&v<i)u.push(c);else if(!(v<n||y>=i)){var b=[];if("Point"===g||"MultiPoint"===g)p(f,b,n,i,o);else if("LineString"===g)d(f,b,n,i,o,!1,l.lineMetrics);else if("MultiLineString"===g)m(f,b,n,i,o,!1);else if("Polygon"===g)m(f,b,n,i,o,!0);else if("MultiPolygon"===g)for(var _=0;_<f.length;_++){var w=[];m(f[_],w,n,i,o,!0),w.length&&b.push(w)}if(b.length){if(l.lineMetrics&&"LineString"===g){for(_=0;_<b.length;_++)u.push(r(c.id,g,b[_],c.tags));continue}"LineString"!==g&&"MultiLineString"!==g||(1===b.length?(g="LineString",b=b[0]):g="MultiLineString"),"Point"!==g&&"MultiPoint"!==g||(g=3===b.length?"Point":"MultiPoint"),u.push(r(c.id,g,b,c.tags))}}}return u.length?u:null}function p(t,e,n,i,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=n&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function d(t,e,n,i,r,o,a){for(var s,l,u=g(t),h=0===r?v:b,c=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],m=t[f+2],_=t[f+3],w=t[f+4],M=0===r?p:d,x=0===r?_:w,A=!1;a&&(s=Math.sqrt(Math.pow(p-_,2)+Math.pow(d-w,2))),M<n?x>n&&(l=h(u,p,d,_,w,n),a&&(u.start=c+s*l)):M>i?x<i&&(l=h(u,p,d,_,w,i),a&&(u.start=c+s*l)):y(u,p,d,m),x<n&&M>=n&&(l=h(u,p,d,_,w,n),A=!0),x>i&&M<=i&&(l=h(u,p,d,_,w,i),A=!0),!o&&A&&(a&&(u.end=c+s*l),e.push(u),u=g(t)),a&&(c+=s)}var T=t.length-3;p=t[T],d=t[T+1],m=t[T+2],(M=0===r?p:d)>=n&&M<=i&&y(u,p,d,m),T=u.length-3,o&&T>=3&&(u[T]!==u[0]||u[T+1]!==u[1])&&y(u,u[0],u[1],u[2]),u.length&&e.push(u)}function g(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function m(t,e,n,i,r,o){for(var a=0;a<t.length;a++)d(t[a],e,n,i,r,o,!1)}function y(t,e,n,i){t.push(e),t.push(n),t.push(i)}function v(t,e,n,i,r,o){var a=(o-e)/(i-e);return t.push(o),t.push(n+(r-n)*a),t.push(1),a}function b(t,e,n,i,r,o){var a=(o-n)/(r-n);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function _(t,e){for(var n=[],i=0;i<t.length;i++){var o,a=t[i],s=a.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)o=w(a.geometry,e);else if("MultiLineString"===s||"Polygon"===s){o=[];for(var l=0;l<a.geometry.length;l++)o.push(w(a.geometry[l],e))}else if("MultiPolygon"===s)for(o=[],l=0;l<a.geometry.length;l++){for(var u=[],h=0;h<a.geometry[l].length;h++)u.push(w(a.geometry[l][h],e));o.push(u)}n.push(r(a.id,s,o,a.tags))}return n}function w(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function M(t,e){if(t.transformed)return t;var n,i,r,o=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],u=l.geometry,h=l.type;if(l.geometry=[],1===h)for(i=0;i<u.length;i+=2)l.geometry.push(x(u[i],u[i+1],e,o,a,s));else for(i=0;i<u.length;i++){var c=[];for(r=0;r<u[i].length;r+=2)c.push(x(u[i][r],u[i][r+1],e,o,a,s));l.geometry.push(c)}}return t.transformed=!0,t}function x(t,e,n,i,r,o){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-o))]}function A(t,e,n,i,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,T(a,t[s],o,r);var l=t[s].minX,u=t[s].minY,h=t[s].maxX,c=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),h>a.maxX&&(a.maxX=h),c>a.maxY&&(a.maxY=c)}return a}function T(t,e,n,i){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)S(a,r,t,n,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)S(a,r[s],t,n,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)S(a,u[s],t,n,!0,0===s)}if(a.length){var h=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var c in h={},e.tags)h[c]=e.tags[c];h.mapbox_clip_start=r.start/r.size,h.mapbox_clip_end=r.end/r.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:h};null!==e.id&&(f.id=e.id),t.features.push(f)}}function S(t,e,n,i,r,o){var a=i*i;if(i>0&&e.size<(r?a:i))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,o=r-2;i<r;o=i,i+=2)n+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=a,t[r-1-i]=s}}(s,o),t.push(s)}}function E(t,e){return new C(t,e)}function C(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)a(n,t.features[i],e,i);else"Feature"===t.type?a(n,t,e):a(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,r=f(t,1,-1-n,n,0,-1,2,e),o=f(t,1,1-n,2+n,0,-1,2,e);return(r||o)&&(i=f(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=_(r,1).concat(i)),o&&(i=i.concat(_(o,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function L(t,e,n){return 32*((1<<t)*n+e)+t}n.r(e),n.d(e,"default",function(){return E}),C.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},C.prototype.splitTile=function(t,e,n,i,r,o,a){for(var s=[t,e,n,i],l=this.options,u=l.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var h=1<<e,c=L(e,n,i),p=this.tiles[c];if(!p&&(u>1&&console.time("creation"),p=this.tiles[c]=A(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var g=1<<r-e;if(n!==Math.floor(o/g)||i!==Math.floor(a/g))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,y,v,b,_,w,M=.5*l.buffer/l.extent,x=.5-M,T=.5+M,S=1+M;m=y=v=b=null,_=f(t,h,n-M,n+T,0,p.minX,p.maxX,l),w=f(t,h,n+x,n+S,0,p.minX,p.maxX,l),t=null,_&&(m=f(_,h,i-M,i+T,1,p.minY,p.maxY,l),y=f(_,h,i+x,i+S,1,p.minY,p.maxY,l),_=null),w&&(v=f(w,h,i-M,i+T,1,p.minY,p.maxY,l),b=f(w,h,i+x,i+S,1,p.minY,p.maxY,l),w=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*n,2*i),s.push(y||[],e+1,2*n,2*i+1),s.push(v||[],e+1,2*n+1,2*i),s.push(b||[],e+1,2*n+1,2*i+1)}}},C.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,o=i.debug;if(t<0||t>24)return null;var a=1<<t,s=L(t,e=(e%a+a)%a,n);if(this.tiles[s])return M(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,u=t,h=e,c=n;!l&&u>0;)u--,h=Math.floor(h/2),c=Math.floor(c/2),l=this.tiles[L(u,h,c)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,h,c),o>1&&console.time("drilling down"),this.splitTile(l.source,u,h,c,t,e,n),o>1&&console.timeEnd("drilling down"),this.tiles[s]?M(this.tiles[s],r):null):null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(122),o=n(20),a=n(7),s=n(17),l=n(1),u=n(40),h=n(76),c=n(19),f=function(){function t(t,e){e.accessKey&&c.MapSettings.setAccessKey(e.accessKey),this._mapView=new r.MapView(t,e),this._data=new h.MapData(this._mapView)}return Object.defineProperty(t.prototype,"mapView",{get:function(){return this._mapView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.enable3dMode=function(t){this.mapView.enable3dMode(t)},t.prototype.getBounds=function(t){return this.mapView.getBounds(t)},t.prototype.setTileUrl=function(t,e){void 0===e&&(e=!1),this.mapView.setTileUrl(t,e)},t.prototype.getTileUrl=function(t){return void 0===t&&(t=!1),this.mapView.getTileUrl(t)},t.prototype.setMinZoom=function(t){this.mapView.setMinZoom(t)},t.prototype.setMaxZoom=function(t){this.mapView.setMaxZoom(t)},t.prototype.getCamera=function(){var t=this.mapView.getCamera();return new s.CameraPosition(t.getTarget(),t.getTilt(),t.getBearing(),t.getZoom())},t.prototype.setCamera=function(t){console.warn("This function is deprecated and will be removed in the future. \n    Please use method moveCamera(position:ICameraPosition, animationOptions: AnimationOptions)"),this.moveCamera(t)},t.prototype.setWeather=function(t){this.mapView.setWeather(t)},t.prototype.getWeather=function(){return this.mapView.getWeather()},t.prototype.panBy=function(t,e){var n=a.Point.convert(t),i=l.MapUtils.pointToPixel(n);this.mapView.panBy(i,e)},t.prototype.panTo=function(t,e){this.mapView.panTo(i.LatLng.convert(t),e)},t.prototype.flyTo=function(t,e,n){console.warn("This function is deprecated and will be removed in the future. \n    Please use method moveCamera(position:ICameraPosition, animationOptions: AnimationOptions)");var i=new s.CameraPosition;i.setTarget(t),i.setZoom(e),this.moveCamera(i,n)},t.prototype.moveCamera=function(t,e){this.mapView.moveCamera(t,e)},t.prototype.fitBounds=function(t,e,n){this._mapView.fitBounds(o.LatLngBounds.convert(t),e,n)},t.prototype.getCameraWithBounds=function(t,e){return this._mapView.getCameraPositionForLatLngBounds(o.LatLngBounds.convert(t),e)},t.prototype.setSwitchMode=function(t){this.mapView.setSwitchMode(t)},t.prototype.addListener=function(t,e,n){return void 0===n&&(n={}),this.mapView.addListener(t,e,n)},t.prototype.setTime=function(t){this.setDate(t),console.warn("This function is deprecated and will be removed in the future. Please use setDate(date: Date) method")},t.prototype.setDate=function(t){this.mapView.setDate(t)},t.prototype.setInfoWindow=function(t){console.warn("This function is deprecated and will be removed in the future. Please use setInfoWindow(infoWindow: string | Node) method of Marker class instead")},t.prototype.setInfoContents=function(t){console.warn("This function is deprecated and will be removed in the future. Please use setInfoContents(infoContents: string | Node) method of Marker class instead")},t.prototype.flyToMyLocation=function(t){void 0===t&&(t=!0),console.warn("This function is deprecated and will be removed in the future. Please use moveToMyLocation(animate: boolean) method"),this.mapView.moveToMyLocation(t)},t.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),this.mapView.moveToMyLocation(t)},t.prototype.is3dMode=function(){return this.mapView.mapState.is3dMode()},t.prototype.is3DMode=function(){return console.warn("This function is deprecated and will be removed in the future. Please use is3dMode() method"),this.mapView.mapState.is3dMode()},t.prototype.getMinZoom=function(){return this.mapView.mapSettings.getMinZoom()},t.prototype.getPreferMinZoom=function(){return this.mapView.mapSettings.getPreferMinZoom()},t.prototype.getMaxZoom=function(){return this.mapView.mapSettings.getMaxZoom()},t.prototype.setMaxNativeZoom=function(t){if(null==t)throw Error("Parameter can not be null");return this.mapView.setMaxNativeZoom(t)},t.prototype.getMaxNativeZoom=function(){return this.mapView.getMaxNativeZoom()},t.prototype.setTimeEffect=function(t){this.mapView.setTimeEffect(t)},t.prototype.getTimeEffect=function(){return this.mapView.getTimeEffect()},t.prototype.setShadowEffect=function(t){this.mapView.setShadowEffect(t)},t.prototype.setWaterEffect=function(t){this.mapView.setWaterEffect(t)},t.prototype.showMapObject=function(t){console.warn("This function is deprecated and will be removed in the future. Please use setObjectsEnabled(enabled: boolean) method instead"),this.mapView.setObjectsEnabled(t)},t.prototype.isShowMapObject=function(){return console.warn("This function is deprecated and will be removed in the future. Please use isObjectsEnabled() method instead"),this.mapView.isObjectsEnabled()},t.prototype.setObjectsEnabled=function(t){this.mapView.setObjectsEnabled(t)},t.prototype.isObjectsEnabled=function(){return this.mapView.isObjectsEnabled()},t.prototype.setPlacesEnabled=function(t){this.mapView.setPlacesEnabled(t)},t.prototype.isPlacesEnabled=function(){return this.mapView.isPlacesEnabled()},t.prototype.setFilterPlaces=function(t){this.mapView.setFilterPlaces(t)},t.prototype.getFilterPlaces=function(){return this.mapView.getFilterPlaces()},t.prototype.setFilterObjects=function(t){this.mapView.setFilterObjects(t)},t.prototype.getFilterObjects=function(){return this.mapView.getFilterObjects()},t.prototype.setSelectedObjects=function(t){this.mapView.setSelectedObjects(t)},t.prototype.getSelectedObjects=function(){return this.mapView.getSelectedObjects()},t.prototype.setSelectedPlace=function(t){this.mapView.setSelectedPlace(t)},t.prototype.getSelectedPlace=function(){return this.mapView.getSelectedPlace()},t.prototype.setHiddenObject=function(t){this.mapView.setHiddenObject(t)},t.prototype.setUnhiddenObject=function(t){this.mapView.setUnhiddenObject(t)},t.prototype.getMapObjectById=function(t){var e=this.mapView.getBuildingResourceManager().getBuilding(t);if(e||(e=this.mapView.getBuildingResourceManager().getHiddenBuilding(t)),e){var n=new u.MapObject;return n.initWithBuilding(e),n}var i=this.mapView.getCustomBuildingManager().getMapObjects().get(t);return i&&i.mapObject},t}();e.Map4D=f},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(123),o=n(9),a=n(124),s=n(2),l=n(41),u=n(131),h=n(132),c=n(133),f=n(134),p=n(156),d=n(19),g=n(217),m=n(5),y=n(79),v=n(42),b=n(229),_=n(4),w=n(0),M=n(230),x=n(12),A=n(8),T=n(1),S=n(239),E=n(20),C=n(17),L=n(240),P=n(13),I=n(241),O=n(242),R=n(117),k=n(65),D=n(21),B=n(243),U=n(39),j=n(249),F=n(253),N=n(254),Z=n(255),V=n(256),z=n(257),W=n(75),Y=n(59),G=n(49),H=n(258),X=n(259),J=n(260),q=n(31),Q=n(66),K=n(263),$=n(265),tt=n(44),et=n(266),nt=n(26),it=n(15),rt=function(t){function e(e,n){var i=t.call(this)||this;i.clientContainer=e,i.gl=null,i.disableShadowMapByTime=!1,i.defaultMapOptions={center:[-1,-1],zoom:12,minZoom:w.MapConstants.defaultMinZoom,maxZoom:w.MapConstants.defaultMaxZoom,maxNativeZoom:w.MapConstants.defaultMaxNativeZoom,geolocate:!1,controls:!1,controlOptions:Y.ControlOptions.BOTTOM_RIGHT,tilt:0,bearing:0,switchMode:G.SwitchMode.Manual},i.defaultAnimationOptions={duration:null,easing:null,animate:!1},i.defaultPaddingOptions={top:0,bottom:0,left:0,right:0};var r={};return T.MapUtils.extendOptions(r,i.defaultMapOptions,n),i.options=r,i.container=l.DOMUtils.create("div","mf-map4d",i.clientContainer),i.createStyleNode(),i.init(),i.createMapControlNode(i.container,i.options),i.createLogoNode(i.container),i}return i(e,t),e.prototype.init=function(){this.setupMapViews(this.container,this.options),this.setupComponents(this.options),this.renderTaskQueue=new Z.TaskQueue,this.loop()},e.prototype.requestRenderFrame=function(t){return this.dirty=!0,this.renderTaskQueue.add(t)},e.prototype.cancelRenderFrame=function(t){this.renderTaskQueue.remove(t)},e.prototype.loop=function(){var t=this,e=Date.now();this.resize(),this.dirty&&(this.dirty=!1,this.update(),this.render()),(this.weatherManager.dirty()||this.timeEffectManager.dirty()||this.mapState.dirty()||this.effectManager.dirty()&&this.mapState.is3dMode()||this.buildingResourceManager.dirty())&&(this.dirty=!0);var n=1e3/w.MapConstants.FPS-(Date.now()-e);n>0&&!this.mouseEventHandler.isHandling?setTimeout(function(){requestAnimationFrame(t.loop.bind(t))},n):requestAnimationFrame(this.loop.bind(this))},e.prototype.update=function(){var t=this;this.cameraAnimation.updateTransitions(),this.annotationManager.update(),this.geoJsonManager.update(),this.layers.forEach(function(e){e.update(t.mapState)}),this.mapSettings.is3dMode()&&(this.weatherManager.update(),this.mapState.getTilt()>w.MapConstants.maxTiltIntersectWithScreen&&this.skyObject.updateMatrices(this.mapState)),!this.effectManager.enableShadowEffect||this.disableShadowMapByTime||this.timeEffectManager.getTimeEffect()!=W.TimeEffect.Evening&&!this.timeEffectManager.isEveningTime()?this.disableShadowMapByTime&&this.timeEffectManager.getTimeEffect()!=W.TimeEffect.Evening&&!this.timeEffectManager.isEveningTime()&&(this.disableShadowMapByTime=!1,this.effectManager.enableShadowEffect=!0):(this.disableShadowMapByTime=!0,this.effectManager.enableShadowEffect=!1),this.compassImage&&(this.compassImage.style.transform="rotate("+this.mapState.getBearing()+"deg)")},e.prototype.resize=function(){if(null!=this.canvas){T.MapUtils.pixelScale=window.devicePixelRatio||1;var t=this.canvas.offsetWidth*T.MapUtils.pixelScale,e=this.canvas.offsetHeight*T.MapUtils.pixelScale;this.width==t&&this.height==e||(this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.mapState.setScreenSize(this.width,this.height),this.weatherManager.resize(t,e),this.effectManager.resize(t,e),null!=this.frameBuffer&&(this.frameBuffer.destroy(),this.frameBuffer=null),this.frameBuffer=new R.FrameBuffer(this.gl,this.width,this.height),this.tileManager.updateVisibleTiles(),this.buildingLayer.setDirty(),this.mapsEventManager.notify(U.MapEvent.boundsChanged),this.placement.updatePlacement(),this.dirty=!0)}},e.prototype.render=function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this.mapRenderer.render(),this.renderTaskQueue.run(),this.mapSettings.is3dMode()&&(t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.buildingIconSelectionManager.render(this.mapState),this.weatherManager.render(this.mapState),t.disable(t.BLEND))},e.prototype.renderSelection=function(){var t=this.gl;t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.renderSelection();var e=o.Color.fromHex(this.mapState.is3dMode()?w.MapConstants.mapBackgroundColor3D:w.MapConstants.mapBackgroundColor2D);t.clearColor(e.red,e.green,e.blue,1)},e.prototype.getSelectionCode=function(t){if(null!=this.frameBuffer){this.frameBuffer.bind(),this.renderSelection();var e=new Uint8Array([0,0,0,0]);this.gl.readPixels(t.x,this.height-t.y,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);var n=e[0],i=e[1],r=e[2];return this.frameBuffer.unbind(),n<<16|i<<8|r}return-1},e.prototype.createLayer=function(t,e,n){if(this.layers.has(t))return console.log("Cannot create layer which layer id already exist"),null;var i=M.LayerFactory.createLayer(t,e,this.tileManager,n);return null!=i?(this.mapRenderer.addLayer(i),this.layers.set(t,i),i):null},e.prototype.removeLayer=function(t,e){this.mapRenderer.removeLayer(t,e),this.layers.delete(t)},e.createCameraAnimationOptions=function(t){var e=new y.CameraAnimationOptions;if(t.animate){if(null!=t.duration&&t.duration<0)throw new Error("Animation duration must be greater or equal to 0");e.easing=t.easing}return e.duration=t.duration,e.gesture=!1,e},e.prototype.panBy=function(t,n){n=T.MapUtils.extendOptions({},this.defaultAnimationOptions,n),this.cameraAnimation.moveBy(t,e.createCameraAnimationOptions(n))},e.prototype.panTo=function(t,n){null==(n=T.MapUtils.extendOptions({},this.defaultAnimationOptions,n)).duration&&(n.duration=T.MapUtils.getTimePanTo(this.mapState.getTarget(),t,this.mapState.getZoom())),this.cameraAnimation.moveTo({target:t,zoom:this.mapState.getZoom()},e.createCameraAnimationOptions(n))},e.prototype.moveCamera=function(t,n){var i=C.CameraPosition.convert(t),r=new y.CameraOptions;if(null!=i.getZoom()?r.zoom=x.MathUtils.clamp(i.getZoom(),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()):r.zoom=this.mapState.getZoom(),null!=i.getTilt()){var o=(a=r.zoom||this.mapState.getZoom())<w.MapConstants.defaultMinZoom3d?w.MapConstants.maxTilt2D:this.mapSettings.getPreferMaxTilt();r.tilt=x.MathUtils.clamp(i.getTilt(),this.mapSettings.getMinTilt(),o)}else{var a=r.zoom||this.mapState.getZoom();r.tilt=this.mapSettings.getPreferMaxTilt()==w.MapConstants.maxTilt2D||a<w.MapConstants.defaultMinZoom3d?0:w.MapConstants.maxTilt2D}var l=i.getBearing();if(r.bearing=null!=l?l:this.mapState.getBearing(),r.target=i.getTarget()||this.mapState.getTarget(),null!=n&&n.animate){var u=this.latLngToScreenCoordinate(r.target),h=new s.Vector2(this.mapState.screenWidth/2,this.mapState.screenHeight/2),c=x.MathUtils.distance(u,h);n=T.MapUtils.extendOptions({},this.defaultAnimationOptions,n),c<h.x?(null==n.duration&&(n.duration=T.MapUtils.getTimePanTo(this.mapState.getTarget(),r.target,this.mapState.getZoom())),this.cameraAnimation.moveTo(r,e.createCameraAnimationOptions(n))):this.cameraAnimation.flyTo(r,e.createCameraAnimationOptions(n))}else this.cameraAnimation.moveTo(r)},e.prototype.fitBounds=function(t,e,n){var i=this.getCameraPositionForLatLngBounds(t,e);this.moveCamera(i,n)},e.prototype.moveBy=function(t){this.cameraAnimation.moveBy(t,null,!0)},e.prototype.moveByVelocity=function(t){this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.cameraAnimation.moveByVelocity(t)},e.prototype.getCameraPositionForLatLngBounds=function(t,e){if((e=T.MapUtils.extendOptions({},this.defaultPaddingOptions,e)).top<0||e.bottom<0||e.left<0||e.right<0)throw new Error("Padding value must be greater or equal to 0");var n={top:e.top*T.MapUtils.pixelScale,bottom:e.bottom*T.MapUtils.pixelScale,left:e.left*T.MapUtils.pixelScale,right:e.right*T.MapUtils.pixelScale};return T.MapUtils.getCameraPositionForLatLngBounds(t,n,this.mapState,this.mapSettings)},e.prototype.setZoom=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var r=new y.CameraAnimationOptions;r.duration=n,r.gesture=i,t=x.MathUtils.clamp(t,this.mapSettings.getPreferMinZoom(),this.mapSettings.getMaxZoom()),this.cameraAnimation.zoom(t,e,r)},e.prototype.setTilt=function(t,e){void 0===e&&(e=!1),this.cameraAnimation.setTilt(t,e)},e.prototype.setBearing=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1),this.cameraAnimation.setBearing(t,e,n)},e.prototype.stopAnimation=function(){this.cameraAnimation.stopAnimation()},e.prototype.setTileUrl=function(t,e){this.mapSettings.getTileUrl(e)!==t&&(this.mapSettings.setTileUrl(t,e),e&&this.mapState.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear()),this.tileManager.reload())},e.prototype.getTileUrl=function(t){return this.mapSettings.getTileUrl(t)},e.prototype.setWeather=function(t){this.weatherManager.setWeather(t),this.dirty=!0},e.prototype.getWeather=function(){return this.weatherManager.getWeather()},e.prototype.enable3dMode=function(t){if(this.mapState.setForce2d(!t),this.mapState.enable3dMode(t)){this.mapState.getZoom()>=w.MapConstants.defaultMinZoom3d&&this.tileManager.reload(),t?this.mapState.getZoom()<w.MapConstants.defaultMinZoom3d&&this.moveCamera({target:this.mapState.getTarget(),zoom:w.MapConstants.defaultMinZoom3d}):(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear());var e=o.Color.fromHex(this.mapState.is3dMode()?w.MapConstants.mapBackgroundColor3D:w.MapConstants.mapBackgroundColor2D);this.gl.clearColor(e.red,e.green,e.blue,1)}},e.prototype.getBounds=function(t){if((t=T.MapUtils.extendOptions({},this.defaultPaddingOptions,t)).top<0||t.bottom<0||t.left<0||t.right<0)throw new Error("Padding value must be greater or equal to 0");t={top:t.top*T.MapUtils.pixelScale,bottom:t.bottom*T.MapUtils.pixelScale,left:t.left*T.MapUtils.pixelScale,right:t.right*T.MapUtils.pixelScale};var e=this.mapState.getScreenSize();if(!this.getCamera().getTarget()||!this.mapState.getZoom()||e.x<=0||e.y<=0)return null;var n=this.mapState.getTilt(),i=!1;n>w.MapConstants.maxTiltIntersectWithScreen&&(this.mapState.setTilt(w.MapConstants.maxTiltIntersectWithScreen),i=!0);var r=this.mapState.cameraPosition,o=A.GeometryUtils.screenCoordinateToLatLng(new s.Vector2(t.left,t.top),r,e).normalize(),a=A.GeometryUtils.screenCoordinateToLatLng(new s.Vector2(e.x-t.right,t.top),r,e).normalize();i&&this.mapState.setTilt(n);var l=A.GeometryUtils.screenCoordinateToLatLng(new s.Vector2(e.x-t.right,e.y-t.bottom),r,e).normalize(),u=A.GeometryUtils.screenCoordinateToLatLng(new s.Vector2(t.left,e.y-t.bottom),r,e).normalize();if(!l.valid()||!u.valid())return E.LatLngBounds.world();var h=new E.LatLngBounds;return h.extend(a).extend(u).extend(o).extend(l),h},e.prototype.getCurrentMousePosition=function(t){return new s.Vector2((t.clientX-this.canvas.getBoundingClientRect().left)*T.MapUtils.pixelScale,(t.clientY-this.canvas.getBoundingClientRect().top)*T.MapUtils.pixelScale)},e.prototype.hideInfoWindow=function(t){this.annotationManager.hideInfoWindow(t)},e.prototype.isInfoWindowShown=function(t){return this.annotationManager.isInfoWindowShown(t)},e.prototype.showInfoWindow=function(t){this.annotationManager.showInfoWindow(t)},e.prototype.setMinZoom=function(t){this.mapSettings.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.mapSettings.setMaxZoom(t)},e.prototype.setDataLayerMinZoom=function(t){this.dirty=!0,this.mapSettings.dataLayerMinZoom=t},e.prototype.setDataLayerMaxZoom=function(t){this.dirty=!0,this.mapSettings.dataLayerMaxZoom=t},e.prototype.getDataLayerMinZoom=function(){return this.mapSettings.dataLayerMinZoom},e.prototype.getDataLayerMaxZoom=function(){return this.mapSettings.dataLayerMaxZoom},e.prototype.setMaxNativeZoom=function(t){t=x.MathUtils.clamp(t,w.MapConstants.defaultMinZoom,w.MapConstants.defaultMaxZoom),this.getMaxNativeZoom()!=t&&(this.mapSettings.setMaxNativeZoom(t),this.tileManager.reload(),this.annotationManager.clearShapeIndexer())},e.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},e.prototype.addTileArea=function(t){return this.tileAreaManager.addTileArea(t)},e.prototype.removeTileArea=function(t){this.tileAreaManager.removeTileArea(t)},e.prototype.addAnnotation=function(t){return this.dirty=!0,this.annotationManager.addAnnotation(t)},e.prototype.updateAnnotationZIndex=function(t,e,n){this.annotationManager.updateAnnotationZIndex(t,e,n),this.dirty=!0},e.prototype.updateAnnotation=function(t,e){void 0===e&&(e=!1),this.annotationManager.updateAnnotation(t,e),this.dirty=!0},e.prototype.removeAnnotation=function(t){this.annotationManager.removeAnnotation(t),this.dirty=!0},e.prototype.addMapObject=function(t){this.customBuildingManager.addMapObject(t),this.dirty=!0},e.prototype.removeMapObject=function(t){this.customBuildingManager.removeMapObject(t),this.dirty=!0},e.prototype.screenCoordinateToLatLng=function(t,e){return void 0===e&&(e=0),e=this.mapState.is3dMode()?e:0,A.GeometryUtils.screenCoordinateToLatLng(t,this.mapState.cameraPosition,this.mapState.getScreenSize(),e)},e.prototype.latLngToScreenCoordinate=function(t,e){return void 0===e&&(e=0),e=this.mapState.is3dMode()?e:0,A.GeometryUtils.latLngToScreenCoordinate(t,e,this.mapState.cameraPosition,this.mapState.getScreenSize())},e.prototype.getCamera=function(){return this.mapState.getCamera()},e.prototype.setSwitchMode=function(t){this.mapState.setSwitchMode(t)},e.prototype.setShadowEffect=function(t){this.disableShadowMapByTime=!1,this.effectManager.enableShadowEffect=t,this.dirty=!0},e.prototype.setWaterEffect=function(t){this.effectManager.enableWaterEffect=t,this.dirty=!0},e.prototype.setObjectsEnabled=function(t){this.mapSettings.objectsEnabled!=t&&(this.mapSettings.objectsEnabled=t,this.mapState.is3dMode()&&(t?this.tileManager.readdBuildings():this.buildingResourceManager.removeBuildings(function(t){var e=t.getBuildingType();return e!=q.BuildingType.External&&e!=q.BuildingType.ExternalExtrude}),this.effectManager.shadowMap.clear(),this.dirty=!0))},e.prototype.isObjectsEnabled=function(){return this.mapSettings.objectsEnabled},e.prototype.setPlacesEnabled=function(t){this.mapSettings.placesEnabled!=t&&(!0===t&&this.placement.updatePlacement(),this.dirty=!0,this.mapSettings.placesEnabled=t)},e.prototype.isPlacesEnabled=function(){return this.mapSettings.placesEnabled},e.prototype.reload=function(){this.tileManager.reload()},e.prototype.setupComponents=function(t){var e=this,n={};T.MapUtils.extendOptions(n,this.defaultMapOptions,t),P.ResourceManager.getInstance(this.gl),Q.TextLabelFactory.getInstance(this.gl),tt.TextLabelResourceManager.getInstance(this.gl),this.layers=new Map,this.httpTaskManager=new p.TaskManager,this.mapsEventManager=new L.MapsEventManager(this),this.mapSettings=new d.MapSettings(this),this.mapState=new c.MapState(this.mapSettings),this.timeEffectManager=new N.TimeEffectManager(this.mapState),this.mapRenderer=new g.MapRenderer(this.gl,this.mapState),this.skyRenderer=new z.SkyRenderer(this.gl,this.timeEffectManager),this.cameraAnimation=new y.CameraAnimation(this.mapState,this,this.mapSettings),this.dirty=!0,this.mapObserver=new u.MapObserver,this.mapState.setScreenSize(this.width,this.height),this.mapState.setBearing(n.bearing),this.mapState.setTarget(_.LatLng.convert(n.center)),this.mapState.setZoom(n.zoom),this.mapSettings.setMinZoom(n.minZoom),this.mapSettings.setMaxZoom(n.maxZoom),this.mapSettings.setMaxNativeZoom(n.maxNativeZoom),n.zoom>=w.MapConstants.defaultMinZoom3d&&n.tilt>w.MapConstants.maxTilt2D?(n.tilt=x.MathUtils.clamp(n.tilt,w.MapConstants.minTilt,w.MapConstants.maxTilt3D),this.mapState.setTilt(n.tilt),this.mapState.enable3dMode(!0)):(n.tilt=x.MathUtils.clamp(n.tilt,w.MapConstants.minTilt,w.MapConstants.maxTilt2D),this.mapState.setTilt(n.tilt));var i=function(){e.dirty=!0};D.SymbolResourceManager.getInstance(this.gl).setRequestRender(i),this.buildingIconSelectionManager=new X.BuildingIconSelectionManager(this.gl,this),this.buildingResourceManager=new O.BuildingResourceManager(this.gl,this.httpTaskManager,this.mapState,this.mouseEventHandler,i),this.customBuildingManager=new J.CustomBuildingManager(this.buildingResourceManager,this.mapState,this.httpTaskManager,i);this.tileManager=new f.TileManager(this,this.httpTaskManager,this.mapState,this.mapSettings,this.buildingResourceManager,this.buildingIconSelectionManager,this.customBuildingManager,function(t){return new I.AnnotationTile(t,e.annotationManager,e.gl)},i),this.tileAreaManager=new b.TileAreaManager(this.tileManager),this.customBuildingManager.setTileManager(this.tileManager);var r=this.createLayer("1.rasterLayer",m.LayerType.RASTER,w.MapConstants.baseMapLowestOrder);this.vectorPointLayer=this.createLayer(f.TileManager.pointLayerId,m.LayerType.SYMBOL,w.MapConstants.baseMapLowestOrder),this.createLayer(K.GeoJsonManager.geoJsonLayerId,m.LayerType.GEOJSON,w.MapConstants.baseMapLowestOrder),this.userVectorPointLayer=this.createLayer(f.TileManager.userPointLayerId,m.LayerType.SYMBOL,w.MapConstants.userFeatureLayerOrder),this.buildingLayer=this.createLayer("2.buildingLayer",m.LayerType.BUILDING,w.MapConstants.buildingLayerOrder),this.buildingLayer.setBuildingResourceManager(this.buildingResourceManager),this.placement=new $.Placement(this.gl,this.mapState,this.mapSettings),this.featureManager=new et.FeatureManager(this.gl,this.tileManager,this.mapState);var o=new j.LightingManager(this.timeEffectManager);this.buildingLayer.timeEffectManager=this.timeEffectManager,this.buildingLayer.setLightingManager(o);var a=new F.ShadowMap(this.gl,o.sunLight,this.mapState);this.effectManager=new H.EffectManager(a),this.mapRenderer.setEffectManager(this.effectManager),r.effectManager=this.effectManager,r.timeEffectManager=this.timeEffectManager,r.setLightingManager(o),this.buildingLayer.effectManager=this.effectManager,this._annotationManager=new v.AnnotationManager(this,this.tileManager),this.weatherManager=new B.WeatherManager(this.gl,this.mapState,this.httpTaskManager),o.setOnLightPositionChanged(function(){a.updateMatrices()}),this.geoJsonManager=new K.GeoJsonManager(this),this.skyObject=new V.SkyObject,r.skyObject=this.skyObject,r.skyRenderer=this.skyRenderer,this.frameBuffer=new R.FrameBuffer(this.gl,this.width,this.height),this.canvas.width=this.width,this.canvas.height=this.height,this.dirty=!0,this.tileManager.updateVisibleTiles()},e.prototype.createStyleNode=function(){var t=document.getElementsByTagName("head")[0],e=t.getElementsByClassName("map-style");if(!(e&&e.length>0)){var n=document.createElement("style");n.innerHTML=r.Style.content,n.className="map-style",t.appendChild(n)}},e.prototype.setupMapViews=function(t,n){var i=l.DOMUtils.create("div","mf-mapgl",t);this.mapContainer=i,this.canvas=l.DOMUtils.create("canvas","",i),this.gl=this.canvas.getContext("experimental-webgl",{stencil:!0}),++e.idContextCounting,this.gl.id=e.idContextCounting.toString();var r=o.Color.fromHex(w.MapConstants.mapBackgroundColor2D);this.gl.clearColor(r.red,r.green,r.blue,r.alpha),this.gl.stencilOp(this.gl.KEEP,this.gl.REPLACE,this.gl.REPLACE),T.MapUtils.pixelScale=window.devicePixelRatio||1,this.width=this.canvas.offsetWidth*T.MapUtils.pixelScale,this.height=this.canvas.offsetHeight*T.MapUtils.pixelScale,this.mouseEventHandler=new a.MouseEventHandler(this.canvas,this),window.addEventListener("resize",this.resize,!1)},e.prototype.createMapControlNode=function(t,e){var n=l.DOMUtils.create("div","mf-ui "+r.Style.getStyleForControlOptions(e.controlOptions),t),i=null,o=null;e.geolocate&&(this.geolocateControl=new S.GeolocateControl(this)),e.controls&&(i=l.DOMUtils.create("div","vertical",n),this.geolocateControl&&this.geolocateControl.updateMapUI(i),this.zoomInButton=l.DOMUtils.create("div","mf-button",i),this.zoomInButton.innerHTML="<a class='mf-zoom-in-icon'></a>",this.zoomOutButton=l.DOMUtils.create("div","mf-button",i),this.zoomOutButton.innerHTML="<a class='mf-zoom-out-icon'></a>",this.modeButton=l.DOMUtils.create("div","mf-button",i),this.modeButton.innerHTML="<a class='mf-mode-icon'></a>",o=l.DOMUtils.create("div","horizontal",n),this.bearingButton=l.DOMUtils.create("div","mf-button",o),this.compassImage=l.DOMUtils.create("a","mf-direct-icon",this.bearingButton),this.compassImage.style.transform=null),this.addControlEvents()},e.prototype.createLogoNode=function(t){var e=this.options.controlOptions==Y.ControlOptions.BOTTOM_LEFT?"mf-right":"mf-left",n=l.DOMUtils.create("div","mf-logo-container "+e,t),i=k.Images.get("logoIcon");n.innerHTML="<a target='_blank' href='https://www.map4d.vn/' aria-label='Map4D Logo'>\n      <img src="+i+" class='mf-logo'/>\n      </a>"},e.prototype.addControlEvents=function(){var t=this;this.options.controls&&(this.zoomInButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()+1,new s.Vector2(t.width/2,t.height/2),0,!1)}),this.zoomOutButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()-1,new s.Vector2(t.width/2,t.height/2),0,!1)}),this.modeButton.addEventListener("click",function(){t.enable3dMode(!t.mapState.is3dMode())}),this.bearingButton.addEventListener("click",function(){t.moveCamera({target:t.mapState.getTarget(),bearing:0},{animate:!0})}))},e.prototype.addListener=function(t,e,n){return this.mapsEventManager.addEvent(t,e,n)},e.prototype.addGeoJsonListener=function(t,e){return this.mapsEventManager.addGeoJsonListener(t,e)},e.prototype.updateInfoContents=function(t){this.annotationManager.updateInfoContents(t)},e.prototype.notifyCameraWillChange=function(t){this.dirty=!0,this.mapsEventManager.notify(U.MapEvent.cameraWillChange,null,t)},e.prototype.notifyCameraIsChanging=function(){this.dirty=!0,this.mapsEventManager.notify(U.MapEvent.cameraChanging),this.mapsEventManager.notify(U.MapEvent.boundsChanged);var t=this.mapState.getForce2d();this.mapState.setForce2d(t&&this.mapState.getZoom()>=w.MapConstants.defaultMinZoom3d),this.buildingLayer.setDirty(),this.tileManager.updateVisibleTiles(),this.mapSettings.placesEnabled&&this.placement.updatePlacement()},e.prototype.notifyCameraDidChange=function(){this.dirty=!0,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.buildingLayer.setDirty(),this.tileManager.updateVisibleTiles(),this.mapState.handleSwitchMode(),this.mapsEventManager.notify(U.MapEvent.idle),this.mapState.willChange=!1},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e.prototype.queryMapObjectAndAnnotation=function(t){return this.annotationManager.queryMapObjectAndAnnotation(t)},e.prototype.queryFeature=function(t){return this.placement.queryFeature(t)},e.prototype.queryBuildingInfo=function(t){var e=this.getSelectionCode(t);return this.buildingLayer.getBuilding(e)},e.prototype.setDate=function(t){this.mapSettings.setDate(t),this.reload(),this.mapSettings.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear())},e.prototype.getMapContainer=function(){return this.mapContainer},e.prototype.destroy=function(){this.frameBuffer&&this.frameBuffer.destroy(),this.shader&&this.shader.destroy(),this.tileManager&&this.tileManager.destroy(),this.mapsEventManager&&this.mapsEventManager.destroy(),this.weatherManager&&this.weatherManager.destroy(),this.layers&&this.layers.clear(),this.buildingLayer&&this.buildingLayer.clear(),this.effectManager&&this.effectManager.destroy(),this.buildingIconSelectionManager&&this.buildingIconSelectionManager.destroy(),this.customBuildingManager&&this.customBuildingManager.destroy(),P.ResourceManager.releaseInstance(this.gl),D.SymbolResourceManager.releaseInstance(this.gl),Q.TextLabelFactory.releaseInstance(this.gl),tt.TextLabelResourceManager.releaseInstance(this.gl),this.gl=null,this.frameBuffer=null,this.effectManager=null},Object.defineProperty(e.prototype,"annotationManager",{get:function(){return this._annotationManager},enumerable:!0,configurable:!0}),e.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),this.geolocateControl&&this.geolocateControl.moveToMyLocation(t)},e.prototype.setTimeEffect=function(t){this.timeEffectManager.setTimeEffect(t),this.buildingLayer.setDirty(),this.dirty=!0},e.prototype.getTimeEffect=function(){return this.timeEffectManager.getTimeEffect()},e.prototype.setFilterPlaces=function(t){this.mapSettings.filterPlaceTypes=t,this.mapState.is3dMode()||(this.placement.updatePlacement(),this.dirty=!0)},e.prototype.getFilterPlaces=function(){return this.mapSettings.filterPlaceTypes},e.prototype.setFilterObjects=function(t){this.buildingLayer.filterObjectTypes=t,this.effectManager.shadowMap.clear(),this.dirty=!0},e.prototype.getFilterObjects=function(){return this.buildingLayer.filterObjectTypes},e.prototype.setSelectedObjects=function(t){this.buildingIconSelectionManager.deselectInfoWindow(),this.buildingLayer.setSelectedObjectIds(t),this.dirty=!0},e.prototype.setSelectedPlace=function(t){if(!t||!t.startsWith(w.MapConstants.placeSelectedIdPrefix)){var e=this.placement.getSelectedFeature();if(e!=t){if(e&&!this.featureManager.hasFeature(e)&&(this.featureManager.removeFeature(w.MapConstants.placeSelectedIdPrefix+e),this.placement.removeFeatures([w.MapConstants.placeSelectedIdPrefix+e])),!this.featureManager.hasFeature(w.MapConstants.placeSelectedIdPrefix+t)&&!this.featureManager.hasFeature(t)){var n=this.placement.getFeatures().get(t);if(null!=n&&null!=n.feature){var i=new Map,r=n.feature.properties;i.set("lat",r.get("lat")),i.set("lng",r.get("lng")),i.set("icon",r.get("icon")),i.set("name",r.get("name"));var o=new nt.VectorTileFeature(w.MapConstants.placeSelectedIdPrefix+t,it.GeometryType.Point,null,i);this.featureManager.addFeature(o)}}this.placement.setSelectedFeature(t),this.dirty=!0}}},e.prototype.getSelectedPlace=function(){return this.placement.getSelectedFeature()},e.prototype.setHiddenObject=function(t){this.buildingResourceManager.setHiddenObject(t),this.dirty=!0},e.prototype.setUnhiddenObject=function(t){this.buildingResourceManager.setUnhiddenObject(t),this.tileManager.updateVisibleTiles()},e.prototype.getSelectedObjects=function(){return this.buildingLayer.getSelectedObjectIds()},e.prototype.getBuildingSelectionIconManager=function(){return this.buildingIconSelectionManager},e.prototype.getBuildingResourceManager=function(){return this.buildingResourceManager},e.prototype.getCustomBuildingManager=function(){return this.customBuildingManager},e.prototype.getBuildingIconSelectionManager=function(){return this.buildingIconSelectionManager},e.prototype.getGeoJsonManager=function(){return this.geoJsonManager},e.prototype.getPlacement=function(){return this.placement},e.prototype.addFeature=function(t){this.featureManager.addFeature(t),this.dirty=!0},e.prototype.removeFeature=function(t){this.featureManager.removeFeature(t),this.dirty=!0},e.prototype.getFeatureManager=function(){return this.featureManager},e.prototype.onMapModeChanged=function(){this.mapsEventManager.notify(U.MapEvent.modeChanged),this.mapSettings.is3dMode()||(this.effectManager.shadowMap.clear(),this.buildingResourceManager.removeAllResources()),this.vectorPointLayer&&(this.vectorPointLayer.renderTiles.clear(),this.userVectorPointLayer.renderTiles.clear()),this.modeButton&&(this.modeButton.className=this.mapSettings.is3dMode()?"mf-button mf-mode-2d":"mf-button")},e.idContextCounting=0,e}(h.CameraAnimationObserver);e.MapView=rt},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(59),r=function(){function t(){}return t.getStyleForControlOptions=function(t){switch(t){case i.ControlOptions.TOP_LEFT:return"mf-ui-top-left";case i.ControlOptions.TOP_RIGHT:return"mf-ui-top-right";case i.ControlOptions.BOTTOM_LEFT:return"mf-ui-bottom-left";case i.ControlOptions.BOTTOM_RIGHT:return"mf-ui-bottom-right"}},t.bgColor="rgba(255,255,255,1)",t.size="29px",t.controlDistance="10px",t.content="\n.mf-map4d {\n  height: 100%;\n  width: 100%;\n  position: relative;\n  box-sizing: content-box;\n  overflow: hidden;\n}\n\n.mf-mapgl {    \n    position: absolute;\n    height: 100%;\n    width: 100%;\n    box-sizing: content-box;  \n  }\n  \n.mf-mapgl canvas {\n  width: inherit;\n  height: inherit;\n  position: absolute;\n  display: inherit;\n}\n\n.mf-map4d .mf-ui {\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n}\n\n.mf-map4d .mf-ui .vertical {\n  display: flex;\n  flex-direction: column;\n}\n\n.mf-map4d .mf-ui .horizontal {\n    display: block;\n    align-self: flex-end;\n    height: 35px;\n}\n\n.mf-ui.mf-ui-top-left {\n  top: "+t.controlDistance+";\n  left: "+t.controlDistance+";\n  flex-direction: inherit;\n}\n.mf-ui.mf-ui-top-right {\n  top: "+t.controlDistance+";\n  right: "+t.controlDistance+";\n  flex-direction: row-reverse;\n}\n.mf-ui.mf-ui-bottom-right {\n  bottom: "+t.controlDistance+";\n  right: "+t.controlDistance+";\n  flex-direction: row-reverse;\n}\n.mf-ui.mf-ui-bottom-left {\n  left: "+t.controlDistance+";\n  bottom: "+t.controlDistance+";\n  flex-direction: inherit;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-left .vertical {\n  flex-direction: column-reverse;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-left .horizontal {\n  align-self: flex-start;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .vertical {\n  flex-direction: column-reverse;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .horizontal {\n  align-self: flex-start;\n}\n\n.mf-map4d .mf-ui .mf-button {\n  margin: 3px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n    box-shadow: 0px 0px 4px #666;\n    background-color: #fff;\n  }\n\n.mf-map4d .mf-ui .mf-button:hover {\n    background-color: darken("+t.bgColor+", 5%);\n  }\n\n.mf-map4d .mf-ui .mf-button:active {\n    background-color: darken("+t.bgColor+', 10%);\n  }\n \n.mf-map4d .mf-ui.mf-ui-bottom-right .mf-location-box,\n.mf-map4d .mf-ui.mf-ui-bottom-left .mf-location-box {\n    margin-bottom: 9px;\n}\n\n.mf-map4d .mf-ui.mf-ui-top-right .mf-location-box,\n.mf-map4d .mf-ui.mf-ui-top-left .mf-location-box {\n    margin-top: 9px;\n}\n\n.mf-map4d .mf-ui a{\n  background-position: center !important;\n  background-repeat: no-repeat !important;\n  background-size: cover !important;\n  opacity: 0.5;\n  width: 29px;\n  height: 29px;\n}\n\n.mf-scrollbar::-webkit-scrollbar {\n  width: 10px;\n}\n \n.mf-scrollbar::-webkit-scrollbar-track {\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); \n  border-radius: 10px;\n}\n \n.mf-scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 10px;\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); \n  background-color: #555;\n}\n\n.mf-map4d .mf-ui .mf-zoom-in-icon { \n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMGSURBVHgB7ZrPTxNBFMdfjQm9CDWx0ioJShNJLyoeJHqAYNIL6gWihyaYKPGkN/8OT+rJoESjBxOOctCkDb2Uein2QKMJKRBIIZCw6sH2pPPdMussWaGlb0kznU+y6a9ZMp99b968LQ38EVAbcIzaBCOqG0ZUN4yobhhR3TCiumFEdcOI6oYR1Y3j5DOllXXKf12k0uoaWdYv+71gsIOi3aco3h+zj1DXCfKbgF9fpUAwnZm3Hw/i+tXLNDI8SMGODvILX0SzuQWa/Zxp6JxQVydN3hv3LbrsoulMjlLikCBNr4mIXbkYp1Co036vUqlSeXOL8oWiSOuiM9ZPWVZR68dPevps2nkd7++jsdsJW/Z/FL8t0eynjDi3tn7P956lBxPjxA1r1Z16M+M8h2Tyzi2XJIoRjkq1qoyLucbZxatQJG7YRDFBGRWk4Ghi2PW5ZYloP39tH+8+fHR9Fo2EaWRo0HmdzeWJGzZRbCGSgUtYj42tM1ReGdXy5ra9hjlhE90Qk5MgbSUyXXd2ow2qlYpnGg+IgiWpZ1tqBLaGQY1AtDtsP9bSddpj7LadwuBcbw9NTozVzouEnTGozJy0bAvILcoWUawvOTmko+xyEDHJ8sqaMzayG3W0gpIdkQHq3+OETRQTluuqvLEl9sMeu0GQaammMSTl+yryQoAzShpzwJa6auTSSmdUL2g21AIUOd2iotgeJJhwSYmOBBcDh5quktTcv4tzmO3pIFhbQLRy2S8L9nOssUcPk3X1rXv74yeP77OLslbdG6K7kWIoTC9evnfEvUC6vno745IE+cIiccN+94KiMyUmbykNAlpCNOvYJ2V1RjO/X1OAi6a2hc3iy/2ol+xh4JQN+PljDdyFpObm9xVGcRpNDFHx+5JnteaSDRzFr1Kwry6vrtNvkbKINvbXk+KIX+hzNQZYq16yybs3xdgYNcORiDbCXllsNbh5b5aW63XVVOWSBC0XUQmqMr594KJlRbkx/5LQDSOqG0ZUN4yobhhR3TCiumFEdaNtRP8C9QdgiPBj+C8AAAAASUVORK5CYII=);       \n}\n\n.mf-map4d .mf-ui .mf-zoom-out-icon { \n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALdSURBVHgB7ZrBTxNBFIdfjbH1INREpFUSlCaSXlQ8iJoIgaQX1AtEDyR4kL/Hk3oyGKIJF8NRDpq0oZdSL8Ue2GhCCgRSCCauerA96fy2mWVqyrbQt2QznS9p2Da7ZL6+N++9bRv6K6AO4BR1CEZUN4yobhhR3TCiumFEdcOI6oYR1Y3T5DOlzR0qfFmj0tY22fZv57VIJEzx3guUHEw4j2j3OfKbkF833hDMZFecv824d/smjY0OUyQcJr/wRTSXX6WlT9kjXRPt7qLZp1O+RZddNJPNU1o8JEjTuyJit64nKRrtcl6rVKpU3tunQtESaW255/opyypq//xFz1/Mu8+TgwM0+SjlyB6G9XWdlj5mxbW1/Xu1/zI9m5kiblir7tzbRfcYktOPH3pK1s5L1J3nFK+iRdywiWKBMipIwYnUaMvXxmM9NDYy7D7P5QvEDZsoWohk6Ab249H2GSqvjGp577uzhzlh66O7YnESpK1E9s7DiJw947aVIVGwcp9XnWNkSLy3h7hgE1UjIBdo26I4vZz3vO5Kfx/NzkzWrosdiKEycxLYEZBblC2i2F9ycZVq1U1HRMwLjIKSHyID1P/HCZsoFizHvfLuvuiHfc6AINOyFTY2t93jSzG+/QnYUleNXEaZjFoFw4Y6F8cuBlQU7UGCBZeU6LRCevngzTlOe2oGm6icaSUL7z+4A0QzkAHqNDR+/w5xw1p1x8V0IwdyFKZXrxfcvtgIpOubd4t1NwGgUFwjbtjvXtA758Ti1WhiJMSwjj4pqzOGea97Vbxp6ljYLr7cjzaSPQ6csiE/v9rHvksvr3gKo1pPpEbI+rbesFpzyYZO4jcM6KsbWzv0R6Qsoo3+el48ktcG6gYD7NVGstNPHohzE9QOoaD9WON/WbQa3Ly3S+BmXTVVuSRB4CIqQVXGpw9cBFaUG/OVhG4YUd0worphRHXDiOqGEdUNI6obRlQ3Okb0H+xvLgcbOwA8AAAAAElFTkSuQmCC);  \n}\n\n.mf-map4d .mf-ui .mf-location {\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMlSURBVHgB7Zo/a1NRGMbfiJAuthnUJlSsMWBNB9s4tKZgwaCCgw7tpKCDFZd+FidnK1hwEMyg4hKIWKExXZI6NFYwsaIktQGjLsmk5znJSU9i0lya9y6n57dcuDkH7nPef8+9xPNXQAeAQ3RAsEJNwwo1DSvUNKxQ07BCTcMKNQ0r1DSsUNM4TC5TrdUos56jwtY3Km7vUKXyR94fGPBSYPgoRSbGKTh6gnxDR8hNPG59SoHAVDpLq2tZqlZrPdfHZqcpOj1JA14vuYErQiu/ftOjJ8/FtR69UyJi5yfCFDw5Qj7foLxXLO1Q6UeZNjbz9HHzs7znGxqkhTvzrkSXXaguEg8+d+OyTM0991TEnuXdPW6IZRf64OFj+cCov7u352UtOgHpHX+ZoJyIMMQu3r/JmsasXffNSroZlW4i0YxQv+1g7dz1K/KAkBWror45Yeu6eLikEAoWOohEY0q+SzcbEw4DdXtJNCEF9ly7OktLy3FKiSY2w9ic2CJa2Pour+Gx06LhtNYXUvJ1YqWl+6qDWRK1qYN6Do6OyLWcUWUTmlnfkNfwWKj1/oecnKPdwAGpTFBEpyLy+kXMXi7YhP4UEQJ+UWM6ybfve+5FmuogoqC4XSYu2IQqxxMYPta8h/RTs3Qv5LrK7jpV306MhlNc9bqcD9ovbEJVA9IjAxfkZI6iA+sNTB2Q0xnsBDah/uP1lM1/bW0g0anJnnsjYszoqA7u18qgX9iEKpuXbXRfBcy6ai6dgEGIabMU5BreF6OKCzahGP5INUSj0DYW4JJgDHT/irW4h990MF8xksD4mRBxwep1MQ9hAwP+hs/1drKA9TGk3mLaUV4Z6QxLyAVr150R9YioFUtlir9IdPS0ENhNJByU8sqxixeIE/7XtH28ciFdnz57JQ0CUnrx3q3/bGS/uPPirYkFkXNhCp8Nyaak0hnRRuRTaxn5agbkwYiU5xYJ3PuUImYharbd3nUDYwjdl3N26njc/vsNopv7lJefTEri45huBjAnEWXUtlsCFR77PyPDsEJNwwo1DSvUNKxQ07BCTcMKNQ0r1DSsUNP4By5Rba+rOeGSAAAAAElFTkSuQmCC);    \n}\n\n.mf-map4d .mf-ui .mf-mode-icon { \n  background-image: url(data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSgBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/AABEIAB0AHQMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APqmgAoAKAPAP21f+SWaV/2Gov8A0RPQB75ceb5En2cIZtp2CQkLuxxnHOKAPPpNX1/TJdVtr3U4bmaGwNwGMCxGKT0QEDzF/wBrBH0rSyZN2T2l94g08aDe3uqx6haajLFDJC1ssRjMgGCCvXH+R6Kydw1PPf21f+SWaV/2Gov/AERPUFHvd1D9otpYS8kfmKV3xttZcjqD2NAHHnwVc3PmtqmtzXsotmtbd3hC+UGGCTg/Ofcmr5uyFYlsPCN4txpx1XXJL2009leC3W2WIBlxtJIJzjHehy7ILHl/7av/ACSzSv8AsNRf+iJ6gYf8NV+B/wDoFeJP/AeD/wCPUAH/AA1X4H/6BXiT/wAB4P8A49QAf8NV+B/+gV4k/wDAeD/49QB5f+0L8a/DnxH8F2WkaHZavBcw6gl2zXkUaoUWORSAVkY5y47etAH/2Q==);    \n}\n\n.mf-map4d .mf-ui .mf-button.mf-mode-2d .mf-mode-icon {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALcSURBVHgB7ZpBaxNBFIBfREg82C7S2IaKpl6kPVTjwVoPDYa2oJiCW3qwqAfFk7/Fm1cjFOmhYA5FLxZaUGiJHmI9GLwolpYktNBtekhyaudNSNlNJrvJm00P0/lgSbLsTObbmffebEjgiAFngHNwRtCiqqFFVUOLqoYWVQ0tqhpaVDW0qGpoUdU4D5JUqlXIF/bAOijxz6FQECL9YTB6L7q2W8/85G1FXGB9GEYPDF0bhFAwCH5AFsVBbrDBrn9nA640Dzg2OgyJ+N2Wwhs/smBZh+DF8I3r8HA67nnjvAhQfjPC2Vtc+gT54p7rdUZvD7x8Pisc5Ju379sSrZOYGIP77KBCitHFpc+ekgjekPTyF/CD1a8ZWGMHFdLSfZychNSHNF+yOGvmzCSPy32rBGvfMpD78/fk2n//d9ixzeLtimufuNTNmSneZ764C9lfOchu5hzXoGyUxa1XXyJIMxoZCMOLpyb/wtevnvBXnoTY+fm5R/y9HZRtF2yL/ZnJKeFSpc4qubxw2WdmkxSCCcSOZZWAAsYlZl47GDKtsrUbXamj5bJzIFgqqMRujjg+86Vd2IVO6YpooegcSOOsdMLQ1ea2+wftZ+s6votiDFm2gWCyoiSPOqLQoISCr6JYTlYbkkUiTq99iEiUgm+iKPlu4aPjXJTNJJYNqX4Fs0eR90UUsyDulBqX7CwrEbKI4vESIblJi6Jkis1k404J66lhyO1Pkezm76ZzA5fD0ClSoq0kH0xPsDrbB7JgOOAOyU6kv490A6WeXkSSuJu5d+cWyIK7KdE+eXwsBhRIoq0kMS4xeaSXV06eT+tg4XdLTDWxldr7rW3hkw3OJjW5kURTC2nh00ttqYlrXNSjlrq1RfAmzs8lgQpJtFytwGkyzkIB970yNVX6p5RugHvj2o5qEG6PjviSvQP6XymKoUVVQ4uqhhZVDS2qGlpUNbSoamhR1dCiqqFFVeMYfD4SpVZLd6IAAAAASUVORK5CYII=);\n}\n\n.mf-map4d .mf-ui .mf-direct-icon { \n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA6CAYAAADhu0ooAAAD6UlEQVR42u2Y608VRxjG+aL/gDHYals1aUtBoAiJ4g2lmqAJWjFiE0VMsV5jNJE2eKm0XnLUqkExKEFTG2krF6PU1hta1KgR5aKHY0UJahRN/ErKu5dZzuM75yCHAwQO8csumSd5s5vs7mR++8zM+86EhSkpKSkpKSkpKSkpKSkNdrW3txdxnOAolFfLssr4esrr9V7jqOG4G2pb/G6jbMOuoNs4jnL8zpAXJRzfP+T7RUHvtbzOC6GtfwzDiLYlKIAohmvqcK+SAau6PjcbHoJydkD7PhfmH6eBN2/C+2pPCLHflqAMls2RyR1M5WsGu1Igh20naHE5KDkNFDkJtHglzNt30c+PG27beVpTUzNE1/VPGTKH404nZJ3bS1kbQGMTQCMiGXg+jNKzcORi5PF4hvK8imDArexoXddnEopS0kGjYkHhDPr5RGhbdkF4Gp0Hy5CxDJnLkO6gufbgP2g//AyKnuqHlDEmAdqydTAvX3MeKEPuk2mhxw8oYTfnLQF9EhcAHREFmjEfetFJiFevDzoNdHuPldPNbv7oAo1PBn0QFQCVEZPETv8Es/aBM+dqDze/XhrsZufwjQct/BbGXxedDSo8j6Bt2w2Kne5fabuDfjgONDEF+v4jzhu+QQXC35dB6ctBH3/ZE/LdPI2cAm3dJoj6Bvu7ap064+t4kJtNT6G78kBxyX6g3kB9rkaDZi6AUV5hf1Cd00R3UKPqJuib7wJ5s6+IToK+8wCXhP+H29vRC1ehJczsBJXzTc8rZIBp/UPKkAvVktUw693OWpTE7Xvc8TX+YRkKqBzavCgZ5eecAyp3JHr+MVD8V6FBvouoKdD35MN60VLiDDfr3KDlXLyPjhsY6Eh2P2MNRD87GvssTIW/gSbN8efI7jAxnE+npoI+m9A7LD8zTpbaH1TcbwBlrWc34wOdHxUD+oL3n3MzoO89DKO4DNr2X0DT5/ld7Jp65I5m807I1GTvck9urCWAXIRkRE4GzVoALTsXRsUFiCfNvhQiXry8YZZw7k3NAEUkcg08LvBT0pbBvPSvvUF110F/gSBr2MTZ0FZmQyv4FWZ1ba8dN89XQluxETQhBfRRrB+Yh71xvNjmjp74E5S5Flp6FiS0eeU6RPPzPjstblbDcB3iTfkiHrqJvh9k5BfZu3iwGpsgXTIrq2DxMA35u+ZnMEoroK3N8dW9xrlL3o5tX33YYJSodUMWG6Ll1b52Xa+1LGuVLTs6kAPqPjfwQtxiyBVtbW0j7Xrcuep9h5s8b+I2XHxN45hjS9DW1tZh3LmN3Q/HBngcU8DfV3fE4zAlJSUlJSUlJSUlJSWlwaS37MjGJ48GqSYAAAAASUVORK5CYII=);     \n}\n\n.mf-map4d .mf-ui a:hover {\n  opacity: 1;  \n}\n\n.mf-logo-container {\n  position: absolute;\n  bottom: 10px;  \n}\n\n.mf-logo-container.mf-right {\n  right: 10px;\n}\n\n.mf-logo-container.mf-left {\n  left: 10px;\n}\n\n.mf-logo {\n  cursor: pointer;\n  width: 75px;\n  opacity: 1;\n}\n\n.mf-info-window-container {\n  position: relative;\n  display: inline-block;\n  transform: translateY(-5px);\n  border: 1px solid #ddd;\n  border-radius: 5px;\n}\n\n.mf-info-window-content:after, .mf-info-window-content:before {\n\ttop: 100%;\n\tleft: 50%;\n\tborder: solid transparent;\n\tcontent: " ";\n\theight: 0;\n\twidth: 0;\n\tposition: absolute;\n\tpointer-events: none;\n}\n\n.mf-info-window-content:after {\n\tborder-color: rgba(255, 255, 255, 0);\n\tborder-top-color: #ffffff;\n\tborder-width: 7px;\n\tmargin-left: -7px;\n}\n\n.mf-info-window-content:before {\n\tborder-color: rgba(221, 221, 221, 0);\n\tborder-top-color: #ddd;\n\tborder-width: 8px;\n\tmargin-left: -8px;\n}\n\n.mf-info-window-content p, h4{\n  margin-bottom: 0;\n  margin-top: 0;\n}\n\n.mf-info-window-content p:empty, h4:empty{\n  display: none;\n}\n\n.mf-info-window-content {\n  background-color: #ffffff;\n  overflow: auto;\n  max-width: 636px;\n  max-height: 298px;\n  text-align: left;\n  padding: 5px;\n}\n\n.mf-info-window-content h4{\n  font-family: Georgia, serif;\n  font-size: 14px;\n  font-weight: normal;\n  text-align: center;\n}\n\n.mf-info-window-content p{\n  font-family: Georgia, serif;\n  font-size: 12px;  \n}\n\n.mf-map4d .mf-ui .mf-button-mode {\n  position: fixed;\n  bottom: 130px;\n  right :13px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: '+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n.mf-iconview-marker-container {\n  position: absolute;\n  display: inline-block;\n  border: 1px solid #ddd;\n  border-radius: 5px;\n}\n",t}();e.Style=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,r,o=n(2),a=n(1),s=n(39),l=n(125),u=n(128),h=n(129),c=n(12);!function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Drag=2]="Drag",t[t.DragEnd=3]="DragEnd",t[t.Wheel=4]="Wheel",t[t.Move=5]="Move",t[t.Over=6]="Over",t[t.Out=7]="Out",t[t.Double=8]="Double",t[t.None=9]="None"}(i=e.MouseAction||(e.MouseAction={})),function(t){t[t.Left=0]="Left",t[t.Wheel=1]="Wheel",t[t.Right=2]="Right",t[t.None=3]="None"}(r=e.MouseButton||(e.MouseButton={}));var f=function(){function t(t,e){this.canvas=t,this.mapView=e,this.checkDragStart=!0,this.mouseOverTimeout=250,this.longClickTimeout=500,this.longClickIsCalled=!1,this.lastTimeTouch=0,this.currentTouchZoom=0,this.inertia=[],t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("wheel",this.mouseWheel.bind(this)),t.addEventListener("mouseover",this.mouseOver.bind(this)),t.addEventListener("mouseout",this.mouseOut.bind(this)),t.addEventListener("dblclick",this.doubleClick.bind(this)),t.addEventListener("contextmenu",function(t){return t.preventDefault()}),t.addEventListener("touchstart",this.touchStart.bind(this),!1),t.addEventListener("touchmove",this.touchMove.bind(this),!1),t.addEventListener("touchcancel",this.touchCancel.bind(this),!1),t.addEventListener("touchend",this.touchEnd.bind(this),!1),this.scrollZoomHandler=new l.ScrollZoomHandler(this.mapView),this.dragRotateHandler=new u.DragRotateHandler(this.mapView),this.dragPanHandler=new h.DragPanHandler(this.mapView),this._isHandling=!1}return t.prototype.touchStart=function(e){e.preventDefault();var n=e.touches.item(0);if(this.touchEvent=n,null!=n){if(e.touches.length<t.MAX_TOUCH_POINTS){n.button=r.Left;var i=Date.now(),o=i-this.lastTimeTouch;if(this.lastTimeTouch=i,o<t.TIME_DETECT_DOUBLE_TOUCH)return void this.doubleClick(n);this.handleGestureStop()}else{var a=e.touches.item(1),s=this.mapView.getCurrentMousePosition(n),l=this.mapView.getCurrentMousePosition(a);this.handleGestureStart(s.x,s.y,l.x,l.y),n.button=r.Right}this.mouseDown(n)}},t.prototype.touchMove=function(e){e.preventDefault();var n=e.touches.item(0);if(this.touchEvent=n,null!=n)if(e.touches.length<t.MAX_TOUCH_POINTS&&!this.isMultiTouch)n.button=r.Left,this.mouseMove(n);else if(e.touches.length>=t.MAX_TOUCH_POINTS){var i=e.touches.item(1),o=this.mapView.getCurrentMousePosition(n),a=this.mapView.getCurrentMousePosition(i);this.handleGesture(o.x,o.y,a.x,a.y)}},t.prototype.touchCancel=function(t){console.log("touch cancel")},t.prototype.touchEnd=function(t){if(t.preventDefault(),0==t.touches.length){var e=void 0;this.isMultiTouch?(e=r.Right,this.handleGestureStop()):e=r.Left;var n=new o.Vector2(this.touchEvent.clientX,this.touchEvent.clientY),i=new MouseEvent("mouseup",{view:window,bubbles:!0,cancelable:!0,clientX:n.x,clientY:n.y,button:e});this.mouseUp(i)}},t.prototype.doubleClick=function(t){this.longClickIsCalled=!1;var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.onDoubleClickEvent(e,t)||(this.mapView.mapsEventManager.notify(s.MapEvent.dblClick,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:i.Double,button:t.button}))},t.prototype.mouseOut=function(t){this.mouseOutside=!0,this.longClickIsCalled=!1,clearTimeout(this.longClickTimeoutHandler),clearTimeout(this.mouseOverTimeoutHandler);var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(s.MapEvent.mouseOut,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:i.Out,button:t.button}),this.mousePosition=null},t.prototype.mouseWheel=function(t){if(this.longClickIsCalled=!1,0!=t.deltaY){var e=this.mapView.getCurrentMousePosition(t);this.dispatch({dx:t.deltaX,dy:1===t.deltaMode?40*t.deltaY:t.deltaY,x:e.x,y:e.y,action:i.Wheel,button:t.button},t)}},t.prototype.mouseDown=function(t){var e=this;return window.getSelection&&(window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges()),this.longClickIsCalled=!1,this.mapView.stopAnimation(),this.mousePosition=this.mapView.getCurrentMousePosition(t),this.mouseDownPosition=this.mousePosition,this.mouseDownTime=Date.now(),t.button==r.Right?this.dragRotateHandler.onDragStart(this.mousePosition):this.dragPanHandler.onDragStart(this.mousePosition),this.dispatch({x:this.mousePosition.x,y:this.mousePosition.y,dx:0,dy:0,action:i.Down,button:t.button}),this.mapView.mapState.isStill()&&(clearTimeout(this.longClickTimeoutHandler),this.longClickTimeoutHandler=setTimeout(function(){t.button==r.Left&&(e.mapView.mapsEventManager.onLongClickEvent(e.mousePosition,t)||(e.longClickIsCalled=!0,e.mapView.mapsEventManager.notify(s.MapEvent.longClick,t)))},this.longClickTimeout)),this.preMouseDown=t,!1},t.prototype.mouseMove=function(t){var e=this;this.longClickIsCalled=!1,clearTimeout(this.longClickTimeoutHandler);var n=this.mapView.getCurrentMousePosition(t),o=null!=this.preMouseDown?this.preMouseDown.button:t.button;if(this.mousePosition){var a=n.subtract(this.mousePosition);if(this.mousePosition=n,0==a.x&&0==a.y)return;var l={x:n.x,y:n.y,dx:a.x,dy:a.y,action:i.Drag,button:o};o==r.Left&&this.dragPanHandler.onDrag(l);var u=this.dragPanHandler.draggableAnnotation||this.dragPanHandler.draggableObject;this.checkDragStart&&(u?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.dragStart,t,u):this.mapView.mapsEventManager.notify(s.MapEvent.dragStart,t),this.checkDragStart=!1),u?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.drag,t,u):this.mapView.mapsEventManager.notify(s.MapEvent.drag,t),this.dispatch(l)}else this.mapView.mapState.isStill()&&(clearTimeout(this.mouseOverTimeoutHandler),this.mouseOverTimeoutHandler=setTimeout(function(){var n=e.mapView.getCurrentMousePosition(t);e.mapView.mapsEventManager.onHoverEvent(n,t)||e.mapView.mapsEventManager.notify(s.MapEvent.hover,t,!1)},this.mouseOverTimeout)),this.mapView.mapsEventManager.notify(s.MapEvent.mouseMove,t),this.dispatch({x:n.x,y:n.y,dx:0,dy:0,action:i.Move,button:o});return!1},t.prototype.mouseOver=function(t){this.mouseOutside=!1,this.longClickIsCalled=!1;var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(s.MapEvent.mouseOver,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:i.Over,button:t.button})},t.prototype.mouseUp=function(e){clearTimeout(this.longClickTimeoutHandler);var n=this.mapView.getCurrentMousePosition(e);this.mouseUpTime=Date.now();var o=n.subtract(this.mouseDownPosition),a=this.mouseUpTime-this.mouseDownTime;if(o.length<1){if(this.dispatch({x:n.x,y:n.y,dx:0,dy:0,action:i.Up,button:e.button}),this.mapView.mapState.isStill()&&!this.longClickIsCalled)if(e.button==r.Left){var l=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onClickEvent(l,e)||this.mapView.mapsEventManager.notify(s.MapEvent.click,e)}else if(e.button==r.Right){l=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onRightClickEvent(l,e)||this.mapView.mapsEventManager.notify(s.MapEvent.rightClick,e)}}else{var u=this.dragPanHandler.draggableAnnotation||this.dragPanHandler.draggableObject;u?this.mapView.mapsEventManager.onDragEvent(s.MapEvent.dragEnd,e,u):this.mapView.mapsEventManager.notify(s.MapEvent.dragEnd,e),this.checkDragStart=!0,this.dispatch({x:n.x,y:n.y,dx:a<t.TIME_DRAG_DETECT?o.x:0,dy:a<t.TIME_DRAG_DETECT?o.y:0,action:i.DragEnd,button:e.button})}return this.mousePosition=null,this.preMouseDown=null,this.longClickIsCalled=!1,!1},t.prototype.dispatch=function(t,e){this.mouseEventHandler(t,e)},t.prototype.mouseEventHandler=function(t,e){switch(t.action){case i.Drag:t.button==r.Right&&this.dragRotateHandler.onDrag(t),this._isHandling=!0;break;case i.Wheel:this.scrollZoomHandler.onWheel(t,e),this._isHandling=!0;break;case i.DragEnd:t.button==r.Left&&this.dragPanHandler.onDragEnd(t),t.button==r.Right&&this.dragRotateHandler.onDragEnd(),this._isHandling=!1;break;case i.Double:if(t.button==r.Left){var n=this.mapView.mapState.getZoom()+1,a=new o.Vector2(t.x,t.y);this.mapView.setZoom(n,a,0,!0)}this._isHandling=!0;break;default:this._isHandling=!1}},Object.defineProperty(t.prototype,"isHandling",{get:function(){return this._isHandling},enumerable:!0,configurable:!0}),t.prototype.handleGestureStart=function(t,e,n,i){var r=n-t,a=i-e;this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]],this.touchX1Prev=t,this.touchY1Prev=e,this.touchX2Prev=n,this.touchY2Prev=i,this.anchorZoom=new o.Vector2((t+n)/2,(e+i)/2),this.touchPrevDistance=Math.sqrt(r*r+a*a),this.touchStartAngle=Math.atan2(a,r),this.isMultiTouch=!0,this.isMultiTouchZoom=!1,this.isMultiTouchTilt=!1},t.prototype.handleGesture=function(e,n,i,r){var o=i-e,s=r-n,l=Math.sqrt(o*o+s*s),u=e-this.touchX1Prev,h=n-this.touchY1Prev,c=i-this.touchX2Prev,f=r-this.touchY2Prev;if(this.touchX1Prev=e,this.touchY1Prev=n,this.touchX2Prev=i,this.touchY2Prev=r,u*c>=0&&h*f>0){var p=Math.max(h,f)/a.MapUtils.pixelScale;this.mapView.setTilt(this.mapView.mapState.cameraPosition.getTilt()-p,!0),this.isMultiTouchTilt=!0}if(this.currentTouchZoom=(l-this.touchPrevDistance)/a.MapUtils.pixelScale,Math.abs(this.currentTouchZoom)>t.STEP_DETECT_ZOOM){this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]];var d=1;return this.currentTouchZoom<0&&(d=-1),this.mapView.setZoom(this.mapView.mapState.getZoom()+d,this.anchorZoom,200),this.mapView.notifyCameraIsChanging(),this.touchPrevDistance=l,void(this.isMultiTouchZoom=!0)}var g=Math.atan2(s,o),m=g-this.touchStartAngle;if(Math.abs(m)>Math.PI/180&&!this.isMultiTouchZoom&&!this.isMultiTouchTilt){var y=this.mapView.mapState.getBearing()-180*m/Math.PI;this.inertia.push([Date.now(),-y]),this.mapView.setBearing(y,0,!0),this.mapView.notifyCameraIsChanging(),this.touchStartAngle=g}},t.prototype.handleGestureStop=function(){this.isMultiTouch=!1,this.isMultiTouchZoom=!1,this.isMultiTouchTilt=!1,this.currentTouchZoom=0;for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift();if(this.inertia.length>2){var n=t.length,i=t[n-1],r=t[n-2],o=i[1]-r[1]>0?1:-1,a=i[1]-r[1],s=3*Math.abs(a);Math.abs(s)>360&&(s=360),s*=o;var l=Math.abs(s)/90;l=c.MathUtils.clamp(l,.5,1),this.mapView.setBearing(this.mapView.mapState.getBearing()-s,l,!0)}},t.TIME_DRAG_DETECT=300,t.MAX_TOUCH_POINTS=2,t.STEP_DETECT_ZOOM=100,t.TIME_DETECT_DOUBLE_TOUCH=300,t}();e.MouseEventHandler=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(79),r=n(2),o=n(8),a=function(){function t(t){this._mapView=t,this._delta=0,this._enabled=!0,this.onTimeout=this.onTimeout.bind(this),this.onScrollFrame=this.onScrollFrame.bind(this)}return t.prototype.isEnabled=function(){return!!this._enabled},t.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0)},t.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},t.prototype.isActive=function(){return!!this._active},t.prototype.onWheel=function(t,e){if(this.data=t,this.isEnabled()){var n=Date.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n;var r=t.dy;0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this.onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._delta-=r,this.isActive()||this.start(t)),e.preventDefault()}},t.prototype.onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this.start(t)},t.prototype.start=function(t){this._delta&&(this._frameId&&(this._mapView.cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isTrackpad()&&this._finishTrackpadTimeout&&clearTimeout(this._finishTrackpadTimeout),this.isWheel()&&this._finishTimeout&&clearTimeout(this._finishTimeout),this._anchor=new r.Vector2(t.x,t.y),this._anchorLatLng=o.GeometryUtils.screenCoordinateToLatLng(this._anchor,this._mapView.mapState.cameraPosition,this._mapView.mapState.getScreenSize()),this._anchorLatLng.valid()||(this._anchorLatLng=this._mapView.mapState.getTarget()),this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)))},t.prototype.onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){if(0!==this._delta){var e=this.isWheel()&&Math.abs(this._delta)>4.000244140625?1/450:.01,n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);var i=null==this._targetZoom?this._mapView.mapState.scale:Math.pow(2,this._targetZoom);this._targetZoom=Math.min(this._mapView.mapSettings.getMaxZoom(),Math.max(this._mapView.mapSettings.getMinZoom(),Math.log2(i*n))),this.isWheel()&&(this._targetZoom>this._startZoom?this._targetZoom=Math.ceil(this._targetZoom):this._targetZoom<this._startZoom&&(this._targetZoom=Math.floor(this._targetZoom)),this._startZoom=this._mapView.mapState.getZoom(),this._easing=this.smoothOutEasing(200)),this._mapView.mapState.zoomIn=this._delta<0,this._mapView.mapState.zoomOut=this._delta>0,!this.isTrackpad||-1!=this._delta&&1!=this._delta||(this._mapView.mapState.zoomIn?this._targetZoom=Math.ceil(this._targetZoom):this._mapView.mapState.zoomOut&&(this._targetZoom=Math.round(this._targetZoom))),this._delta=0}var o=null==this._targetZoom?this._mapView.mapState.getZoom():this._targetZoom,a=this._startZoom,s=this._easing,l=!1;if(this.isWheel()&&a&&s){var u=Math.min((Date.now()-this._lastWheelEventTime)/200,1),h=s(u),c=a*(1-h)+o*h,f=new r.Vector2(this.data.x,this.data.y);this.setZoom(c,f,200),u<1?this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)):l=!0}else{f=new r.Vector2(this.data.x,this.data.y);this.setZoom(o,f),l=!0}l&&(this._active=!1,this.isWheel()&&(this._finishTimeout=setTimeout(function(){t._finishTimeout=null,t._targetZoom=null},200)))}},t.prototype.isWheel=function(){return"wheel"===this._type},t.prototype.isTrackpad=function(){return"trackpad"===this._type},t.prototype.setZoom=function(t,e,n){void 0===n&&(n=0),this._mapView.mapState.getZoom()!=t&&(this._mapView.setZoom(t,e,n),this._mapView.notifyCameraIsChanging())},t.prototype.smoothOutEasing=function(t){var e=i.bezier(.25,.1,.25,1);if(this._prevEase){var n=this._prevEase,r=(Date.now()-n.start)/n.duration,o=n.easing(r+.01)-n.easing(r),a=.27/Math.sqrt(o*o+1e-4)*.01,s=Math.sqrt(.0729-a*a);e=i.bezier(a,s,.25,1)}return this._prevEase={start:Date.now(),duration:t,easing:e},e},t}();e.ScrollZoomHandler=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by}return t.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},t.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},t.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},t.prototype.solveCurveX=function(t,e){var n,i,r,o,a,s;for(r=t,s=0;s<8;++s){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;if(a=this.sampleCurveDerivativeX(r),Math.abs(a)<1e-6)break;r-=o/a}if(i=1,(r=t)<(n=0))return n;if(r>i)return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},t.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t}();e.UnitBezier=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),r=n(0),o=function(){function t(t,e){this.dx=0,this.dy=0,this.timeConstant=t,this.initialSpeedRate=0,this.velocityRatioX=0,this.velocityRatioY=0,this.cameraAnimationObserver=e}return t.prototype.getDisplacement=function(t,e,n){return t*e*-Math.expm1(-n/t)},t.prototype.getDuration=function(e,n){return-e*Math.log(t.minTrackSpeed/n)},t.prototype.startFling=function(e,n){return e=i.MathUtils.clamp(e,r.MapConstants.flingMinVelocity,r.MapConstants.flingMaxVelocity),n=i.MathUtils.clamp(n,r.MapConstants.flingMinVelocity,r.MapConstants.flingMaxVelocity),e*=t.secToMs,n*=t.secToMs,this.initialSpeedRate=Math.sqrt(e*e+n*n),this.initialSpeedRate<t.minTrackSpeed?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.flingDuration=this.getDuration(this.timeConstant,this.initialSpeedRate),this.getDisplacement(this.timeConstant,this.initialSpeedRate,this.flingDuration)<t.minDisplacement?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.velocityRatioX=e/this.initialSpeedRate,this.velocityRatioY=n/this.initialSpeedRate,this.previousPositionX=0,this.previousPositionY=0,void(this.flingStart=Date.now())))},t.prototype.stopFling=function(){this.initialSpeedRate=0},t.prototype.isFlingInProgress=function(){return this.initialSpeedRate>0},t.prototype.trackMovement=function(){if(!this.isFlingInProgress())return!1;var t=Date.now()-this.flingStart;if(t>this.flingDuration)return this.stopFling(),this.cameraAnimationObserver.notifyCameraDidChange(),!1;var e=this.getDisplacement(this.timeConstant,this.initialSpeedRate,t),n=e*this.velocityRatioX,i=e*this.velocityRatioY;return this.dx=n-this.previousPositionX,this.dy=i-this.previousPositionY,this.previousPositionX=n,this.previousPositionY=i,!0},t.secToMs=.001,t.minTrackSpeed=.01,t.minDisplacement=20,t}();e.FlingTracker=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(12),o=function(){function t(t){this.inertia=[],this._mapView=t}return t.prototype.onDragStart=function(t){this.lastDragRotatePosition=new i.Vector2(t.x,t.y),this.inertia=[[Date.now(),this._mapView.mapState.getBearing()]]},t.prototype.onDrag=function(t){this.inertia.push([Date.now(),-t.x]);var e=.4*(this.lastDragRotatePosition.x-t.x),n=-.5*(this.lastDragRotatePosition.y-t.y);this._mapView.setBearing(this._mapView.mapState.getBearing()-e,0,!0),this._mapView.setTilt(this._mapView.mapState.cameraPosition.getTilt()-n,!0),this.lastDragRotatePosition=new i.Vector2(t.x,t.y)},t.prototype.onDragEnd=function(){if(this.drainInertiaBuffer(),this.inertia.length<2)this._mapView.notifyCameraDidChange();else{var t=this.inertia,e=t.length,n=t[e-1],i=t[e-2],o=n[1]-i[1]>0?1:-1,a=n[1]-i[1],s=3*Math.abs(a);Math.abs(s)>360&&(s=360),s*=o;var l=Math.abs(s)/90;l=r.MathUtils.clamp(l,.5,1),this._mapView.setBearing(this._mapView.mapState.getBearing()-s,l,!0)}},t.prototype.drainInertiaBuffer=function(){for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},t}();e.DragRotateHandler=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(1),o=n(0),a=n(7),s=n(40),l=n(32),u=n(33),h=n(52),c=n(6),f=n(50),p=function(){function t(t){this._mapView=t,this._targetStart=null}return t.prototype.onDragStart=function(t){if(this._draggableObjectId=null,this._draggableAnnotation=null,this._targetStart=this._mapView.screenCoordinateToLatLng(t),this._targetStart.valid()){var e=this._mapView.queryMapObjectAndAnnotation(t);null!=e&&(e instanceof l.Marker&&e.isDraggable()||e instanceof u.Polyline&&e.isDraggable()||e instanceof h.Polygon&&e.isDraggable()||e instanceof f.Circle&&e.isDraggable()?this._draggableAnnotation=e:e instanceof s.MapObject&&e.isDraggable()&&(this._draggableObjectId=e.getId()))}else this._targetStart=null},t.prototype.onDrag=function(t){var e=this,n=this._mapView.screenCoordinateToLatLng(new i.Vector2(t.x,t.y),0);if(n.valid())if(this._draggableObjectId){var o=n.subtract(this._targetStart),s=this._mapView.getBuildingResourceManager().getBuilding(this._draggableObjectId);if(null==s)return void(this._targetStart=n);var p=s.getLocation().add(o);this._mapView.getCustomBuildingManager().updateMapObjectLocation(this._draggableObjectId,p),this._mapView.getBuildingIconSelectionManager().updateBuilding(s),this._targetStart=n,this._mapView.dirty=!0}else if(this._draggableAnnotation){if(this._draggableAnnotation instanceof l.Marker){var d=this._draggableAnnotation,g=n.subtract(this._targetStart),m=d.getPosition().add(g);d.setPosition(m),this._targetStart=n}else if(this._draggableAnnotation instanceof u.Polyline){var y=this._draggableAnnotation,v=n.subtract(this._targetStart),b=y.getPath();b.forEach(function(t,e){var n=t.add(v);b[e]=n}),y.setPath(b),this._targetStart=n}else if(this._draggableAnnotation instanceof h.Polygon){var _=this._draggableAnnotation,w=_.getPaths(),M=[],x=this._mapView.mapState.getScale();w.forEach(function(t){var r=[];t.forEach(function(t){var o=c.ProjectionMercator.projectScale(n,x),a=c.ProjectionMercator.projectScale(e._targetStart,x),s=o.subtract(a),l=c.ProjectionMercator.projectScale(t,x);l=l.add(new i.Vector2(s.x,s.y));var u=c.ProjectionMercator.unproject(l,x);r.push(u)}),M.push(r)}),_.setPaths(M),this._targetStart=n}else if(this._draggableAnnotation instanceof f.Circle){var A=this._draggableAnnotation,T=n.subtract(this._targetStart),S=A.getCenter().add(T);A.setCenter(S),this._targetStart=n}}else{var E=new a.Point(-t.dx*r.MapUtils.pixelScale,t.dy*r.MapUtils.pixelScale);this._mapView.moveBy(E)}},t.prototype.onDragEnd=function(t){if(null==this._draggableAnnotation&&null==this._draggableObjectId){var e=new i.Vector2(-t.dx,t.dy).multiply(r.MapUtils.pixelScale);this._mapView.moveByVelocity(new i.Vector2(e.x,e.y).multiply(o.MapConstants.flingSpeedMultiply*r.MapUtils.pixelScale))}this._draggableObjectId=null,this._draggableAnnotation=null},Object.defineProperty(t.prototype,"draggableObject",{get:function(){if(!this._draggableObjectId)return null;var t=new s.MapObject,e=this._mapView.getBuildingResourceManager().getBuilding(this._draggableObjectId);return null==e?(this._draggableObjectId=null,null):(t.initWithBuilding(e),t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"draggableAnnotation",{get:function(){return this._draggableAnnotation},enumerable:!0,configurable:!0}),t}();e.DragPanHandler=p},function(t,e,n){"use strict";var i=Math.PI/180,r=180/Math.PI;function o(t){var e=a(t[0]+1,t[2]);return[a(t[0],t[2]),s(t[1]+1,t[2]),e,s(t[1],t[2])]}function a(t,e){return t/Math.pow(2,e)*360-180}function s(t,e){var n=Math.PI-2*Math.PI*t/Math.pow(2,e);return r*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))}function l(t,e,n){var i=d(t,e,n);return i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i}function u(t){return[[2*t[0],2*t[1],t[2]+1],[2*t[0]+1,2*t[1],t[2]+1],[2*t[0]+1,2*t[1]+1,t[2]+1],[2*t[0],2*t[1]+1,t[2]+1]]}function h(t){return t[0]%2==0&&t[1]%2==0?[t[0]/2,t[1]/2,t[2]-1]:t[0]%2==0&&!t[1]%2==0?[t[0]/2,(t[1]-1)/2,t[2]-1]:!t[0]%2==0&&t[1]%2==0?[(t[0]-1)/2,t[1]/2,t[2]-1]:[(t[0]-1)/2,(t[1]-1)/2,t[2]-1]}function c(t){return u(h(t))}function f(t,e){for(var n=0;n<t.length;n++)if(p(t[n],e))return!0;return!1}function p(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function d(t,e,n){var r=Math.sin(e*i),o=Math.pow(2,n);return[o*(t/360+.5),o*(.5-.25*Math.log((1+r)/(1-r))/Math.PI),n]}t.exports={tileToGeoJSON:function(t){var e=o(t);return{type:"Polygon",coordinates:[[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]]]}},tileToBBOX:o,getChildren:u,getParent:h,getSiblings:c,hasTile:f,hasSiblings:function(t,e){for(var n=c(t),i=0;i<n.length;i++)if(!f(e,n[i]))return!1;return!0},tilesEqual:p,tileToQuadkey:function(t){for(var e="",n=t[2];n>0;n--){var i=0,r=1<<n-1;0!=(t[0]&r)&&i++,0!=(t[1]&r)&&(i+=2),e+=i.toString()}return e},quadkeyToTile:function(t){for(var e=0,n=0,i=t.length,r=i;r>0;r--){var o=1<<r-1,a=+t[i-r];1===a&&(e|=o),2===a&&(n|=o),3===a&&(e|=o,n|=o)}return[e,n,i]},pointToTile:l,bboxToTile:function(t){var e=l(t[0],t[1],32),n=l(t[2],t[3],32),i=[e[0],e[1],n[0],n[1]],r=function(t){for(var e=0;e<28;e++){var n=1<<32-(e+1);if((t[0]&n)!=(t[2]&n)||(t[1]&n)!=(t[3]&n))return e}return 28}(i);return 0===r?[0,0,0]:[i[0]>>>32-r,i[1]>>>32-r,r]},pointToTileFraction:d}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.onMapWillChange=function(t){},t.prototype.onMapIsChanging=function(t){},t.prototype.onMapDidChange=function(t){},t}();e.MapObserver=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.prototype.notifyCameraWillChange=function(t){},t.prototype.notifyCameraIsChanging=function(){},t.prototype.notifyCameraDidChange=function(){},t}();e.CameraAnimationObserver=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(17),r=n(11),o=n(0),a=n(6),s=n(2),l=n(14),u=n(8),h=n(12),c=n(49),f=n(60),p=function(){function t(t){this.force2d=!1,this.scale=1,this.willChange=!1,this.zoomIn=!1,this.zoomOut=!1,this.panning=!1,this.flyingTo=!1,this.tilting=!1,this.bearing=!1,this.gesture=!1,this.mapSettings=t,this.cameraPosition=new i.CameraPosition([0,0],0,0,0)}return t.prototype.setScreenSize=function(t,e){this.screenWidth=t,this.screenHeight=e,this.recalculateMatrices()},t.prototype.matrixFor=function(t){var e=1<<t.getTileCoordinate().getZoom(),n=a.ProjectionMercator.worldSize(this.scale)/e,i=t.toVec2(),o=i.x*n+n/2,l=i.y*n+n/2,h=u.GeometryUtils.pixelCoordinateToCameraCoordinate(new s.Vector2(o,l),this.cameraPosition),c=r.Matrix4.translate(h.x,h.y,0);return c=r.Matrix4.scale(n/2,n/2,1).concat(c)},t.prototype.recalculateMatrices=function(){this.projectionMatrix=f.CameraUtils.calculateProjectionMatrix(this.screenWidth,this.screenHeight),this.orthoProjectionMatrix=f.CameraUtils.calculateOrthoProjectionMatrix(this.screenWidth,this.screenHeight);var t=f.CameraUtils.calculateViewMatrix(this.cameraPosition,this.screenHeight);this.viewProjectionMatrix=t.concat(this.projectionMatrix);var e=r.Matrix4.rotateX(this.cameraPosition.getTilt()).transform(new l.Vector3(0,0,1),0);this.cameraPositionVector=r.Matrix4.rotateZ(this.cameraPosition.getBearing()).transform(e,0)},t.prototype.setTarget=function(t){this.cameraPosition.setTarget(t),this.recalculateMatrices()},t.prototype.setTilt=function(t){this.cameraPosition.setTilt(t),this.recalculateMatrices()},t.prototype.setBearing=function(t){this.cameraPosition.setBearing(t),this.recalculateMatrices()},t.prototype.setZoom=function(t){this.cameraPosition.setZoom(t),this.scale=Math.pow(2,t),this.recalculateMatrices()},t.prototype.enable3dMode=function(t){if(t==this.mapSettings.is3dMode())return!1;if(!t){var e=h.MathUtils.clamp(this.getTilt(),this.getMinTilt(),o.MapConstants.maxTilt2D);this.setTilt(e)}return this.mapSettings.enable3dMode(t)},t.prototype.getProjectionMatrix=function(){return this.projectionMatrix},t.prototype.getViewProjectionMatrix=function(){return this.viewProjectionMatrix},t.prototype.getOrthoProjectionMatrix=function(){return this.orthoProjectionMatrix},t.prototype.getScreenSize=function(){return new s.Vector2(this.screenWidth,this.screenHeight)},t.prototype.getTilt=function(){return this.cameraPosition.getTilt()},t.prototype.getMinTilt=function(){return this.mapSettings.getMinTilt()},t.prototype.getMaxTilt=function(){return this.mapSettings.getMaxTilt()},t.prototype.getDistanceToSky=function(){return this.distanceToSky},t.prototype.setDistanceToSky=function(t){this.distanceToSky=t},t.prototype.getBearing=function(){return this.cameraPosition.getBearing()},t.prototype.getScale=function(){return this.scale},t.prototype.getZoom=function(){return this.cameraPosition.getZoom()},t.prototype.getTarget=function(){return this.cameraPosition.getTarget()},t.prototype.isGesture=function(){return this.gesture},t.prototype.isZoomIn=function(){return this.zoomIn},t.prototype.isZoomOut=function(){return this.zoomOut},t.prototype.isTilting=function(){return this.tilting},t.prototype.isBearing=function(){return this.bearing},t.prototype.isPanning=function(){return this.panning},t.prototype.isFlyingTo=function(){return this.flyingTo},t.prototype.isMoving=function(){return this.movingTo},t.prototype.isStill=function(){return!(this.isBearing()||this.isFlyingTo()||this.isMoving()||this.isPanning()||this.isTilting()||this.isZoomIn()||this.isZoomOut())},t.prototype.dirty=function(){return this.isFlyingTo()||this.isPanning()||this.isZoomIn()||this.isZoomOut()||this.isMoving()||this.isBearing()},t.prototype.getCamera=function(){return this.cameraPosition},t.prototype.isWillChange=function(){return this.willChange},t.prototype.setCamera=function(t){this.cameraPosition=t},t.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},t.prototype.is3dMode=function(){return this.mapSettings.is3dMode()},t.prototype.setSwitchMode=function(t){this.mapSettings.setSwitchMode(t)},t.prototype.handleSwitchMode=function(){if(!this.force2d)switch(this.mapSettings.getSwitchMode()){case c.SwitchMode.Auto3DTo2D:this.getZoom()<o.MapConstants.defaultMinZoom3d&&this.enable3dMode(!1);break;case c.SwitchMode.Auto2DTo3D:case c.SwitchMode.Auto:this.enable3dMode(this.getZoom()>=o.MapConstants.defaultMinZoom3d)}},t.prototype.setForce2d=function(t){this.force2d=t},t.prototype.getForce2d=function(){return this.force2d},t.prototype.getSkyRatio=function(){return this.skyRatio},t.prototype.setSkyRatio=function(t){this.skyRatio=t},t}();e.MapState=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(135),r=n(34),o=n(61),a=n(62),s=n(8),l=n(2),u=n(136),h=n(0),c=n(25),f=n(35),p=n(6),d=n(1),g=n(137),m=n(138),y=n(31),v=n(14),b=n(85),_=n(7),w=n(4),M=n(81),x=n(140),A=n(141),T=n(86),S=n(39),E=n(26),C=n(21),L=n(15),P=n(27),I=n(44),O=function(){function t(t,e,n,r,o,a,s,l,u){this.renderTiles=[],this.visibleTiles=[],this.mapView=t,this.tileTaskManager=e,this.mapState=n,this.tileCache=new i.TileCache(h.MapConstants.tileCacheSize),this.tiles=new Map,this.annotationTiles=new Map,this.userVectorTiles=new Map,this.finishedLoad=!0,this.tilesLoaded=!0,this.mapSettings=r,this.lastZoom=this.mapState.getZoom(),this.lastZoomUpdateVisibleTiles=this.mapState.getZoom(),this.tileAreas=new Map,this.tileRequestsMap=new Map,this.tileDataRequestsMap=new Map,this.buildingResourceManager=o,this.buildingIconSelectionManager=a,this.customBuildingManager=s,this.createAnnotationTile=l,this.requestRender=u}return t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-h.MathConstants.epsilon)>t||Math.floor(t+h.MathConstants.epsilon)<t))&&(e=!1),e},t.prototype.update=function(t){this.isDirty()&&(this.updateRenderableTiles(t),this.tileRequestsMap.size||(0==this.tilesLoaded&&this.mapView.mapsEventManager.notify(S.MapEvent.tilesLoaded),this.tilesLoaded=!0,this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){var t=this;this.mapView.getGeoJsonManager().removeAllTiles(),this.tiles.forEach(function(e){e.tile instanceof b.RasterTile&&t.removePlaces(e.tile),e.tile.destroy()}),this.mapSettings.placesEnabled&&this.mapView.getPlacement().updatePlacement(),this.annotationTiles.forEach(function(t){t.tile.destroy()}),this.tiles.clear(),this.annotationTiles.clear(),this.renderTiles=[],this.tileCache.clear(),this.finishedLoad=!1,this.mapView.dirty=!0,this.tileRequestsMap.forEach(function(e){t.tileTaskManager.cancelTask(e)}),this.tileRequestsMap.clear(),this.tileDataRequestsMap.forEach(function(e){t.tileTaskManager.cancelTask(e)}),this.tileDataRequestsMap.clear()},t.prototype.destroy=function(){this.reload(),this.visibleTiles=[],this.buildingResourceManager.removeHiddenBuildings(),this.buildingResourceManager.removeAllResources()},t.prototype.getRenderTiles=function(){return this.renderTiles},t.prototype.getVisibleTiles=function(){return this.visibleTiles},t.prototype.updateVisibleTilesForZoom=function(t){var e=this;this.mapState.getZoom()>this.mapSettings.getMaxNativeZoom()&&(t=this.mapSettings.getMaxNativeZoom());var n=this.mapState.cameraPosition,i=this.mapState.getScreenSize(),r=Math.pow(2,t),o=this.mapState.getTilt(),c=!1;o>h.MapConstants.maxTiltIntersectWithScreen&&(this.mapState.setTilt(h.MapConstants.maxTiltIntersectWithScreen),c=!0);var f=s.GeometryUtils.screenCoordinateToLatLngZoom(new l.Vector2(0,0),n,i,t),g=p.ProjectionMercator.projectScale(f,r).multiply(1/d.MapUtils.getTileSize()),m=s.GeometryUtils.screenCoordinateToLatLngZoom(new l.Vector2(i.x,0),n,i,t),y=p.ProjectionMercator.projectScale(m,r).multiply(1/d.MapUtils.getTileSize());c&&this.mapState.setTilt(o);var v=s.GeometryUtils.screenCoordinateToLatLngZoom(new l.Vector2(i.x,i.y),n,i,t),b=p.ProjectionMercator.projectScale(v,r).multiply(1/d.MapUtils.getTileSize()),_=s.GeometryUtils.screenCoordinateToLatLngZoom(new l.Vector2(0,i.y),n,i,t),w=p.ProjectionMercator.projectScale(_,r).multiply(1/d.MapUtils.getTileSize()),M=s.GeometryUtils.screenCoordinateToLatLngZoom(new l.Vector2(i.x/2,i.y/2),n,i,t),A=p.ProjectionMercator.projectScale(M,r).multiply(1/d.MapUtils.getTileSize());this.mapState.is3dMode()&&(this.mapState.setSkyRatio(s.GeometryUtils.latLngToScreenCoordinate(f,0,n,i).y/i.y),this.mapState.setDistanceToSky(x.Geometry2DUtils.calculateDistanceBetweenPointToLineBy2Point(y,w,b)*d.MapUtils.getTileSize()));var T=1<<Math.floor(t),S=[],E=function(t,e,n){if(n>=0&&n<=T)for(var i=t;i<e;++i){var r=i+.5-A.x,o=n+.5-A.y,a={x:i,y:n,sqDist:r*r+o*o};S.push(a)}};u.Rasterize.scanTriangle(g,y,b,0,T,E),u.Rasterize.scanTriangle(b,w,g,0,T,E),S.sort(function(t,e){return t.sqDist==e.sqDist?t.x==e.x?t.y-e.y:t.x-e.x:t.sqDist-e.sqDist}),S.filter(function(t,e,n){return 0==e||t.x!=n[e-1].x||t.y!=n[e-1].y}).forEach(function(n){return e.visibleTiles.push(a.UnwrappedTileCoordinate.createWithXYZoom(n.x,n.y,t,e.mapState.is3dMode()))})},t.prototype.updateVisibleTiles=function(){this.finishedLoad=!1,this.visibleTiles=[];var t=this.mapState.getZoom();this.lastZoomUpdateVisibleTiles<t?this.updateVisibleTilesForZoom(Math.ceil(t)):this.updateVisibleTilesForZoom(Math.floor(t)),this.lastZoomUpdateVisibleTiles=t,this.cancelOutdatedTasks()},t.prototype.cancelOutdatedTasks=function(){var t=this;this.tileRequestsMap.forEach(function(e,n,i){t.visibleTiles.some(function(t){return t.getTileCoordinate().toString()==n})||(i.delete(n),t.tileTaskManager.cancelTask(e))}),this.tileDataRequestsMap.forEach(function(e,n,i){t.visibleTiles.some(function(t){return t.getTileCoordinate().toString()==n})||(i.delete(n),t.tileTaskManager.cancelTask(e))})},t.prototype.updateRenderableTiles=function(t){var e=this,n=[],i=[],r=[];if(this.mapState.getZoom()<this.lastZoom&&0!=this.visibleTiles.length){var a=this.visibleTiles[0].getTileCoordinate().getZoom();this.renderTiles.forEach(function(t){t.getUnwrappedTileCoordinate().getTileCoordinate().getZoom()>a&&r.push(t)})}this.renderTiles=[],this.visibleTiles.forEach(function(a){var s=a.getTileCoordinate();s.set3DMode(e.mapState.is3dMode());var l=e.getTile(s);if(!(null!=l&&(l.isRenderable()||e.tileRequestsMap.has(s.toString())))){l=e.createTile(s,t);var u=new T.VectorTile(s,e.mapView.gl);if(l instanceof b.RasterTile)l.setVectorTile(u);e.mapView.getGeoJsonManager().addTile(new T.VectorTile(s,e.mapView.gl))}if(l.isRenderable()&&(e.renderTiles.push(new o.RenderTile(a,l)),n.push(s)),!l.isFinishedLoading()){if(n.push(s),e.mapState.isFlyingTo())return;if(e.mapState.getZoom()>e.lastZoom)for(var h=a.parent();h.getTileCoordinate().getZoom()>=e.lastZoom;){if(s=h.getTileCoordinate(),null!=(l=e.getTile(s))&&l.isFinishedLoading()){n.some(function(t){return t.equal(s)})||(n.push(s),i.push(new o.RenderTile(h,l)));break}h=h.parent()}else e.mapState.getZoom()<e.lastZoom&&r.forEach(function(t){var i=t.getUnwrappedTileCoordinate();i.getTileCoordinate().isChildOf(a.getTileCoordinate())&&(s=i.getTileCoordinate(),null!=(l=e.getTile(s))&&l.isFinishedLoading()&&(n.some(function(t){return t.equal(s)})||(n.push(s),e.renderTiles.push(new o.RenderTile(i,l)))))})}}),0!=i.length&&(this.renderTiles.forEach(function(t){i.push(t)}),this.renderTiles=i),n.sort(function(t,e){return t.lessThan(e)?-1:t.lessThan(e)?0:1});for(var s=[],l=0;l<n.length;++l)n[l]!==n[l+1]&&s.push(n[l]);n=s;var u=Array.from(this.tiles),h=Array.from(this.annotationTiles);u.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1}),h.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1});for(var c=0,f=0,p=0,d=!1;c<u.length;)if(f==n.length||u[c][1].tileCoordinate.lessThan(n[f])){var g=u[c][1].tile;g.getBuildings().forEach(function(t){e.buildingResourceManager.decreaseBuildingReference(t.id)}),this.removePlaces(g),d=!0,this.mapView.getGeoJsonManager().removeTile(g.tileCoordinate),this.tileCache.add(u[c][0],u[c][1].tile),this.tiles.delete(u[c][0].toString());var m=h[p][1].tile;this.annotationTiles.delete(h[p][0]),m.destroy(),++c,++p}else n[f].lessThan(u[c][1].tileCoordinate)||(++c,++p),++f;d&&this.mapSettings.placesEnabled&&this.mapView.getPlacement().updatePlacement()},t.prototype.getTile=function(t){if(this.buildingResourceManager.unhiddenBuildings.length>0)for(var e=0;e<this.buildingResourceManager.unhiddenBuildings.length;++e){var n=this.buildingResourceManager.unhiddenBuildings[e],i=r.TileCoordinate.fromLatLng(n.getLocation(),this.mapState.getZoom(),this.mapState.is3dMode());if(t.equal(i))return this.tileCache.pop(t.toString()),this.buildingResourceManager.unhiddenBuildings.splice(e,1),null}if(!this.tiles.has(t.toString())){var o=this.tileCache.pop(t.toString());if(null!=o){var a=o,s=a.getBuildings();for(e=s.length;e--;)this.buildingResourceManager.hiddenBuildings.has(s[e].id)&&s.splice(e,1);this.addBuildings(s),this.addPlaces(a),this.tiles.set(t.toString(),{tileCoordinate:t,tile:o}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)});var l=new T.VectorTile(t,this.mapView.gl);return this.mapView.getGeoJsonManager().addTile(l),o}return null}return this.tiles.get(t.toString()).tile},t.prototype.clearTileCache=function(){this.tileCache.clear()},t.prototype.createTile=function(t,e){var n=this,i=this.tileCache.pop(t.toString());if(null==i){this.tilesLoaded=!1;var r=this.mapSettings.getTileUrl(this.mapState.is3dMode()),o=t.getZoom(),a=!1;this.tileAreas.forEach(function(e){a||o<=e.getMaxZoom()&&o>=e.getMinZoom()&&g.TileRange.fromLatLngBounds(e.getBounds(),o,o).contains(t)&&(r=e.getUrl(),a=!0)});var s=c.UrlUtils.getTileUrl(r,t.getX(),t.getY(),t.getZoom());i=e(t);var l=new f.RequestTask(f.Resource.RasterTile);l.url=s,l.completion=function(e){if(e.success){null!=e.data&&i.init(e,function(){n.requestRender(),n.tileRequestsMap.delete(t.toString())})}},this.tileRequestsMap.set(t.toString(),l),this.tileTaskManager.postTask(l),r=this.mapSettings.getMapUrl(),s=c.UrlUtils.getTileUrl(r,t.getX(),t.getY(),t.getZoom());var u=new f.RequestTask(f.Resource.TileData);u.url=s,u.completion=function(e){if(n.tileDataRequestsMap.delete(t.toString()),e.success&&null!=e.data){var r=i,o=(e.data.result||{}).objects||[];o&&o.forEach(function(t){t.model=A.ReflectUtils.renameProp({textureName:"texture",objName:"obj"},t.model)});for(var a=o||[],s=n.mapView.mapSettings.getDate().getTime(),l=a.length;l--;){var u=a[l],c=null!=u.startDate?u.startDate:Number.NEGATIVE_INFINITY,f=null!=u.endDate?u.endDate:Number.POSITIVE_INFINITY;(c>s||f<s||n.buildingResourceManager.hiddenBuildings.has(u.id))&&a.splice(l,1)}if(n.addBuildings(a),r.addBuildings(a),n.mapState.is3dMode()){var p=n.customBuildingManager.getObjectsForTile(i.getTileCoordinate());if(p&&0!=p.length){var d=[];p.forEach(function(t){var e=n.customBuildingManager.getJsonForMapObject(t);d.push(e),r.getBuildings().push(e)}),n.addBuildings(d)}}var g=(e.data.result||{}).places||[];g=g.slice(0,h.MapConstants.maxPlacePerTile),r.addPlaces(g),n.addPlaces(r),i.dataLoaded=!0,n.requestRender()}},this.tileDataRequestsMap.set(t.toString(),u),this.tileTaskManager.postTask(u)}return null!=this.tiles&&this.tiles.set(t.toString(),{tileCoordinate:t,tile:i}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)}),i},t.prototype.addTileArea=function(t,e){this.tileAreas.set(t,e),this.reload()},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.addTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.reload())},t.prototype.readdBuildings=function(){var t=this;this.tiles.forEach(function(e){var n=e.tile;t.addBuildings(n.getBuildings(),!0)})},t.prototype.removeUserPlaces=function(e){if(e instanceof b.RasterTile){var n=e.tileCoordinate,i=this.mapView.getPlacement();this.mapView.getLayer(t.userPointLayerId).renderTiles.delete(n.toString());var r=[];this.mapView.getFeatureManager().queryFeatures(n).filter(function(t){return t.getType()==L.GeometryType.Point}).forEach(function(t){r.push(t.getId())}),i.removeFeatures(r)}},t.prototype.removePlaces=function(e){var n=this;if(e instanceof b.RasterTile){var i=e,r=i.getPlaces(),o=i.tileCoordinate;if(i.isInitialized()){var a=this.mapView.getPlacement();this.mapView.getLayer(t.pointLayerId).renderTiles.delete(o.toString());var s=[];r.forEach(function(t){if(s.push(t.id),null!=t.name){var e=new P.MarkerLabel({text:t.name,fontSize:h.MapConstants.placeFontSize,fontWeight:h.MapConstants.placeFontWeight,line:h.MapConstants.placeNumLine,maxWidth:h.MapConstants.placeMaxWidth});I.TextLabelResourceManager.getInstance(n.mapView.gl).release(e)}}),a.removeFeatures(s),this.removeUserPlaces(e)}}},t.prototype.addUserPlaces=function(e){if(e instanceof b.RasterTile){var n=e;if(n.isInitialized()){var i=n.tileCoordinate,r=null;this.userVectorTiles.has(i.toString())?r=this.userVectorTiles.get(i.toString()).tile:(r=new T.VectorTile(i,this.mapView.gl),this.userVectorTiles.set(i.toString(),{tileCoordinate:i,tile:r}));var s=new E.VectorTileData;r.setData(s);var l=s.addLayer(t.pointLayerId),u=[];this.mapView.getFeatureManager().queryFeatures(i).filter(function(t){return t.getType()==L.GeometryType.Point}).forEach(function(t){l.addFeature(t.getId(),L.GeometryType.Point,null,t.getProperties()),u.push(t)});var h=this.mapView.getPlacement(),c=new o.RenderTile(a.UnwrappedTileCoordinate.createWithXYZoom(i.getX(),i.getY(),i.getZoom()),r);this.mapView.getLayer(t.userPointLayerId).addRenderTile(i.toString(),c),h.addFeatures(u)}}},t.prototype.addPlaces=function(e){var n=this;if(e instanceof b.RasterTile){var i=e;if(i.isInitialized()){var r=i.getPlaces(),s=i.tileCoordinate,l=i.getVectorTile();null==l&&(l=new T.VectorTile(s,this.mapView.gl),i.setVectorTile(l));var u=new E.VectorTileData;l.setData(u);var c=u.addLayer(t.pointLayerId),f=C.SymbolResourceManager.getInstance(this.mapView.gl);r&&r.forEach(function(t){var e=new Map,i=w.LatLng.convert(t.location);e.set("color",t.icon&&t.icon.color?t.icon.color:h.MapConstants.placeDefaultColor),e.set("url",(t.icon||{}).url||"iconDefault"),e.set("lat",i.lat),e.set("lng",i.lng),e.set("name",t.name),e.set("address",t.address),e.set("types",null!=t.types?t.types.join():""),c.addFeature(t.id,L.GeometryType.Point,null,e);var r=e.get("url");if(f.acquire(r),null!=t.name){var o=new P.MarkerLabel({text:t.name,fontSize:h.MapConstants.placeFontSize,fontWeight:h.MapConstants.placeFontWeight,line:h.MapConstants.placeNumLine,maxWidth:h.MapConstants.placeMaxWidth});I.TextLabelResourceManager.getInstance(n.mapView.gl).acquire(o)}});var p=new o.RenderTile(a.UnwrappedTileCoordinate.createWithXYZoom(s.getX(),s.getY(),s.getZoom()),l);this.mapView.getLayer(t.pointLayerId).addRenderTile(s.toString(),p);var d=this.mapView.getPlacement(),g=[];c.features.forEach(function(t){g.push(t)}),d.addFeatures(g),this.addUserPlaces(e)}}},t.prototype.addBuildings=function(t,e){var n=this;void 0===e&&(e=!1),t.forEach(function(t){var i=n.getBuildingType(t.model);if((n.mapSettings.objectsEnabled||i==y.BuildingType.External||i==y.BuildingType.ExternalExtrude)&&(!e||i!=y.BuildingType.External&&i!=y.BuildingType.ExternalExtrude))if(n.buildingResourceManager.hasBuilding(t.id)){u=n.buildingResourceManager.getBuilding(t.id);var r=w.LatLng.convert(t.location),o=u.getLocation();if(r&&o&&!r.equals(o)){if((x=u.getCoordinates())&&x.length>0){var a=r.lng-o.lng,s=r.lat-o.lat,l=[];x.forEach(function(t){l.push(new w.LatLng(t.lat+s,t.lng+a))}),u.setCoordinates(l)}u.setLocation(w.LatLng.convert(t.location))}n.buildingResourceManager.increaseBuildingReference(t.id)}else{var u;(u=new m.Building(n.buildingIconSelectionManager)).setId(t.id),null==t.name?u.setName("Unknown name"):u.setName(t.name),u.setPlaces(t.places);var h=t.model.height||0,c=i==y.BuildingType.ExternalExtrude||i==y.BuildingType.Extrude,f=t.scale;if(c&&(f=t.scale*h),u.setScale(new v.Vector3(t.scale,t.scale,f)),u.setBearing(t.bearing),u.setLocation(w.LatLng.convert(t.location)),u.setElevation(t.elevation),u.setHeight(h),u.setCamera(t.camera),u.setTypes(t.types),u.setVerified(t.isVerified),u.setMinZoom(t.minZoom),u.setMaxZoom(t.maxZoom),u.setStartDate(t.startDate),u.setEndDate(t.endDate),u.setDraggable(t.draggable||!1),"string"==typeof t.model.obj?u.setObjName(t.model.obj):t.model.obj&&(u.setObjName(t.model.obj.reuseId||t.id),u.setObjData(t.model.obj.data)),"string"==typeof t.model.texture?u.setTextureName(t.model.texture):t.model.texture&&(u.setTextureName(t.model.texture.reuseId||t.id),u.setTextureData(t.model.texture.data)),null!=t.model.objUrl&&u.setObjName(t.model.objUrl),null!=t.model.textureUrl&&u.setTextureName(t.model.textureUrl),u.setBuildingType(i),u.getBuildingType()==y.BuildingType.Extrude||i==y.BuildingType.ExternalExtrude){for(var d=p.ProjectionMercator.convertToMeterFromLatLng(u.getLocation()),g=[],b=[],x=[],A=0;A<t.model.coordinates.length;++A){var T=t.model.coordinates[A],S=w.LatLng.convert(T);x.push(S);var E=p.ProjectionMercator.convertToMeterFromLatLng(S);b.push(new _.Point(E.x-d.x,d.y-E.y))}u.setCoordinates(x),g.push(b);var C=M.BuildingExtrudeUtils.extrudePolygon(g,1);n.buildingResourceManager.addBuildingWithData(t.id,u,C.vertices,C.indices)}else n.buildingResourceManager.addBuilding(t.id,u)}})},t.prototype.getBuildingType=function(t){var e=t.type;return"Object"==e?y.BuildingType.Texture:"Polygon"==e?y.BuildingType.Extrude:"External"==e?y.BuildingType.External:"ExternalExtrude"==e?y.BuildingType.ExternalExtrude:void console.warn("Invalid building type: "+e+" of model: "+t.obj)},t.prototype.getTiles=function(){return this.tiles},t.prototype.getTileCache=function(){return this.tileCache},t.prototype.reloadTileData=function(t){var e=this.tiles.get(t.toString());null!=e&&this.addPlaces(e.tile)},t.pointLayerId="2.maplink.vector.tile.points",t.userPointLayerId="1.maplink.vector.tile.user.points",t}();e.TileManager=O},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.orderedKeys=[],this.size=t,this.tiles=new Map}return t.prototype.setSize=function(t){for(this.size=t;this.orderedKeys.length>t;){var e=this.orderedKeys[0];this.orderedKeys.shift(),this.tiles.delete(e.toString())}},t.prototype.add=function(t,e){if(e.isRenderable()&&this.size){if(this.tiles.has(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1);var i=this.tiles.get(t);i!=e&&i.destroy()}if(this.tiles.set(t,e),this.orderedKeys.push(t),this.orderedKeys.length>this.size-1)this.pop(this.orderedKeys[0]).destroy()}else e.destroy()},t.prototype.get=function(t){return this.tiles.get(t)},t.prototype.pop=function(t){var e=this.tiles.get(t);if(this.tiles.delete(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1)}return e},t.prototype.has=function(t){return null!=this.tiles.get(t)},t.prototype.clear=function(){this.orderedKeys=[],this.tiles.forEach(function(t){t.destroy()}),this.tiles.clear()},t}();e.TileCache=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.scanTriangle=function(t,e,n,i,a,s){var l=new r(t,e),u=new r(e,n),h=new r(n,t);if(l.dy>u.dy){var c=l;l=u,u=c}if(l.dy>h.dy){c=l;l=h,h=c}if(u.dy>h.dy){c=u;u=h,h=c}l.dy&&o(h,l,i,a,s),u.dy&&o(h,u,i,a,s)},t}();e.Rasterize=i;var r=function(){return function(t,e){if(this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.dx=0,this.dy=0,t.y>e.y){var n=t;t=e,e=n}this.x0=t.x,this.y0=t.y,this.x1=e.x,this.y1=e.y,this.dx=e.x-t.x,this.dy=e.y-t.y}}();function o(t,e,n,i,r){var o=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var l=t.dx/t.dy,u=e.dx/e.dy,h=t.dx>0?1:0,c=e.dx<0?1:0,f=o;f<a;++f){var p=l*Math.max(0,Math.min(t.dy,f+h-t.y0))+t.x0,d=u*Math.max(0,Math.min(e.dy,f+c-e.y0))+e.x0;r(Math.floor(d),Math.ceil(p),f)}}e.Edge=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),r=n(12),o=function(){function t(t,e,n,i,r,o){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i,this.minZoom=r,this.maxZoom=o}return t.fromLatLngBounds=function(e,n,o){var a=i.ProjectionMercator.projectZoom(e.getSouthwest(),o),s=i.ProjectionMercator.projectZoom(e.getNortheast(),o),l=Math.pow(2,o);return new t(Math.floor(a.x),Math.floor(s.x),r.MathUtils.clamp(Math.floor(s.y),0,l),r.MathUtils.clamp(Math.floor(a.y),0,l),n,o)},t.prototype.contains=function(t){var e=t.getX(),n=t.getY(),i=t.getZoom();if(i<=this.maxZoom&&i>=this.minZoom){if(0==i)return!0;var r=this.maxZoom-i,o=this.minX>>r,a=this.maxX>>r,s=this.minY>>r,l=this.maxY>>r;return(this.minX>this.maxX?e>=o||e<=a:e<=a&&e>=o)&&n<=l&&n>=s}return!1},t}();e.TileRange=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),o=n(31),a=n(6),s=n(8),l=n(2),u=n(84),h=n(11),c=n(77),f=n(0),p=function(t){function e(e){var n=t.call(this)||this;return n.coordinates=[],n.location=new c.LatLng(0,0),n.scale=new r.Vector3(1,1,1),n.bearing=0,n.name="Unknown name",n.elevation=0,n.selectionCode=0,n.objData=null,n.textureData=null,n.selected=!1,n.buildingIconSelectionManager=e,n}return i(e,t),e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.getName=function(){return this.name},e.prototype.setName=function(t){this.name=t},e.prototype.setPlaces=function(t){this.places=t},e.prototype.getPlaces=function(){return this.places},e.prototype.getScale=function(){return this.scale},e.prototype.setScale=function(t){this.scale=t},e.prototype.setBearing=function(t){this.bearing=t},e.prototype.getBearing=function(){return this.bearing},e.prototype.setLocation=function(t){this.location=c.LatLng.convert(t)},e.prototype.getLocation=function(){return this.location},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.setCoordinates=function(t){this.coordinates=t},e.prototype.getCoordinates=function(){return this.coordinates},e.prototype.setCamera=function(t){this.camera=t},e.prototype.getCamera=function(){return this.camera},e.prototype.setTypes=function(t){this.types=t},e.prototype.getTypes=function(){return this.types},e.prototype.setVerified=function(t){this._isVerified=t},e.prototype.isVerified=function(){return this._isVerified},e.prototype.setMinZoom=function(t){this.minZoom=t},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setStartDate=function(t){this.startDate=t},e.prototype.getStartDate=function(){return this.startDate},e.prototype.setEndDate=function(t){this.endDate=t},e.prototype.getEndDate=function(){return this.endDate},e.prototype.getTextureName=function(){return this.textureName},e.prototype.setTextureName=function(t){this.textureName=t},e.prototype.getTextureData=function(){return this.textureData},e.prototype.setTextureData=function(t){this.textureData=t},e.prototype.getObjName=function(){return this.objName},e.prototype.setObjName=function(t){this.objName=t},e.prototype.getObjData=function(){return this.objData},e.prototype.setObjData=function(t){this.objData=t},e.prototype.setDraggable=function(t){this.draggable=t},e.prototype.isDraggable=function(){return this.draggable},e.prototype.getBuildingType=function(){return this.buildingType},e.prototype.setBuildingType=function(t){this.buildingType=t},e.prototype.getSelectionCode=function(){return this.selectionCode},e.prototype.setSelectionCode=function(t){this.selectionCode=t},e.prototype.setHighestPosition=function(t){this.highestPosition=t},e.prototype.getHighestPosition=function(){return this.highestPosition},e.prototype.setHeight=function(t){this.height=t},e.prototype.getHeight=function(){return this.height},e.prototype.setSelected=function(t){t!=this.selected&&(t&&this.getHighestPosition()?this.buildingIconSelectionManager.addBuilding(this):!t&&this.selected&&this.getHighestPosition()&&this.buildingIconSelectionManager&&this.buildingIconSelectionManager.removeBuilding(this.id),this.selected=t)},e.prototype.isSelected=function(){return this.selected},e.prototype.getScaledModelMatrix=function(){return this.scaledModelMatrix},e.prototype.getScaledMvpMatrix=function(){return this.scaledMvpMatrix},e.prototype.notifyModelDownloaded=function(){this.selected&&this.buildingIconSelectionManager.addBuilding(this)},e.prototype.destroy=function(){this.buildingIconSelectionManager&&this.selected&&this.buildingIconSelectionManager.removeBuilding(this.id),this.buildingIconSelectionManager=null,this.buildingType!=o.BuildingType.Extrude&&this.buildingType!=o.BuildingType.ExternalExtrude||this.model&&this.model.destroy()},e.prototype.updateMatrices=function(t){if(null!=this.model){var n=1/a.ProjectionMercator.getMetersPerPixelAtLatitude(f.MapConstants.metersPerPixelAtLatitude,t.getZoom()),i=a.ProjectionMercator.projectScale(this.location,t.getScale()),r=s.GeometryUtils.pixelCoordinateToCameraCoordinate(new l.Vector2(i.x,i.y),t.cameraPosition),o=t.is3dMode()?s.GeometryUtils.getElevationPixelFromMeter(this.getElevation(),t.cameraPosition):0;this.modelMatrix=h.Matrix4.translate(r.x,r.y,o),this.modelMatrix=h.Matrix4.scale(this.scale.x*n,this.scale.y*n,this.scale.z*n).concat(this.modelMatrix),this.modelMatrix=h.Matrix4.rotateZ(this.bearing).concat(this.modelMatrix),this.modelMatrix=h.Matrix4.rotateX(e.buildingRotationX).concat(this.modelMatrix),this.mvpMatrix=this.modelMatrix.concat(t.getViewProjectionMatrix());var u=.1,c=.1,p=.015;if(this.model.minX){var d=5/(this.model.maxX-this.model.minX);d=d==1/0?.1:d,u=Math.max(u,d),d=(d=5/(this.model.maxY-this.model.minY))==1/0?.1:d,c=Math.max(c,d),d=(d=.5/(this.model.maxZ-this.model.minZ))==1/0?.1:d,p=Math.max(p,d)}this.scaledModelMatrix=h.Matrix4.translate(r.x,r.y,o),this.scaledModelMatrix=h.Matrix4.scale(this.scale.x*n+u,this.scale.y*n+c,this.scale.z*n+p).concat(this.scaledModelMatrix),this.scaledModelMatrix=h.Matrix4.rotateZ(this.bearing).concat(this.scaledModelMatrix),this.scaledModelMatrix=h.Matrix4.rotateX(e.buildingRotationX).concat(this.scaledModelMatrix),this.scaledMvpMatrix=this.scaledModelMatrix.concat(t.getViewProjectionMatrix())}else console.warn("Model of "+this.getId()+" is null!")},e.prototype.updateScaledMatrix=function(t){var n=1/a.ProjectionMercator.getMetersPerPixelAtLatitude(f.MapConstants.metersPerPixelAtLatitude,t.getZoom()),i=a.ProjectionMercator.projectScale(this.location,t.getScale()),r=s.GeometryUtils.pixelCoordinateToCameraCoordinate(new l.Vector2(i.x,i.y),t.cameraPosition),o=t.is3dMode()?s.GeometryUtils.getElevationPixelFromMeter(this.getElevation(),t.cameraPosition):0,u=.1,c=.1,p=.015;if(this.model.minX){var d=5/(this.model.maxX-this.model.minX);d=d==1/0?.1:d,u=Math.max(u,d),d=(d=5/(this.model.maxY-this.model.minY))==1/0?.1:d,c=Math.max(c,d),d=(d=.5/(this.model.maxZ-this.model.minZ))==1/0?.1:d,p=Math.max(p,d)}this.scaledModelMatrix=h.Matrix4.translate(r.x,r.y,o),this.scaledModelMatrix=h.Matrix4.scale(this.scale.x*n+u,this.scale.y*n+c,this.scale.z*n+p).concat(this.scaledModelMatrix),this.scaledModelMatrix=h.Matrix4.rotateZ(this.bearing).concat(this.scaledModelMatrix),this.scaledModelMatrix=h.Matrix4.rotateX(e.buildingRotationX).concat(this.scaledModelMatrix),this.scaledMvpMatrix=this.scaledModelMatrix.concat(t.getViewProjectionMatrix())},e.buildingRotationX=90,e}(u.Object3D);e.Building=p},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(53),o=n(5),a=function(t){function e(e){var n=t.call(this,o.LayerType.RASTER)||this;return n.texture=e,n}return i(e,t),e.prototype.destroy=function(){this.texture&&this.texture.destroy()},e}(r.LayerData);e.RasterLayerData=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=function(){function t(){}return t.calculateDistanceBetweenPointToLineBy2Point=function(e,n,i){return Math.sqrt(t.distToSegmentSquared(e,n,i))},t.calculateDistanceBetweenPointToLine=function(e,n){return Math.sqrt(t.distToSegmentSquared(e,new i.Vector2(n[0][0],n[0][1]),new i.Vector2(n[1][0],n[1][1])))},t.distToSegmentSquared=function(e,n,r){var o=t.dist2(n,r);if(0==o)return t.dist2(e,n);var a=((e.x-n.x)*(r.x-n.x)+(e.y-n.y)*(r.y-n.y))/o;return a=Math.max(0,Math.min(1,a)),t.dist2(e,new i.Vector2(n.x+a*(r.x-n.x),n.y+a*(r.y-n.y)))},t.dist2=function(e,n){return t.sqr(e.x-n.x)+t.sqr(e.y-n.y)},t.sqr=function(t){return t*t},t}();e.Geometry2DUtils=r},function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.renameProp=function(t,e){return Object.keys(e).reduce(function(n,r){var o,a=((o={})[t[r]||r]=e[r],o);return i({},n,a)},{})},t}();e.ReflectUtils=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(53),o=n(37),a=n(15),s=n(5),l=n(54),u=n(1),h=n(2),c=n(10),f=n(9),p=n(26),d=n(64),g=function(t){function e(e,n){var i=t.call(this,s.LayerType.FILL)||this;return i.vertices=[],i.indices=[],i.gl=n,i.fillPartials=new Map,i.linePartials=new Map,i.fillProperties=new Map,i.strokeProperties=new Map,i.buildStroke(e),i.buildPolygon(e),i.model=new o.Model(i.gl),i.model.init(i.vertices,[new c.AttributeInfo("a_position",2,0,2)],i.indices),i.vertices=[],i.indices=[],i.initializeProperties(e),i}return i(e,t),e.prototype.getModel=function(){return this.model},e.prototype.getFillPartials=function(){return this.fillPartials},e.prototype.getLinePartials=function(){return this.linePartials},e.prototype.getFillProperties=function(){return this.fillProperties},e.prototype.getStrokeProperties=function(){return this.strokeProperties},e.prototype.buildStroke=function(t){for(var e=u.MapUtils.getTileSize(),n=t.featureCount(),i=0,r=0,o=[],s=0;s<n;++s){var l=t.getFeature(s);if(l.getType()==a.GeometryType.LineString){for(var c=l.getGeometries().geometryCoordinates,f=this.indices.length,g=0;g<c.length;++g){r+=c[g].length;for(var m=0;m<c[g].length;++m){var y=new h.Vector2(c[g][m][0],c[g][m][1]);y.x=y.x*e,y.y=y.y*e,this.vertices.push(y.x),this.vertices.push(y.y),i!=r-1?(this.indices.push(i++),this.indices.push(i)):i++}}var v=this.indices.length-f;o.push(new d.Range(f,v));var b="";l instanceof p.VectorTileFeature&&(b=l.getId());var _=this.linePartials.get(b);_?_.push(o):this.linePartials.set(b,[o]),o=[]}}},e.prototype.initializeProperties=function(t){if(t instanceof p.VectorTileLayer)for(var n=t.featureCount(),i=0;i<n;++i){var r=t.getFeature(i),o=r.getType(),s=r.getProperties(),l=r.getId()||"";if(o==a.GeometryType.Polygon)if(s){var u=s.get("fill")||"#000000",h=s.has("fill-opacity")?s.get("fill-opacity"):1,c=f.Color.fromHex(u);c.alpha=h,this.fillProperties.set(l,{fillColor:c})}else this.fillProperties.set(l,{fillColor:e.defaultFillColor});else{var d=s.get("stroke")||"#000000",g=s.has("stroke-opacity")?s.get("stroke-opacity"):1,m=f.Color.fromHex(d);m.alpha=g,this.strokeProperties.set(l,{strokeColor:m})}}},e.prototype.buildPolygon=function(t){var e=this,n=this.vertices.length/2,i=new l.PolygonBuilderContext;i.addVertex=function(t){e.vertices.push(t.x,t.y)};for(var r=u.MapUtils.getTileSize(),o=t.featureCount(),s=0;s<o;++s){var c=t.getFeature(s);if(c.getType()==a.GeometryType.Polygon){var f=c.getProperties();if(f&&!0===f.get("multi-polygon")){for(var g=c.getGeometries().geometryCoordinates,m=[],y=[],v=0;v<g.length;++v){for(var b=this.indices.length,_=[],w=0;w<g[v].length;++w){(A=new h.Vector2(g[v][w][0],g[v][w][1])).x=A.x*r,A.y=A.y*r,_.push(A)}m.push(_),l.buildPolygon(m,i),i.indices.forEach(function(t){return e.indices.push(t+n)}),n=this.vertices.length/2,m=[];var M=this.indices.length-b;y.push(new d.Range(b,M))}var x="";c instanceof p.VectorTileFeature&&(x=c.getId()),this.fillPartials.set(x,y)}else{for(b=this.indices.length,g=c.getGeometries().geometryCoordinates,m=[],v=0;v<g.length;++v){for(_=[],w=0;w<g[v].length;++w){var A;(A=new h.Vector2(g[v][w][0],g[v][w][1])).x=A.x*r,A.y=A.y*r,_.push(A)}m.push(_)}l.buildPolygon(m,i);x="";c instanceof p.VectorTileFeature&&(x=c.getId()),i.indices.forEach(function(t){return e.indices.push(t+n)}),n=this.vertices.length/2;M=this.indices.length-b;this.fillPartials.set(x,[new d.Range(b,M)])}}}},e.prototype.destroy=function(){this.model&&this.model.destroy()},e.defaultFillColor=f.Color.fromHex("#000000"),e}(r.LayerData);e.FillLayerData=g},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(n,i,r,o,a){!function e(n,i,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=i-r+1,u=Math.log(s),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(s-h)/s)*(l-s/2<0?-1:1),f=Math.max(r,Math.floor(i-l*h/s+c)),p=Math.min(o,Math.floor(i+(s-l)*h/s+c));e(n,i,f,p,a)}var d=n[i],g=r,m=o;for(t(n,r,i),a(n[o],d)>0&&t(n,r,o);g<m;){for(t(n,g,m),g++,m--;a(n[g],d)<0;)g++;for(;a(n[m],d)>0;)m--}0===a(n[r],d)?t(n,r,m):t(n,++m,o),m<=i&&(r=m+1),i<=m&&(o=m-1)}}(n,i,r||0,o||n.length-1,a||e)}}()},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),o=function(t){function e(e,n,i,r){var o=t.call(this,n,i,r)||this;return o._id=e,o}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e}(r.GeometryTileFeature);e.AnnotationTileFeature=o;var a=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.addFeature=function(t,e,n,i){void 0===i&&(i=new Map),this.features.push(new o(t,e,n,i))},e}(r.GeometryTileLayer);e.AnnotationTileLayer=a;var s=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return i(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new a(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(r.GeometryTileData);e.AnnotationTileData=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(20),r=n(42),o=n(6),a=n(2),s=n(5),l=function(){function t(t,e){this._id=t,this._layerId=r.AnnotationManager.annotationLayerId+t.toString(),this._circleAnnotation=e,this.updateBounds()}return t.prototype.updateLayer=function(t){var e=t.getLayer(this._layerId);null==e&&(e=t.createLayer(this._layerId,s.LayerType.CIRCLE,this._circleAnnotation.getZIndex()));var n=e;n.setCenter(this._circleAnnotation.getCenter()),n.setRadius(this._circleAnnotation.getRadius()),n.setFillColor(this._circleAnnotation.getFillColor()),n.setFillOpacity(this._circleAnnotation.getFillOpacity()),n.setVisible(this._circleAnnotation.isVisible()),n.setElevation(this._circleAnnotation.getElevation()),n.setStrokeColor(this._circleAnnotation.getStrokeColor()),n.setStrokeWidth(this._circleAnnotation.getStrokeWidth())},t.prototype.updateBounds=function(){var t=this._circleAnnotation.getCenter(),e=this._circleAnnotation.getRadius(),n=o.ProjectionMercator.convertToMeterFromLatLng(t),r=new a.Vector2(n.x-e,n.y-e),s=new a.Vector2(n.x+e,n.y+e),l=new i.LatLngBounds(o.ProjectionMercator.convertToLatLngFromMeter(r),o.ProjectionMercator.convertToLatLngFromMeter(s));this._minX=l.getSouthwest().lng,this._minY=l.getSouthwest().lat,this._maxX=l.getNortheast().lng,this._maxY=l.getNortheast().lat},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),t.prototype.getAnnotation=function(){return this._circleAnnotation},Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}();e.CircleAnnotationData=l},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polygonAnnotation=n,i}return i(e,t),e.prototype.getAnnotation=function(){return this.polygonAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,r.LayerType.FILL,this.polygonAnnotation.getZIndex()));var i=n;i.setFillColor(this.polygonAnnotation.getFillColor()),i.setFillOpacity(this.polygonAnnotation.getFillOpacity()),i.setStrokeColor(this.polygonAnnotation.getStrokeColor()),i.setStrokeWidth(this.polygonAnnotation.getStrokeWidth()),i.setElevation(this.polygonAnnotation.getElevation()),i.setVisible(this.polygonAnnotation.isVisible())},e.prototype.getFeatures=function(){var t,e=[];this.polygonAnnotation.getPaths().forEach(function(t){var n=[];t.forEach(function(t){return n.push([t.lng,t.lat])}),e.push(n)});var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e}},{type:"Feature",properties:{},geometry:{type:"MultiLineString",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(n(90).ShapeAnnotationData);e.PolygonAnnotationData=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polylineAnnotation=n,i}return i(e,t),e.prototype.getAnnotation=function(){return this.polylineAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,r.LayerType.LINE,this.polylineAnnotation.getZIndex()));var i=n;i.setStrokeColor(this.polylineAnnotation.getStrokeColor()),i.setStrokeOpacity(this.polylineAnnotation.getStrokeOpacity()),i.setStrokeWidth(this.polylineAnnotation.getStrokeWidth()),i.setElevation(this.polylineAnnotation.getElevation()),i.setVisible(this.polylineAnnotation.isVisible()),i.setStyle(this.polylineAnnotation.getStyle())},e.prototype.getFeatures=function(){var t,e=[];this.polylineAnnotation.getPath().forEach(function(t){e.push([t.lng,t.lat])}),this.polylineAnnotation.isClosed()&&0!=e.length&&e.push(e[0]);var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(n(90).ShapeAnnotationData);e.PolylineAnnotationData=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(51),r=n(1),o=n(21),a=n(27),s=n(5),l=n(42),u=n(92),h=n(66),c=n(25),f=function(){function t(t,e,n){this._gl=t,this._id=e,this._symbolAnnotation=n,this.updateBounds(),this.updateIcon()}return t.prototype.updateLayer=function(t){var e=l.AnnotationManager.pointLayerId+this._id,n=t.getLayer(e);null==n&&(n=t.createLayer(e,s.LayerType.SYMBOL,this._symbolAnnotation.getZIndex()));var i=n;i.anchor=this._symbolAnnotation.getAnchor(),i.position=this._symbolAnnotation.getPosition(),i.width=this._width?this._width:-1,i.height=this._height?this._height:-1,i.elevation=this._symbolAnnotation.getElevation(),i.labelAnchor=this._symbolAnnotation.getLabelAnchor(),i.rotation=this._symbolAnnotation.getRotation(),i.url=this._url;var r=this._symbolAnnotation.getLabel();i.textLabelData&&(i.textLabelData.destroy(),i.textLabelData=null),r&&(i.markerLabel=r instanceof a.MarkerLabel?r:new a.MarkerLabel({text:r}),i.textLabelData=h.TextLabelFactory.getInstance(this._gl).createText(new u.TextLabel(i.markerLabel.getText(),i.markerLabel.getFontSize()),i.markerLabel.getFontWeight(),i.markerLabel.getMaxWidth(),i.markerLabel.getLine()))},t.prototype.destroy=function(){o.SymbolResourceManager.getInstance(this._gl).release(this._url)},t.prototype.updateBounds=function(){var t=this._symbolAnnotation.getPosition();this._minX=t.lng,this._minY=t.lat,this._maxX=t.lng,this._maxY=t.lat},t.prototype.updateAnnotationData=function(){var t=this._symbolAnnotation.getPosition();t.lat!=this._minY||t.lng!=this._minX?this.updateBounds():this.updateIcon()},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"symbolAnnotation",{get:function(){return this._symbolAnnotation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t.prototype.updateIcon=function(){this._width=null,this._height=null;var e=o.SymbolResourceManager.getInstance(this._gl),n=this._symbolAnnotation.getIcon(),a=this._url;n instanceof i.Icon?(this._url=n.getUrl(),this._width=n.getWidth()*r.MapUtils.pixelScale,this._height=n.getHeight()*r.MapUtils.pixelScale):this._url=n,c.UrlUtils.isUrlRequest(this._url)||null!=this._width&&null!=this._height||(this._width=t.DEFAULT_SYMBOL_WIDTH*r.MapUtils.pixelScale,this._height=t.DEFAULT_SYMBOL_HEIGHT*r.MapUtils.pixelScale),e.acquire(this._url),null!=a&&a!==this._url&&e.release(a)},t.DEFAULT_SYMBOL_WIDTH=32,t.DEFAULT_SYMBOL_HEIGHT=32,t}();e.SymbolAnnotationData=f},function(t,e,n){var i;!function(){"use strict";function r(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function o(t,e,n){var i=e.x,r=e.y,o=n.x-i,a=n.y-r;if(0!==o||0!==a){var s=((t.x-i)*o+(t.y-r)*a)/(o*o+a*a);s>1?(i=n.x,r=n.y):s>0&&(i+=o*s,r+=a*s)}return(o=t.x-i)*o+(a=t.y-r)*a}function a(t,e){var n=t.length-1,i=[t[0]];return function t(e,n,i,r,a){for(var s,l=r,u=n+1;u<i;u++){var h=o(e[u],e[n],e[i]);h>l&&(s=u,l=h)}l>r&&(s-n>1&&t(e,n,s,r,a),a.push(e[s]),i-s>1&&t(e,s,i,r,a))}(t,0,n,e,i),i.push(t[n]),i}function s(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=a(t=n?t:function(t,e){for(var n,i=t[0],o=[i],a=1,s=t.length;a<s;a++)r(n=t[a],i)>e&&(o.push(n),i=n);return i!==n&&o.push(n),o}(t,i),i)}void 0===(i=function(){return s}.call(e,n,e,t))||(t.exports=i)}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,i,r,o,a){this._text=t,this._font=e,this._size=n,this._width=i,this._height=r,this._widthPerLine=o,this._model=a}return t.prototype.destroy=function(){this._model&&(this._model.destroy(),this._model=null)},Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widthPerLine",{get:function(){return this._widthPerLine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t}();e.TextLabelData=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(152),r=n(36),o=n(0),a=function(){function t(t,e,n,i,r){this.chars=" !&quot;#$%&amp;'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`\\abcdefghijklmnopqrstuvwxyz{|}~",this.gl=t,this._fontSize=e,this.fontImageData=[],this._metrics=new Array(this.chars.length),this.update(e,n,i,r)}return t.prototype.update=function(t,e,n,a){this.fontImageData=new Array(o.FontConstant.fontTextureWidth*o.FontConstant.fontTextureHeight*4).fill(0);var s=t/8,l=t/3,u=o.FontConstant.fontTextureWidth,h=o.FontConstant.fontTextureHeight;this._tinySDFGenerator=new i(t,s,l,e,n,a);for(var c=this._tinySDFGenerator,f=0,p=0;f+c.size<=h&&p<this.chars.length;f+=c.size)for(var d=0;d+c.size<=u&&p<this.chars.length;d+=c.size){var g=this.makeRGBAImageData(c.draw(this.chars[p]),c.size);g&&this.putImageData(g,d,f),this._metrics[this.chars[p]]={x:d,y:f},p++}var m=new Uint8Array(this.fontImageData);this._texture=new r.Texture(this.gl),this._texture.loadImageDataArray(m,u,h,this.gl.LINEAR)},t.prototype.makeRGBAImageData=function(t,e){for(var n=new Array(e*e*4),i=0;i<t.length;i++)n[4*i+0]=t[i],n[4*i+1]=t[i],n[4*i+2]=t[i],n[4*i+3]=255;return n},t.prototype.putImageData=function(t,e,n){for(var i=o.FontConstant.fontTextureWidth,r=this._tinySDFGenerator.size,a=0;a<r;++a)for(var s=0;s<r;++s)this.fontImageData[4*(n+a)*i+(4*e+4*s)]=t[4*a*r+4*s],this.fontImageData[4*(n+a)*i+(4*e+4*s+1)]=t[4*a*r+(4*s+1)],this.fontImageData[4*(n+a)*i+(4*e+4*s+2)]=t[4*a*r+(4*s+2)],this.fontImageData[4*(n+a)*i+(4*e+4*s+3)]=t[4*a*r+(4*s+3)]},Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tinySDFGenerator",{get:function(){return this._tinySDFGenerator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metrics",{get:function(){return this._metrics},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._texture.destroy()},t}();e.FontSDF=a},function(t,e,n){"use strict";t.exports=r;var i=1e20;function r(t,e,n,i,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,i,r,o,s){for(var l=0;l<e;l++){for(var u=0;u<n;u++)i[u]=t[u*e+l];for(a(i,r,o,s,n),u=0;u<n;u++)t[u*e+l]=r[u]}for(u=0;u<n;u++){for(l=0;l<e;l++)i[l]=t[u*e+l];for(a(i,r,o,s,e),l=0;l<e;l++)t[u*e+l]=Math.sqrt(r[l])}}function a(t,e,n,r,o){n[0]=0,r[0]=-i,r[1]=+i;for(var a=1,s=0;a<o;a++){for(var l=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);l<=r[s];)s--,l=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);n[++s]=a,r[s]=l,r[s+1]=+i}for(a=0,s=0;a<o;a++){for(;r[s+1]<a;)s++;e[a]=(a-n[s])*(a-n[s])+t[n[s]]}}r.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var a=e.data[4*r+3]/255;this.gridOuter[r]=1===a?0:0===a?i:Math.pow(Math.max(0,.5-a),2),this.gridInner[r]=1===a?i:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var s=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(93),r=n(41),o=function(){function t(t,e){this.map=t,this.symbolAnnotations=e,this.infoWindows=new Map,this.createInfoWindowContainer()}return t.prototype.createInfoWindowContainer=function(){this.infoWindowContainer||(this.infoWindowContainer=r.DOMUtils.create("div","mf-info-window-container",this.map.getMapContainer()))},t.prototype.createInfoContentsContainer=function(){this.infoContentsContainer||(this.createInfoWindowContainer(),this.infoContentsContainer=r.DOMUtils.create("div","mf-info-window-content mf-scrollbar",this.infoWindowContainer))},t.prototype.createInfoWindow=function(t){var e=this.getInfoWindow(t);return null!=e?(null==this.infoContentsContainer&&(this.infoContentsContainer=r.DOMUtils.create("div",null,this.infoWindowContainer)),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createInfoContents=function(t){var e=this.getInfoContents(t);return null!=e?(this.createInfoContentsContainer(),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createDefaultInfoContents=function(t){var e=t.getTitle(),n=t.getSnippet();if(!(""!==e&&null!=e||""!==n&&null!=n))return null;this.createInfoContentsContainer();var i=this.getDefaultContents(t);return this.setContentsHTMLElement(i),this.infoContentsContainer},t.prototype.deselectMarker=function(){null!=this.selectedMarkerId&&this.hideInfoWindow(this.selectedMarkerId)},t.prototype.getDefaultContents=function(t){var e=t.getTitle()||"",n=t.getSnippet()||"";return(e.length>0?"<h4>"+e+"</h4>":"")+(n.length>0?"<p>"+t.getSnippet()+"</p>":"")},t.prototype.getInfoContents=function(t){var e=t.getInfoContents();return null!=e?e:null},t.prototype.getInfoWindow=function(t){var e=t.getInfoWindow();return null!=e?e:null},t.prototype.getInfoWindowHTMLElement=function(t){var e=this.createInfoWindow(t);if(null!=e)return e;var n=this.createInfoContents(t);return null!=n?n:this.createDefaultInfoContents(t)},t.prototype.isInfoWindowShown=function(t){return null!=this.selectedMarkerId&&this.selectedMarkerId==t},t.prototype.removeContent=function(){this.infoContentsContainer&&(r.DOMUtils.remove(this.infoContentsContainer),this.infoContentsContainer=null)},t.prototype.render=function(t){null!=this.selectedMarkerId&&(t.indexOf(this.selectedMarkerId)>-1?this.update():this.infoWindowContainer.style.visibility="hidden")},t.prototype.update=function(){var t=this.symbolAnnotations.get(this.selectedMarkerId);if(null!=t){var e=this.infoWindows.get(this.selectedMarkerId).getPositionBySymbolAnnotationData(t,this.map.mapState);if(null==e)return;var n=e.x,i=e.y,r=this.infoWindowContainer.style;r.top=i.toString()+"px",r.left=n.toString()+"px","hidden"==r.visibility&&(r.visibility="visible")}},t.prototype.hideInfoWindow=function(t){var e=t||this.selectedMarkerId;null!=e&&(this.removeContent(),this.infoWindows.delete(e),this.selectedMarkerId=null)},t.prototype.showInfoWindow=function(t){if(t!==this.selectedMarkerId){this.deselectMarker();var e=this.symbolAnnotations.get(t);if(null!=e&&e.symbolAnnotation.isVisible()){var n=e.symbolAnnotation,r=this.getInfoWindowHTMLElement(n);if(r&&r.children.length>0){for(var o="",a=0;a<r.children.length;++a)o+=r.children[a].innerHTML;""==o&&(console.error("All content you set for Info Window is NULL, Please check your custom setInfoContents() method."),r=null)}var s=new i.InfoWindow(r,n.getWindowAnchor());this.infoWindows.clear(),this.infoWindows.set(t,s),this.selectedMarkerId=t,this.update()}}},t.prototype.setContentsHTMLElement=function(t){this.infoContentsContainer&&(this.infoContentsContainer.innerHTML=t.toString())},t.prototype.updateInfoContents=function(t){var e=this.symbolAnnotations.get(t).symbolAnnotation,n=this.infoWindows.get(t);null!=n&&(n.setContent(this.getInfoWindowHTMLElement(e)),this.update())},t}();e.InfoWindowManager=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(41),r=n(1),o=n(0),a=function(){function t(t){this._mapView=t,this._iconViewMarkers=new Map,this._iconViewsHTML=new Map}return t.prototype.update=function(){var t=this;this._iconViewMarkers.forEach(function(e){t.updateIconView(e.getId())})},t.prototype.updateIconView=function(t){if(this._iconViewMarkers.get(t)){var e=this._iconViewMarkers.get(t),n=this._mapView.latLngToScreenCoordinate(e.getPosition(),e.getElevation());n.x/=r.MapUtils.pixelScale,n.y/=r.MapUtils.pixelScale;var a=this._iconViewsHTML.get(t);a||((a=i.DOMUtils.create("div","mf-iconview-marker-container",this._mapView.getMapContainer())).style.pointerEvents="none"),a.id="mf-iconview-marker-"+t,a.innerHTML=""+e.getIconView(),this._iconViewsHTML.set(t,a);var s=document.getElementById(""+a.id),l=a.style,u=s.clientWidth%2?s.clientWidth+1:s.clientWidth,h=s.clientHeight%2?s.clientHeight+1:s.clientHeight,c=n.x+(.5-e.getAnchor().x)*u,f=n.y+(.5-e.getAnchor().y)*h;l.top=f.toString()+"px",l.left=c.toString()+"px",l.zIndex=e.getZIndex().toString(),e.isVisible()?l.visibility="visible":l.visibility="hidden",n.y=this._mapView.mapState.getZoom()>o.MapConstants.defaultMaxNativeZoom?n.y:n.y+24;var p=this._mapView.screenCoordinateToLatLng(n);(a.offsetLeft>this._mapView.mapState.getScreenSize().x||a.offsetLeft<-a.offsetWidth||a.offsetTop>this._mapView.mapState.getScreenSize().y||a.offsetTop<-a.offsetHeight||p.lng==1/0||p.lat==1/0)&&(l.visibility="hidden")}},t.prototype.add=function(t,e){this._iconViewMarkers.set(t,e),this.updateIconView(t)},t.prototype.getIconViewMarkers=function(){return this._iconViewMarkers},t.prototype.getIconViewsHTML=function(){return this._iconViewsHTML},t.prototype.remove=function(t){this.removeContainer(t),this._iconViewsHTML.delete(t),this._iconViewMarkers.delete(t)},t.prototype.removeContainer=function(t){if(this._iconViewsHTML.get(t)){var e=this._iconViewsHTML.get(t);i.DOMUtils.remove(e),e=null}},t.prototype.removeAllContainers=function(){this._iconViewsHTML.forEach(function(t){i.DOMUtils.remove(t),t=null}),this._iconViewsHTML.clear()},t.prototype.destroy=function(){this.removeAllContainers(),this._iconViewMarkers.clear()},t}();e.IconViewMarkerManager=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(53),o=n(37),a=n(15),s=n(5),l=n(54),u=n(1),h=n(2),c=n(10),f=n(9),p=n(26),d=n(64),g=n(4),m=function(t){function e(e,n){var i=t.call(this,s.LayerType.GEOJSON)||this;return i.vertices=[],i.indices=[],i.gl=n,i.partials=new Map,i.fillOutlinedPartials=new Map,i.fillProperties=new Map,i.lineProperties=new Map,i.fillOutlinedProperties=new Map,i.pointCoordinates=new Map,i.buildFillStroke(e),i.buildModel(e),i.model=new o.Model(i.gl),i.model.init(i.vertices,[new c.AttributeInfo("a_position",2,0,4),new c.AttributeInfo("a_extrude",2,2,4)],i.indices),i.vertices=[],i.indices=[],i.initializeProperties(e),i}return i(e,t),e.prototype.getModel=function(){return this.model},e.prototype.getPartials=function(){return this.partials},e.prototype.getFillOutlinedPartials=function(){return this.fillOutlinedPartials},e.prototype.getFillProperties=function(){return this.fillProperties},e.prototype.getLineProperties=function(){return this.lineProperties},e.prototype.getFillOutlinedProperties=function(){return this.fillOutlinedProperties},e.prototype.getPointCoordinates=function(){return this.pointCoordinates},e.prototype.buildFillStroke=function(t){for(var e=u.MapUtils.getTileSize(),n=t.featureCount(),i=0,r=0,o=[],s=0;s<n;++s){var l=t.getFeature(s);if(l.getType()==a.GeometryType.LineString&&!0===l.getProperties().get("fill-outlined")){for(var c=l.getGeometries().geometryCoordinates,f=this.indices.length,g=0;g<c.length;++g){r+=c[g].length;for(var m=0;m<c[g].length;++m){var y=new h.Vector2(c[g][m][0],c[g][m][1]);y.x=y.x*e,y.y=y.y*e,this.vertices.push(y.x),this.vertices.push(y.y),this.vertices.push(0),this.vertices.push(0),i!=r-1?(this.indices.push(i++),this.indices.push(i)):i++}}var v=this.indices.length-f;o.push(new d.Range(f,v));var b="";l instanceof p.VectorTileFeature&&(b=l.getId());var _=this.fillOutlinedPartials.get(b);_?_.push(o):this.fillOutlinedPartials.set(b,[o]),o=[]}}},e.prototype.initializeProperties=function(t){if(t instanceof p.VectorTileLayer)for(var n=t.featureCount(),i=0;i<n;++i){var r=t.getFeature(i),o=r.getType(),s=r.getProperties(),l=r.getId()||"";if(o==a.GeometryType.Point){var h=s.get("coordinate-lat"),c=s.get("coordinate-lng");if(null==h||null==c){console.warn("Point feature does not have coordinate");continue}this.pointCoordinates.has(l)?this.pointCoordinates.get(l).push(new g.LatLng(h,c)):this.pointCoordinates.set(l,[new g.LatLng(h,c)])}else if(o==a.GeometryType.LineString)if(null==s)this.lineProperties.set(l,{strokeColor:e.defaultStrokeColor,strokeWidth:e.defaultStrokeWidth*u.MapUtils.pixelScale});else if(s.has("fill-outlined")){var d=s.get("stroke")||"#555555",m=s.has("stroke-opacity")?s.get("stroke-opacity"):1;(y=f.Color.fromHex(d)).alpha=m,this.fillOutlinedProperties.set(l,{strokeColor:y})}else{var y,v=s.get("stroke")||"#555555",b=s.has("stroke-opacity")?s.get("stroke-opacity"):1;(y=f.Color.fromHex(v)).alpha=b;var _=s.has("stroke-width")?s.get("stroke-width"):e.defaultStrokeWidth;_*=u.MapUtils.pixelScale,this.lineProperties.set(l,{strokeColor:y,strokeWidth:_})}else if(s){v=s.get("fill")||"#555555",b=s.has("fill-opacity")?s.get("fill-opacity"):.5;var w=f.Color.fromHex(v);w.alpha=b,this.fillProperties.set(l,{fillColor:w})}else this.fillProperties.set(l,{fillColor:e.defaultFillColor})}},e.prototype.buildModel=function(t){var e=this,n=this.vertices.length/4,i=0,r=new l.PolygonBuilderContext;r.addVertex=function(t){e.vertices.push(t.x,t.y,0,0),++i};var o=new l.PolylineBuilderContext;o.addVertex=function(t,n){e.vertices.push(t.x,t.y,n.x,n.y),++i},o.lineCapType=l.LineCapType.Butt,o.lineJoinType=l.LineJoinType.Round;for(var s=u.MapUtils.getTileSize(),c=t.featureCount(),f=0;f<c;++f){var g=t.getFeature(f),m=g.getProperties(),y=g.getType();if(y==a.GeometryType.Point);else if(y==a.GeometryType.Polygon){for(var v=this.indices.length,b=g.getGeometries().geometryCoordinates,_=[],w=0;w<b.length;++w){for(var M=[],x=0;x<b[w].length;++x){(E=new h.Vector2(b[w][x][0],b[w][x][1])).x=E.x*s,E.y=E.y*s,M.push(E)}_.push(M)}r.clear(),l.buildPolygon(_,r);var A="";g instanceof p.VectorTileFeature&&(A=g.getId()),r.indices.forEach(function(t){return e.indices.push(t+n)}),n+=i,i=0;var T=this.indices.length-v;this.partials.has(A)?this.partials.get(A).push(new d.Range(v,T)):this.partials.set(A,[new d.Range(v,T)])}else{if(null==m||m.has("fill-outlined"))continue;o.clear();for(v=this.indices.length,b=g.getGeometries().geometryCoordinates,w=0;w<b.length;++w){var S=[];for(x=0;x<b[w].length;++x){var E;(E=new h.Vector2(b[w][x][0],b[w][x][1])).x=E.x*s,E.y=E.y*s,S.push(E)}o.buildPolyLine(S)}o.indices.forEach(function(t){return e.indices.push(t+n)}),n+=i,i=0;T=this.indices.length-v,A="";g instanceof p.VectorTileFeature&&(A=g.getId()),this.partials.set(A,[new d.Range(v,T)])}}},e.prototype.destroy=function(){this.model&&this.model.destroy()},e.defaultFillColor=f.Color.fromHex("#555555"),e.defaultStrokeColor=f.Color.fromHex("#555555"),e.defaultStrokeWidth=5,e}(r.LayerData);e.GeoJsonLayerData=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(35),r=n(157),o=function(){function t(){var t=this;this.maxConcurrentRequest=5,this.maxWorker=3,this.workers=[],this.pendingTasks=[],this.activedTasks=[];for(var e=0;e<this.maxWorker;++e){var n=r.WorkerHelper.createWorker(function(e){t.onCompletionTask(e)});this.workers.push(n)}for(e=0;e<i.Resource.MAX;e++)this.pendingTasks.push([])}return t.prototype.postTask=function(t){this.pendingTasks[t.type].unshift(t),this.executeTasks()},t.prototype.executeTasks=function(){if(!(this.activedTasks.length>this.maxConcurrentRequest))for(var t=0,e=this.workers;t<e.length;t++){var n=e[t];if(n.canExecuteTask()&&this.hasTask()){var i=this.getTask();this.activedTasks.push(i),i.worker=n,n.executeTask(i)}}},t.prototype.hasTask=function(){for(var t=0;t<i.Resource.MAX;t++)if(this.pendingTasks[t].length>0)return!0;return!1},t.prototype.getTask=function(){for(var t=0;t<i.Resource.MAX;t++)if(this.pendingTasks[t].length>0)return this.pendingTasks[t].pop();return null},t.prototype.cancelTask=function(t){if(t){var e=this.removeTask(t.id);null!=e&&(e.worker&&e.worker.cancel(e),e.completion&&e.completion(new i.ResponseTask(t.id)))}},t.prototype.onCompletionTask=function(t){var e=this.activedTasks.findIndex(function(e){return e.id==t.id});if(e<0)this.executeTasks();else{var n=this.activedTasks[e];this.activedTasks.splice(e,1),n.completion&&n.completion(t),this.executeTasks()}},t.prototype.removeTask=function(t){for(var e=0;e<i.Resource.MAX;e++){var n=this.pendingTasks[e].findIndex(function(e){return e.id==t});if(n>=0){var r=this.pendingTasks[e][n];return this.pendingTasks[e].splice(n,1),r}}var o=this.activedTasks.findIndex(function(e){return e.id==t});if(o>=0){r=this.activedTasks[o];return this.activedTasks.splice(o,1),r}return null},t}();e.TaskManager=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(158),r=n(35),o=n(214),a=n(215),s=n(74),l=n(48),u=function(){function t(t){this.id=t}return t.prototype.abort=function(){null!=this.request&&this.request.abort()},t}(),h=function(){function t(){}return t.createWorker=function(t){var e=this.workerUrl,n=new Worker(e),i=new a.TaskWorker(n);return n.onmessage=function(e){var n=e.data;i.finishedTask(),t(n)},i},Object.defineProperty(t,"workerUrl",{get:function(){var e=[];if(t.scriptUrl)e=[t.scriptUrl];else for(var n=document.getElementsByTagName("script"),i=0;i<n.length;++i){var r=n[i];r.src.indexOf("map4d.vn")>-1&&r.src.indexOf("/api/js")>-1&&e.push(r.src)}var o="importScripts("+e.map(function(t){return'"'+t+'"'}).join(",")+");",a=new Blob([o],{type:"application/javascript"});return window.URL.createObjectURL(a)},enumerable:!0,configurable:!0}),t.setupWorkerThread=function(){var t=this;self.onmessage=function(e){var n=e.data;n.execute?t.execute(JSON.parse(n.payload)):t.cancel(JSON.parse(n.payload))}},t.getTexture=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==n.status){e.success=!0;var o=i(this.response);if(!o)return console.error("There is an error while parsing the texture image"),e.success=!1,void postMessage(e);o.data=o.data.buffer,e.data=o,postMessage(e,[e.data.data])}else e.success=!1,postMessage(e)}},n.open("GET",t.url),n.responseType="arraybuffer",n.send(),e.request=n},t.getModel=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==n.status){e.success=!0;var i=s.ObjModelLoader.loadModel(this.responseText,!0);e.data=i,null!=i&&i.length>0?postMessage(e,[e.data[0].data]):(e.success=!1,postMessage(e))}else e.success=!1,postMessage(e)}},n.open("GET",t.url),this.setHeaderInfo(n),n.send(),e.request=n},t.getTileData=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==n.status){e.success=!0;var i=JSON.parse(n.responseText);e.data=i,postMessage(e)}else e.success=!1,postMessage(e)}},n.open(t.method,t.url,!0),null!=t.params&&n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Accept","application/json"),n.send(t.params),e.request=n},t.setHeaderInfo=function(t){t.setRequestHeader("sdk-name","map4d-map"),t.setRequestHeader("sdk-platform","web"),t.setRequestHeader("sdk-version",l.Env.sdkVersion),t.setRequestHeader("signature","__SIGNATURE__")},t.getJson=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=new r.ResponseTask(t.id);if(200==n.status){e.success=!0;var i=JSON.parse(n.responseText);e.data=i,postMessage(e)}else e.success=!1,postMessage(e)}},n.open(t.method,t.url,!0),null!=t.params&&n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Accept","application/json"),this.setHeaderInfo(n),n.send(t.params),e.request=n},t.execute=function(t){var e=new u(t.id);this.executeTasks.push(e),t.type==r.Resource.Texture?this.getTexture(t,e):t.type==r.Resource.Model?this.getModel(t,e):t.type==r.Resource.RasterTile?this.getTexture(t,e):t.type==r.Resource.TileData?this.getTileData(t,e):t.type==r.Resource.Json&&this.getJson(t,e)},t.cancel=function(t){var e=this.removeTask(t.id);null!=e&&e.abort()},t.removeTask=function(t){var e=this.executeTasks.findIndex(function(e){return e.id==t});if(e>=0){var n=this.executeTasks[e];return this.executeTasks.splice(e,1),n}return null},t.scriptUrl="",t.executeTasks=[],t}();e.WorkerHelper=h,o.Thread.isWorker&&h.setupWorkerThread(),o.Thread.isWorker||(document.currentScript.onload=function(t){var e=null!=t.path&&t.path.length>0?t.path[0].src:null,n=null!=t.currentTarget?t.currentTarget.src:null,i=null!=t.target?t.target.src:null;h.scriptUrl=e||n||i,console.log(h.scriptUrl),window.__INIT_MAP__&&window.__INIT_MAP__()})},function(t,e,n){"use strict";var i=n(159),r=n(95);function o(t,e){if(!(t=r(t)))return null;e?"string"==typeof e&&(e={type:e}):e={};var n=e.type;if(!n){if(!(n=i(new Uint8Array(t))))return null;if(!o[n=n.mime])throw Error("Type `"+n+"` does not seem to be supported")}return o[n](t,e)}t.exports=o,o.png=o["image/png"]=n(168),o.gif=o["image/gif"]=n(196),o["image/jpeg"]=o["image/jpg"]=o.jpg=o.jpeg=n(198),o.bmp=o["image/bmp"]=o["image/bitmap"]=n(203),o.tiff=o["image/tiff"]=n(207),o.webp=o["image/webp"]=n(213)},function(t,e,n){"use strict";const i=n(160),r=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),o=t=>{const e=i(t);return r.has(e&&e.ext)?e:null};t.exports=o,t.exports.default=o,Object.defineProperty(o,"minimumBytes",{value:i.minimumBytes})},function(module,exports,__webpack_require__){"use strict";(function(Buffer){const toBytes=t=>[...t].map(t=>t.charCodeAt(0)),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let n=t[e],i=1,r=0;for(;++r<8;)i*=256,n+=t[e+r]*i;return n}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const n=(t,n)=>{n=Object.assign({offset:0},n);for(let i=0;i<t.length;i++)if(n.mask){if(t[i]!==(n.mask[i]&e[i+n.offset]))return!1}else if(t[i]!==e[i+n.offset])return!1;return!0},i=(t,e)=>n(toBytes(t),e);if(n([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(n([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(n([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(n([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((n([73,73,42,0])||n([77,77,0,42]))&&n([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(n([73,73,42,0])||n([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n([66,77]))return{ext:"bmp",mime:"image/bmp"};if(n([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(n([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n([80,75,3,4])){if(n([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(n(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(i("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(i("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(i("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex((t,n,i)=>n>=e&&80===i[n]&&75===i[n+1]&&3===i[n+2]&&4===i[n+3]);let r=0,o=!1,a=null;do{const s=r+30;if(o||(o=n(oxmlContentTypes,{offset:s})||n(oxmlRels,{offset:s})),a||(i("word/",{offset:s})?a={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:i("ppt/",{offset:s})?a={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:i("xl/",{offset:s})&&(a={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),o&&a)return a;r=t(e,s)}while(r>=0);if(a)return a}if(n([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(n([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(n([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(n([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(n([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(n([51,103,112,53])||n([0,0,0])&&n([102,116,121,112],{offset:4})&&(n([109,112,52,49],{offset:8})||n([109,112,52,50],{offset:8})||n([105,115,111,109],{offset:8})||n([105,115,111,50],{offset:8})||n([109,109,112,52],{offset:8})||n([77,52,86],{offset:8})||n([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(n([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(n([26,69,223,163])){const t=e.subarray(4,4100),n=t.findIndex((t,e,n)=>66===n[e]&&130===n[e+1]);if(-1!==n){const e=n+3,i=n=>[...n].every((n,i)=>t[e+i]===n.charCodeAt(0));if(i("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(i("webm"))return{ext:"webm",mime:"video/webm"}}}if(n([0,0,0,20,102,116,121,112,113,116,32,32])||n([102,114,101,101],{offset:4})||n([102,116,121,112,113,116,32,32],{offset:4})||n([109,100,97,116],{offset:4})||n([109,111,111,118],{offset:4})||n([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(n([82,73,70,70])){if(n([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(n([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(n([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const i=readUInt64LE(e,t+16);if(n([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(n([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(n([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=i}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(n([0,0,1,186])||n([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(n([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(n([73,68,51],{offset:t})||n([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(n([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(n([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(n([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(n([79,103,103,83]))return n([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:n([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:n([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:n([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:n([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(n([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(n([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(n([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(n([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(n([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(n([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&n([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(n([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(n([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(n([119,79,70,70])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(n([119,79,70,50])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(n([76,80],{offset:34})&&(n([0,0,1],{offset:8})||n([1,0,2],{offset:8})||n([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(n([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(n([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(n([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(n([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n([37,33]))return{ext:"ps",mime:"application/postscript"};if(n([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(n([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n([77,83,67,70])||n([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(n([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(n([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(n([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(n([31,160])||n([31,157]))return{ext:"Z",mime:"application/x-compress"};if(n([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(n([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(n([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n([71],{offset:4})&&(n([71],{offset:192})||n([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(n([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(n([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n([0,0,0,12,106,80,32,32,13,10,135,10])){if(n([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(n([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(n([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(n([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(n([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(n([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(n([102,116,121,112],{offset:4})){if(n([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(n([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(n([104,101,105,99],{offset:8})||n([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(n([104,101,118,99],{offset:8})||n([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return n([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:n([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:n([77,80,43])?{ext:"mpc",mime:"audio/x-musepack"}:n([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:n([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:n([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:n([212,195,178,161])||n([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,()=>{})):resolve(readableStream.pipe(t))})}))}).call(this,__webpack_require__(3).Buffer)},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){for(var e,n=u(t),i=n[0],a=n[1],s=new o(function(t,e,n){return 3*(e+n)/4-n}(0,i,a)),l=0,h=a>0?i-4:i,c=0;c<h;c+=4)e=r[t.charCodeAt(c)]<<18|r[t.charCodeAt(c+1)]<<12|r[t.charCodeAt(c+2)]<<6|r[t.charCodeAt(c+3)],s[l++]=e>>16&255,s[l++]=e>>8&255,s[l++]=255&e;2===a&&(e=r[t.charCodeAt(c)]<<2|r[t.charCodeAt(c+1)]>>4,s[l++]=255&e);1===a&&(e=r[t.charCodeAt(c)]<<10|r[t.charCodeAt(c+1)]<<4|r[t.charCodeAt(c+2)]>>2,s[l++]=e>>8&255,s[l++]=255&e);return s},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o=[],a=0,s=n-r;a<s;a+=16383)o.push(c(t,a,a+16383>s?s:a+16383));1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],r[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}function c(t,e,n){for(var i,r=[],o=e;o<n;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),r.push(h(i));return r.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,u=l>>1,h=-7,c=n?r-1:0,f=n?-1:1,p=t[e+c];for(c+=f,o=p&(1<<-h)-1,p>>=-h,h+=s;h>0;o=256*o+t[e+c],c+=f,h-=8);for(a=o&(1<<-h)-1,o>>=-h,h+=i;h>0;a=256*a+t[e+c],c+=f,h-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=u}return(p?-1:1)*a*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var a,s,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,d=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=h):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(a++,l/=2),a+c>=h?(s=0,a=h):a+c>=1?(s=(e*l-1)*Math.pow(2,r),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,r),a=0));r>=8;t[n+p]=255&s,p+=d,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[n+p]=255&a,p+=d,a/=256,u-=8);t[n+p-d]|=128*g}},function(t,e,n){"use strict";var i=n(164),r=n(165);function o(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e.buffer}t.exports=function(t){if("string"!=typeof t)throw Error("Argument should be a string");return/^data\:/i.test(t)?function(t){var e=(t=t.replace(/\r?\n/g,"")).indexOf(",");if(-1===e||e<=4)throw new TypeError("malformed data-URI");for(var n=t.substring(5,e).split(";"),r=!1,a="US-ASCII",s=0;s<n.length;s++)"base64"==n[s]?r=!0:0==n[s].indexOf("charset=")&&(a=n[s].substring(8));var l=unescape(t.substring(e+1));r&&(l=i(l));var u=o(l);return u.type=n[0]||"text/plain",u.charset=a,u}(t):(r(t)&&(t=i(t)),o(t))}},function(t,e){t.exports=function(t){return atob(t)}},function(t,e,n){!function(n){"use strict";function i(t,e){if(t instanceof Boolean||"boolean"==typeof t)return!1;if(e instanceof Object||(e={}),e.hasOwnProperty("allowBlank")&&!e.allowBlank&&""===t)return!1;var n="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return e.mime&&(n="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+n),!1===e.paddingRequired&&(n="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+n+"$","gi").test(t)}void 0!==t&&t.exports&&(e=t.exports=i),e.isBase64=i}()},function(t,e,n){var i=n(167);t.exports=function(t,e,n){if(!t)throw new TypeError("must specify data as first parameter");if(n=0|+(n||0),Array.isArray(t)&&t[0]&&"number"==typeof t[0][0]){var r,o,a,s,l=t[0].length,u=t.length*l;e&&"string"!=typeof e||(e=new(i(e||"float32"))(u+n));var h=e.length-n;if(u!==h)throw new Error("source length "+u+" ("+l+"x"+t.length+") does not match destination length "+h);for(r=0,a=n;r<t.length;r++)for(o=0;o<l;o++)e[a++]=null===t[r][o]?NaN:t[r][o]}else if(e&&"string"!=typeof e)e.set(t,n);else{var c=i(e||"float32");if(Array.isArray(t)||"array"===e)for(e=new c(t.length+n),r=0,a=n,s=e.length;a<s;a++,r++)e[a]=null===t[r]?NaN:t[r];else 0===n?e=new c(t):(e=new c(t.length+n)).set(t,n)}return e}},function(t,e){t.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},function(t,e,n){"use strict";(function(e){var i=n(169).PNG,r=n(95);t.exports=function(t,n){var o=i.sync.read(e.from(t));return{data:new Uint8Array(r(o.data)),width:0|o.width,height:0|o.height}}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(t,i){var r=n(23),o=n(56),a=n(182),s=n(188),l=n(191),u=e.PNG=function(e){o.call(this),e=e||{},this.width=0|e.width,this.height=0|e.height,this.data=this.width>0&&this.height>0?new t(4*this.width*this.height):null,e.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new a(e),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(t){this.data=t,this.emit("parsed",t)}.bind(this)),this._packer=new s(e),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(u,o),u.sync=l,u.prototype.pack=function(){return this.data&&this.data.length?(i.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},u.prototype.parse=function(t,e){var n,i;e&&(n=function(t){this.removeListener("error",i),this.data=t,e(null,this)}.bind(this),i=function(t){this.removeListener("parsed",n),e(t,null)}.bind(this),this.once("parsed",n),this.once("error",i));return this.end(t),this},u.prototype.write=function(t){return this._parser.write(t),!0},u.prototype.end=function(t){this._parser.end(t)},u.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},u.prototype._gamma=function(t){this.gamma=t},u.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},u.bitblt=function(t,e,n,i,r,o,a,s){if(i|=0,r|=0,o|=0,a|=0,s|=0,(n|=0)>t.width||i>t.height||n+r>t.width||i+o>t.height)throw new Error("bitblt reading outside image");if(a>e.width||s>e.height||a+r>e.width||s+o>e.height)throw new Error("bitblt writing outside image");for(var l=0;l<o;l++)t.data.copy(e.data,(s+l)*e.width+a<<2,(i+l)*t.width+n<<2,(i+l)*t.width+n+r<<2)},u.prototype.bitblt=function(t,e,n,i,r,o,a){return u.bitblt(this,t,e,n,i,r,o,a),this},u.adjustGamma=function(t){if(t.gamma){for(var e=0;e<t.height;e++)for(var n=0;n<t.width;n++)for(var i=t.width*e+n<<2,r=0;r<3;r++){var o=t.data[i+r]/255;o=Math.pow(o,1/2.2/t.gamma),t.data[i+r]=Math.round(255*o)}t.gamma=0}},u.prototype.adjustGamma=function(){u.adjustGamma(this)}}).call(this,n(3).Buffer,n(16))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){},function(t,e,n){"use strict";var i=n(58).Buffer,r=n(173);function o(t,e,n){t.copy(e,n)}t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var e=i.allocUnsafe(t>>>0),n=this.head,r=0;n;)o(n.data,e,r),r+=n.data.length,n=n.next;return e},t}(),r&&r.inspect&&r.inspect.custom&&(t.exports.prototype[r.inspect.custom]=function(){var t=r.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(175),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(22))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r=1,o={},a=!1,s=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){h(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&h(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),i=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){h(t.data)},i=function(e){t.port2.postMessage(e)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var t=s.documentElement;i=function(e){var n=s.createElement("script");n.onreadystatechange=function(){h(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():i=function(t){setTimeout(h,0,t)},l.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var a={callback:t,args:e};return o[r]=a,i(r),r++},l.clearImmediate=u}function u(t){delete o[t]}function h(t){if(a)setTimeout(h,0,t);else{var e=o[t];if(e){a=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}(e)}finally{u(t),a=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(22),n(16))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),i=!0}return t.apply(this,arguments)}}}).call(this,n(22))},function(t,e,n){"use strict";t.exports=o;var i=n(100),r=n(45);function o(t){if(!(this instanceof o))return new o(t);i.call(this,t)}r.inherits=n(28),r.inherits(o,i),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(69)},function(t,e,n){t.exports=n(29)},function(t,e,n){t.exports=n(68).Transform},function(t,e,n){t.exports=n(68).PassThrough},function(t,e,n){"use strict";var i=n(23),r=n(46),o=n(105),a=n(187),s=n(109),l=n(111),u=n(112),h=t.exports=function(t){o.call(this),this._parser=new s(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};i.inherits(h,o),h.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},h.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=r.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,n=Math.max(e,r.Z_MIN_CHUNK);this._inflate=r.createInflate({chunkSize:n});var i=e,o=this.emit.bind(this,"error");this._inflate.on("error",function(t){i&&o(t)}),this._filter.on("complete",this._complete.bind(this));var a=this._filter.write.bind(this._filter);this._inflate.on("data",function(t){i&&(t.length>i&&(t=t.slice(0,i)),i-=t.length,a(t))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},h.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new a(this._bitmapInfo)},h.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},h.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},h.prototype._simpleTransparency=function(){this._metaData.alpha=!0},h.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},h.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},h.prototype._complete=function(t){if(!this.errord){try{var e=l.dataToBitMap(t,this._bitmapInfo),n=u(e,this._bitmapInfo);e=null}catch(t){return void this._handleError(t)}this.emit("parsed",n)}}},function(t,e,n){"use strict";(function(t,i){var r=n(70),o=n(71),a=n(101),s=n(104),l=n(73);for(var u in l)e[u]=l[u];e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7;function h(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}h.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?a.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||s.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},h.prototype.write=function(t,e,n,i,r,o,a){return this._write(!0,t,e,n,i,r,o,a)},h.prototype.writeSync=function(t,e,n,i,r,o,a){return this._write(!1,t,e,n,i,r,o,a)},h.prototype._write=function(n,o,a,s,l,u,h,c){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==e.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===o,"must provide flush value"),this.write_in_progress=!0,o!==e.Z_NO_FLUSH&&o!==e.Z_PARTIAL_FLUSH&&o!==e.Z_SYNC_FLUSH&&o!==e.Z_FULL_FLUSH&&o!==e.Z_FINISH&&o!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==a&&(a=t.alloc(0),l=0,s=0),this.strm.avail_in=l,this.strm.input=a,this.strm.next_in=s,this.strm.avail_out=c,this.strm.output=u,this.strm.next_out=h,this.flush=o,!n)return this._process(),this._checkError()?this._afterSync():void 0;var f=this;return i.nextTick(function(){f._process(),f._after()}),this},h.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},h.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},h.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},h.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},h.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},h.prototype.init=function(t,n,i,o,a){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(t>=8&&t<=15,"invalid windowBits"),r(n>=-1&&n<=9,"invalid compression level"),r(i>=1&&i<=9,"invalid memlevel"),r(o===e.Z_FILTERED||o===e.Z_HUFFMAN_ONLY||o===e.Z_RLE||o===e.Z_FIXED||o===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,t,i,o,a),this._setDictionary()},h.prototype.params=function(){throw new Error("deflateParams Not supported")},h.prototype.reset=function(){this._reset(),this._setDictionary()},h.prototype._init=function(t,n,i,r,l){switch(this.level=t,this.windowBits=n,this.memLevel=i,this.strategy=r,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=l,this.write_in_progress=!1,this.init_done=!0},h.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},h.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=a.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=h}).call(this,n(3).Buffer,n(16))},function(t,e,n){"use strict";var i=n(24),r=4,o=0,a=1,s=2;function l(t){for(var e=t.length;--e>=0;)t[e]=0}var u=0,h=1,c=2,f=29,p=256,d=p+1+f,g=30,m=19,y=2*d+1,v=15,b=16,_=7,w=256,M=16,x=17,A=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(d+2));l(L);var P=new Array(2*g);l(P);var I=new Array(512);l(I);var O=new Array(256);l(O);var R=new Array(f);l(R);var k,D,B,U=new Array(g);function j(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function F(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function N(t){return t<256?I[t]:I[256+(t>>>7)]}function Z(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function V(t,e,n){t.bi_valid>b-n?(t.bi_buf|=e<<t.bi_valid&65535,Z(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=n-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function z(t,e,n){V(t,n[2*e],n[2*e+1])}function W(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function Y(t,e,n){var i,r,o=new Array(v+1),a=0;for(i=1;i<=v;i++)o[i]=a=a+n[i-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=W(o[s]++,s))}}function G(t){var e;for(e=0;e<d;e++)t.dyn_ltree[2*e]=0;for(e=0;e<g;e++)t.dyn_dtree[2*e]=0;for(e=0;e<m;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*w]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function H(t){t.bi_valid>8?Z(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function X(t,e,n,i){var r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]}function J(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&X(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!X(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function q(t,e,n){var i,r,o,a,s=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],r=t.pending_buf[t.l_buf+s],s++,0===i?z(t,r,e):(z(t,(o=O[r])+p+1,e),0!==(a=T[o])&&V(t,r-=R[o],a),z(t,o=N(--i),n),0!==(a=S[o])&&V(t,i-=U[o],a))}while(s<t.last_lit);z(t,w,e)}function Q(t,e){var n,i,r,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=y,n=0;n<l;n++)0!==o[2*n]?(t.heap[++t.heap_len]=u=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=a[2*r+1]);for(e.max_code=u,n=t.heap_len>>1;n>=1;n--)J(t,o,n);r=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],J(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*r]=o[2*n]+o[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=r,t.heap[1]=r++,J(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,r,o,a,s,l=e.dyn_tree,u=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,d=e.stat_desc.max_length,g=0;for(o=0;o<=v;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<y;n++)(o=l[2*l[2*(i=t.heap[n])+1]+1]+1)>d&&(o=d,g++),l[2*i+1]=o,i>u||(t.bl_count[o]++,a=0,i>=p&&(a=f[i-p]),s=l[2*i],t.opt_len+=s*(o+a),c&&(t.static_len+=s*(h[2*i+1]+a)));if(0!==g){do{for(o=d-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[d]--,g-=2}while(g>0);for(o=d;0!==o;o--)for(i=t.bl_count[o];0!==i;)(r=t.heap[--n])>u||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),i--)}}(t,e),Y(o,u,t.bl_count)}function K(t,e,n){var i,r,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=e[2*(i+1)+1],++s<l&&r===a||(s<u?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[2*M]++):s<=10?t.bl_tree[2*x]++:t.bl_tree[2*A]++,s=0,o=r,0===a?(l=138,u=3):r===a?(l=6,u=3):(l=7,u=4))}function $(t,e,n){var i,r,o=-1,a=e[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),i=0;i<=n;i++)if(r=a,a=e[2*(i+1)+1],!(++s<l&&r===a)){if(s<u)do{z(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(z(t,r,t.bl_tree),s--),z(t,M,t.bl_tree),V(t,s-3,2)):s<=10?(z(t,x,t.bl_tree),V(t,s-3,3)):(z(t,A,t.bl_tree),V(t,s-11,7));s=0,o=r,0===a?(l=138,u=3):r===a?(l=6,u=3):(l=7,u=4)}}l(U);var tt=!1;function et(t,e,n,r){V(t,(u<<1)+(r?1:0),3),function(t,e,n,r){H(t),r&&(Z(t,n),Z(t,~n)),i.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}e._tr_init=function(t){tt||(function(){var t,e,n,i,r,o=new Array(v+1);for(n=0,i=0;i<f-1;i++)for(R[i]=n,t=0;t<1<<T[i];t++)O[n++]=i;for(O[n-1]=i,r=0,i=0;i<16;i++)for(U[i]=r,t=0;t<1<<S[i];t++)I[r++]=i;for(r>>=7;i<g;i++)for(U[i]=r<<7,t=0;t<1<<S[i]-7;t++)I[256+r++]=i;for(e=0;e<=v;e++)o[e]=0;for(t=0;t<=143;)L[2*t+1]=8,t++,o[8]++;for(;t<=255;)L[2*t+1]=9,t++,o[9]++;for(;t<=279;)L[2*t+1]=7,t++,o[7]++;for(;t<=287;)L[2*t+1]=8,t++,o[8]++;for(Y(L,d+1,o),t=0;t<g;t++)P[2*t+1]=5,P[2*t]=W(t,5);k=new j(L,T,p+1,d,v),D=new j(P,S,0,g,v),B=new j(new Array(0),E,0,m,_)}(),tt=!0),t.l_desc=new F(t.dyn_ltree,k),t.d_desc=new F(t.dyn_dtree,D),t.bl_desc=new F(t.bl_tree,B),t.bi_buf=0,t.bi_valid=0,G(t)},e._tr_stored_block=et,e._tr_flush_block=function(t,e,n,i){var l,u,f=0;t.level>0?(t.strm.data_type===s&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return o;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return a;for(e=32;e<p;e++)if(0!==t.dyn_ltree[2*e])return a;return o}(t)),Q(t,t.l_desc),Q(t,t.d_desc),f=function(t){var e;for(K(t,t.dyn_ltree,t.l_desc.max_code),K(t,t.dyn_dtree,t.d_desc.max_code),Q(t,t.bl_desc),e=m-1;e>=3&&0===t.bl_tree[2*C[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),l=t.opt_len+3+7>>>3,(u=t.static_len+3+7>>>3)<=l&&(l=u)):l=u=n+5,n+4<=l&&-1!==e?et(t,e,n,i):t.strategy===r||u===l?(V(t,(h<<1)+(i?1:0),3),q(t,L,P)):(V(t,(c<<1)+(i?1:0),3),function(t,e,n,i){var r;for(V(t,e-257,5),V(t,n-1,5),V(t,i-4,4),r=0;r<i;r++)V(t,t.bl_tree[2*C[r]+1],3);$(t,t.dyn_ltree,e-1),$(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,f+1),q(t,t.dyn_ltree,t.dyn_dtree)),G(t),i&&H(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(O[n]+p+1)]++,t.dyn_dtree[2*N(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){V(t,h<<1,3),z(t,w,L),function(t){16===t.bi_valid?(Z(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},function(t,e,n){"use strict";t.exports=function(t,e){var n,i,r,o,a,s,l,u,h,c,f,p,d,g,m,y,v,b,_,w,M,x,A,T,S;n=t.state,i=t.next_in,T=t.input,r=i+(t.avail_in-5),o=t.next_out,S=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=n.dmax,u=n.wsize,h=n.whave,c=n.wnext,f=n.window,p=n.hold,d=n.bits,g=n.lencode,m=n.distcode,y=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;t:do{d<15&&(p+=T[i++]<<d,d+=8,p+=T[i++]<<d,d+=8),b=g[p&y];e:for(;;){if(p>>>=_=b>>>24,d-=_,0===(_=b>>>16&255))S[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=g[(65535&b)+(p&(1<<_)-1)];continue e}if(32&_){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}w=65535&b,(_&=15)&&(d<_&&(p+=T[i++]<<d,d+=8),w+=p&(1<<_)-1,p>>>=_,d-=_),d<15&&(p+=T[i++]<<d,d+=8,p+=T[i++]<<d,d+=8),b=m[p&v];n:for(;;){if(p>>>=_=b>>>24,d-=_,!(16&(_=b>>>16&255))){if(0==(64&_)){b=m[(65535&b)+(p&(1<<_)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(M=65535&b,d<(_&=15)&&(p+=T[i++]<<d,(d+=8)<_&&(p+=T[i++]<<d,d+=8)),(M+=p&(1<<_)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(p>>>=_,d-=_,M>(_=o-a)){if((_=M-_)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(x=0,A=f,0===c){if(x+=u-_,_<w){w-=_;do{S[o++]=f[x++]}while(--_);x=o-M,A=S}}else if(c<_){if(x+=u+c-_,(_-=c)<w){w-=_;do{S[o++]=f[x++]}while(--_);if(x=0,c<w){w-=_=c;do{S[o++]=f[x++]}while(--_);x=o-M,A=S}}}else if(x+=c-_,_<w){w-=_;do{S[o++]=f[x++]}while(--_);x=o-M,A=S}for(;w>2;)S[o++]=A[x++],S[o++]=A[x++],S[o++]=A[x++],w-=3;w&&(S[o++]=A[x++],w>1&&(S[o++]=A[x++]))}else{x=o-M;do{S[o++]=S[x++],S[o++]=S[x++],S[o++]=S[x++],w-=3}while(w>2);w&&(S[o++]=S[x++],w>1&&(S[o++]=S[x++]))}break}}break}}while(i<r&&o<s);i-=w=d>>3,p&=(1<<(d-=w<<3))-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=d}},function(t,e,n){"use strict";var i=n(24),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,l,u,h,c,f){var p,d,g,m,y,v,b,_,w,M=f.bits,x=0,A=0,T=0,S=0,E=0,C=0,L=0,P=0,I=0,O=0,R=null,k=0,D=new i.Buf16(16),B=new i.Buf16(16),U=null,j=0;for(x=0;x<=15;x++)D[x]=0;for(A=0;A<l;A++)D[e[n+A]]++;for(E=M,S=15;S>=1&&0===D[S];S--);if(E>S&&(E=S),0===S)return u[h++]=20971520,u[h++]=20971520,f.bits=1,0;for(T=1;T<S&&0===D[T];T++);for(E<T&&(E=T),P=1,x=1;x<=15;x++)if(P<<=1,(P-=D[x])<0)return-1;if(P>0&&(0===t||1!==S))return-1;for(B[1]=0,x=1;x<15;x++)B[x+1]=B[x]+D[x];for(A=0;A<l;A++)0!==e[n+A]&&(c[B[e[n+A]]++]=A);if(0===t?(R=U=c,v=19):1===t?(R=r,k-=257,U=o,j-=257,v=256):(R=a,U=s,v=-1),O=0,A=0,x=T,y=h,C=E,L=0,g=-1,m=(I=1<<E)-1,1===t&&I>852||2===t&&I>592)return 1;for(;;){b=x-L,c[A]<v?(_=0,w=c[A]):c[A]>v?(_=U[j+c[A]],w=R[k+c[A]]):(_=96,w=0),p=1<<x-L,T=d=1<<C;do{u[y+(O>>L)+(d-=p)]=b<<24|_<<16|w|0}while(0!==d);for(p=1<<x-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,A++,0==--D[x]){if(x===S)break;x=e[n+c[A]]}if(x>E&&(O&m)!==g){for(0===L&&(L=E),y+=T,P=1<<(C=x-L);C+L<S&&!((P-=D[C+L])<=0);)C++,P<<=1;if(I+=1<<C,1===t&&I>852||2===t&&I>592)return 1;u[g=O&m]=E<<24|C<<16|y-h|0}}return 0!==O&&(u[y+O]=x-L<<24|64<<16|0),f.bits=E,0}},function(t,e,n){"use strict";(function(e){var i=n(23),r=n(105),o=n(106),a=t.exports=function(t){r.call(this);var n=[],i=this;this._filter=new o(t,{read:this.read.bind(this),write:function(t){n.push(t)},complete:function(){i.emit("complete",e.concat(n))}}),this._filter.start()};i.inherits(a,r)}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(23),r=n(56),o=n(47),a=n(113),s=t.exports=function(t){r.call(this);var e=t||{};this._packer=new a(e),this._deflate=this._packer.createDeflate(),this.readable=!0};i.inherits(s,r),s.prototype.pack=function(t,n,i,r){this.emit("data",new e(o.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(n,i)),r&&this.emit("data",this._packer.packGAMA(r));var a=this._packer.filterData(t,n,i);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(t){this.emit("data",this._packer.packIDAT(t))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(a)}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(47);t.exports=function(t,n,r,o){var a=-1!==[i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(o.colorType);if(o.colorType===o.inputColorType){var s=function(){var t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256!==new Int16Array(t)[0]}();if(8===o.bitDepth||16===o.bitDepth&&s)return t}var l=16!==o.bitDepth?t:new Uint16Array(t.buffer),u=255,h=i.COLORTYPE_TO_BPP_MAP[o.inputColorType];4!==h||o.inputHasAlpha||(h=3);var c=i.COLORTYPE_TO_BPP_MAP[o.colorType];16===o.bitDepth&&(u=65535,c*=2);var f=new e(n*r*c),p=0,d=0,g=o.bgColor||{};function m(){var t,e,n,r=u;switch(o.inputColorType){case i.COLORTYPE_COLOR_ALPHA:r=l[p+3],t=l[p],e=l[p+1],n=l[p+2];break;case i.COLORTYPE_COLOR:t=l[p],e=l[p+1],n=l[p+2];break;case i.COLORTYPE_ALPHA:r=l[p+1],e=t=l[p],n=t;break;case i.COLORTYPE_GRAYSCALE:e=t=l[p],n=t;break;default:throw new Error("input color type:"+o.inputColorType+" is not supported at present")}return o.inputHasAlpha&&(a||(r/=u,t=Math.min(Math.max(Math.round((1-r)*g.red+r*t),0),u),e=Math.min(Math.max(Math.round((1-r)*g.green+r*e),0),u),n=Math.min(Math.max(Math.round((1-r)*g.blue+r*n),0),u))),{red:t,green:e,blue:n,alpha:r}}void 0===g.red&&(g.red=u),void 0===g.green&&(g.green=u),void 0===g.blue&&(g.blue=u);for(var y=0;y<r;y++)for(var v=0;v<n;v++){var b=m();switch(o.colorType){case i.COLORTYPE_COLOR_ALPHA:case i.COLORTYPE_COLOR:8===o.bitDepth?(f[d]=b.red,f[d+1]=b.green,f[d+2]=b.blue,a&&(f[d+3]=b.alpha)):(f.writeUInt16BE(b.red,d),f.writeUInt16BE(b.green,d+2),f.writeUInt16BE(b.blue,d+4),a&&f.writeUInt16BE(b.alpha,d+6));break;case i.COLORTYPE_ALPHA:case i.COLORTYPE_GRAYSCALE:var _=(b.red+b.green+b.blue)/3;8===o.bitDepth?(f[d]=_,a&&(f[d+1]=b.alpha)):(f.writeUInt16BE(_,d),a&&f.writeUInt16BE(b.alpha,d+2));break;default:throw new Error("unrecognised color Type "+o.colorType)}p+=h,d+=c}return f}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(108);var r={0:function(t,e,n,i,r){for(var o=0;o<n;o++)i[r+o]=t[e+o]},1:function(t,e,n,i,r,o){for(var a=0;a<n;a++){var s=a>=o?t[e+a-o]:0,l=t[e+a]-s;i[r+a]=l}},2:function(t,e,n,i,r){for(var o=0;o<n;o++){var a=e>0?t[e+o-n]:0,s=t[e+o]-a;i[r+o]=s}},3:function(t,e,n,i,r,o){for(var a=0;a<n;a++){var s=a>=o?t[e+a-o]:0,l=e>0?t[e+a-n]:0,u=t[e+a]-(s+l>>1);i[r+a]=u}},4:function(t,e,n,r,o,a){for(var s=0;s<n;s++){var l=s>=a?t[e+s-a]:0,u=e>0?t[e+s-n]:0,h=e>0&&s>=a?t[e+s-(n+a)]:0,c=t[e+s]-i(l,u,h);r[o+s]=c}}},o={0:function(t,e,n){for(var i=0,r=e+n,o=e;o<r;o++)i+=Math.abs(t[o]);return i},1:function(t,e,n,i){for(var r=0,o=0;o<n;o++){var a=o>=i?t[e+o-i]:0,s=t[e+o]-a;r+=Math.abs(s)}return r},2:function(t,e,n){for(var i=0,r=e+n,o=e;o<r;o++){var a=e>0?t[o-n]:0,s=t[o]-a;i+=Math.abs(s)}return i},3:function(t,e,n,i){for(var r=0,o=0;o<n;o++){var a=o>=i?t[e+o-i]:0,s=e>0?t[e+o-n]:0,l=t[e+o]-(a+s>>1);r+=Math.abs(l)}return r},4:function(t,e,n,r){for(var o=0,a=0;a<n;a++){var s=a>=r?t[e+a-r]:0,l=e>0?t[e+a-n]:0,u=e>0&&a>=r?t[e+a-(n+r)]:0,h=t[e+a]-i(s,l,u);o+=Math.abs(h)}return o}};t.exports=function(t,n,i,a,s){var l;if("filterType"in a&&-1!==a.filterType){if("number"!=typeof a.filterType)throw new Error("unrecognised filter types");l=[a.filterType]}else l=[0,1,2,3,4];16===a.bitDepth&&(s*=2);for(var u=n*s,h=0,c=0,f=new e((u+1)*i),p=l[0],d=0;d<i;d++){if(l.length>1)for(var g=1/0,m=0;m<l.length;m++){var y=o[l[m]](t,c,u,s);y<g&&(p=l[m],g=y)}f[h]=p,h++,r[p](t,c,u,f,h,s),h+=u,c+=u}return f}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=n(192),r=n(195);e.read=function(t,e){return i(t,e||{})},e.write=function(t,e){return r(t,e)}},function(t,e,n){"use strict";(function(e){var i=!0,r=n(46),o=n(193);r.deflateSync||(i=!1);var a=n(114),s=n(194),l=n(109),u=n(111),h=n(112);t.exports=function(t,n){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var c,f,p;var d=[];var g=new a(t);if(new l(n,{read:g.read.bind(g),error:function(t){c=t},metadata:function(t){f=t},gamma:function(t){p=t},palette:function(t){f.palette=t},transColor:function(t){f.transColor=t},inflateData:function(t){d.push(t)},simpleTransparency:function(){f.alpha=!0}}).start(),g.process(),c)throw c;var m,y=e.concat(d);if(d.length=0,f.interlace)m=r.inflateSync(y);else{var v=(1+(f.width*f.bpp*f.depth+7>>3))*f.height;m=o(y,{chunkSize:v,maxLength:v})}if(y=null,!m||!m.length)throw new Error("bad png - invalid inflate data response");var b=s.process(m,f);y=null;var _=u.dataToBitMap(b,f);b=null;var w=h(_,f);return f.data=w,f.gamma=p||0,f}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(i,r){var o=n(70).ok,a=n(46),s=n(23),l=n(3).kMaxLength;function u(t){if(!(this instanceof u))return new u(t);t&&t.chunkSize<a.Z_MIN_CHUNK&&(t.chunkSize=a.Z_MIN_CHUNK),a.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function h(t,e){e&&i.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function c(t,e){return function(t,e){if("string"==typeof e&&(e=r.from(e)),!(e instanceof r))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return null==n&&(n=a.Z_FINISH),t._processChunk(e,n)}(new u(e),t)}u.prototype._processChunk=function(t,e,n){if("function"==typeof n)return a.Inflate._processChunk.call(this,t,e,n);var i,s=this,u=t&&t.length,c=this._chunkSize-this._offset,f=this._maxLength,p=0,d=[],g=0;function m(t,e){if(!s._hadError){var n=c-e;if(o(n>=0,"have should not go down"),n>0){var i=s._buffer.slice(s._offset,s._offset+n);if(s._offset+=n,i.length>f&&(i=i.slice(0,f)),d.push(i),g+=i.length,0===(f-=i.length))return!1}return(0===e||s._offset>=s._chunkSize)&&(c=s._chunkSize,s._offset=0,s._buffer=r.allocUnsafe(s._chunkSize)),0===e&&(p+=u-t,u=t,!0)}}this.on("error",function(t){i=t}),o(this._handle,"zlib binding closed");do{var y=this._handle.writeSync(e,t,p,u,this._buffer,this._offset,c);y=y||this._writeState}while(!this._hadError&&m(y[0],y[1]));if(this._hadError)throw i;if(g>=l)throw h(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes");var v=r.concat(d,g);return h(this),v},s.inherits(u,a.Inflate),t.exports=e=c,e.Inflate=u,e.createInflate=function(t){return new u(t)},e.inflateSync=c}).call(this,n(16),n(3).Buffer)},function(t,e,n){"use strict";(function(t){var i=n(114),r=n(106);e.process=function(e,n){var o=[],a=new i(e);return new r(n,{read:a.read.bind(a),write:function(t){o.push(t)},complete:function(){}}).start(),a.process(),t.concat(o)}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=!0,r=n(46);r.deflateSync||(i=!1);var o=n(47),a=n(113);t.exports=function(t,n){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var s=new a(n||{}),l=[];l.push(new e(o.PNG_SIGNATURE)),l.push(s.packIHDR(t.width,t.height)),t.gamma&&l.push(s.packGAMA(t.gamma));var u=s.filterData(t.data,t.width,t.height),h=r.deflateSync(u,s.getDeflateOptions());if(u=null,!h||!h.length)throw new Error("bad png - invalid compressed data response");return l.push(s.packIDAT(h)),l.push(s.packIEND()),e.concat(l)}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(197).GifReader;t.exports=function(t,n){var r=new i(e.from(t)),o=new Uint8Array(r.width*r.height*4);return r.decodeAndBlitFrameRGBA(0,o),{data:o,width:r.width,height:r.height}}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";function i(t,e,n,i){for(var r=t[e++],o=1<<r,a=o+1,s=a+1,l=r+1,u=(1<<l)-1,h=0,c=0,f=0,p=t[e++],d=new Int32Array(4096),g=null;;){for(;h<16&&0!==p;)c|=t[e++]<<h,h+=8,1===p?p=t[e++]:--p;if(h<l)break;var m=c&u;if(c>>=l,h-=l,m!==o){if(m===a)break;for(var y=m<s?m:g,v=0,b=y;b>o;)b=d[b]>>8,++v;var _=b;if(f+v+(y!==m?1:0)>i)return void console.log("Warning, gif stream longer than expected.");n[f++]=_;var w=f+=v;for(y!==m&&(n[f++]=_),b=y;v--;)b=d[b],n[--w]=255&b,b>>=8;null!==g&&s<4096&&(d[s++]=g<<8|_,s>=u+1&&l<12&&(++l,u=u<<1|1)),g=m}else s=a+1,u=(1<<(l=r+1))-1,g=null}return f!==i&&console.log("Warning, gif stream shorter than expected."),n}try{e.GifWriter=function(t,e,n,i){var r=0,o=void 0===(i=void 0===i?{}:i).loop?null:i.loop,a=void 0===i.palette?null:i.palette;if(e<=0||n<=0||e>65535||n>65535)throw new Error("Width/Height invalid.");function s(t){var e=t.length;if(e<2||e>256||e&e-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return e}t[r++]=71,t[r++]=73,t[r++]=70,t[r++]=56,t[r++]=57,t[r++]=97;var l=0,u=0;if(null!==a){for(var h=s(a);h>>=1;)++l;if(h=1<<l,--l,void 0!==i.background){if((u=i.background)>=h)throw new Error("Background index out of range.");if(0===u)throw new Error("Background index explicitly passed as 0.")}}if(t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=(null!==a?128:0)|l,t[r++]=u,t[r++]=0,null!==a)for(var c=0,f=a.length;c<f;++c){var p=a[c];t[r++]=p>>16&255,t[r++]=p>>8&255,t[r++]=255&p}if(null!==o){if(o<0||o>65535)throw new Error("Loop count invalid.");t[r++]=33,t[r++]=255,t[r++]=11,t[r++]=78,t[r++]=69,t[r++]=84,t[r++]=83,t[r++]=67,t[r++]=65,t[r++]=80,t[r++]=69,t[r++]=50,t[r++]=46,t[r++]=48,t[r++]=3,t[r++]=1,t[r++]=255&o,t[r++]=o>>8&255,t[r++]=0}var d=!1;this.addFrame=function(e,n,i,o,l,u){if(!0===d&&(--r,d=!1),u=void 0===u?{}:u,e<0||n<0||e>65535||n>65535)throw new Error("x/y invalid.");if(i<=0||o<=0||i>65535||o>65535)throw new Error("Width/Height invalid.");if(l.length<i*o)throw new Error("Not enough pixels for the frame size.");var h=!0,c=u.palette;if(void 0!==c&&null!==c||(h=!1,c=a),void 0===c||null===c)throw new Error("Must supply either a local or global palette.");for(var f=s(c),p=0;f>>=1;)++p;f=1<<p;var g=void 0===u.delay?0:u.delay,m=void 0===u.disposal?0:u.disposal;if(m<0||m>3)throw new Error("Disposal out of range.");var y=!1,v=0;if(void 0!==u.transparent&&null!==u.transparent&&(y=!0,(v=u.transparent)<0||v>=f))throw new Error("Transparent color index.");if((0!==m||y||0!==g)&&(t[r++]=33,t[r++]=249,t[r++]=4,t[r++]=m<<2|(!0===y?1:0),t[r++]=255&g,t[r++]=g>>8&255,t[r++]=v,t[r++]=0),t[r++]=44,t[r++]=255&e,t[r++]=e>>8&255,t[r++]=255&n,t[r++]=n>>8&255,t[r++]=255&i,t[r++]=i>>8&255,t[r++]=255&o,t[r++]=o>>8&255,t[r++]=!0===h?128|p-1:0,!0===h)for(var b=0,_=c.length;b<_;++b){var w=c[b];t[r++]=w>>16&255,t[r++]=w>>8&255,t[r++]=255&w}return r=function(t,e,n,i){t[e++]=n;var r=e++,o=1<<n,a=o-1,s=o+1,l=s+1,u=n+1,h=0,c=0;function f(n){for(;h>=n;)t[e++]=255&c,c>>=8,h-=8,e===r+256&&(t[r]=255,r=e++)}function p(t){c|=t<<h,h+=u,f(8)}var d=i[0]&a,g={};p(o);for(var m=1,y=i.length;m<y;++m){var v=i[m]&a,b=d<<8|v,_=g[b];if(void 0===_){for(c|=d<<h,h+=u;h>=8;)t[e++]=255&c,c>>=8,h-=8,e===r+256&&(t[r]=255,r=e++);4096===l?(p(o),l=s+1,u=n+1,g={}):(l>=1<<u&&++u,g[b]=l++),d=v}else d=_}return p(d),p(s),f(1),r+1===e?t[r]=0:(t[r]=e-r-1,t[e++]=0),e}(t,r,p<2?2:p,l)},this.end=function(){return!1===d&&(t[r++]=59,d=!0),r},this.getOutputBuffer=function(){return t},this.setOutputBuffer=function(e){t=e},this.getOutputBufferPosition=function(){return r},this.setOutputBufferPosition=function(t){r=t}},e.GifReader=function(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var n=t[e++]|t[e++]<<8,r=t[e++]|t[e++]<<8,o=t[e++],a=o>>7,s=1<<1+(7&o);t[e++],t[e++];var l=null,u=null;a&&(l=e,u=s,e+=3*s);var h=!0,c=[],f=0,p=null,d=0,g=null;for(this.width=n,this.height=r;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,g=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(0===C)break;e+=C}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var m=t[e++];f=t[e++]|t[e++]<<8,p=t[e++],0==(1&m)&&(p=null),d=m>>2&7,e++;break;case 254:for(;;){if(!((C=t[e++])>=0))throw Error("Invalid block size");if(0===C)break;e+=C}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var y=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,b=t[e++]|t[e++]<<8,_=t[e++]|t[e++]<<8,w=t[e++],M=w>>6&1,x=1<<1+(7&w),A=l,T=u,S=!1;w>>7&&(S=!0,A=e,T=x,e+=3*x);var E=e;for(e++;;){var C;if(!((C=t[e++])>=0))throw Error("Invalid block size");if(0===C)break;e+=C}c.push({x:y,y:v,width:b,height:_,has_local_palette:S,palette_offset:A,palette_size:T,data_offset:E,data_length:e-E,transparent_index:p,interlaced:!!M,delay:f,disposal:d});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(t){if(t<0||t>=c.length)throw new Error("Frame index out of range.");return c[t]},this.decodeAndBlitFrameBGRA=function(e,r){var o=this.frameInfo(e),a=o.width*o.height,s=new Uint8Array(a);i(t,o.data_offset,s,a);var l=o.palette_offset,u=o.transparent_index;null===u&&(u=256);var h=o.width,c=n-h,f=h,p=4*(o.y*n+o.x),d=4*((o.y+o.height)*n+o.x),g=p,m=4*c;!0===o.interlaced&&(m+=4*n*7);for(var y=8,v=0,b=s.length;v<b;++v){var _=s[v];if(0===f&&(f=h,(g+=m)>=d&&(m=4*c+4*n*(y-1),g=p+(h+c)*(y<<1),y>>=1)),_===u)g+=4;else{var w=t[l+3*_],M=t[l+3*_+1],x=t[l+3*_+2];r[g++]=x,r[g++]=M,r[g++]=w,r[g++]=255}--f}},this.decodeAndBlitFrameRGBA=function(e,r){var o=this.frameInfo(e),a=o.width*o.height,s=new Uint8Array(a);i(t,o.data_offset,s,a);var l=o.palette_offset,u=o.transparent_index;null===u&&(u=256);var h=o.width,c=n-h,f=h,p=4*(o.y*n+o.x),d=4*((o.y+o.height)*n+o.x),g=p,m=4*c;!0===o.interlaced&&(m+=4*n*7);for(var y=8,v=0,b=s.length;v<b;++v){var _=s[v];if(0===f&&(f=h,(g+=m)>=d&&(m=4*c+4*n*(y-1),g=p+(h+c)*(y<<1),y>>=1)),_===u)g+=4;else{var w=t[l+3*_],M=t[l+3*_+1],x=t[l+3*_+2];r[g++]=w,r[g++]=M,r[g++]=x,r[g++]=255}--f}}}}catch(t){}},function(t,e,n){"use strict";var i=n(199),r=n(202);t.exports=function(t,e){var n=i.decode(t);if(!n)throw new Error("Error decoding jpeg");return{data:r(n.data),height:n.height,width:n.width}}},function(t,e,n){var i=n(200),r=n(201);t.exports={encode:i,decode:r}},function(t,e,n){(function(e){function n(t){Math.round;var n,i,r,o,a,s=Math.floor,l=new Array(64),u=new Array(64),h=new Array(64),c=new Array(64),f=new Array(65535),p=new Array(65535),d=new Array(64),g=new Array(64),m=[],y=0,v=7,b=new Array(64),_=new Array(64),w=new Array(64),M=new Array(256),x=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],O=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function R(t,e){for(var n=0,i=0,r=new Array,o=1;o<=16;o++){for(var a=1;a<=t[o];a++)r[e[i]]=[],r[e[i]][0]=n,r[e[i]][1]=o,i++,n++;n*=2}return r}function k(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(y|=1<<v),n--,--v<0&&(255==y?(D(255),D(0)):D(y),v=7,y=0)}function D(t){m.push(t)}function B(t){D(t>>8&255),D(255&t)}function U(t,e,n,i,r){for(var o,a=r[0],s=r[240],l=function(t,e){var n,i,r,o,a,s,l,u,h,c,f=0;for(h=0;h<8;++h){n=t[f],i=t[f+1],r=t[f+2],o=t[f+3],a=t[f+4],s=t[f+5],l=t[f+6];var p=n+(u=t[f+7]),g=n-u,m=i+l,y=i-l,v=r+s,b=r-s,_=o+a,w=o-a,M=p+_,x=p-_,A=m+v,T=m-v;t[f]=M+A,t[f+4]=M-A;var S=.707106781*(T+x);t[f+2]=x+S,t[f+6]=x-S;var E=.382683433*((M=w+b)-(T=y+g)),C=.5411961*M+E,L=1.306562965*T+E,P=.707106781*(A=b+y),I=g+P,O=g-P;t[f+5]=O+C,t[f+3]=O-C,t[f+1]=I+L,t[f+7]=I-L,f+=8}for(f=0,h=0;h<8;++h){n=t[f],i=t[f+8],r=t[f+16],o=t[f+24],a=t[f+32],s=t[f+40],l=t[f+48];var R=n+(u=t[f+56]),k=n-u,D=i+l,B=i-l,U=r+s,j=r-s,F=o+a,N=o-a,Z=R+F,V=R-F,z=D+U,W=D-U;t[f]=Z+z,t[f+32]=Z-z;var Y=.707106781*(W+V);t[f+16]=V+Y,t[f+48]=V-Y;var G=.382683433*((Z=N+j)-(W=B+k)),H=.5411961*Z+G,X=1.306562965*W+G,J=.707106781*(z=j+B),q=k+J,Q=k-J;t[f+40]=Q+H,t[f+24]=Q-H,t[f+8]=q+X,t[f+56]=q-X,f++}for(h=0;h<64;++h)c=t[h]*e[h],d[h]=c>0?c+.5|0:c-.5|0;return d}(t,e),u=0;u<64;++u)g[A[u]]=l[u];var h=g[0]-n;n=g[0],0==h?k(i[0]):(k(i[p[o=32767+h]]),k(f[o]));for(var c=63;c>0&&0==g[c];c--);if(0==c)return k(a),n;for(var m,y=1;y<=c;){for(var v=y;0==g[y]&&y<=c;++y);var b=y-v;if(b>=16){m=b>>4;for(var _=1;_<=m;++_)k(s);b&=15}o=32767+g[y],k(r[(b<<4)+p[o]]),k(f[o]),y++}return 63!=c&&k(a),n}function j(t){if(t<=0&&(t=1),t>100&&(t=100),a!=t){(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var i=s((e[n]*t+50)/100);i<1?i=1:i>255&&(i=255),l[A[n]]=i}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],o=0;o<64;o++){var a=s((r[o]*t+50)/100);a<1?a=1:a>255&&(a=255),u[A[o]]=a}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],p=0,d=0;d<8;d++)for(var g=0;g<8;g++)h[p]=1/(l[A[p]]*f[d]*f[g]*8),c[p]=1/(u[A[p]]*f[d]*f[g]*8),p++})(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),a=t}}this.encode=function(t,a){(new Date).getTime();a&&j(a),m=new Array,y=0,v=7,B(65496),B(65504),B(16),D(74),D(70),D(73),D(70),D(0),D(1),D(1),D(0),B(1),B(1),D(0),D(0),function(){B(65499),B(132),D(0);for(var t=0;t<64;t++)D(l[t]);D(1);for(var e=0;e<64;e++)D(u[e])}(),function(t,e){B(65472),B(17),D(8),B(e),B(t),D(3),D(1),D(17),D(0),D(2),D(17),D(1),D(3),D(17),D(1)}(t.width,t.height),function(){B(65476),B(418),D(0);for(var t=0;t<16;t++)D(T[t+1]);for(var e=0;e<=11;e++)D(S[e]);D(16);for(var n=0;n<16;n++)D(E[n+1]);for(var i=0;i<=161;i++)D(C[i]);D(1);for(var r=0;r<16;r++)D(L[r+1]);for(var o=0;o<=11;o++)D(P[o]);D(17);for(var a=0;a<16;a++)D(I[a+1]);for(var s=0;s<=161;s++)D(O[s])}(),B(65498),B(12),D(3),D(1),D(0),D(2),D(17),D(3),D(17),D(0),D(63),D(0);var s=0,f=0,p=0;y=0,v=7,this.encode.displayName="_encode_";for(var d,g,M,A,R,F,N,Z,V,z=t.data,W=t.width,Y=t.height,G=4*W,H=0;H<Y;){for(d=0;d<G;){for(F=R=G*H+d,N=-1,Z=0,V=0;V<64;V++)F=R+(Z=V>>3)*G+(N=4*(7&V)),H+Z>=Y&&(F-=G*(H+1+Z-Y)),d+N>=G&&(F-=d+N-G+4),g=z[F++],M=z[F++],A=z[F++],b[V]=(x[g]+x[M+256>>0]+x[A+512>>0]>>16)-128,_[V]=(x[g+768>>0]+x[M+1024>>0]+x[A+1280>>0]>>16)-128,w[V]=(x[g+1280>>0]+x[M+1536>>0]+x[A+1792>>0]>>16)-128;s=U(b,h,s,n,r),f=U(_,c,f,i,o),p=U(w,c,p,i,o),d+=32}H+=8}if(v>=0){var X=[];X[1]=v+1,X[0]=(1<<v+1)-1,k(X)}return B(65497),new e(m)},function(){(new Date).getTime();t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)M[e]=t(e)}(),n=R(T,S),i=R(L,P),r=R(E,C),o=R(I,O),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var i=t;i<e;i++)p[32767+i]=n,f[32767+i]=[],f[32767+i][1]=n,f[32767+i][0]=i;for(var r=-(e-1);r<=-t;r++)p[32767+r]=n,f[32767+r]=[],f[32767+r][1]=n,f[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256>>0]=38470*t,x[t+512>>0]=7471*t+32768,x[t+768>>0]=-11059*t,x[t+1024>>0]=-21709*t,x[t+1280>>0]=32768*t+8421375,x[t+1536>>0]=-27439*t,x[t+1792>>0]=-5329*t}(),j(t),(new Date).getTime()}()}t.exports=function(t,e){void 0===e&&(e=50);return{data:new n(e).encode(t,e),width:t.width,height:t.height}}}).call(this,n(3).Buffer)},function(t,e,n){(function(e){var n=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,n=799,i=3406,r=2276,o=1567,a=3784,s=5793,l=2896;function u(){}function h(t,e){for(var n,i,r=0,o=[],a=16;a>0&&!t[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(n=0;n<a;n++){for(i=0;i<t[n];i++){for((l=o.pop()).children[l.index]=e[r];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=n;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;r++}n+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function c(e,n,i,r,o,a,s,l,u){i.precision,i.samplesPerLine,i.scanLines;var h=i.mcusPerLine,c=i.progressive,f=(i.maxH,i.maxV,n),p=0,d=0;function g(){if(d>0)return p>>--d&1;if(255==(p=e[n++])){var t=e[n++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return d=7,p>>>7}function m(t){for(var e,n=t;null!==(e=g());){if("number"==typeof(n=n[e]))return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function y(t){for(var e=0;t>0;){var n=g();if(null===n)return;e=e<<1|n,t--}return e}function v(t){var e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}var b=0;var _,w=0;function M(t,e,n,i,r){var o=n%h,a=(n/h|0)*t.v+i,s=o*t.h+r;e(t,t.blocks[a][s])}function x(t,e,n){var i=n/t.blocksPerLine|0,r=n%t.blocksPerLine;e(t,t.blocks[i][r])}var A,T,S,E,C,L,P=r.length;L=c?0===a?0===l?function(t,e){var n=m(t.huffmanTableDC),i=0===n?0:v(n)<<u;e[0]=t.pred+=i}:function(t,e){e[0]|=g()<<u}:0===l?function(e,n){if(b>0)b--;else for(var i=a,r=s;i<=r;){var o=m(e.huffmanTableAC),l=15&o,h=o>>4;if(0!==l)n[t[i+=h]]=v(l)*(1<<u),i++;else{if(h<15){b=y(h)+(1<<h)-1;break}i+=16}}}:function(e,n){for(var i=a,r=s,o=0;i<=r;){var l=t[i],h=n[l]<0?-1:1;switch(w){case 0:var c=m(e.huffmanTableAC),f=15&c;if(o=c>>4,0===f)o<15?(b=y(o)+(1<<o),w=4):(o=16,w=1);else{if(1!==f)throw new Error("invalid ACn encoding");_=v(f),w=o?2:3}continue;case 1:case 2:n[l]?n[l]+=(g()<<u)*h:0==--o&&(w=2==w?3:0);break;case 3:n[l]?n[l]+=(g()<<u)*h:(n[l]=_<<u,w=0);break;case 4:n[l]&&(n[l]+=(g()<<u)*h)}i++}4===w&&0==--b&&(w=0)}:function(e,n){var i=m(e.huffmanTableDC),r=0===i?0:v(i);n[0]=e.pred+=r;for(var o=1;o<64;){var a=m(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s)n[t[o+=l]]=v(s),o++;else{if(l<15)break;o+=16}}};var I,O,R,k,D=0;for(O=1==P?r[0].blocksPerLine*r[0].blocksPerColumn:h*i.mcusPerColumn,o||(o=O);D<O;){for(T=0;T<P;T++)r[T].pred=0;if(b=0,1==P)for(A=r[0],C=0;C<o;C++)x(A,L,D),D++;else for(C=0;C<o;C++){for(T=0;T<P;T++)for(R=(A=r[T]).h,k=A.v,S=0;S<k;S++)for(E=0;E<R;E++)M(A,L,D,S,E);if(++D===O)break}if(d=0,(I=e[n]<<8|e[n+1])<65280)throw new Error("marker was not found");if(!(I>=65488&&I<=65495))break;n+=2}return n-f}function f(t,u){var h,c,f=[],p=u.blocksPerLine,d=u.blocksPerColumn,g=p<<3,m=new Int32Array(64),y=new Uint8Array(64);function v(t,h,c){var f,p,d,g,m,y,v,b,_,w,M=u.quantizationTable,x=c;for(w=0;w<64;w++)x[w]=t[w]*M[w];for(w=0;w<8;++w){var A=8*w;0!=x[1+A]||0!=x[2+A]||0!=x[3+A]||0!=x[4+A]||0!=x[5+A]||0!=x[6+A]||0!=x[7+A]?(f=s*x[0+A]+128>>8,p=s*x[4+A]+128>>8,d=x[2+A],g=x[6+A],m=l*(x[1+A]-x[7+A])+128>>8,b=l*(x[1+A]+x[7+A])+128>>8,y=x[3+A]<<4,v=x[5+A]<<4,_=f-p+1>>1,f=f+p+1>>1,p=_,_=d*a+g*o+128>>8,d=d*o-g*a+128>>8,g=_,_=m-v+1>>1,m=m+v+1>>1,v=_,_=b+y+1>>1,y=b-y+1>>1,b=_,_=f-g+1>>1,f=f+g+1>>1,g=_,_=p-d+1>>1,p=p+d+1>>1,d=_,_=m*r+b*i+2048>>12,m=m*i-b*r+2048>>12,b=_,_=y*n+v*e+2048>>12,y=y*e-v*n+2048>>12,v=_,x[0+A]=f+b,x[7+A]=f-b,x[1+A]=p+v,x[6+A]=p-v,x[2+A]=d+y,x[5+A]=d-y,x[3+A]=g+m,x[4+A]=g-m):(_=s*x[0+A]+512>>10,x[0+A]=_,x[1+A]=_,x[2+A]=_,x[3+A]=_,x[4+A]=_,x[5+A]=_,x[6+A]=_,x[7+A]=_)}for(w=0;w<8;++w){var T=w;0!=x[8+T]||0!=x[16+T]||0!=x[24+T]||0!=x[32+T]||0!=x[40+T]||0!=x[48+T]||0!=x[56+T]?(f=s*x[0+T]+2048>>12,p=s*x[32+T]+2048>>12,d=x[16+T],g=x[48+T],m=l*(x[8+T]-x[56+T])+2048>>12,b=l*(x[8+T]+x[56+T])+2048>>12,y=x[24+T],v=x[40+T],_=f-p+1>>1,f=f+p+1>>1,p=_,_=d*a+g*o+2048>>12,d=d*o-g*a+2048>>12,g=_,_=m-v+1>>1,m=m+v+1>>1,v=_,_=b+y+1>>1,y=b-y+1>>1,b=_,_=f-g+1>>1,f=f+g+1>>1,g=_,_=p-d+1>>1,p=p+d+1>>1,d=_,_=m*r+b*i+2048>>12,m=m*i-b*r+2048>>12,b=_,_=y*n+v*e+2048>>12,y=y*e-v*n+2048>>12,v=_,x[0+T]=f+b,x[56+T]=f-b,x[8+T]=p+v,x[48+T]=p-v,x[16+T]=d+y,x[40+T]=d-y,x[24+T]=g+m,x[32+T]=g-m):(_=s*c[w+0]+8192>>14,x[0+T]=_,x[8+T]=_,x[16+T]=_,x[24+T]=_,x[32+T]=_,x[40+T]=_,x[48+T]=_,x[56+T]=_)}for(w=0;w<64;++w){var S=128+(x[w]+8>>4);h[w]=S<0?0:S>255?255:S}}for(var b=0;b<d;b++){var _=b<<3;for(h=0;h<8;h++)f.push(new Uint8Array(g));for(var w=0;w<p;w++){v(u.blocks[b][w],y,m);var M=0,x=w<<3;for(c=0;c<8;c++){var A=f[_+c];for(h=0;h<8;h++)A[x+h]=y[M++]}}}return f}function p(t){return t<0?0:t>255?255:t}return u.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var n=0;e.length;function i(){var t=e[n]<<8|e[n+1];return n+=2,t}function r(){var t=i(),r=e.subarray(n,n+t-2);return n+=r.length,r}function o(t){var e,n,i=0,r=0;for(n in t.components)t.components.hasOwnProperty(n)&&(i<(e=t.components[n]).h&&(i=e.h),r<e.v&&(r=e.v));var o=Math.ceil(t.samplesPerLine/8/i),a=Math.ceil(t.scanLines/8/r);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];for(var s=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/i),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/r),u=o*e.h,h=a*e.v,c=[],f=0;f<h;f++){for(var p=[],d=0;d<u;d++)p.push(new Int32Array(64));c.push(p)}e.blocksPerLine=s,e.blocksPerColumn=l,e.blocks=c}t.maxH=i,t.maxV=r,t.mcusPerLine=o,t.mcusPerColumn=a}var a,s,l=null,u=null,p=[],d=[],g=[],m=[],y=i();if(65496!=y)throw new Error("SOI not found");for(y=i();65497!=y;){switch(y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=r();65504===y&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(l={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===y&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(u={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var b=i()+n-2;n<b;){var _=e[n++],w=new Int32Array(64);if(_>>4==0)for(Z=0;Z<64;Z++){w[t[Z]]=e[n++]}else{if(_>>4!=1)throw new Error("DQT: invalid table spec");for(Z=0;Z<64;Z++){w[t[Z]]=i()}}p[15&_]=w}break;case 65472:case 65473:case 65474:i(),(a={}).extended=65473===y,a.progressive=65474===y,a.precision=e[n++],a.scanLines=i(),a.samplesPerLine=i(),a.components={},a.componentsOrder=[];var M,x=e[n++];for(F=0;F<x;F++){M=e[n];var A=e[n+1]>>4,T=15&e[n+1],S=e[n+2];a.componentsOrder.push(M),a.components[M]={h:A,v:T,quantizationIdx:S},n+=3}o(a),d.push(a);break;case 65476:var E=i();for(F=2;F<E;){var C=e[n++],L=new Uint8Array(16),P=0;for(Z=0;Z<16;Z++,n++)P+=L[Z]=e[n];var I=new Uint8Array(P);for(Z=0;Z<P;Z++,n++)I[Z]=e[n];F+=17+P,(C>>4==0?m:g)[15&C]=h(L,I)}break;case 65501:i(),s=i();break;case 65498:i();var O=e[n++],R=[];for(F=0;F<O;F++){V=a.components[e[n++]];var k=e[n++];V.huffmanTableDC=m[k>>4],V.huffmanTableAC=g[15&k],R.push(V)}var D=e[n++],B=e[n++],U=e[n++],j=c(e,n,a,R,s,D,B,U>>4,15&U);n+=j;break;case 65535:255!==e[n]&&n--;break;default:if(255==e[n-3]&&e[n-2]>=192&&e[n-2]<=254){n-=3;break}throw new Error("unknown JPEG marker "+y.toString(16))}y=i()}if(1!=d.length)throw new Error("only single frame JPEGs supported");for(var F=0;F<d.length;F++){var N=d[F].components;for(var Z in N)N[Z].quantizationTable=p[N[Z].quantizationIdx],delete N[Z].quantizationIdx}this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=l,this.adobe=u,this.components=[];for(F=0;F<a.componentsOrder.length;F++){var V=a.components[a.componentsOrder[F]];this.components.push({lines:f(0,V),scaleX:V.h/a.maxH,scaleY:V.v/a.maxV})}},getData:function(t,e){var n,i,r,o,a,s,l,u,h,c,f,d,g,m,y,v,b,_,w,M,x,A=this.width/t,T=this.height/e,S=0,E=t*e*this.components.length,C=new Uint8Array(E);switch(this.components.length){case 1:for(n=this.components[0],c=0;c<e;c++)for(a=n.lines[0|c*n.scaleY*T],h=0;h<t;h++)f=a[0|h*n.scaleX*A],C[S++]=f;break;case 2:for(n=this.components[0],i=this.components[1],c=0;c<e;c++)for(a=n.lines[0|c*n.scaleY*T],s=i.lines[0|c*i.scaleY*T],h=0;h<t;h++)f=a[0|h*n.scaleX*A],C[S++]=f,f=s[0|h*i.scaleX*A],C[S++]=f;break;case 3:for(x=!0,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),n=this.components[0],i=this.components[1],r=this.components[2],c=0;c<e;c++)for(a=n.lines[0|c*n.scaleY*T],s=i.lines[0|c*i.scaleY*T],l=r.lines[0|c*r.scaleY*T],h=0;h<t;h++)x?(f=a[0|h*n.scaleX*A],d=s[0|h*i.scaleX*A],_=p(f+1.402*((g=l[0|h*r.scaleX*A])-128)),w=p(f-.3441363*(d-128)-.71413636*(g-128)),M=p(f+1.772*(d-128))):(_=a[0|h*n.scaleX*A],w=s[0|h*i.scaleX*A],M=l[0|h*r.scaleX*A]),C[S++]=_,C[S++]=w,C[S++]=M;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(x=!1,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),n=this.components[0],i=this.components[1],r=this.components[2],o=this.components[3],c=0;c<e;c++)for(a=n.lines[0|c*n.scaleY*T],s=i.lines[0|c*i.scaleY*T],l=r.lines[0|c*r.scaleY*T],u=o.lines[0|c*o.scaleY*T],h=0;h<t;h++)x?(f=a[0|h*n.scaleX*A],d=s[0|h*i.scaleX*A],g=l[0|h*r.scaleX*A],m=u[0|h*o.scaleX*A],y=255-p(f+1.402*(g-128)),v=255-p(f-.3441363*(d-128)-.71413636*(g-128)),b=255-p(f+1.772*(d-128))):(y=a[0|h*n.scaleX*A],v=s[0|h*i.scaleX*A],b=l[0|h*r.scaleX*A],m=u[0|h*o.scaleX*A]),C[S++]=255-y,C[S++]=255-v,C[S++]=255-b,C[S++]=255-m;break;default:throw new Error("Unsupported color mode")}return C},copyToImageData:function(t){var e,n,i,r,o,a,s,l,u,h=t.width,c=t.height,f=t.data,d=this.getData(h,c),g=0,m=0;switch(this.components.length){case 1:for(n=0;n<c;n++)for(e=0;e<h;e++)i=d[g++],f[m++]=i,f[m++]=i,f[m++]=i,f[m++]=255;break;case 3:for(n=0;n<c;n++)for(e=0;e<h;e++)s=d[g++],l=d[g++],u=d[g++],f[m++]=s,f[m++]=l,f[m++]=u,f[m++]=255;break;case 4:for(n=0;n<c;n++)for(e=0;e<h;e++)o=d[g++],a=d[g++],i=d[g++],s=255-p(o*(1-(r=d[g++])/255)+r),l=255-p(a*(1-r/255)+r),u=255-p(i*(1-r/255)+r),f[m++]=s,f[m++]=l,f[m++]=u,f[m++]=255;break;default:throw new Error("Unsupported color mode")}}},u}();t.exports=function(t,i){var r={useTArray:!1,colorTransform:!0};i?"object"==typeof i?i={useTArray:void 0===i.useTArray?r.useTArray:i.useTArray,colorTransform:void 0===i.colorTransform?r.colorTransform:i.colorTransform}:(i=r).useTArray=!0:i=r;var o=new Uint8Array(t),a=new n;a.parse(o),a.colorTransform=i.colorTransform;var s={width:a.width,height:a.height,data:i.useTArray?new Uint8Array(a.width*a.height*4):new e(a.width*a.height*4)};return a.copyToImageData(s),s}}).call(this,n(3).Buffer)},function(t,e,n){(function(e){t.exports=function(t){if(t){if("Uint8Array"===t.constructor.name||t.constructor===Uint8Array)return t;"string"==typeof t&&(t=e(t));for(var n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t[i];return n}}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";(function(e){var i=n(204);t.exports=function(t,n){for(var r=i.decode(e.from(t)),o=r.width,a=r.height,s=new Uint8Array(o*a*4),l=0;l<s.length;l+=4){var u=r.data[l+0],h=r.data[l+1],c=r.data[l+2],f=r.data[l+3];s[l+0]=f,s[l+1]=c,s[l+2]=h,s[l+3]=r.is_with_alpha?u:255}return{data:s,width:r.width,height:r.height}}}).call(this,n(3).Buffer)},function(t,e,n){var i=n(205),r=n(206);t.exports={encode:i,decode:r}},function(t,e,n){(function(e){function n(t){this.buffer=t.data,this.width=t.width,this.height=t.height,this.extraBytes=this.width%4,this.rgbSize=this.height*(3*this.width+this.extraBytes),this.headerInfoSize=40,this.data=[],this.flag="BM",this.reserved=0,this.offset=54,this.fileSize=this.rgbSize+this.offset,this.planes=1,this.bitPP=24,this.compress=0,this.hr=0,this.vr=0,this.colors=0,this.importantColors=0}n.prototype.encode=function(){var t=new e(this.offset+this.rgbSize);this.pos=0,t.write(this.flag,this.pos,2),this.pos+=2,t.writeUInt32LE(this.fileSize,this.pos),this.pos+=4,t.writeUInt32LE(this.reserved,this.pos),this.pos+=4,t.writeUInt32LE(this.offset,this.pos),this.pos+=4,t.writeUInt32LE(this.headerInfoSize,this.pos),this.pos+=4,t.writeUInt32LE(this.width,this.pos),this.pos+=4,t.writeInt32LE(-this.height,this.pos),this.pos+=4,t.writeUInt16LE(this.planes,this.pos),this.pos+=2,t.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,t.writeUInt32LE(this.compress,this.pos),this.pos+=4,t.writeUInt32LE(this.rgbSize,this.pos),this.pos+=4,t.writeUInt32LE(this.hr,this.pos),this.pos+=4,t.writeUInt32LE(this.vr,this.pos),this.pos+=4,t.writeUInt32LE(this.colors,this.pos),this.pos+=4,t.writeUInt32LE(this.importantColors,this.pos),this.pos+=4;for(var n=0,i=3*this.width+this.extraBytes,r=0;r<this.height;r++){for(var o=0;o<this.width;o++){var a=this.pos+r*i+3*o;n++,t[a]=this.buffer[n++],t[a+1]=this.buffer[n++],t[a+2]=this.buffer[n++]}if(this.extraBytes>0){var s=this.pos+r*i+3*this.width;t.fill(0,s,s+this.extraBytes)}}return t},t.exports=function(t,e){return void 0===e&&(e=100),{data:new n(t).encode(),width:t.width,height:t.height}}}).call(this,n(3).Buffer)},function(t,e,n){(function(e){function n(t,e){if(this.pos=0,this.buffer=t,this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),"BM"!=this.flag)throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}n.prototype.parseHeader=function(){if(this.fileSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.reserved=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.offset=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.headerSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.width=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.height=this.buffer.readInt32LE(this.pos),this.pos+=4,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compress=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.rawSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.hr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.vr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.colors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.importantColors=this.buffer.readUInt32LE(this.pos),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++);this.palette[e]={red:r,green:i,blue:n,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},n.prototype.parseRGBA=function(){var t="bit"+this.bitPP,n=this.width*this.height*4;this.data=new e(n),this[t]()},n.prototype.bit1=function(){var t=Math.ceil(this.width/8),e=t%4,n=this.height>=0?this.height-1:-this.height;for(n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<t;r++)for(var o=this.buffer.readUInt8(this.pos++),a=i*this.width*4+8*r*4,s=0;s<8&&8*r+s<this.width;s++){var l=this.palette[o>>7-s&1];this.data[a+4*s]=0,this.data[a+4*s+1]=l.blue,this.data[a+4*s+2]=l.green,this.data[a+4*s+3]=l.red}0!=e&&(this.pos+=4-e)}},n.prototype.bit4=function(){if(2==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0,n=!1;t<this.data.length;){var i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++);if(0==i){if(0==r){this.bottom_up?e--:e++,t=e*this.width*4,n=!1;continue}if(1==r)break;if(2==r){var o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=a:e+=a,t+=a*this.width*4+4*o}else{for(var s=this.buffer.readUInt8(this.pos++),l=0;l<r;l++)n?u.call(this,15&s):u.call(this,(240&s)>>4),1&l&&l+1<r&&(s=this.buffer.readUInt8(this.pos++)),n=!n;1==(r+1>>1&1)&&this.pos++}}else for(l=0;l<i;l++)n?u.call(this,15&r):u.call(this,(240&r)>>4),n=!n}function u(e){var n=this.palette[e];this.data[t]=0,this.data[t+1]=n.blue,this.data[t+2]=n.green,this.data[t+3]=n.red,t+=4}}else{var h=Math.ceil(this.width/2),c=h%4;for(a=this.height-1;a>=0;a--){var f=this.bottom_up?a:this.height-1-a;for(o=0;o<h;o++){r=this.buffer.readUInt8(this.pos++),t=f*this.width*4+2*o*4;var p=r>>4,d=15&r,g=this.palette[p];if(this.data[t]=0,this.data[t+1]=g.blue,this.data[t+2]=g.green,this.data[t+3]=g.red,2*o+1>=this.width)break;g=this.palette[d],this.data[t+4]=0,this.data[t+4+1]=g.blue,this.data[t+4+2]=g.green,this.data[t+4+3]=g.red}0!=c&&(this.pos+=4-c)}}},n.prototype.bit8=function(){if(1==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0;t<this.data.length;){var n=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++);if(0==n){if(0==i){this.bottom_up?e--:e++,t=e*this.width*4;continue}if(1==i)break;if(2==i){var r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=o:e+=o,t+=o*this.width*4+4*r}else{for(var a=0;a<i;a++){var s=this.buffer.readUInt8(this.pos++);l.call(this,s)}!0&i&&this.pos++}}else for(a=0;a<n;a++)l.call(this,i)}function l(e){var n=this.palette[e];this.data[t]=0,this.data[t+1]=n.blue,this.data[t+2]=n.green,this.data[t+3]=n.red,t+=4}}else{var u=this.width%4;for(o=this.height-1;o>=0;o--){var h=this.bottom_up?o:this.height-1-o;for(r=0;r<this.width;r++){i=this.buffer.readUInt8(this.pos++),t=h*this.width*4+4*r;if(i<this.palette.length){var c=this.palette[i];this.data[t]=0,this.data[t+1]=c.blue,this.data[t+2]=c.green,this.data[t+3]=c.red}else this.data[t]=0,this.data[t+1]=255,this.data[t+2]=255,this.data[t+3]=255}0!=u&&(this.pos+=4-u)}}},n.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var o=this.buffer.readUInt16LE(this.pos);this.pos+=2;var a=(o&e)/e*255|0,s=(o>>5&e)/e*255|0,l=(o>>10&e)/e*255|0,u=o>>15?255:0,h=i*this.width*4+4*r;this.data[h]=u,this.data[h+1]=a,this.data[h+2]=s,this.data[h+3]=l}this.pos+=t}},n.prototype.bit16=function(){var t=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,3==this.compress&&(this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4);for(var e=[0,0,0],n=0;n<16;n++)this.maskRed>>n&1&&e[0]++,this.maskGreen>>n&1&&e[1]++,this.maskBlue>>n&1&&e[2]++;e[1]+=e[0],e[2]+=e[1],e[0]=8-e[0],e[1]-=8,e[2]-=8;for(var i=this.height-1;i>=0;i--){for(var r=this.bottom_up?i:this.height-1-i,o=0;o<this.width;o++){var a=this.buffer.readUInt16LE(this.pos);this.pos+=2;var s=(a&this.maskBlue)<<e[0],l=(a&this.maskGreen)>>e[1],u=(a&this.maskRed)>>e[2],h=r*this.width*4+4*o;this.data[h]=0,this.data[h+1]=s,this.data[h+2]=l,this.data[h+3]=u}this.pos+=t}},n.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=e*this.width*4+4*n;this.data[a]=0,this.data[a+1]=i,this.data[a+2]=r,this.data[a+3]=o}this.pos+=this.width%4}},n.prototype.bit32=function(){if(3==this.compress){this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4;for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=e*this.width*4+4*n;this.data[s]=i,this.data[s+1]=r,this.data[s+2]=o,this.data[s+3]=a}}else for(t=this.height-1;t>=0;t--)for(e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){r=this.buffer.readUInt8(this.pos++),o=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),s=e*this.width*4+4*n;this.data[s]=i,this.data[s+1]=r,this.data[s+2]=o,this.data[s+3]=a}},n.prototype.getData=function(){return this.data},t.exports=function(t){return new n(t)}}).call(this,n(3).Buffer)},function(t,e,n){"use strict";var i=n(208);t.exports=function(t,e){var n=i.decode(t);return i.decodeImages(t,n),{data:i.toRGBA8(n[0]),height:n[0].height,width:n[0].width}}},function(t,e,n){(function(e){!function(){var i={};function r(){void 0===e&&console.log.apply(console,arguments)}t.exports=i,function(t,e){!function(){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t){this.message="JPEG error: "+t}return t.prototype=Error(),t.prototype.name="JpegError",t.constructor=t}(),i=function(){function t(t,e){this.message=t,this.g=e}return t.prototype=Error(),t.prototype.name="DNLMarkerError",t.constructor=t}();!function(){function r(){this.M=null,this.B=-1}function o(t,e){for(var n,i,r=0,o=[],a=16;0<a&&!t[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(n=0;n<a;n++){for(i=0;i<t[n];i++){for((l=o.pop()).children[l.index]=e[r];0<l.index;)l=o.pop();for(l.index++,o.push(l);o.length<=n;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;r++}n+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function a(t,r,o,a,s,h,c,f,p){function d(){if(0<L)return C>>--L&1;if(255===(C=t[r++])){var e=t[r++];if(e){if(220===e&&T){r+=2;var a=t[r++]<<8|t[r++];if(0<a&&a!==o.g)throw new i("Found DNL marker (0xFFDC) while parsing scan data",a)}throw new n("unexpected marker "+(C<<8|e).toString(16))}}return L=7,C>>>7}function g(t){for(;;){if("number"==typeof(t=t[d()]))return t;if("object"!==(void 0===t?"undefined":e(t)))throw new n("invalid huffman sequence")}}function m(t){for(var e=0;0<t;)e=e<<1|d(),t--;return e}function y(t){if(1===t)return 1===d()?1:-1;var e=m(t);return e>=1<<t-1?e:e+(-1<<t)+1}for(var v,b,_,w,M,x,A,T=9<arguments.length&&void 0!==arguments[9]&&arguments[9],S=o.P,E=r,C=0,L=0,P=0,I=0,O=a.length,R=o.S?0===h?0===f?function(t,e){var n=g(t.D);n=0===n?0:y(n)<<p,t.a[e]=t.m+=n}:function(t,e){t.a[e]|=d()<<p}:0===f?function(t,e){if(0<P)P--;else for(var n=h;n<=c;){var i=g(t.o),r=15&i;if(i>>=4,0===r){if(15>i){P=m(i)+(1<<i)-1;break}n+=16}else n+=i,t.a[e+u[n]]=y(r)*(1<<p),n++}}:function(t,e){for(var i,r=h,o=0;r<=c;){i=e+u[r];var a=0>t.a[i]?-1:1;switch(I){case 0:if(i=15&(o=g(t.o)),o>>=4,0===i)15>o?(P=m(o)+(1<<o),I=4):(o=16,I=1);else{if(1!==i)throw new n("invalid ACn encoding");v=y(i),I=o?2:3}continue;case 1:case 2:t.a[i]?t.a[i]+=a*(d()<<p):0==--o&&(I=2===I?3:0);break;case 3:t.a[i]?t.a[i]+=a*(d()<<p):(t.a[i]=v<<p,I=0);break;case 4:t.a[i]&&(t.a[i]+=a*(d()<<p))}r++}4===I&&0==--P&&(I=0)}:function(t,e){var n=g(t.D);for(n=0===n?0:y(n),t.a[e]=t.m+=n,n=1;64>n;){var i=g(t.o),r=15&i;if(i>>=4,0===r){if(15>i)break;n+=16}else n+=i,t.a[e+u[n]]=y(r),n++}},k=0,D=1===O?a[0].c*a[0].l:S*o.O;k<D;){var B=s?Math.min(D-k,s):D;for(b=0;b<O;b++)a[b].m=0;if(P=0,1===O){var U=a[0];for(M=0;M<B;M++)R(U,64*((U.c+1)*(k/U.c|0)+k%U.c)),k++}else for(M=0;M<B;M++){for(b=0;b<O;b++)for(x=(U=a[b]).h,A=U.j,_=0;_<A;_++)for(w=0;w<x;w++)R(U,64*((U.c+1)*((k/S|0)*U.j+_)+(k%S*U.h+w)));k++}if(L=0,(U=l(t,r))&&U.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+U.f),r=U.offset),!(U=U&&U.F)||65280>=U)throw new n("marker was not found");if(!(65488<=U&&65495>=U))break;r+=2}return(U=l(t,r))&&U.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+U.f),r=U.offset),r-E}function s(t,e){for(var i=e.c,r=e.l,o=new Int16Array(64),a=0;a<r;a++)for(var s=0;s<i;s++){var l=64*((e.c+1)*a+s),u=o,h=e.G,c=e.a;if(!h)throw new n("missing required Quantization Table.");for(var f=0;64>f;f+=8){var p=c[l+f],d=c[l+f+1],g=c[l+f+2],m=c[l+f+3],y=c[l+f+4],v=c[l+f+5],b=c[l+f+6],_=c[l+f+7];if(p*=h[f],0==(d|g|m|y|v|b|_))p=5793*p+512>>10,u[f]=p,u[f+1]=p,u[f+2]=p,u[f+3]=p,u[f+4]=p,u[f+5]=p,u[f+6]=p,u[f+7]=p;else{d*=h[f+1],g*=h[f+2],m*=h[f+3],y*=h[f+4],v*=h[f+5],b*=h[f+6],_*=h[f+7];var w=5793*p+128>>8,M=5793*y+128>>8,x=g,A=b;M=(w=w+M+1>>1)-M,p=3784*x+1567*A+128>>8,x=1567*x-3784*A+128>>8,v=(y=(y=2896*(d-_)+128>>8)+(v<<=4)+1>>1)-v,m=(_=(_=2896*(d+_)+128>>8)+(m<<=4)+1>>1)-m,A=(w=w+(A=p)+1>>1)-A,x=(M=M+x+1>>1)-x,p=2276*y+3406*_+2048>>12,y=3406*y-2276*_+2048>>12,_=p,p=799*m+4017*v+2048>>12,m=4017*m-799*v+2048>>12,v=p,u[f]=w+_,u[f+7]=w-_,u[f+1]=M+v,u[f+6]=M-v,u[f+2]=x+m,u[f+5]=x-m,u[f+3]=A+y,u[f+4]=A-y}}for(h=0;8>h;++h)p=u[h],0==((d=u[h+8])|(g=u[h+16])|(m=u[h+24])|(y=u[h+32])|(v=u[h+40])|(b=u[h+48])|(_=u[h+56]))?(p=-2040>(p=5793*p+8192>>14)?0:2024<=p?255:p+2056>>4,c[l+h]=p,c[l+h+8]=p,c[l+h+16]=p,c[l+h+24]=p,c[l+h+32]=p,c[l+h+40]=p,c[l+h+48]=p,c[l+h+56]=p):(M=(w=4112+((w=5793*p+2048>>12)+(M=5793*y+2048>>12)+1>>1))-M,p=3784*(x=g)+1567*(A=b)+2048>>12,x=1567*x-3784*A+2048>>12,A=p,v=(y=(y=2896*(d-_)+2048>>12)+v+1>>1)-v,m=(_=(_=2896*(d+_)+2048>>12)+m+1>>1)-m,p=2276*y+3406*_+2048>>12,y=3406*y-2276*_+2048>>12,_=p,p=799*m+4017*v+2048>>12,m=4017*m-799*v+2048>>12,v=p,p=(w=w+A+1>>1)+_,_=w-_,d=(M=M+x+1>>1)+v,b=M-v,g=(x=M-x)+m,v=x-m,m=(A=w-A)+y,y=A-y,p=16>p?0:4080<=p?255:p>>4,d=16>d?0:4080<=d?255:d>>4,g=16>g?0:4080<=g?255:g>>4,m=16>m?0:4080<=m?255:m>>4,y=16>y?0:4080<=y?255:y>>4,v=16>v?0:4080<=v?255:v>>4,b=16>b?0:4080<=b?255:b>>4,_=16>_?0:4080<=_?255:_>>4,c[l+h]=p,c[l+h+8]=d,c[l+h+16]=g,c[l+h+24]=m,c[l+h+32]=y,c[l+h+40]=v,c[l+h+48]=b,c[l+h+56]=_)}return e.a}function l(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,i=t.length-1;if(n=n<e?n:e,e>=i)return null;var r=t[e]<<8|t[e+1];if(65472<=r&&65534>=r)return{f:null,F:r,offset:e};for(var o=t[n]<<8|t[n+1];!(65472<=o&&65534>=o);){if(++n>=i)return null;o=t[n]<<8|t[n+1]}return{f:r.toString(16),F:o,offset:n}}var u=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);r.prototype={parse:function(t){function e(){var e=t[p]<<8|t[p+1];return p+=2,e}function r(){var n=e(),i=l(t,n=p+n-2,p);return i&&i.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+i.f),n=i.offset),n=t.subarray(p,n),p+=n.length,n}function h(t){for(var e=Math.ceil(t.v/8/t.s),n=Math.ceil(t.g/8/t.u),i=0;i<t.b.length;i++){E=t.b[i];var r=Math.ceil(Math.ceil(t.v/8)*E.h/t.s),o=Math.ceil(Math.ceil(t.g/8)*E.j/t.u);E.a=new Int16Array(64*n*E.j*(e*E.h+1)),E.c=r,E.l=o}t.P=e,t.O=n}var c=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).N,f=void 0===c?null:c,p=0,d=null,g=0;c=[];var m=[],y=[],v=e();if(65496!==v)throw new n("SOI not found");for(v=e();65497!==v;){switch(v){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=r();65518===v&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&(d={version:b[5]<<8|b[6],Y:b[7]<<8|b[8],Z:b[9]<<8|b[10],W:b[11]});break;case 65499:v=e()+p-2;for(var _;p<v;){var w=t[p++],M=new Uint16Array(64);if(0==w>>4)for(b=0;64>b;b++)M[_=u[b]]=t[p++];else{if(1!=w>>4)throw new n("DQT - invalid table spec");for(b=0;64>b;b++)M[_=u[b]]=e()}c[15&w]=M}break;case 65472:case 65473:case 65474:if(x)throw new n("Only single frame JPEGs supported");e();var x={};for(x.X=65473===v,x.S=65474===v,x.precision=t[p++],v=e(),x.g=f||v,x.v=e(),x.b=[],x.C={},b=t[p++],v=M=w=0;v<b;v++){_=t[p];var A=t[p+1]>>4,T=15&t[p+1];w<A&&(w=A),M<T&&(M=T),A=x.b.push({h:A,j:T,T:t[p+2],G:null}),x.C[_]=A-1,p+=3}x.s=w,x.u=M,h(x);break;case 65476:for(_=e(),v=2;v<_;){for(w=t[p++],M=new Uint8Array(16),b=A=0;16>b;b++,p++)A+=M[b]=t[p];for(T=new Uint8Array(A),b=0;b<A;b++,p++)T[b]=t[p];v+=17+A,(0==w>>4?y:m)[15&w]=o(M,T)}break;case 65501:e();var S=e();break;case 65498:for(b=1==++g&&!f,e(),w=t[p++],_=[],v=0;v<w;v++){M=x.C[t[p++]];var E=x.b[M];M=t[p++],E.D=y[M>>4],E.o=m[15&M],_.push(E)}v=t[p++],w=t[p++],M=t[p++];try{var C=a(t,p,x,_,S,v,w,M>>4,15&M,b);p+=C}catch(e){if(e instanceof i)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(t,{N:e.g});throw e}break;case 65500:p+=4;break;case 65535:255!==t[p]&&p--;break;default:if(255===t[p-3]&&192<=t[p-2]&&254>=t[p-2])p-=3;else{if(!(b=l(t,p-2))||!b.f)throw new n("unknown marker "+v.toString(16));(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+b.f),p=b.offset}}v=e()}for(this.width=x.v,this.height=x.g,this.A=d,this.b=[],v=0;v<x.b.length;v++)(S=c[(E=x.b[v]).T])&&(E.G=S),this.b.push({R:s(0,E),U:E.h/x.s,V:E.j/x.u,c:E.c,l:E.l});this.i=this.b.length},L:function(t,e){var n,i,r=this.width/t,o=this.height/e,a=this.b.length,s=t*e*a,l=new Uint8ClampedArray(s),u=new Uint32Array(t);for(i=0;i<a;i++){var h=this.b[i],c=h.U*r,f=h.V*o,p=i,d=h.R,g=h.c+1<<3;for(n=0;n<t;n++)h=0|n*c,u[n]=(4294967288&h)<<3|7&h;for(c=0;c<e;c++)for(h=g*(4294967288&(h=0|c*f))|(7&h)<<3,n=0;n<t;n++)l[p]=d[h+u[n]],p+=a}if(o=this.M)for(i=0;i<s;)for(r=h=0;h<a;h++,i++,r+=2)l[i]=(l[i]*o[r]>>8)+o[r+1];return l},w:function(){return this.A?!!this.A.W:3===this.i?0!==this.B:1===this.B},I:function(t){for(var e,n,i,r=0,o=t.length;r<o;r+=3)e=t[r],n=t[r+1],i=t[r+2],t[r]=e-179.456+1.402*i,t[r+1]=e+135.459-.344*n-.714*i,t[r+2]=e-226.816+1.772*n;return t},K:function(t){for(var e,n,i,r,o=0,a=0,s=t.length;a<s;a+=4)e=t[a],n=t[a+1],i=t[a+2],r=t[a+3],t[o++]=n*(-660635669420364e-19*n+.000437130475926232*i-54080610064599e-18*e+.00048449797120281*r-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*e-.00477271405408747*r+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*r+.48357088451265)+r*(-.000336197177618394*r+.484791561490776),t[o++]=107.268039397724+n*(219927104525741e-19*n-.000640992018297945*i+.000659397001245577*e+.000426105652938837*r-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*e+.000770482631801132*r-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*r+.25802910206845)+r*(-.000318913117588328*r-.213742400323665),t[o++]=n*(-.000570115196973677*n-263409051004589e-19*i+.0020741088115012*e-.00288260236853442*r+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*e+.000560833691242812*r-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*r+.116935020465145)+r*(-.000343531996510555*r+.24165260232407);return t.subarray(0,o)},J:function(t){for(var e,n,i,r=0,o=t.length;r<o;r+=4)e=t[r],n=t[r+1],i=t[r+2],t[r]=434.456-e-1.402*i,t[r+1]=119.541-e+.344*n+.714*i,t[r+2]=481.816-e-1.772*n;return t},H:function(t){for(var e,n,i,r,o=0,a=1/255,s=0,l=t.length;s<l;s+=4)e=t[s]*a,n=t[s+1]*a,i=t[s+2]*a,r=t[s+3]*a,t[o++]=255+e*(-4.387332384609988*e+54.48615194189176*n+18.82290502165302*i+212.25662451639585*r-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*i-17.873870861415444*r-5.497006427196366)+i*(-2.5217340131683033*i-21.248923337353073*r+17.5119270841813)-r*(21.86122147463605*r+189.48180835922747),t[o++]=255+e*(8.841041422036149*e+60.118027045597366*n+6.871425592049007*i+31.159100130055922*r-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*i+131.35250912493976*r-190.9453302588951)+i*(4.444339102852739*i+9.8632861493405*r-24.86741582555878)-r*(20.737325471181034*r+187.80453709719578),t[o++]=255+e*(.8842522430003296*e+8.078677503112928*n+30.89978309703729*i-.23883238689178934*r-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*i+50.606957656360734*r-112.23884253719248)+i*(.03296041114873217*i+115.60384449646641*r-193.58209356861505)-r*(22.33816807309886*r+180.12613974708367);return t.subarray(0,o)},getData:function(t,e,i){if(4<this.i)throw new n("Unsupported color mode");if(t=this.L(t,e),1===this.i&&i){i=t.length,e=new Uint8ClampedArray(3*i);for(var r=0,o=0;o<i;o++){var a=t[o];e[r++]=a,e[r++]=a,e[r++]=a}return e}if(3===this.i&&this.w())return this.I(t);if(4===this.i){if(this.w())return i?this.K(t):this.J(t);if(i)return this.H(t)}return t}},t.JpegDecoder=r}()}(),t.encodeImage=function(e,n,i,r){var o={t256:[n],t257:[i],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[i],t279:[n*i*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(r)for(var a in r)o[a]=r[a];var s=new Uint8Array(t.encode([o])),l=new Uint8Array(e),u=new Uint8Array(1e3+n*i*4);for(a=0;a<s.length;a++)u[a]=s[a];for(a=0;a<l.length;a++)u[1e3+a]=l[a];return u.buffer},t.encode=function(e){var n=new Uint8Array(2e4),i=4,r=t._binBE;n[0]=77,n[1]=77,n[3]=42;var o=8;r.writeUint(n,i,o),i+=4;for(var a=0;a<e.length;a++){var s=t._writeIFD(r,n,o,e[a]);o=s[1],a<e.length-1&&r.writeUint(n,s[0],o)}return n.slice(0,o).buffer},t.decode=function(e){t.decode._decodeG3.allow2D=null;var n=new Uint8Array(e),i=0,r=t._binBE.readASCII(n,i,2);i+=2;var o="II"==r?t._binLE:t._binBE;o.readUshort(n,i);i+=2;var a=o.readUint(n,i);i+=4;for(var s=[];;){var l=t._readIFD(o,n,a,s);if(0==(a=o.readUint(n,l)))break}return s},t.decodeImages=function(e,n){for(var i=new Uint8Array(e),o=t._binBE.readASCII(i,0,2),a=0;a<n.length;a++){var s=n[a];if(null!=s.t256){s.isLE="II"==o,s.width=s.t256[0],s.height=s.t257[0];var l=s.t259?s.t259[0]:1,u=s.t266?s.t266[0]:1;s.t284&&2==s.t284[0]&&r("PlanarConfiguration 2 should not be used!");var h=(s.t258?Math.min(32,s.t258[0]):1)*(s.t277?s.t277[0]:1),c=8*Math.ceil(s.width*h/8),f=s.t273;null==f&&(f=s.t324);var p=s.t279;1==l&&1==f.length&&(p=[s.height*(c>>>3)]),null==p&&(p=s.t325);var d=new Uint8Array(s.height*(c>>>3)),g=0;if(null!=s.t322){for(var m=s.t322[0],y=s.t323[0],v=Math.floor((s.width+m-1)/m),b=Math.floor((s.height+y-1)/y),_=new Uint8Array(0|Math.ceil(m*y*h/8)),w=0;w<b;w++)for(var M=0;M<v;M++){for(var x=w*v+M,A=0;A<_.length;A++)_[A]=0;t.decode._decompress(s,i,f[x],p[x],l,_,0,u),6==l?d=_:t._copyTile(_,0|Math.ceil(m*h/8),y,d,0|Math.ceil(s.width*h/8),s.height,0|Math.ceil(M*m*h/8),w*y)}g=8*d.length}else{var T=s.t278?s.t278[0]:s.height;T=Math.min(T,s.height);for(x=0;x<f.length;x++)t.decode._decompress(s,i,f[x],p[x],l,d,0|Math.ceil(g/8),u),g+=c*T;g=Math.min(g,8*d.length)}s.data=new Uint8Array(d.buffer,0,0|Math.ceil(g/8))}}},t.decode._decompress=function(n,i,o,a,s,l,u,h){if(1==s)for(var c=0;c<a;c++)l[u+c]=i[o+c];else if(3==s)t.decode._decodeG3(i,o,a,l,u,n.width,h);else if(4==s)t.decode._decodeG4(i,o,a,l,u,n.width,h);else if(5==s)t.decode._decodeLZW(i,o,l,u);else if(6==s)t.decode._decodeOldJPEG(n,i,o,a,l,u);else if(7==s)t.decode._decodeNewJPEG(n,i,o,a,l,u);else if(8==s)for(var f=new Uint8Array(i.buffer,o,a),p=e.inflate(f),d=0;d<p.length;d++)l[u+d]=p[d];else 32773==s?t.decode._decodePackBits(i,o,a,l,u):32809==s?t.decode._decodeThunder(i,o,a,l,u):r("Unknown compression",s);if(n.t317&&2==n.t317[0])for(var g=n.t277?n.t277[0]:1,m=n.t278?n.t278[0]:n.height,y=n.width*g,v=0;v<m;v++){var b=u+v*y;if(3==g)for(c=3;c<y;c+=3)l[b+c]=l[b+c]+l[b+c-3]&255,l[b+c+1]=l[b+c+1]+l[b+c-2]&255,l[b+c+2]=l[b+c+2]+l[b+c-1]&255;else for(c=g;c<y;c++)l[b+c]=l[b+c]+l[b+c-g]&255}},t.decode._decodeNikon=function(t,e,n,i,o){var a,s;r(t.slice(e,e+100)),a=t[e],s=t[++e],e++,r(a.toString(16),s.toString(16),n)},t.decode._decodeNewJPEG=function(e,n,i,r,o,a){var s=e.t347,l=s?s.length:0,u=new Uint8Array(l+r);if(s){for(var h=0,c=0;c<l-1&&(255!=s[c]||217!=s[c+1]);c++)u[h++]=s[c];var f=n[i],p=n[i+1];255==f&&216==p||(u[h++]=f,u[h++]=p);for(c=2;c<r;c++)u[h++]=n[i+c]}else for(c=0;c<r;c++)u[c]=n[i+c];if(32803==e.t262){var d=e.t258[0],g=(new LosslessJpegDecoder).decode(u),m=g.length;if(16==d)for(c=0;c<m;c++)o[a++]=255&g[c],o[a++]=g[c]>>>8;else{if(12!=d)throw new Error("unsupported bit depth "+d);for(c=0;c<m;c+=2)o[a++]=g[c]>>>4,o[a++]=255&(g[c]<<4|g[c+1]>>>8),o[a++]=255&g[c+1]}}else{var y=new t.JpegDecoder;y.parse(u);var v=y.getData(y.width,y.height);for(c=0;c<v.length;c++)o[a+c]=v[c]}6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodeOldJPEGInit=function(t,e,n,i){var o,a,s,l,u,h=0,c=0,f=!1,p=t.t513,d=p?p[0]:0,g=t.t514,m=g?g[0]:0,y=t.t324||t.t273||p,v=t.t530,b=0,_=0,w=t.t277?t.t277[0]:1,M=t.t515;if(y&&(c=y[0],f=y.length>1),!f){if(255==e[n]&&216==e[n+1])return{jpegOffset:n};if(null!=p&&(255==e[n+d]&&216==e[n+d+1]?h=n+d:r("JPEGInterchangeFormat does not point to SOI"),null==g?r("JPEGInterchangeFormatLength field is missing"):(d>=c||d+m<=c)&&r("JPEGInterchangeFormatLength field value is invalid"),null!=h))return{jpegOffset:h}}if(null!=v&&(b=v[0],_=v[1]),null!=p&&null!=g)if(m>=2&&d+m<=c){for(o=255==e[n+d+m-2]&&216==e[n+d+m-1]?new Uint8Array(m-2):new Uint8Array(m),s=0;s<o.length;s++)o[s]=e[n+d+s];r("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else r("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==o){var x=0,A=[];A[x++]=255,A[x++]=216;var T=t.t519;if(null==T)throw new Error("JPEGQTables tag is missing");for(s=0;s<T.length;s++)for(A[x++]=255,A[x++]=219,A[x++]=0,A[x++]=67,A[x++]=s,l=0;l<64;l++)A[x++]=e[n+T[s]+l];for(u=0;u<2;u++){var S=t[0==u?"t520":"t521"];if(null==S)throw new Error((0==u?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(s=0;s<S.length;s++){A[x++]=255,A[x++]=196;var E=19;for(l=0;l<16;l++)E+=e[n+S[s]+l];for(A[x++]=E>>>8,A[x++]=255&E,A[x++]=s|u<<4,l=0;l<16;l++)A[x++]=e[n+S[s]+l];for(l=0;l<E;l++)A[x++]=e[n+S[s]+16+l]}}if(A[x++]=255,A[x++]=192,A[x++]=0,A[x++]=8+3*w,A[x++]=8,A[x++]=t.height>>>8&255,A[x++]=255&t.height,A[x++]=t.width>>>8&255,A[x++]=255&t.width,A[x++]=w,1==w)A[x++]=1,A[x++]=17,A[x++]=0;else for(s=0;s<3;s++)A[x++]=s+1,A[x++]=0!=s?17:(15&b)<<4|15&_,A[x++]=s;null!=M&&0!=M[0]&&(A[x++]=255,A[x++]=221,A[x++]=0,A[x++]=4,A[x++]=M[0]>>>8&255,A[x++]=255&M[0]),o=new Uint8Array(A)}var C=-1;for(s=0;s<o.length-1;){if(255==o[s]&&192==o[s+1]){C=s;break}s++}if(-1==C){var L=new Uint8Array(o.length+10+3*w);L.set(o);var P=o.length;if(C=o.length,(o=L)[P++]=255,o[P++]=192,o[P++]=0,o[P++]=8+3*w,o[P++]=8,o[P++]=t.height>>>8&255,o[P++]=255&t.height,o[P++]=t.width>>>8&255,o[P++]=255&t.width,o[P++]=w,1==w)o[P++]=1,o[P++]=17,o[P++]=0;else for(s=0;s<3;s++)o[P++]=s+1,o[P++]=0!=s?17:(15&b)<<4|15&_,o[P++]=s}if(255==e[c]&&218==e[c+1]){var I=e[c+2]<<8|e[c+3];for((a=new Uint8Array(I+2))[0]=e[c],a[1]=e[c+1],a[2]=e[c+2],a[3]=e[c+3],s=0;s<I-2;s++)a[s+4]=e[c+s+4]}else{var O=0;if((a=new Uint8Array(8+2*w))[O++]=255,a[O++]=218,a[O++]=0,a[O++]=6+2*w,a[O++]=w,1==w)a[O++]=1,a[O++]=0;else for(s=0;s<3;s++)a[O++]=s+1,a[O++]=s<<4|s;a[O++]=0,a[O++]=63,a[O++]=0}return{jpegOffset:n,tables:o,sosMarker:a,sofPosition:C}},t.decode._decodeOldJPEG=function(e,n,i,r,o,a){var s,l,u,h=t.decode._decodeOldJPEGInit(e,n,i,r);if(null!=h.jpegOffset)for(s=i+r-h.jpegOffset,u=new Uint8Array(s),p=0;p<s;p++)u[p]=n[h.jpegOffset+p];else{for(l=h.tables.length,(u=new Uint8Array(l+h.sosMarker.length+r+2)).set(h.tables),l,u[h.sofPosition+5]=e.height>>>8&255,u[h.sofPosition+6]=255&e.height,u[h.sofPosition+7]=e.width>>>8&255,u[h.sofPosition+8]=255&e.width,255==n[i]&&n[i+1]==SOS||(u.set(h.sosMarker,bufoff),bufoff+=sosMarker.length),p=0;p<r;p++)u[bufoff++]=n[i+p];u[bufoff++]=255,u[bufoff++]=EOI}var c=new t.JpegDecoder;c.parse(u);for(var f=c.getData(c.width,c.height),p=0;p<f.length;p++)o[a+p]=f[p];6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodePackBits=function(t,e,n,i,r){for(var o=new Int8Array(t.buffer),a=new Int8Array(i.buffer),s=e+n;e<s;){var l=o[e];if(e++,l>=0&&l<128)for(var u=0;u<l+1;u++)a[r]=o[e],r++,e++;if(l>=-127&&l<0){for(u=0;u<1-l;u++)a[r]=o[e],r++;e++}}},t.decode._decodeThunder=function(t,e,n,i,r){for(var o=[0,1,0,-1],a=[0,1,2,3,0,-3,-2,-1],s=e+n,l=2*r,u=0;e<s;){var h=t[e],c=h>>>6,f=63&h;if(e++,3==c&&(u=15&f,i[l>>>1]|=u<<4*(1-l&1),l++),0==c)for(var p=0;p<f;p++)i[l>>>1]|=u<<4*(1-l&1),l++;if(2==c)for(p=0;p<2;p++){4!=(d=f>>>3*(1-p)&7)&&(u+=a[d],i[l>>>1]|=u<<4*(1-l&1),l++)}if(1==c)for(p=0;p<3;p++){var d;2!=(d=f>>>2*(2-p)&3)&&(u+=o[d],i[l>>>1]|=u<<4*(1-l&1),l++)}}},t.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},t.decode._lens=function(){var t=function(t,e,n,i){for(var r=0;r<e.length;r++)t[e[r]]=n+r*i},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",n="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",i="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",r="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",o="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),n=n.split(","),i=i.split(","),r=r.split(","),o=o.split(",");var a={},s={};return t(a,e,0,1),t(a,i,64,64),t(a,o,1792,64),t(s,n,0,1),t(s,r,64,64),t(s,o,1792,64),[a,s]}(),t.decode._decodeG4=function(e,n,i,r,o,a,s){for(var l=t.decode,u=n<<3,h=0,c="",f=[],p=[],d=0;d<a;d++)p.push(0);p=l._makeDiff(p);for(var g=0,m=0,y=0,v=0,b=0,_=0,w="",M=0,x=8*Math.ceil(a/8);u>>>3<n+i;){y=l._findDiff(p,g+(0==g?0:1),1-b),v=l._findDiff(p,y,b);var A=0;if(1==s&&(A=e[u>>>3]>>>7-(7&u)&1),2==s&&(A=e[u>>>3]>>>(7&u)&1),u++,c+=A,"H"==w){if(null!=l._lens[b][c]){var T=l._lens[b][c];c="",h+=T,T<64&&(l._addNtimes(f,h,b),g+=h,b=1-b,h=0,0==--M&&(w=""))}}else"0001"==c&&(c="",l._addNtimes(f,v-g,b),g=v),"001"==c&&(c="",w="H",M=2),null!=l._dmap[c]&&(m=y+l._dmap[c],l._addNtimes(f,m-g,b),g=m,c="",b=1-b);f.length==a&&""==w&&(l._writeBits(f,r,8*o+_*x),b=0,_++,g=0,p=l._makeDiff(f),f=[])}},t.decode._findDiff=function(t,e,n){for(var i=0;i<t.length;i+=2)if(t[i]>=e&&t[i+1]==n)return t[i]},t.decode._makeDiff=function(t){var e=[];1==t[0]&&e.push(0,1);for(var n=1;n<t.length;n++)t[n-1]!=t[n]&&e.push(n,t[n]);return e.push(t.length,0,t.length,1),e},t.decode._decodeG3=function(e,n,i,r,o,a,s){for(var l=t.decode,u=n<<3,h=0,c="",f=[],p=[],d=0;d<a;d++)f.push(0);for(var g=0,m=0,y=0,v=0,b=0,_=-1,w="",M=0,x=!1,A=8*Math.ceil(a/8);u>>>3<n+i;){y=l._findDiff(p,g+(0==g?0:1),1-b),v=l._findDiff(p,y,b);var T=0;if(1==s&&(T=e[u>>>3]>>>7-(7&u)&1),2==s&&(T=e[u>>>3]>>>(7&u)&1),u++,c+=T,x){if(null!=l._lens[b][c]){var S=l._lens[b][c];c="",h+=S,S<64&&(l._addNtimes(f,h,b),b=1-b,h=0)}}else if("H"==w){if(null!=l._lens[b][c]){S=l._lens[b][c];c="",h+=S,S<64&&(l._addNtimes(f,h,b),g+=h,b=1-b,h=0,0==--M&&(w=""))}}else"0001"==c&&(c="",l._addNtimes(f,v-g,b),g=v),"001"==c&&(c="",w="H",M=2),null!=l._dmap[c]&&(m=y+l._dmap[c],l._addNtimes(f,m-g,b),g=m,c="",b=1-b);c.endsWith("000000000001")&&(_>=0&&l._writeBits(f,r,8*o+_*A),1==s&&(x=1==(e[u>>>3]>>>7-(7&u)&1)),2==s&&(x=1==(e[u>>>3]>>>(7&u)&1)),u++,null==l._decodeG3.allow2D&&(l._decodeG3.allow2D=x),l._decodeG3.allow2D||(x=!0,u--),c="",b=0,_++,g=0,p=l._makeDiff(f),f=[])}f.length==a&&l._writeBits(f,r,8*o+_*A)},t.decode._addNtimes=function(t,e,n){for(var i=0;i<e;i++)t.push(n)},t.decode._writeBits=function(t,e,n){for(var i=0;i<t.length;i++)e[n+i>>>3]|=t[i]<<7-(n+i&7)},t.decode._decodeLZW=function(e,n,i,r){if(null==t.decode._lzwTab){for(var o=new Uint32Array(65535),a=new Uint16Array(65535),s=new Uint8Array(2e6),l=0;l<256;l++)s[l<<2]=l,o[l]=l<<2,a[l]=1;t.decode._lzwTab=[o,a,s]}for(var u=t.decode._copyData,h=t.decode._lzwTab[0],c=t.decode._lzwTab[1],f=(s=t.decode._lzwTab[2],258),p=1032,d=9,g=n<<3,m=0,y=0;m=(e[g>>>3]<<16|e[g+8>>>3]<<8|e[g+16>>>3])>>24-(7&g)-d&(1<<d)-1,g+=d,257!=m;){if(256==m){if(d=9,f=258,p=1032,m=(e[g>>>3]<<16|e[g+8>>>3]<<8|e[g+16>>>3])>>24-(7&g)-d&(1<<d)-1,g+=d,257==m)break;i[r]=m,r++}else if(m<f){var v=h[m],b=c[m];if(u(s,v,i,r,b),r+=b,y>=f)h[f]=p,s[h[f]]=v[0],c[f]=1,p=p+1+3&-4,f++;else h[f]=p,u(s,h[y],s,p,_=c[y]),s[p+_]=s[v],_++,c[f]=_,f++,p=p+_+3&-4;f+1==1<<d&&d++}else{var _;if(y>=f)h[f]=p,c[f]=0,f++;else h[f]=p,u(s,h[y],s,p,_=c[y]),s[p+_]=s[p],_++,c[f]=_,f++,u(s,p,i,r,_),r+=_,p=p+_+3&-4;f+1==1<<d&&d++}y=m}},t.decode._copyData=function(t,e,n,i,r){for(var o=0;o<r;o+=4)n[i+o]=t[e+o],n[i+o+1]=t[e+o+1],n[i+o+2]=t[e+o+2],n[i+o+3]=t[e+o+3]},t.tags={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffset",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",296:"ResolutionUnit",297:"PageNumber",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffset",325:"TileByteCounts",330:"SubIFDs",336:"DotRange",338:"ExtraSample",339:"SampleFormat",347:"JPEGTables",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",700:"XMP",33421:"CFARepeatPatternDim",33422:"CFAPattern",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33723:"IPTC/NAA",34377:"Photoshop",34665:"ExifIFD",34675:"ICC Profile",34850:"ExposureProgram",34853:"GPSInfo",34855:"ISOSpeedRatings",34858:"TimeZoneOffset",34859:"SelfTimeMode",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37377:"ShutterSpeedValue",37378:"ApertureValue",37380:"ExposureBiasValue",37383:"MeteringMode",37385:"Flash",37386:"FocalLength",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37398:"TIFF/EPStandardID",37399:"SensingMethod",37500:"MakerNote",37510:"UserComment",37724:"ImageSourceData",40092:"XPComment",40094:"XPKeywords",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelXDimension",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50733:"BayerGreenSplit",50738:"AntiAliasStrength",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50727:"AnalogBalance",50728:"AsShotNeutral",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50827:"OriginalRawFileName",50829:"ActiveArea",50830:"MaskedAreas",50931:"CameraCalibrationSignature",50932:"ProfileCalibrationSignature",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualityFinalSize",51091:"OriginalDefaultCropSize",51125:"DefaultUserCrop"},t.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},t._readIFD=function(e,n,i,o){var a=e.readUshort(n,i);i+=2;var s={};o.push(s);for(var l=0;l<a;l++){var u=e.readUshort(n,i);i+=2;var h=e.readUshort(n,i);i+=2;var c=e.readUint(n,i);i+=4;var f=e.readUint(n,i);i+=4;var p=[];if(s["t"+u]=p,1==h||7==h)for(var d=0;d<c;d++)p.push(n[(c<5?i-4:f)+d]);if(2==h&&p.push(e.readASCII(n,c<5?i-4:f,c-1)),3==h)for(d=0;d<c;d++)p.push(e.readUshort(n,(c<3?i-4:f)+2*d));if(4==h)for(d=0;d<c;d++)p.push(e.readUint(n,(c<2?i-4:f)+4*d));if(5==h)for(d=0;d<c;d++)p.push(e.readUint(n,f+8*d)/e.readUint(n,f+8*d+4));if(8==h)for(d=0;d<c;d++)p.push(e.readShort(n,(c<3?i-4:f)+2*d));if(9==h)for(d=0;d<c;d++)p.push(e.readInt(n,(c<2?i-4:f)+4*d));if(10==h)for(d=0;d<c;d++)p.push(e.readInt(n,f+8*d)/e.readInt(n,f+8*d+4));if(11==h)for(d=0;d<c;d++)p.push(e.readFloat(n,f+4*d));if(12==h)for(d=0;d<c;d++)p.push(e.readDouble(n,f+8*d));if(0!=c&&0==p.length&&r("unknown TIFF tag type: ",h,"num:",c),330==u)for(d=0;d<c;d++)t._readIFD(e,n,p[d],o)}return i},t._writeIFD=function(e,n,i,r){var o=Object.keys(r);e.writeUshort(n,i,o.length);for(var a=(i+=2)+12*o.length+4,s=0;s<o.length;s++){var l=o[s],u=parseInt(l.slice(1)),h=t.ttypes[u];if(null==h)throw new Error("unknown type of tag: "+u);var c=r[l];2==h&&(c=c[0]+"\0");var f=c.length;e.writeUshort(n,i,u),i+=2,e.writeUshort(n,i,h),i+=2,e.writeUint(n,i,f);var p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][h]*f,d=i+=4;if(p>4&&(e.writeUint(n,i,a),d=a),2==h&&e.writeASCII(n,d,c),3==h)for(var g=0;g<f;g++)e.writeUshort(n,d+2*g,c[g]);if(4==h)for(g=0;g<f;g++)e.writeUint(n,d+4*g,c[g]);if(5==h)for(g=0;g<f;g++)e.writeUint(n,d+8*g,Math.round(1e4*c[g])),e.writeUint(n,d+8*g+4,1e4);if(12==h)for(g=0;g<f;g++)e.writeDouble(n,d+8*g,c[g]);p>4&&(a+=p+=1&p),i+=4}return[i,a]},t.toRGBA8=function(t){var e=t.width,n=t.height,i=e*n,o=4*i,a=t.data,s=new Uint8Array(4*i),l=t.t262[0],u=t.t258?Math.min(32,t.t258[0]):1,h=t.isLE?1:0;if(0==l)for(var c=Math.ceil(u*e/8),f=0;f<n;f++){var p=f*c,d=f*e;if(1==u)for(var g=0;g<e;g++){var m=d+g<<2,y=a[p+(g>>3)]>>7-(7&g)&1;s[m]=s[m+1]=s[m+2]=255*(1-y),s[m+3]=255}if(4==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+(g>>1)]>>4-4*(1&g)&15;s[m]=s[m+1]=s[m+2]=17*(15-y),s[m+3]=255}if(8==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+g];s[m]=s[m+1]=s[m+2]=255-y,s[m+3]=255}}else if(1==l)for(c=Math.ceil(u*e/8),f=0;f<n;f++){p=f*c,d=f*e;if(1==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+(g>>3)]>>7-(7&g)&1;s[m]=s[m+1]=s[m+2]=255*y,s[m+3]=255}if(2==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+(g>>2)]>>6-2*(3&g)&3;s[m]=s[m+1]=s[m+2]=85*y,s[m+3]=255}if(8==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+g];s[m]=s[m+1]=s[m+2]=y,s[m+3]=255}if(16==u)for(g=0;g<e;g++){m=d+g<<2,y=a[p+(2*g+h)];s[m]=s[m+1]=s[m+2]=Math.min(255,y),s[m+3]=255}}else if(2==l)if(8==u)if(t.t338)if(t.t338[0]>0)for(g=0;g<o;g++)s[g]=a[g];else for(g=0;g<o;g+=4)s[g]=a[g],s[g+1]=a[g+1],s[g+2]=a[g+2],s[g+3]=255;else{if(4==(w=t.t258?t.t258.length:3))for(g=0;g<o;g++)s[g]=a[g];if(3==w)for(g=0;g<i;g++){var v=3*g;s[m=g<<2]=a[v],s[m+1]=a[v+1],s[m+2]=a[v+2],s[m+3]=255}}else for(g=0;g<i;g++){v=6*g;s[m=g<<2]=a[v],s[m+1]=a[v+2],s[m+2]=a[v+4],s[m+3]=255}else if(3==l){var b=t.t320;for(g=0;g<i;g++){m=g<<2;var _=a[g];s[m]=b[_]>>8,s[m+1]=b[256+_]>>8,s[m+2]=b[512+_]>>8,s[m+3]=255}}else if(5==l){var w,M=(w=t.t258?t.t258.length:4)>4?1:0;for(g=0;g<i;g++){m=g<<2;var x=g*w,A=255-a[x],T=255-a[x+1],S=255-a[x+2],E=(255-a[x+3])*(1/255);s[m]=~~(A*E+.5),s[m+1]=~~(T*E+.5),s[m+2]=~~(S*E+.5),s[m+3]=255*(1-M)+a[x+4]*M}}else r("Unknown Photometric interpretation: "+l);return s},t.replaceIMG=function(){for(var e=document.getElementsByTagName("img"),n=0;n<e.length;n++){var i=e[n],r=i.getAttribute("src");if(null!=r){var o=r.split(".").pop().toLowerCase();if("tif"==o||"tiff"==o){var a=new XMLHttpRequest;t._xhrs.push(a),t._imgs.push(i),a.open("GET",r),a.responseType="arraybuffer",a.onload=t._imgLoaded,a.send()}}}},t._xhrs=[],t._imgs=[],t._imgLoaded=function(e){var n=e.target.response,i=t.decode(n),r=i[0];t.decodeImages(n,i);var o=t.toRGBA8(r),a=r.width,s=r.height,l=t._xhrs.indexOf(e.target),u=t._imgs[l];t._xhrs.splice(l,1),t._imgs.splice(l,1);var h=document.createElement("canvas");h.width=a,h.height=s;for(var c=h.getContext("2d"),f=c.createImageData(a,s),p=0;p<o.length;p++)f.data[p]=o[p];c.putImageData(f,0,0);var d=["style","class","id"];for(p=0;p<d.length;p++)h.setAttribute(d[p],u.getAttribute(d[p]));u.parentNode.replaceChild(h,u)},t._binBE={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},readShort:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+1],i[1]=e[n+0],t._binBE.i16[0]},readInt:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+3],i[1]=e[n+2],i[2]=e[n+1],i[3]=e[n+0],t._binBE.i32[0]},readUint:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+3],i[1]=e[n+2],i[2]=e[n+1],i[3]=e[n+0],t._binBE.ui32[0]},readASCII:function(t,e,n){for(var i="",r=0;r<n;r++)i+=String.fromCharCode(t[e+r]);return i},readFloat:function(e,n){for(var i=t._binBE.ui8,r=0;r<4;r++)i[r]=e[n+3-r];return t._binBE.fl32[0]},readDouble:function(e,n){for(var i=t._binBE.ui8,r=0;r<8;r++)i[r]=e[n+7-r];return t._binBE.fl64[0]},writeUshort:function(t,e,n){t[e]=n>>8&255,t[e+1]=255&n},writeUint:function(t,e,n){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=n>>0&255},writeASCII:function(t,e,n){for(var i=0;i<n.length;i++)t[e+i]=n.charCodeAt(i)},writeDouble:function(e,n,i){t._binBE.fl64[0]=i;for(var r=0;r<8;r++)e[n+r]=t._binBE.ui8[7-r]}},t._binBE.ui8=new Uint8Array(8),t._binBE.i16=new Int16Array(t._binBE.ui8.buffer),t._binBE.i32=new Int32Array(t._binBE.ui8.buffer),t._binBE.ui32=new Uint32Array(t._binBE.ui8.buffer),t._binBE.fl32=new Float32Array(t._binBE.ui8.buffer),t._binBE.fl64=new Float64Array(t._binBE.ui8.buffer),t._binLE={nextZero:t._binBE.nextZero,readUshort:function(t,e){return t[e+1]<<8|t[e]},readShort:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+0],i[1]=e[n+1],t._binBE.i16[0]},readInt:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+0],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t._binBE.i32[0]},readUint:function(e,n){var i=t._binBE.ui8;return i[0]=e[n+0],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t._binBE.ui32[0]},readASCII:t._binBE.readASCII,readFloat:function(e,n){for(var i=t._binBE.ui8,r=0;r<4;r++)i[r]=e[n+r];return t._binBE.fl32[0]},readDouble:function(e,n){for(var i=t._binBE.ui8,r=0;r<8;r++)i[r]=e[n+r];return t._binBE.fl64[0]}},t._copyTile=function(t,e,n,i,r,o,a,s){for(var l=Math.min(e,r-a),u=Math.min(n,o-s),h=0;h<u;h++)for(var c=(s+h)*r+a,f=h*e,p=0;p<l;p++)i[c+p]=t[f+p]}}(i,n(209))}()}).call(this,n(16))},function(t,e,n){"use strict";var i={};(0,n(24).assign)(i,n(210),n(211),n(73)),t.exports=i},function(t,e,n){"use strict";var i=n(101),r=n(24),o=n(115),a=n(72),s=n(71),l=Object.prototype.toString,u=0,h=-1,c=0,f=8;function p(t){if(!(this instanceof p))return new p(t);this.options=r.assign({level:h,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==u)throw new Error(a[n]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var d;if(d="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(n=i.deflateSetDictionary(this.strm,d))!==u)throw new Error(a[n]);this._dict_set=!0}}function d(t,e){var n=new p(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}p.prototype.push=function(t,e){var n,a,s=this.strm,h=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(h),s.next_out=0,s.avail_out=h),1!==(n=i.deflate(s,a))&&n!==u)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==a||(this.onEnd(u),s.avail_out=0,!0)},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=p,e.deflate=d,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,d(t,e)}},function(t,e,n){"use strict";var i=n(104),r=n(24),o=n(115),a=n(73),s=n(72),l=n(71),u=n(212),h=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,e.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new u,i.inflateGetHeader(this.strm,this.header)}function f(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}c.prototype.push=function(t,e){var n,s,l,u,c,f,p=this.strm,d=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?p.input=o.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new r.Buf8(d),p.next_out=0,p.avail_out=d),(n=i.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(f="string"==typeof g?o.string2buf(g):"[object ArrayBuffer]"===h.call(g)?new Uint8Array(g):g,n=i.inflateSetDictionary(this.strm,f)),n===a.Z_BUF_ERROR&&!0===m&&(n=a.Z_OK,m=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&n!==a.Z_STREAM_END&&(0!==p.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),u=p.next_out-l,c=o.buf2string(p.output,l),p.next_out=u,p.avail_out=d-u,u&&r.arraySet(p.output,p.output,l,u,0),this.onData(c)):this.onData(r.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(m=!0)}while((p.avail_in>0||0===p.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),p.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=f,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},e.ungzip=f},function(t,e,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(t,e,n){"use strict";t.exports=function(t,e){}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return Object.defineProperty(t,"isWorker",{get:function(){try{return!window.document}catch(t){return!0}},enumerable:!0,configurable:!0}),t}();e.Thread=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.maxTask=3,this.numberOfRunningTask=0,this.worker=t}return t.prototype.finishedTask=function(){this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t.prototype.canExecuteTask=function(){return this.numberOfRunningTask<this.maxTask},t.prototype.executeTask=function(t){if(this.canExecuteTask()){var e={execute:!0,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask+=1}},t.prototype.cancel=function(t){var e={execute:!1,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t}();e.TaskWorker=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(){this.numberOfVertices=0}}();e.ModelGeometry=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(218),r=n(5),o=n(219),a=function(){function t(t,e){this.mapState=e,this.gl=t,this.layerRenderers=i(r.compareLayerId)}return t.prototype.render=function(){this.mapState.is3dMode()&&this.effectManager.enableShadowEffect&&this.layerRenderers.forEach(function(t,e){e.renderShadowMapping()}),this.layerRenderers.forEach(function(t,e){e.render()})},t.prototype.renderSelection=function(){this.layerRenderers.forEach(function(t,e){e.renderSelection()})},t.prototype.addLayer=function(t){this.layerRenderers=this.layerRenderers.insert(new r.LayerId(t.getLayerId(),t.getOrder()),o.LayerRenderFactory.create(this.gl,this.mapState,t))},t.prototype.setEffectManager=function(t){this.effectManager=t},t.prototype.removeLayer=function(t,e){var n=new r.LayerId(t,e);this.layerRenderers=this.layerRenderers.remove(n)},t}();e.MapRenderer=a},function(t,e,n){"use strict";t.exports=function(t){return new u(t||d,null)};var i=0,r=1;function o(t,e,n,i,r,o){this._color=t,this.key=e,this.value=n,this.left=i,this.right=r,this._count=o}function a(t){return new o(t._color,t.key,t.value,t.left,t.right,t._count)}function s(t,e){return new o(t,e.key,e.value,e.left,e.right,e._count)}function l(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function u(t,e){this._compare=t,this.root=e}var h=u.prototype;function c(t,e){this.tree=t,this._stack=e}Object.defineProperty(h,"keys",{get:function(){var t=[];return this.forEach(function(e,n){t.push(e)}),t}}),Object.defineProperty(h,"values",{get:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t}}),Object.defineProperty(h,"length",{get:function(){return this.root?this.root._count:0}}),h.insert=function(t,e){for(var n=this._compare,a=this.root,h=[],c=[];a;){var f=n(t,a.key);h.push(a),c.push(f),a=f<=0?a.left:a.right}h.push(new o(i,t,e,null,null,1));for(var p=h.length-2;p>=0;--p){a=h[p];c[p]<=0?h[p]=new o(a._color,a.key,a.value,h[p+1],a.right,a._count+1):h[p]=new o(a._color,a.key,a.value,a.left,h[p+1],a._count+1)}for(p=h.length-1;p>1;--p){var d=h[p-1];a=h[p];if(d._color===r||a._color===r)break;var g=h[p-2];if(g.left===d)if(d.left===a){if(!(m=g.right)||m._color!==i){if(g._color=i,g.left=d.right,d._color=r,d.right=g,h[p-2]=d,h[p-1]=a,l(g),l(d),p>=3)(y=h[p-3]).left===g?y.left=d:y.right=d;break}d._color=r,g.right=s(r,m),g._color=i,p-=1}else{if(!(m=g.right)||m._color!==i){if(d.right=a.left,g._color=i,g.left=a.right,a._color=r,a.left=d,a.right=g,h[p-2]=a,h[p-1]=d,l(g),l(d),l(a),p>=3)(y=h[p-3]).left===g?y.left=a:y.right=a;break}d._color=r,g.right=s(r,m),g._color=i,p-=1}else if(d.right===a){if(!(m=g.left)||m._color!==i){if(g._color=i,g.right=d.left,d._color=r,d.left=g,h[p-2]=d,h[p-1]=a,l(g),l(d),p>=3)(y=h[p-3]).right===g?y.right=d:y.left=d;break}d._color=r,g.left=s(r,m),g._color=i,p-=1}else{var m;if(!(m=g.left)||m._color!==i){var y;if(d.left=a.right,g._color=i,g.right=a.left,a._color=r,a.right=d,a.left=g,h[p-2]=a,h[p-1]=d,l(g),l(d),l(a),p>=3)(y=h[p-3]).right===g?y.right=a:y.left=a;break}d._color=r,g.left=s(r,m),g._color=i,p-=1}}return h[0]._color=r,new u(n,h[0])},h.forEach=function(t,e,n){if(this.root)switch(arguments.length){case 1:return function t(e,n){var i;if(n.left&&(i=t(e,n.left)))return i;return(i=e(n.key,n.value))||(n.right?t(e,n.right):void 0)}(t,this.root);case 2:return function t(e,n,i,r){if(n(e,r.key)<=0){var o;if(r.left&&(o=t(e,n,i,r.left)))return o;if(o=i(r.key,r.value))return o}if(r.right)return t(e,n,i,r.right)}(e,this._compare,t,this.root);case 3:if(this._compare(e,n)>=0)return;return function t(e,n,i,r,o){var a,s=i(e,o.key),l=i(n,o.key);if(s<=0){if(o.left&&(a=t(e,n,i,r,o.left)))return a;if(l>0&&(a=r(o.key,o.value)))return a}if(l>0&&o.right)return t(e,n,i,r,o.right)}(e,n,this._compare,t,this.root)}},Object.defineProperty(h,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new c(this,t)}}),Object.defineProperty(h,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new c(this,t)}}),h.at=function(t){if(t<0)return new c(this,[]);for(var e=this.root,n=[];;){if(n.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new c(this,n);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new c(this,[])},h.ge=function(t){for(var e=this._compare,n=this.root,i=[],r=0;n;){var o=e(t,n.key);i.push(n),o<=0&&(r=i.length),n=o<=0?n.left:n.right}return i.length=r,new c(this,i)},h.gt=function(t){for(var e=this._compare,n=this.root,i=[],r=0;n;){var o=e(t,n.key);i.push(n),o<0&&(r=i.length),n=o<0?n.left:n.right}return i.length=r,new c(this,i)},h.lt=function(t){for(var e=this._compare,n=this.root,i=[],r=0;n;){var o=e(t,n.key);i.push(n),o>0&&(r=i.length),n=o<=0?n.left:n.right}return i.length=r,new c(this,i)},h.le=function(t){for(var e=this._compare,n=this.root,i=[],r=0;n;){var o=e(t,n.key);i.push(n),o>=0&&(r=i.length),n=o<0?n.left:n.right}return i.length=r,new c(this,i)},h.find=function(t){for(var e=this._compare,n=this.root,i=[];n;){var r=e(t,n.key);if(i.push(n),0===r)return new c(this,i);n=r<=0?n.left:n.right}return new c(this,[])},h.remove=function(t){var e=this.find(t);return e?e.remove():this},h.get=function(t){for(var e=this._compare,n=this.root;n;){var i=e(t,n.key);if(0===i)return n.value;n=i<=0?n.left:n.right}};var f=c.prototype;function p(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function d(t,e){return t<e?-1:t>e?1:0}Object.defineProperty(f,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(f,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),f.clone=function(){return new c(this.tree,this._stack.slice())},f.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),n=t[t.length-1];e[e.length-1]=new o(n._color,n.key,n.value,n.left,n.right,n._count);for(var h=t.length-2;h>=0;--h){(n=t[h]).left===t[h+1]?e[h]=new o(n._color,n.key,n.value,e[h+1],n.right,n._count):e[h]=new o(n._color,n.key,n.value,n.left,e[h+1],n._count)}if((n=e[e.length-1]).left&&n.right){var c=e.length;for(n=n.left;n.right;)e.push(n),n=n.right;var f=e[c-1];e.push(new o(n._color,f.key,f.value,n.left,n.right,n._count)),e[c-1].key=n.key,e[c-1].value=n.value;for(h=e.length-2;h>=c;--h)n=e[h],e[h]=new o(n._color,n.key,n.value,n.left,e[h+1],n._count);e[c-1].left=e[c]}if((n=e[e.length-1])._color===i){var d=e[e.length-2];d.left===n?d.left=null:d.right===n&&(d.right=null),e.pop();for(h=0;h<e.length;++h)e[h]._count--;return new u(this.tree._compare,e[0])}if(n.left||n.right){n.left?p(n,n.left):n.right&&p(n,n.right),n._color=r;for(h=0;h<e.length-1;++h)e[h]._count--;return new u(this.tree._compare,e[0])}if(1===e.length)return new u(this.tree._compare,null);for(h=0;h<e.length;++h)e[h]._count--;var g=e[e.length-2];return function(t){for(var e,n,o,u,h=t.length-1;h>=0;--h){if(e=t[h],0===h)return void(e._color=r);if((n=t[h-1]).left===e){if((o=n.right).right&&o.right._color===i)return u=(o=n.right=a(o)).right=a(o.right),n.right=o.left,o.left=n,o.right=u,o._color=n._color,e._color=r,n._color=r,u._color=r,l(n),l(o),h>1&&((c=t[h-2]).left===n?c.left=o:c.right=o),void(t[h-1]=o);if(o.left&&o.left._color===i)return u=(o=n.right=a(o)).left=a(o.left),n.right=u.left,o.left=u.right,u.left=n,u.right=o,u._color=n._color,n._color=r,o._color=r,e._color=r,l(n),l(o),l(u),h>1&&((c=t[h-2]).left===n?c.left=u:c.right=u),void(t[h-1]=u);if(o._color===r){if(n._color===i)return n._color=r,void(n.right=s(i,o));n.right=s(i,o);continue}o=a(o),n.right=o.left,o.left=n,o._color=n._color,n._color=i,l(n),l(o),h>1&&((c=t[h-2]).left===n?c.left=o:c.right=o),t[h-1]=o,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}else{if((o=n.left).left&&o.left._color===i)return u=(o=n.left=a(o)).left=a(o.left),n.left=o.right,o.right=n,o.left=u,o._color=n._color,e._color=r,n._color=r,u._color=r,l(n),l(o),h>1&&((c=t[h-2]).right===n?c.right=o:c.left=o),void(t[h-1]=o);if(o.right&&o.right._color===i)return u=(o=n.left=a(o)).right=a(o.right),n.left=u.right,o.right=u.left,u.right=n,u.left=o,u._color=n._color,n._color=r,o._color=r,e._color=r,l(n),l(o),l(u),h>1&&((c=t[h-2]).right===n?c.right=u:c.left=u),void(t[h-1]=u);if(o._color===r){if(n._color===i)return n._color=r,void(n.left=s(i,o));n.left=s(i,o);continue}var c;o=a(o),n.left=o.right,o.right=n,o._color=n._color,n._color=i,l(n),l(o),h>1&&((c=t[h-2]).right===n?c.right=o:c.left=o),t[h-1]=o,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}}}(e),g.left===n?g.left=null:g.right=null,new u(this.tree._compare,e[0])},Object.defineProperty(f,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(f,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(f,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var n=this.tree.root;return n?n._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var i=e.length-2;i>=0;--i)e[i+1]===e[i].right&&(++t,e[i].left&&(t+=e[i].left._count));return t},enumerable:!0}),f.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(f,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),f.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var n=new Array(e.length),i=e[e.length-1];n[n.length-1]=new o(i._color,i.key,t,i.left,i.right,i._count);for(var r=e.length-2;r>=0;--r)(i=e[r]).left===e[r+1]?n[r]=new o(i._color,i.key,i.value,n[r+1],i.right,i._count):n[r]=new o(i._color,i.key,i.value,i.left,n[r+1],i._count);return new u(this.tree._compare,n[0])},f.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(f,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),r=n(220),o=n(222),a=n(223),s=n(224),l=n(225),u=n(226),h=n(228),c=function(){function t(){}return t.create=function(t,e,n){switch(n.getLayerType()){case i.LayerType.RASTER:return new r.RasterLayerRenderer(e,n);case i.LayerType.BUILDING:return new l.BuildingLayerRenderer(t,e,n);case i.LayerType.LINE:return new o.LineLayerRenderer(e,n);case i.LayerType.FILL:return new a.FillLayerRenderer(e,n);case i.LayerType.CIRCLE:return new s.CircleLayerRenderer(e,n);case i.LayerType.SYMBOL:return new u.SymbolLayerRenderer(e,n);case i.LayerType.GEOJSON:return new h.GeoJsonLayerRenderer(e,n);default:console.log("Invalid layer type")}},t}();e.LayerRenderFactory=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(13),o=n(10),a=n(30),s=n(0),l=n(11),u=n(8),h=n(6),c=n(2),f=n(18),p=n(9),d=n(48),g=n(17),m=n(60),y=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.time=0,i}return i(e,t),e.prototype.render=function(){var t=this,e=this.layer.tileManager.mapView.gl,n=r.ResourceManager.getInstance(e),i=this.mapState.is3dMode()&&this.mapState.getTilt()>s.MapConstants.maxTiltIntersectWithScreen,a=n.getModel(r.ModelEnum.RASTER_MODEL),y=null,v=this.layer,b=v.effectManager,_=this.mapState.is3dMode()&&b.enableShadowEffect;if(a.bind(),i){(y=_?n.getShader(r.ShaderEnum.RASTER_3D_WITH_SHADOW_SHADER):n.getShader(r.ShaderEnum.RASTER_FOG_SHADER)).bind(),y.setAttributes(a.attributeInfos);var w=s.MapConstants.defaultMaxNativeZoom,M=v.timeEffectManager.getFogColor(),x=6*Math.max(this.mapState.getZoom()-w,0),A=v.lightManager.sunLight;y.setUniforms([new o.UniformInfo("u_light_color","3fv",A.lightColor.rgbBuffer()),new o.UniformInfo("u_light_position","3f",A.lightPosition),new o.UniformInfo("u_fogStart","1f",22+x),new o.UniformInfo("u_fogRange","1f",10+x),new o.UniformInfo("u_fogColor","3fv",M.rgbBuffer())])}else(y=_?n.getShader(r.ShaderEnum.RASTER_WITH_SHADOW_SHADER):n.getShader(r.ShaderEnum.RASTER_SHADER)).bind(),y.setAttributes(a.attributeInfos);if(this.mapState.is3dMode()&&this.mapState.getTilt()>s.MapConstants.maxTiltIntersectWithScreen){var T=p.Color.fromHex(s.MapConstants.mapBackgroundColor3D),S=n.getTexture(r.TextureEnum.WHITE_TEXTURE);S.loadColor(T);var E=new g.CameraPosition(this.mapState.cameraPosition.target,this.mapState.cameraPosition.tilt,0,this.mapState.cameraPosition.zoom),C=this.mapState.getScreenSize(),L=m.CameraUtils.calculateViewProjectionMatrix(E,C.x,C.y),P=h.ProjectionMercator.projectScale(this.mapState.getTarget(),this.mapState.scale),I=u.GeometryUtils.pixelCoordinateToCameraCoordinate(new c.Vector2(P.x,P.y),this.mapState.cameraPosition),O=l.Matrix4.translate(I.x,I.y,0),R=l.Matrix4.scale(s.MapConstants.mapBackgroundScaleRatio,s.MapConstants.mapBackgroundScaleRatio,1),k=(O=O.concat(R)).concat(L);y.setUniforms([new o.UniformInfo("u_texture","texture",S),new o.UniformInfo("u_mvpMatrix","matrix",k)]),a.render(e.TRIANGLES),y.resetTextureUnit()}var D=n.getTexture(r.TextureEnum.WATER_DISPLACEMENT),B=n.getTexture(r.TextureEnum.WATER_COLOR),U=v.effectManager.enableWaterEffect&&this.mapState.is3dMode()?1:0,j=v.lightManager.sunLight;this.time+=8e-4,y.setUniforms([new o.UniformInfo("u_light_color","3fv",j.lightColor.rgbBuffer()),new o.UniformInfo("u_light_position","3f",j.lightPosition),new o.UniformInfo("u_time","1f",this.time),new o.UniformInfo("u_enableWater","1i",U)]);var F=this.getRenderTiles();F.forEach(function(n){var i=n.getTile();if(i.getKind()==f.Kind.RASTER){var r=i.getTexture();if(null!=r){var l=t.mapState.getViewProjectionMatrix(),u=t.mapState.matrixFor(n.getUnwrappedTileCoordinate()),h=u.concat(l);if(_){var c=b.shadowMap,p=u.concat(c.getLightViewProjectionMatrix()).concat(s.MapConstants.biasMatrix);y.setUniforms([new o.UniformInfo("u_shadowMap","texture",c.getShadowMapTexture()),new o.UniformInfo("u_shadowMvpMatrix","matrix",p)])}y.setUniforms([new o.UniformInfo("u_waterDisplacement","texture",D),new o.UniformInfo("u_waterColor","texture",B),new o.UniformInfo("u_texture","texture",r),new o.UniformInfo("u_mvpMatrix","matrix",h)]),a.render(e.TRIANGLES),y.resetTextureUnit()}}else console.log("Tile is not raster tile")}),d.Env.isTileDebug&&((y=n.getShader(r.ShaderEnum.TILE_DEBUG_SHADER)).bind(),y.setAttributes(a.attributeInfos),F.forEach(function(n){if(n.getTile().getKind()==f.Kind.RASTER){var i=t.mapState.getViewProjectionMatrix(),r=t.mapState.matrixFor(n.getUnwrappedTileCoordinate()).concat(i);y.setUniforms([new o.UniformInfo("u_mvpMatrix","matrix",r)]),a.render(e.LINE_STRIP)}else console.log("Tile is not raster tile")})),a.unbind(),y.disableAttributes(),this.mapState.is3dMode()&&this.mapState.getTilt()>s.MapConstants.maxTiltIntersectWithScreen&&v.skyRenderer.render(v.skyObject,this.mapState)},e}(a.LayerRenderer);e.RasterLayerRenderer=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.lightEffect="\n    vec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color) {\n        vec4 ambient_color = vec4(0.03, 0.03, 0.03, 0);\n        material_color += ambient_color;\n        \n        float light_intensity = 1.0;\n        vec3 diffuse = vec3(1.0, 1.0, 1.0);\n        float diffuseCoefficient1 = max(0.0, dot(normal, light));\n        diffuseCoefficient1 = diffuseCoefficient1 * light_intensity;\n        diffuseCoefficient1 = clamp(diffuseCoefficient1, 0.0, 1.0);\n\n        float diffuseCoefficient2 = max(0.0, dot(normal, camera));\n        diffuseCoefficient2 = clamp(diffuseCoefficient2, 0.0, 1.0);\n        \n        vec4 finalColor = vec4(mix(material_color.rgb, diffuseCoefficient1 * light_color, diffuseCoefficient1 * 0.35), material_color.a);\n        finalColor = vec4(mix(finalColor.rgb, diffuseCoefficient2 * material_color.rgb, diffuseCoefficient2 * 0.35), finalColor.a);   \n        \n        return finalColor;\n    }\n  ",t.waterFragment="\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time) {\n      float eps = 0.01;\n      if (abs(tileColor.x - 0.639) < eps && abs(tileColor.y - 0.8) < eps && abs(tileColor.z - 1.0) < eps) {\n        vec2 displacement = texture2D( waterDispl, 4.0 * vec2(uv.x, uv.y + time )).rg;\n        vec2 offset = (displacement * 2.0 - 1.0) * 0.2;\n        vec4 color = texture2D(waterColor, uv * 2.0 + offset);\n        return color;\n      } else {\n        return tileColor;\n      } \n    }\n  ",t.basicVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n   ",t.basicFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;   \n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    vec4 tileColor = texture2D(u_texture, v_uv);     \n  \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    gl_FragColor = vertexColor;\n}  \n  "+t.waterFragment,t.rasterFogVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n   ",t.rasterFogFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\n\nvarying vec2 v_uv;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;   \nuniform int u_enableWater;\n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    float light_intensity = 1.0;\n    \n    // initialize\n    vec3 diffuse = vec3(1.0, 1.0, 1.0);\n    vec3 v_normal = vec3(0.0, 0.0, 1.0);\n    vec4 tileColor = texture2D(u_texture, v_uv); \n    \n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normalize(v_normal), normalize(u_light_position)));\n    diffuseCoefficient = mix((1.0 - light_intensity), max((0.5 + light_intensity), 1.0), diffuseCoefficient);\n    diffuse = clamp(diffuseCoefficient * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n    vec4 vertexLightColor = vec4(mix(tileColor.rgb, diffuseCoefficient * diffuse, 0.3), tileColor.a);\n    \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    vertexColor = vec4(mix(vertexColor.rgb, vertexLightColor.rgb, 0.2), vertexColor.a);\n    \n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = vec4(mix(vertexColor.rgb, u_fogColor, visibility), vertexColor.a);\n} \n  "+t.waterFragment,t.polylineVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\nattribute vec2 a_uv;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  vec2 delta = (u_lineWidth / 2.0) * a_extrude;\n  v_uv = a_uv;\n  gl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0);\n}\n  ",t.polylineFS="\nprecision mediump float;\n\nuniform vec4 u_color;\nuniform float u_textureScale;\nuniform bool u_isDotted;\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  if (u_isDotted) {\n    vec2 line_st = vec2(v_uv.x * u_textureScale, v_uv.y);\n    vec4 line_color = texture2D(u_texture, line_st);\n    if (line_color.r > 0.9) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n}\n  ",t.fillVS="\nattribute vec2 a_position;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n}\n  ",t.fillFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.geoJsonVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  vec2 delta = (u_lineWidth / 2.0) * a_extrude;\n  gl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0); \n}\n  ",t.geoJsonFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.circleVS="\n  precision highp float;\nattribute vec2 a_extrude;\n\nuniform float u_radius;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_extrude;\n\nvoid main() {\n    vec2 circleExtrude = u_radius * a_extrude;\n    gl_Position = u_mvpMatrix * vec4(circleExtrude, 0, 1);\n    v_extrude = circleExtrude;        \n}\n  ",t.circleFS="\nprecision highp float;\n\nuniform vec4 u_color;\nuniform mat4 u_mvpMatrix;\nuniform float u_strokeWidth;\nuniform vec4 u_strokeColor;\nuniform float u_outerRadius;\nuniform float u_innerRadius;\n\nvarying vec2 v_extrude;\n\nvoid main() {      \n \n    float dist = length(v_extrude);\n    if (dist - u_outerRadius >= 0.0) {\n      discard;\n    }            \n    if (dist - u_innerRadius >= 0.0){\n      gl_FragColor = u_strokeColor;\n    }\n    else {\n      gl_FragColor = u_color;\n    }\n}\n  ",t.markerVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n  ",t.markerFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n  ",t.buildingVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nattribute vec3 a_normal;\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec3 v_position;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n    v_uv = a_uv;\n    // Convert normal vector to world space (make sure that we don't translate it)\n    v_normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n    v_position = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n}\n  ",t.buildingFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\nuniform vec3 u_camera_direction;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec3 v_position;\n\nvec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color);\n\nvoid main() {\n    vec4 material_color = texture2D(u_texture, v_uv);\n    vec4 vertexColor = calculateLightEffect(normalize(v_normal), normalize(u_light_position), normalize(u_camera_direction), u_light_color, material_color);\n    \n    float distance = distance(v_position, vec3(0));\n    // fog\n    float visibility = (distance - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = vec4(mix(vertexColor.rgb, u_fogColor, visibility), vertexColor.a);\n    \n    if (gl_FragColor.a < 0.3 || visibility >= 0.5) {\n      discard;\n    }\n}\n  "+t.lightEffect,t.buildingSelectionVS="\nattribute vec3 a_position;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n  ",t.buildingSelectionFS="\nprecision mediump float;\nuniform vec3 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(u_color, 1.0);\n}\n  ",t.debugSelectionVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    \n    varying vec2 v_uv;\n    \n    void main() {\n      gl_Position = vec4(a_position, 1.0);\n      v_uv = a_uv;\n    }\n  ",t.debugSelectionFS="\n    precision mediump float;\n    \n    uniform sampler2D u_texture;\n    varying vec2 v_uv;\n    \n    void main() {\n        gl_FragColor = texture2D(u_texture, vec2(v_uv.x , 1.0 - v_uv.y));\n    }\n\n  ",t.skyVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_viewMatrix;\n\nvarying vec3 v_position;\n\nvoid main() { \n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  gl_Position.z = gl_Position.w - 0.000001;  \n  v_position = gl_Position.xyz;\n}\n  ",t.skyFS="\nprecision mediump float;\nuniform float u_lowerLimit;\nuniform float u_upperLimit;\n\nuniform vec3 u_skyColor;\nuniform vec3 u_fogColor;\n\nvarying vec3 v_position;\n\nvoid main() {\n  float factor = (v_position.y - u_lowerLimit) / (u_upperLimit - u_lowerLimit);       \n  factor = clamp(factor, 0.05, 1.0);  \n  if (v_position.y > u_lowerLimit) {\n    gl_FragColor = vec4(mix(u_fogColor.rgb, u_skyColor.rgb, factor), 1.0);\n  } else {\n    discard;\n  }      \n}\n  ",t.shadowMappingVS="\n    attribute vec3 a_position;\n\n    uniform mat4 u_shadowMvpMatrix;\n    \n    varying vec4 v_position;\n\n    void main() {\n      gl_Position = u_shadowMvpMatrix * vec4(a_position, 1.0);\n      v_position = gl_Position;\n    }\n   ",t.shadowMappingFS="\n    precision mediump float;\n    \n    varying vec4 v_position;\n    \n    vec4 pack(float depth) {\n        depth *= (256.0 * 256.0 * 256.0 - 1.0) / (256.0 * 256.0 * 256.0);\n        vec4 encode = fract(depth * vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0) );\n        return vec4(encode.xyz - encode.yzw / 256.0, encode.w ) + 1.0 / 512.0;\n    }\n\n    void main() {\n      float depth = v_position.z / v_position.w;\n      depth = (depth + 1.0) / 2.0;\n      gl_FragColor = pack(depth);\n    }  \n  ",t.shadowFS="\n  \n    float unpack(vec4 pack) {\n      float depth = dot(pack, 1.0 / vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0));\n      return depth * (256.0 * 256.0 * 256.0) / (256.0 * 256.0 * 256.0 - 1.0);\n    }\n  \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias) {\n      float shadowFactor = 1.0;\n      vec4 shadowMapPosition = shadowCoord / shadowCoord.w;\n      bool inShadowArea = (shadowMapPosition.x >= 0.0 && shadowMapPosition.x <= 1.0) && \n      (shadowMapPosition.y >= 0.0 && shadowMapPosition.y <= 1.0) && \n      (shadowMapPosition.z >= 0.0 && shadowMapPosition.z <= 1.0);\n      if (inShadowArea) {\n        float distanceFromLight = unpack(texture2D(shadowMap, shadowMapPosition.xy));\t\n        if (distanceFromLight  + bias < shadowMapPosition.z  ) {\n          shadowFactor = 0.7;   \n        }\n      }\n      return shadowFactor;\n    }\n    \n  ",t.raster3DWithShadowVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_shadowMvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\nvarying vec3 v_position;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n  // Calculate shadow coordinate\n  v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n}\n   ",t.raster3DWithShadowFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\n// The shadow map\nuniform sampler2D u_shadowMap;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;\n    \nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\nvarying vec3 v_position;\n    \nfloat calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    float light_intensity = 1.0;\n\n    // initialize\n    vec3 diffuse = vec3(1.0, 1.0, 1.0);\n    vec3 v_normal = vec3(0.0, 0.0, 1.0);\n    vec4 tileColor = texture2D(u_texture, v_uv);\n    \n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normalize(v_normal), normalize(u_light_position)));\n    diffuseCoefficient = mix((1.0 - light_intensity), max((0.5 + light_intensity), 1.0), diffuseCoefficient);\n    diffuse = clamp(diffuseCoefficient * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n    vec4 vertexLightColor = vec4(mix(tileColor.rgb, diffuseCoefficient * diffuse, 0.3), tileColor.a);\n    \n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    vertexColor = vec4(mix(vertexColor.rgb, vertexLightColor.rgb, 0.2), vertexColor.a);\n    \n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n    vec3 vertexWithFogColor = mix(vertexColor.rgb, u_fogColor.rgb, visibility);\n    gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), vertexWithFogColor, shadowFactor), vertexColor.a);\n} \n  "+t.waterFragment,t.rasterWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n\n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n\n    void main() {\n      gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n      v_uv = a_uv;\n      // Calculate shadow coordinate\n      v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n    }\n   ",t.rasterWithShadowFS="\n    precision mediump float;\n    \n    // The texture\n    uniform sampler2D u_texture;\n    // The shadow map\n    uniform sampler2D u_shadowMap;\n    \n    uniform sampler2D u_waterDisplacement;\n    uniform sampler2D u_waterColor;\n    uniform float u_time;\n    uniform int u_enableWater;\n \n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n    \n    void main() {\n      vec4 tileColor = texture2D(u_texture, v_uv);\n      vec4 rasterColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n      float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n      gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), rasterColor.rgb, shadowFactor), rasterColor.a);      \n    }\n  "+t.waterFragment,t.buildingWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    attribute vec3 a_normal;\n\n    uniform mat4 u_modelMatrix;\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n\n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_position;\n    \n    void main() { \n      gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n      v_uv = a_uv;\n      // Convert normal vector to world space (make sure that we don't translate it)\n      vec3 normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n      v_position = (u_modelMatrix * vec4(a_position, 1.0)).xyz;\n      v_normal = normal;\n      \n      // Calculate shadow coordinate\n      v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0); \n    }\n  ",t.buildingWithShadowFS="\n    precision mediump float;\n\n    uniform sampler2D u_texture;\n    uniform sampler2D u_shadowMap;   \n    uniform float u_fogStart;\n    uniform float u_fogRange;\n    uniform vec3 u_fogColor;\n    uniform vec3 u_light_color;\n    uniform vec3 u_light_position;\n    uniform vec3 u_camera_direction;\n    \n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_position;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n\n    float calculateBias() {\n      float bias;\n      vec3 n = normalize(v_normal); \n      vec3 l = normalize(u_light_position);\n      float cosTheta = clamp( dot( n,l ), 0.0, 1.0 );\n      bias = 0.0001 * tan(acos(cosTheta));\n      bias = clamp(bias, 0.0, 0.01);\n      return bias;\n    }\n    \n    vec4 calculateLightEffect(vec3 normal, vec3 light, vec3 camera, vec3 light_color, vec4 material_color);\n    \n    void main() {\n      vec4 material_color = texture2D(u_texture, v_uv);\n      float bias = calculateBias();\n      float shadowFactor = 1.0;\n      if (bias >= 0.01) {\n        shadowFactor = 0.7;\n      }\n      else {\n        shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, bias);\n      }\n      \n      vec4 vertexColor = calculateLightEffect(normalize(v_normal), normalize(u_light_position), normalize(u_camera_direction), u_light_color, material_color);\n      \n      // fog\n      float distance = distance(v_position, vec3(0));\n      float visibility = (distance - u_fogStart) / u_fogRange;\n      visibility = clamp(visibility, 0.0, 1.0);\n      vec3 vertexWithFogColor = mix(vertexColor.rgb, u_fogColor.rgb, visibility);\n      \n      gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), vertexWithFogColor, shadowFactor), material_color.a);\n      \n      if (gl_FragColor.a < 0.3 || visibility >= 0.5) {\n        discard;\n      }\n    }\n  "+t.lightEffect,t.buildingOutliningFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n  ",t.textLabelVS="\nattribute vec2 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\nuniform vec2 u_texsize;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n  v_uv = a_uv / u_texsize;\t\n}\n   ",t.textLabelFS="\n#define SDF_PX 8.0\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform float u_pixel_scale;\nuniform vec4 u_color;\nuniform float u_gamma_scale;\nuniform bool u_is_halo;\nuniform float u_text_size;\n\nvarying vec2 v_uv;\n\nvoid main() {\n     lowp float dist = texture2D(u_texture, v_uv).r;\n     float font_scale = u_text_size / 24.0;\n     lowp float buff = (256.0 - 64.0) / 256.0;\n     highp float edge_gamma = 0.105 / u_pixel_scale;\n     highp float gamma = edge_gamma / (font_scale * u_gamma_scale);\n     if (u_is_halo) {\n      float halo_width = u_pixel_scale * font_scale;\n      float halo_blur = 0.01;\n      gamma = (halo_blur * 1.19 / SDF_PX + edge_gamma) / (font_scale * u_gamma_scale);\n      buff = (6.0 - halo_width / font_scale) / SDF_PX;\n     }\n     highp float alpha = smoothstep(buff - gamma, buff + gamma, dist);\n     gl_FragColor = vec4(u_color.rgb, alpha * u_color.a);\n}  \n  ",t.tileDebugVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n   ",t.tileDebugFS="\nprecision mediump float;  \n\nvoid main() {\n    gl_FragColor = vec4(0.1, 0.2, 0.3, 1.0);\n}",t}();e.ShaderSource=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(2),a=n(13),s=n(10),l=n(1),u=n(11),h=n(18),c=n(8),f=n(6),p=n(30),d=n(0),g=n(33),m=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==r.LayerType.LINE){var e=this.layer;if(0!=e.renderTiles.size&&e.isVisible()){var n=e.getStyle()==g.PolylineStyle.Dotted,i=this.layer.tileManager.mapView.gl,p=a.ResourceManager.getInstance(i).getShader(a.ShaderEnum.POLYLINE_SHADER);i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),e.getElevation()>0&&i.enable(i.DEPTH_TEST),p.bind();var m=f.ProjectionMercator.worldSize(this.mapState.getScale()),y=this.layer.getLayerId(),v=1;this.mapState.getZoom()>this.mapState.getMaxNativeZoom()&&(v=Math.pow(2,Math.round(this.mapState.getZoom())-this.mapState.getMaxNativeZoom()));var b=e.getStrokeWidth();e.renderTiles.forEach(function(f){var g=f.getTile(),_=g.getKind();if(_==h.Kind.ANNOTAION||_==h.Kind.VECTOR){var w=g;if(w.hasData(y)){var M=w.getLayerData(y,r.LayerType.LINE,b);if(M.getType()==r.LayerType.LINE){var x=M,A=w.getTileCoordinate(),T=1<<A.getZoom(),S=m/T,E=S/l.MapUtils.getTileSize(),C=c.GeometryUtils.pixelCoordinateToCameraCoordinate(new o.Vector2(A.getX()*S+S/2,A.getY()*S+S/2),t.mapState.cameraPosition),L=u.Matrix4.translate(C.x,C.y,t.mapState.is3dMode()?c.GeometryUtils.getElevationPixelFromMeter(e.getElevation(),t.mapState.cameraPosition):0);L=u.Matrix4.scale(E,E,1).concat(L);var P=x.getLineLayerDataProperties(),I=x.getModel();I.bind(),p.setAttributes(I.attributeInfos),p.setUniforms([new s.UniformInfo("u_mvpMatrix","matrix",L.concat(t.mapState.getViewProjectionMatrix()))]);var O,R=x.getLinePartials();if(n){O=v/b*(d.PolyConstants.polylineTextureHeight/d.PolyConstants.polylineTextureWidth);var k=a.ResourceManager.getInstance(i).getTexture(a.TextureEnum.POLYLINE_TEXTURE);p.setUniforms([new s.UniformInfo("u_texture","texture",k)])}for(var D=0;D<R.length;++D){var B=P[D];p.setUniforms([new s.UniformInfo("u_lineWidth","1f",_==h.Kind.ANNOTAION?b/v:B.strokeWidth/v),new s.UniformInfo("u_color","4fv",_==h.Kind.ANNOTAION?e.getStrokeColor().buffer():B.strokeColor.buffer()),new s.UniformInfo("u_isDotted","1i",n)]),n&&p.setUniforms([new s.UniformInfo("u_textureScale","1f",O)]);var U=R[D];I.renderPartial(i.TRIANGLES,U.start,U.length)}}else console.warn("ERROR: layerData.getType() != LayerType.LINE .............")}}else console.warn("Invalid tile kind")}),i.disable(i.DEPTH_TEST),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null),i.bindBuffer(i.ARRAY_BUFFER,null),p.disableAttributes()}}},e}(p.LayerRenderer);e.LineLayerRenderer=m},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(2),a=n(13),s=n(10),l=n(1),u=n(11),h=n(18),c=n(8),f=n(6),p=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==r.LayerType.FILL){var e=this.layer;if(0!=e.renderTiles.size&&e.visible){var n=this.layer.tileManager.mapView.gl,i=a.ResourceManager.getInstance(n).getShader(a.ShaderEnum.FILL_SHADER);n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),i.bind(),e.elevation>0&&n.enable(n.DEPTH_TEST);var p=f.ProjectionMercator.worldSize(this.mapState.getScale()),d=this.layer.getLayerId();e.renderTiles.forEach(function(a){var f=a.getTile(),g=f.getKind();if(g==h.Kind.ANNOTAION||g==h.Kind.VECTOR){var m=f;if(m.hasData(d)){var y=m.getLayerData(d,r.LayerType.FILL);if(y.getType()==r.LayerType.FILL){var v=y,b=m.getTileCoordinate(),_=1<<b.getZoom(),w=p/_,M=w/l.MapUtils.getTileSize(),x=c.GeometryUtils.pixelCoordinateToCameraCoordinate(new o.Vector2(b.getX()*w+w/2,b.getY()*w+w/2),t.mapState.cameraPosition),A=u.Matrix4.translate(x.x,x.y,t.mapState.is3dMode()?c.GeometryUtils.getElevationPixelFromMeter(e.elevation,t.mapState.cameraPosition):0),T=(A=u.Matrix4.scale(M,M,1).concat(A)).concat(t.mapState.getViewProjectionMatrix());i.setUniforms([new s.UniformInfo("u_mvpMatrix","matrix",T)]);var S=v.getFillPartials(),E=v.getLinePartials(),C=v.getModel(),L=v.getFillProperties(),P=v.getStrokeProperties(),I=Array.from(S.keys());C.bind(),i.setAttributes(C.attributeInfos),I.forEach(function(t){for(var r=S.get(t),o=E.get(t),a=0;a<r.length;++a){i.setUniforms([new s.UniformInfo("u_color","4fv",g==h.Kind.ANNOTAION?e.fillColor.buffer():L.get(t).fillColor.buffer())]);var l=r[a];if(C.renderPartial(n.TRIANGLES,l.start,l.length),g==h.Kind.ANNOTAION&&e.strokeWidth>0||g!=h.Kind.ANNOTAION)if(o&&a<o.length)(u=o[a]).forEach(function(r){i.setUniforms([new s.UniformInfo("u_color","4fv",g==h.Kind.ANNOTAION?e.strokeColor.buffer():P.get(t).strokeColor.buffer())]),C.renderPartial(n.LINES,r.start,r.length)})}if(o)for(a=r.length;a<o.length;++a){var u=o[a];i.setUniforms([new s.UniformInfo("u_color","4fv",g==h.Kind.ANNOTAION?e.strokeColor.buffer():P.get(t).strokeColor.buffer())]),u.forEach(function(t){C.renderPartial(n.LINES,t.start,t.length)})}})}else console.warn("ERROR: layerData.getType() != LayerType.FILL .............")}}else console.warn("Invalid tile kind")}),n.disable(n.DEPTH_TEST),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),n.bindBuffer(n.ARRAY_BUFFER,null)}}else console.log("Invalid layer type")},e}(n(30).LayerRenderer);e.FillLayerRenderer=p},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(13),a=n(10),s=n(11),l=n(8),u=n(30),h=n(6),c=n(0),f=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==r.LayerType.CIRCLE){var t=this.layer;if(0!=t.renderTiles.size&&t.visible){var e=this.layer.tileManager.mapView.gl,n=o.ResourceManager.getInstance(e),i=n.getShader(o.ShaderEnum.CIRCLE_SHADER);e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),t.elevation>0&&e.enable(e.DEPTH_TEST),i.bind();var u=n.getModel(o.ModelEnum.CIRCLE_MODEL),f=this.mapState.cameraPosition.getTarget(),p=h.ProjectionMercator.getMetersPerPixelAtLatitude(f.lat,this.mapState.getZoom()),d=t.radius/p,g=d/Math.cos(Math.PI/c.PolyConstants.numTrianglesPerCircle),m=t.strokeWidth,y=l.GeometryUtils.pixelCoordinateToCameraCoordinate(h.ProjectionMercator.projectScale(t.center,this.mapState.scale),this.mapState.cameraPosition),v=s.Matrix4.translate(y.x,y.y,this.mapState.is3dMode()?l.GeometryUtils.getElevationPixelFromMeter(t.elevation,this.mapState.cameraPosition):0);i.setUniforms([new a.UniformInfo("u_color","4fv",t.fillColor.buffer()),new a.UniformInfo("u_radius","1f",g+t.hypotenuseStrokeWidth),new a.UniformInfo("u_outerRadius","1f",d+m),new a.UniformInfo("u_innerRadius","1f",d),new a.UniformInfo("u_strokeColor","4fv",t.strokeColor.buffer()),new a.UniformInfo("u_mvpMatrix","matrix",v.concat(this.mapState.getViewProjectionMatrix()))]),u.bind(),i.setAttributes(u.attributeInfos),u.render(e.TRIANGLES),u.unbind(),e.disable(e.DEPTH_TEST)}}else console.log("Invalid layer type")},e}(u.LayerRenderer);e.CircleLayerRenderer=f},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(30),a=n(5),s=n(13),l=n(10),u=n(9),h=n(14),c=n(0);!function(t){t[t.Building=0]="Building",t[t.Selection=1]="Selection",t[t.Shadow=2]="Shadow"}(r||(r={}));var f=function(t){function e(e,n,i){var r=t.call(this,n,i)||this;return r.gl=e,r.fogStartUniformValue=Number.POSITIVE_INFINITY,r.fogRangeUniformValue=Number.POSITIVE_INFINITY,r}return i(e,t),e.prototype.render=function(){this.renderInternal(r.Building)},e.prototype.renderSelection=function(){this.renderInternal(r.Selection)},e.prototype.renderShadowMapping=function(){this.renderInternal(r.Shadow)},e.prototype.renderOutlining=function(t){var e=this;if(t&&0!=t.length){var n=s.ResourceManager.getInstance(this.gl).getShader(s.ShaderEnum.BUILDING_OUTLINING);n.bind(),this.gl.enable(this.gl.STENCIL_TEST),this.gl.stencilFunc(this.gl.NOTEQUAL,1,255),this.gl.stencilMask(0),t.forEach(function(t){var i=t.getModel();i.bind(),n.setAttributes(i.attributeInfos),n.setUniforms([new l.UniformInfo("u_modelMatrix","matrix",t.getScaledModelMatrix()),new l.UniformInfo("u_mvpMatrix","matrix",t.getScaledMvpMatrix())]),i.render(e.gl.TRIANGLES),i.unbind()}),this.gl.disable(this.gl.STENCIL_TEST),n.disableAttributes()}},e.prototype.renderInternal=function(t){if(this.mapState.is3dMode())if(this.layer.getLayerType()==a.LayerType.BUILDING){var e=this.layer;if(0!=e.textureBuildingGroups.size||0!=e.extrudeBuildings.length){var n=s.ResourceManager.getInstance(this.gl);this.gl.enable(this.gl.DEPTH_TEST);var i=null;if(this.fogStartUniformValue=Number.POSITIVE_INFINITY,this.fogRangeUniformValue=Number.POSITIVE_INFINITY,t===r.Building){if(this.mapState.getTilt()>c.MapConstants.maxTiltIntersectWithScreen){var o=c.MapConstants.defaultMaxNativeZoom,u=1.5*this.mapState.getScreenSize().y,h=Math.pow(2,Math.max(this.mapState.getZoom()-o,0));this.fogStartUniformValue=u*h+256,this.fogRangeUniformValue=this.mapState.getDistanceToSky()*h-u}else this.fogStartUniformValue=99999999999,this.fogRangeUniformValue=99999999999;(i=e.effectManager.enableShadowEffect?n.getShader(s.ShaderEnum.BUILDING_WITH_SHADOW_SHADER):n.getShader(s.ShaderEnum.BUILDING_SHADER)).bind();var f=e.lightManager.sunLight,p=e.timeEffectManager.getFogColor();i.setUniforms([new l.UniformInfo("u_light_position","3f",f.lightPosition),new l.UniformInfo("u_light_color","3fv",f.lightColor.rgbBuffer()),new l.UniformInfo("u_fogStart","1f",this.fogStartUniformValue),new l.UniformInfo("u_fogRange","1f",this.fogRangeUniformValue),new l.UniformInfo("u_fogColor","3fv",p.rgbBuffer())])}else t===r.Selection?((i=n.getShader(s.ShaderEnum.BUILDING_SELECTION_SHADER)).bind(),this.resetSelectionCode()):t===r.Shadow&&(e.effectManager.shadowMap.bind(),(i=n.getShader(s.ShaderEnum.SHADOW_MAPPING_SHADER)).bind());var d=[];this.renderTextureBuildings(t,e,i,d),this.renderExtrudeBuildings(t,e,i,d),this.gl.disable(this.gl.DEPTH_TEST),t==r.Shadow&&e.effectManager.shadowMap.unbind(),i.disableAttributes(),this.renderOutlining(d)}}else console.warn("This layer is not building !")},e.prototype.renderTextureBuildings=function(t,e,n,i){var o=this;if(0!=e.textureBuildingGroups.size){var a=s.ResourceManager.getInstance(this.gl).getTexture(s.TextureEnum.WHITE_TEXTURE);e.getBuildingResourceManager();e.textureBuildingGroups.forEach(function(s){var f=s.getModel();null!=f&&0!=f.attributeInfos.length&&s.buildings.forEach(function(s){if(t===r.Building){s.isSelected()&&(o.gl.enable(o.gl.STENCIL_TEST),o.gl.stencilFunc(o.gl.ALWAYS,1,255),o.gl.stencilMask(255),i.push(s));var p=s.getTexture();if(null==p&&(p=a),(v=e.effectManager).enableShadowEffect){var d=v.shadowMap,g=s.getModelMatrix().concat(d.getLightViewProjectionMatrix()).concat(c.MapConstants.biasMatrix);n.setUniforms([new l.UniformInfo("u_shadowMap","texture",d.getShadowMapTexture()),new l.UniformInfo("u_shadowMvpMatrix","matrix",g)])}n.setUniforms([new l.UniformInfo("u_camera_direction","3f",o.mapState.cameraPositionVector),new l.UniformInfo("u_modelMatrix","matrix",s.getModelMatrix()),new l.UniformInfo("u_mvpMatrix","matrix",s.getMvpMatrix()),new l.UniformInfo("u_texture","texture",p)])}else if(t===r.Selection){var m=o.getSelectionCode();s.setSelectionCode(m);var y=u.Color.fromInt(m);n.setUniforms([new l.UniformInfo("u_color","3f",new h.Vector3(y.red,y.green,y.blue)),new l.UniformInfo("u_mvpMatrix","matrix",s.getMvpMatrix())])}else if(t===r.Shadow){var v;d=(v=e.effectManager).shadowMap,g=s.getModelMatrix().concat(d.getLightViewProjectionMatrix());n.setUniforms([new l.UniformInfo("u_shadowMvpMatrix","matrix",g)])}f.bind(),n.setAttributes(f.attributeInfos),f.render(o.gl.TRIANGLES),f.unbind(),n.resetTextureUnit(),t===r.Building&&s.isSelected()&&o.gl.disable(o.gl.STENCIL_TEST)})})}},e.prototype.renderExtrudeBuildings=function(t,e,n,i){var o=this;if(0!=e.extrudeBuildings.length){var a=s.ResourceManager.getInstance(this.gl).getTexture(s.TextureEnum.WHITE_TEXTURE);e.getBuildingResourceManager();if(t===r.Building){var f=e.effectManager;if(f.enableShadowEffect){var p=f.shadowMap;n.setUniforms([new l.UniformInfo("u_shadowMap","texture",p.getShadowMapTexture())])}}e.extrudeBuildings.forEach(function(s){if(t!==r.Shadow){var f=s.getModel();if(null!=f){if(t===r.Building){s.isSelected()&&(o.gl.enable(o.gl.STENCIL_TEST),o.gl.stencilFunc(o.gl.ALWAYS,1,255),o.gl.stencilMask(255),i.push(s));var p=s.getTexture();if(null==p&&(p=a),(v=e.effectManager).enableShadowEffect){var d=v.shadowMap,g=s.getModelMatrix().concat(d.getLightViewProjectionMatrix()).concat(c.MapConstants.biasMatrix);n.setUniforms([new l.UniformInfo("u_shadowMvpMatrix","matrix",g)])}n.setUniforms([new l.UniformInfo("u_texture","texture",p),new l.UniformInfo("u_camera_direction","3f",o.mapState.cameraPositionVector),new l.UniformInfo("u_modelMatrix","matrix",s.getModelMatrix()),new l.UniformInfo("u_mvpMatrix","matrix",s.getMvpMatrix())])}else if(t===r.Selection){var m=o.getSelectionCode();s.setSelectionCode(m);var y=u.Color.fromInt(m);n.setUniforms([new l.UniformInfo("u_color","3f",new h.Vector3(y.red,y.green,y.blue)),new l.UniformInfo("u_mvpMatrix","matrix",s.getMvpMatrix())])}else if(t===r.Shadow){var v;d=(v=e.effectManager).shadowMap,g=s.getModelMatrix().concat(d.getLightViewProjectionMatrix());n.setUniforms([new l.UniformInfo("u_shadowMvpMatrix","matrix",g)])}f.bind(),n.setAttributes(f.attributeInfos),f.render(o.gl.TRIANGLES),f.unbind(),n.resetTextureUnit(),t===r.Building&&s.isSelected()&&o.gl.disable(o.gl.STENCIL_TEST)}}})}},e}(o.LayerRenderer);e.BuildingLayerRenderer=f},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(30),a=n(13),s=n(18),l=n(8),u=n(11),h=n(10),c=n(227),f=n(9),p=n(2),d=n(1),g=n(21),m=n(27),y=n(0),v=n(4),b=n(44),_=n(25),w=n(19),M=function(t){function e(e,n){var i=t.call(this,e,n)||this,r=a.ResourceManager.getInstance(i.layer.tileManager.mapView.gl);return i.symbolShader=r.getShader(a.ShaderEnum.SYMBOL_SHADER),i.model=r.getModel(a.ModelEnum.SYMBOL_MODEL),i}return i(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==r.LayerType.SYMBOL){var e=this.layer,n=this.layer.tileManager.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),this.flag=!0;var i=[],o=0,a=g.SymbolResourceManager.getInstance(n),u=this.mapState.cameraPosition,h=this.mapState.getScreenSize();e.renderTiles.forEach(function(r){var c=r.getTile().getKind();if(c==s.Kind.ANNOTAION||c==s.Kind.VECTOR)if(c==s.Kind.ANNOTAION){var f=a.acquire(e.url),p=e.width<0?f.width:e.width,g=e.height<0?f.height:e.height,m=t.mapState.is3dMode()?e.elevation:0,b=l.GeometryUtils.latLngToScreenCoordinate(e.position,m,u,h),M=e.anchor,x=e.textLabelData;if(t.renderSymbol(n,f,b,p,g,M,e.rotation),a.release(e.url),x){var A=e.labelAnchor,T=e.markerLabel;t.renderSymbolLabel(n,b,p,g,M,x,T,A),t.flag=!0}}else{if(!t.mapState.mapSettings.placesEnabled)return;t.symbolShader.bind(),t.model.bind(),t.symbolShader.setAttributes(t.model.attributeInfos);var S=r.tile.getTileData();S.getLayerIds().forEach(function(e){S.getLayer(e).features.forEach(function(e){var r=e.getProperties();if(r.get("symbolVisible")){var s=r.get("selected"),c=r.get("url"),f=!0===r.get("userFeature")?_.UrlUtils.getIconRequestUrl(y.MapConstants.userIconRequestUrl,c,w.MapSettings.getAccessKey()):c,p=!0===s?a.acquire(y.SymbolConstants.placeSelectedSymbol,!1):a.acquire(f,!1),g=(!0===s?y.MapConstants.placeSelectedWidth:y.MapConstants.placeWidth)*d.MapUtils.pixelScale,m=(!0===s?y.MapConstants.placeSelectedHeight:y.MapConstants.placeHeight)*d.MapUtils.pixelScale,b=l.GeometryUtils.latLngToScreenCoordinate(new v.LatLng(r.get("lat"),r.get("lng")),0,u,h),M=y.MapConstants.placeAnchor;r.set("renderOrder",++o);var x=t.renderPlace(n,p,b,g,m,M),A=r.get("textVisible");x&&!0===A&&i.push({text:r.get("name"),coordinate:b,color:!0===s?y.MapConstants.placeSelectedColor:r.get("color"),symbolWidth:g,symbolHeight:m,anchor:M})}})})}else console.error("Invalid tile")}),i.forEach(function(e){var i=new m.MarkerLabel({text:e.text,anchor:[0,.5],fontSize:y.MapConstants.placeFontSize,fontWeight:y.MapConstants.placeFontWeight,line:y.MapConstants.placeNumLine,maxWidth:y.MapConstants.placeMaxWidth,color:e.color}),r=b.TextLabelResourceManager.getInstance(n).acquire(i),o=y.MapConstants.placeLabelAnchor;t.renderSymbolLabel(n,e.coordinate,e.symbolWidth,e.symbolHeight,e.anchor,r,i,o),b.TextLabelResourceManager.getInstance(n).release(i)}),this.model.unbind(),n.disable(n.BLEND)}else console.log("Invalid layer type")},e.prototype.renderSymbol=function(t,e,n,i,r,o,a){if(void 0===a&&(a=0),e.isLoaded){this.flag&&(this.symbolShader.bind(),this.model.bind(),this.symbolShader.setAttributes(this.model.attributeInfos),this.flag=!1);var s=u.Matrix4.translate(n.x,n.y,0);s=u.Matrix4.translate((.5-o.x)*i,(.5-o.y)*r,0).concat(s);var l=u.Matrix4.scale(i/2,r/2,1);s=u.Matrix4.rotateZ(a).concat(s);var c=(s=l.concat(s)).concat(this.mapState.getOrthoProjectionMatrix());this.symbolShader.setUniforms([new h.UniformInfo("u_mvpMatrix","matrix",c),new h.UniformInfo("u_texture","texture",e)]),this.model.render(t.TRIANGLES),this.symbolShader.resetTextureUnit()}},e.prototype.renderSymbolLabel=function(t,e,n,i,r,o,a,s){var l=a.getMargin(),u=a.getAnchor(),h=d.MapUtils.pixelScale,g=o.widthPerLine==y.MapConstants.none?o.width:o.widthPerLine,m=(s.x-r.x)*n+(l.left-l.right)*h+g*(.5-u.x),v=(s.y-r.y)*i+(l.top-l.bottom)*h+o.height*(.5-u.y),b=e.add(new p.Vector2(m,v));c.TextLabelRenderer.render(t,this.mapState,o,b,f.Color.fromHex(a.getColor()),a.hasHalo(),f.Color.fromHex(a.getHaloColor()))},e.prototype.renderPlace=function(t,e,n,i,r,o){if(!e.isLoaded)return!1;var a=u.Matrix4.translate(n.x,n.y,0);a=u.Matrix4.translate((.5-o.x)*i,(.5-o.y)*r,0).concat(a);var s=(a=u.Matrix4.scale(i/2,r/2,1).concat(a)).concat(this.mapState.getOrthoProjectionMatrix());return this.symbolShader.setUniforms([new h.UniformInfo("u_mvpMatrix","matrix",s),new h.UniformInfo("u_texture","texture",e)]),this.model.render(t.TRIANGLES),this.symbolShader.resetTextureUnit(),!0},e}(o.LayerRenderer);e.SymbolLayerRenderer=M},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),r=n(4),o=n(8),a=n(11),s=n(10),l=n(9),u=n(1),h=n(6),c=function(){function t(){}return t.renderCurved=function(t,e,n,r,c,f,p){void 0===c&&(c=l.Color.fromHex("#000000")),void 0===f&&(f=!0),void 0===p&&(p=l.Color.fromHex("#FFFFFF"));var d=i.ResourceManager.getInstance(t).getShader(i.ShaderEnum.TEXT_LABEL_SHADER);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),d.bind();var g=n.font.texture;n.model.bind(),d.setAttributes(n.model.attributeInfos);var m=o.GeometryUtils.pixelCoordinateToCameraCoordinate(h.ProjectionMercator.projectScale(r,e.scale),e.cameraPosition),y=a.Matrix4.translate(m.x,m.y,0).concat(e.getViewProjectionMatrix());d.setUniforms([new s.UniformInfo("u_mvpMatrix","matrix",y),new s.UniformInfo("u_texture","texture",g),new s.UniformInfo("u_pixel_scale","1f",u.MapUtils.pixelScale),new s.UniformInfo("u_text_size","1f",n.size),new s.UniformInfo("u_texsize","2fv",new Float32Array([g.width,g.height]))]),f&&(d.setUniforms([new s.UniformInfo("u_color","4fv",p.buffer()),new s.UniformInfo("u_is_halo","1i",!0)]),n.model.render(t.TRIANGLES)),d.setUniforms([new s.UniformInfo("u_color","4fv",c.buffer()),new s.UniformInfo("u_gamma_scale","1f",1),new s.UniformInfo("u_is_halo","1i",!1)]),n.model.render(t.TRIANGLES)},t.render=function(t,e,n,h,c,f,p){void 0===c&&(c=l.Color.fromHex("#000000")),void 0===f&&(f=!0),void 0===p&&(p=l.Color.fromHex("#FFFFFF"));var d=i.ResourceManager.getInstance(t).getShader(i.ShaderEnum.TEXT_LABEL_SHADER);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),d.bind();var g=n.font.texture;n.model.bind(),d.setAttributes(n.model.attributeInfos);var m=null;m=h instanceof r.LatLng?o.GeometryUtils.latLngToScreenCoordinate(h,0,e.cameraPosition,e.getScreenSize()):h;var y=a.Matrix4.translate(m.x,m.y,0).concat(e.getOrthoProjectionMatrix());d.setUniforms([new s.UniformInfo("u_mvpMatrix","matrix",y),new s.UniformInfo("u_texture","texture",g),new s.UniformInfo("u_pixel_scale","1f",u.MapUtils.pixelScale),new s.UniformInfo("u_text_size","1f",n.size),new s.UniformInfo("u_texsize","2fv",new Float32Array([g.width,g.height]))]),f&&(d.setUniforms([new s.UniformInfo("u_color","4fv",p.buffer()),new s.UniformInfo("u_is_halo","1i",!0)]),n.model.render(t.TRIANGLES)),d.setUniforms([new s.UniformInfo("u_color","4fv",c.buffer()),new s.UniformInfo("u_gamma_scale","1f",1),new s.UniformInfo("u_is_halo","1i",!1)]),n.model.render(t.TRIANGLES)},t}();e.TextLabelRenderer=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(30),a=n(13),s=n(6),l=n(18),u=n(1),h=n(11),c=n(2),f=n(10),p=n(8),d=n(21),g=n(0),m=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==r.LayerType.GEOJSON){var e=this.layer;if(0!=e.renderTiles.size){var n=this.mapState.getZoom();if(!(n<this.mapState.mapSettings.dataLayerMinZoom||n>this.mapState.mapSettings.dataLayerMaxZoom)){var i=this.layer.tileManager.mapView.gl,o=a.ResourceManager.getInstance(i),m=o.getShader(a.ShaderEnum.GEOJSON_SHADER);i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA);var y=s.ProjectionMercator.worldSize(this.mapState.getScale()),v=this.layer.getLayerId(),b=1;n>this.mapState.getMaxNativeZoom()&&(b=Math.pow(2,Math.round(n)-this.mapState.getMaxNativeZoom()));var _=this.mapState.cameraPosition,w=this.mapState.getScreenSize();e.renderTiles.forEach(function(e){e.forEach(function(e){var n=e.getTile();if(n.getKind()==l.Kind.VECTOR){var o=n;if(o.hasData(v)){var a=o.getLayerData(v,r.LayerType.GEOJSON);if(a.getType()==r.LayerType.GEOJSON){m.bind();var s=a,d=o.getTileCoordinate(),g=1<<d.getZoom(),w=y/g,M=w/u.MapUtils.getTileSize(),x=p.GeometryUtils.pixelCoordinateToCameraCoordinate(new c.Vector2(d.getX()*w+w/2,d.getY()*w+w/2),_),A=h.Matrix4.translate(x.x,x.y,0),T=(A=h.Matrix4.scale(M,M,1).concat(A)).concat(t.mapState.getViewProjectionMatrix());m.setUniforms([new f.UniformInfo("u_mvpMatrix","matrix",T)]);var S=s.getPartials(),E=s.getFillOutlinedPartials(),C=s.getFillProperties(),L=s.getLineProperties(),P=s.getFillOutlinedProperties(),I=Array.from(S.keys()),O=s.getModel();O.bind(),m.setAttributes(O.attributeInfos),I.forEach(function(t){if(L.has(t))for(var e=S.get(t),n=L.get(t),r=0;r<e.length;++r){m.setUniforms([new f.UniformInfo("u_lineWidth","1f",n.strokeWidth/b),new f.UniformInfo("u_color","4fv",n.strokeColor.buffer())]);var o=e[r];O.renderPartial(i.TRIANGLES,o.start,o.length)}else if(C.has(t)){m.setUniforms([new f.UniformInfo("u_lineWidth","1f",0)]);var a=S.get(t),s=E.get(t);for(r=0;r<a.length;++r){m.setUniforms([new f.UniformInfo("u_color","4fv",C.get(t).fillColor.buffer())]);var l=a[r];if(O.renderPartial(i.TRIANGLES,l.start,l.length),s&&r<s.length)(u=s[r]).forEach(function(e){m.setUniforms([new f.UniformInfo("u_color","4fv",P.get(t).strokeColor.buffer())]),O.renderPartial(i.LINES,e.start,e.length)})}if(s)for(r=a.length;r<s.length;++r){var u=s[r];m.setUniforms([new f.UniformInfo("u_color","4fv",P.get(t).strokeColor.buffer())]),u.forEach(function(t){O.renderPartial(i.LINES,t.start,t.length)})}}else console.warn("Invalid geojson key: "+t)})}else console.warn("ERROR: layerData.getType() != LayerType.GEOJSON .............")}}else console.warn("Invalid tile kind")})});var M=o.getShader(a.ShaderEnum.SYMBOL_SHADER),x=o.getModel(a.ModelEnum.SYMBOL_MODEL),A=d.SymbolResourceManager.getInstance(i).acquire(g.SymbolConstants.defaultSymbol);M.bind(),x.bind(),M.setAttributes(x.attributeInfos),M.setUniforms([new f.UniformInfo("u_texture","texture",A)]),e.renderTiles.forEach(function(e){e.forEach(function(e){var n=e.getTile();if(n.getKind()==l.Kind.VECTOR){var o=n;if(o.hasData(v)){var a=o.getLayerData(v,r.LayerType.GEOJSON);if(a.getType()==r.LayerType.GEOJSON)a.getPointCoordinates().forEach(function(e){e.forEach(function(e){var n=p.GeometryUtils.latLngToScreenCoordinate(e,0,_,w),r=h.Matrix4.translate(n.x,n.y,0),o=g.MapConstants.pointGeoJsonAnchor,a=o[0],s=o[1],l=g.MapConstants.pointGeoJsonWidth*u.MapUtils.pixelScale,c=g.MapConstants.pointGeoJsonHeight*u.MapUtils.pixelScale;r=h.Matrix4.translate((.5-a)*l,(.5-s)*c,0).concat(r);var d=(r=h.Matrix4.scale(l/2,c/2,1).concat(r)).concat(t.mapState.getOrthoProjectionMatrix());M.setUniforms([new f.UniformInfo("u_mvpMatrix","matrix",d)]),x.render(i.TRIANGLES)})});else console.warn("ERROR: layerData.getType() != LayerType.GEOJSON .............")}}else console.warn("Invalid tile kind")})}),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,null),i.bindBuffer(i.ARRAY_BUFFER,null)}}}},e}(o.LayerRenderer);e.GeoJsonLayerRenderer=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.idCounter=0,this.tileManager=t,this.tileAreas=new Map}return t.prototype.addTileArea=function(t){var e=this.idCounter++;return this.tileAreas.set(e,t),this.tileManager.addTileArea(e,t),e},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.tileAreas.set(t,e),this.tileManager.updateTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.delete(t),this.tileManager.removeTileArea(t)},t}();e.TileAreaManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),r=n(231),o=n(232),a=n(233),s=n(234),l=n(235),u=n(237),h=n(238),c=function(){function t(){}return t.createLayer=function(t,e,n,c){switch(e){case i.LayerType.RASTER:return new r.RasterLayer(t,c,n);case i.LayerType.BUILDING:return new l.BuildingLayer(t,c,n);case i.LayerType.LINE:return new o.LineLayer(t,c,n);case i.LayerType.FILL:return new a.FillLayer(t,c,n);case i.LayerType.CIRCLE:return new s.CircleLayer(t,c,n);case i.LayerType.SYMBOL:return new u.SymbolLayer(t,c,n);case i.LayerType.GEOJSON:return new h.GeoJsonLayer(t,c,n);default:return console.log("Un-support layer type"),null}},t}();e.LayerFactory=c},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(85),a=function(t){function e(e,n,i){return t.call(this,e,n,r.LayerType.RASTER,i)||this}return i(e,t),e.prototype.update=function(){var t=this;this.tileManager.update(function(e){return new o.RasterTile(e,t.tileManager.mapView.gl)})},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},set:function(t){this._timeEffectManager=t},enumerable:!0,configurable:!0}),e.prototype.setLightingManager=function(t){this.lightManager=t},e}(r.Layer);e.RasterLayer=a},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(9),a=n(1),s=n(33),l=function(t){function e(e,n,i){var a=t.call(this,e,n,r.LayerType.LINE,i)||this;return a._strokeWidth=5,a._strokeColor=new o.Color(0,0,0,1),a._strokeOpacity=1,a._visible=!0,a._elevation=0,a._style=s.PolylineStyle.Solid,a.renderTiles=new Map,a}return i(e,t),e.prototype.update=function(t){},e.prototype.setStrokeWidth=function(t){this._strokeWidth=t*a.MapUtils.pixelScale},e.prototype.setStrokeColor=function(t){null!==t?(this._strokeColor=o.Color.fromHex(t),this._strokeColor.alpha=this._strokeOpacity):this._strokeColor=new o.Color(255,0,0,this._strokeOpacity)},e.prototype.setStrokeOpacity=function(t){this._strokeOpacity=t,this._strokeColor.alpha=this._strokeOpacity},e.prototype.setElevation=function(t){this._elevation=t},e.prototype.setStyle=function(t){this._style=t},e.prototype.setVisible=function(t){this._visible=t},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.getStrokeOpacity=function(){return this._strokeOpacity},e.prototype.getElevation=function(){return this._elevation},e.prototype.getStyle=function(){return this._style},e.prototype.isVisible=function(){return this._visible},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)||this.renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(r.Layer);e.LineLayer=l},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(9),a=n(1),s=function(t){function e(e,n,i){var a=t.call(this,e,n,r.LayerType.FILL,i)||this;return a._fillColor=new o.Color(0,0,0,1),a._fillOpacity=1,a._strokeColor=new o.Color(0,0,0,1),a._strokeWidth=0,a._visible=!0,a._elevation=0,a._renderTiles=new Map,a}return i(e,t),e.prototype.update=function(t){},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=o.Color.fromHex(t),this._fillColor.alpha=this._fillOpacity):this._fillColor=new o.Color(255,0,0,this._fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this._fillColor.alpha=this._fillOpacity},e.prototype.setStrokeColor=function(t){this._strokeColor=null!==t?o.Color.fromHex(t):new o.Color(0,255,0,1)},e.prototype.setStrokeWidth=function(t){this._strokeWidth=t*a.MapUtils.pixelScale},e.prototype.setElevation=function(t){this._elevation=t},e.prototype.setVisible=function(t){this._visible=t},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this._strokeColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWidth",{get:function(){return this._strokeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elevation",{get:function(){return this._elevation},enumerable:!0,configurable:!0}),e}(r.Layer);e.FillLayer=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(9),a=n(4),s=n(1),l=n(0),u=function(t){function e(e,n,i){var s=t.call(this,e,n,r.LayerType.CIRCLE,i)||this;return s._center=new a.LatLng(0,0),s._radius=0,s._fillColor=new o.Color(0,0,0,1),s._fillOpacity=1,s._strokeColor=new o.Color(0,0,0,1),s._strokeWidth=5,s._elevation=0,s._visible=!0,s._renderTiles=new Map,s}return i(e,t),e.prototype.update=function(t){},e.prototype.setCenter=function(t){this._center=t},e.prototype.setRadius=function(t){this._radius=t},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=o.Color.fromHex(t),this.fillColor.alpha=this.fillOpacity):this._fillColor=new o.Color(255,0,0,this.fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this.fillColor.alpha=this.fillOpacity},e.prototype.setStrokeColor=function(t){null!==t?(this._strokeColor=o.Color.fromHex(t),this._strokeColor.alpha=1):this._strokeColor=new o.Color(0,1,0,1)},e.prototype.setStrokeWidth=function(t){var e=5*s.MapUtils.pixelScale;null!==t&&(e=t*s.MapUtils.pixelScale)<1&&(e=0),this._strokeWidth=e,this._hypotenuseStrokeWidth=e/Math.cos(Math.PI/l.PolyConstants.numTrianglesPerCircle)},e.prototype.setElevation=function(t){this._elevation=t},e.prototype.setVisible=function(t){this._visible=t},Object.defineProperty(e.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this._strokeColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWidth",{get:function(){return this._strokeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hypotenuseStrokeWidth",{get:function(){return this._hypotenuseStrokeWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elevation",{get:function(){return this._elevation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},e}(r.Layer);e.CircleLayer=u},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(236),a=n(31),s=n(40),l=function(t){function e(e,n,i){var o=t.call(this,e,n,r.LayerType.BUILDING,i)||this;return o.extrudeBuildings=[],o.dirty=!0,o.textureBuildingGroups=new Map,o._selectedObjectMap=new Map,o}return i(e,t),e.prototype.update=function(t){var e=this;t.is3dMode()&&(this.buildingResourceManager.update(),this.dirty&&(this.dirty=!1,this.textureBuildingGroups.clear(),this.extrudeBuildings=[],this.buildingResourceManager.buildings.forEach(function(n){if(e.isInFilterObjectTypes(n.getTypes())){n.updateMatrices(t),n.setSelected(e._selectedObjectMap.has(n.getId()));var i=n.getObjName(),r=n.getBuildingType();if(r==a.BuildingType.Extrude||r==a.BuildingType.ExternalExtrude)e.extrudeBuildings.push(n);else{var s=e.textureBuildingGroups.get(i);if(null==s){var l=new o.BuildingGroup(i);l.addBuilding(n),e.textureBuildingGroups.set(i,l)}else s.addBuilding(n)}}}),this.lightManager.update(t.getCamera().getTarget())))},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.getBuildingResourceManager=function(){return this.buildingResourceManager},e.prototype.setBuildingResourceManager=function(t){var e=this;this.buildingResourceManager=t,this.buildingResourceManager.setBuildingLayerDirty=function(){e.setDirty()}},e.prototype.setLightingManager=function(t){this.lightManager=t},e.prototype.getBuilding=function(t){if(t<0)return null;if(0==this.textureBuildingGroups.size&&0==this.extrudeBuildings.length)return null;var e=null;if(0!=this.textureBuildingGroups.size&&this.textureBuildingGroups.forEach(function(n){n.buildings.forEach(function(n){n.getSelectionCode()!=t||(e=n)})}),null==e&&0!=this.extrudeBuildings.length&&this.extrudeBuildings.forEach(function(n){n.getSelectionCode()!=t||(e=n)}),null!=e){var n=new s.MapObject;return n.initWithBuilding(e),n}return null},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},set:function(t){this._timeEffectManager=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.textureBuildingGroups.clear(),this.extrudeBuildings=[]},Object.defineProperty(e.prototype,"filterObjectTypes",{get:function(){return this._filterObjectTypes},set:function(t){this._filterObjectTypes=t,this.dirty=!0},enumerable:!0,configurable:!0}),e.prototype.getSelectedObjectIds=function(){return Array.from(this._selectedObjectMap.keys())},e.prototype.setSelectedObjectIds=function(t){var e=this;this._selectedObjectMap.clear(),t&&(t.forEach(function(t){return e._selectedObjectMap.set(t,!0)}),this.dirty=!0)},e.prototype.isInFilterObjectTypes=function(t){return!this._filterObjectTypes||!this._filterObjectTypes.length||this._filterObjectTypes.length<1||!!t&&this._filterObjectTypes.some(function(e){return-1!==t.indexOf(e)})},e}(r.Layer);e.BuildingLayer=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.buildings=[],this.id=t}return t.prototype.addBuilding=function(t){this.buildings.push(t)},t.prototype.getModel=function(){return 0==this.buildings.length?null:this.buildings[0].getModel()},t}();e.BuildingGroup=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=function(t){function e(e,n,i){var o=t.call(this,e,n,r.LayerType.SYMBOL,i)||this;return o._renderTiles=new Map,o}return i(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},e.prototype.clearRenderTiles=function(){this._renderTiles.clear()},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},set:function(t){this._renderTiles=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerLabel",{get:function(){return this._markerLabel},set:function(t){this._markerLabel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elevation",{get:function(){return this._elevation},set:function(t){this._elevation=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelAnchor",{get:function(){return this._labelAnchor},set:function(t){this._labelAnchor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textLabelData",{get:function(){return this._textLabelData},set:function(t){this._textLabelData=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t},enumerable:!0,configurable:!0}),e}(r.Layer);e.SymbolLayer=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=function(t){function e(e,n,i){var o=t.call(this,e,n,r.LayerType.GEOJSON,i)||this;return o.renderTiles=new Map,o}return i(e,t),e.prototype.update=function(t){},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)?this.renderTiles.get(t).push(e):this.renderTiles.set(t,[e])},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(r.Layer);e.GeoJsonLayer=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(41),r=n(4),o=n(51),a=n(32),s=n(7),l=function(){function t(t){this.userLocationDotId=-1,this.userLocationDot=null,this.lastKnownLocation=null,this.myLocationZoom=17,this.animate=!1,this.defaultPositionOptions={enableHighAccuracy:!0,maximumAge:0,timeout:6e3},this.mapView=t}return t.prototype.updateMapUI=function(t){var e=this;null!=t&&(this.myLocationButton=i.DOMUtils.create("div","mf-button",t),this.myLocationButton.innerHTML="<a class='mf-location'></a>",this.myLocationButton.addEventListener("click",function(){e.onMyLocationButtonClick()}))},t.prototype.moveToMyLocation=function(t){void 0===t&&(t=!0),location.protocol.startsWith("https")||location.host.startsWith("localhost")?(this.animate=t,window.navigator.geolocation.getCurrentPosition(this.onGetCurrentPositionSuccess.bind(this),this.onGetCurrentPositionError.bind(this),this.defaultPositionOptions)):alert("This feature is available only in secure contexts (HTTPS)")},t.prototype.onMyLocationButtonClick=function(){this.moveToMyLocation()},t.prototype.onGetCurrentPositionSuccess=function(t){var e=new r.LatLng(t.coords.latitude,t.coords.longitude);if(this.mapView.moveCamera({target:e,zoom:this.myLocationZoom},{animate:this.animate}),this.lastKnownLocation=e,null==this.userLocationDot){var n=new o.Icon(32,32,"myPosition");this.userLocationDot=new a.Marker({position:e,visible:!0,anchor:new s.Point(.5,.5),icon:n}),this.userLocationDotId=this.mapView.addAnnotation(this.userLocationDot)}else this.userLocationDot.setPosition(e),this.userLocationDot.setVisible(!0)},t.prototype.onGetCurrentPositionError=function(t){-1!=this.userLocationDotId&&(this.mapView.removeAnnotation(this.userLocationDotId),this.userLocationDotId=-1,this.userLocationDot=null)},t}();e.GeolocateControl=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),r=n(33),o=n(52),a=n(50),s=n(17),l=n(1),u=n(39),h=n(40),c=n(32),f=n(15),p=n(116),d=function(){function t(t,e,n){this._id=t,this._eventOptions=e,this._eventCallback=n}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventCallBack",{get:function(){return this._eventCallback},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventOptions",{get:function(){return this._eventOptions},set:function(t){this._eventOptions=t},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t){this.eventIdCounter=0,this.events=new Map,this.geoJsonEvents=new Map,this.mapView=t}return t.convertEventFromName=function(t){switch(t){case"cameraWillChange":return u.MapEvent.cameraWillChange;case"cameraChanging":return u.MapEvent.cameraChanging;case"idle":return u.MapEvent.idle;case"click":return u.MapEvent.click;case"dblClick":return u.MapEvent.dblClick;case"drag":return u.MapEvent.drag;case"dragEnd":return u.MapEvent.dragEnd;case"dragStart":return u.MapEvent.dragStart;case"mouseMove":return u.MapEvent.mouseMove;case"mouseOut":return u.MapEvent.mouseOut;case"mouseOver":return u.MapEvent.mouseOver;case"rightClick":return u.MapEvent.rightClick;case"modeChanged":return u.MapEvent.modeChanged;case"longClick":return u.MapEvent.longClick;case"hover":return u.MapEvent.hover;case"tilesLoaded":return u.MapEvent.tilesLoaded;case"boundsChanged":return u.MapEvent.boundsChanged;default:throw new Error("Event not supported: "+t)}},t.prototype.addGeoJsonListener=function(e,n){var i="string"==typeof e?t.convertEventFromName(e):e,r=this.eventIdCounter++,o=new d(r,{},n);this.geoJsonEvents.has(i)?this.geoJsonEvents.get(i).push(o):this.geoJsonEvents.set(i,[o]);var a=this.geoJsonEvents;return new(function(){function t(){}return t.prototype.remove=function(){if(a.has(i)){var t=a.get(i),e=t.findIndex(function(t){return t.id==r});e>=0&&t.splice(e,1),0===t.length&&a.delete(i)}},t.prototype.updateEventOptions=function(t){},t}())},t.prototype.addEvent=function(e,n,i){var r="string"==typeof e?t.convertEventFromName(e):e,o={};l.MapUtils.extendOptions(o,t.defaultEventOptions,i),o.marker||o.polygon||o.polyline||o.object||o.circle||o.location||o.place||(o.location=!0);var a=this.eventIdCounter++,s=new d(a,o,n);this.events.has(r)?this.events.get(r).push(s):this.events.set(r,[s]);var u=this.events;return new(function(){function e(){}return e.prototype.remove=function(){if(u.has(r)){var t=u.get(r),e=t.findIndex(function(t){return t.id==a});e>=0&&t.splice(e,1),0===t.length&&u.delete(r)}},e.prototype.updateEventOptions=function(e){var n={};l.MapUtils.extendOptions(n,t.defaultEventOptions,e),n.marker||n.polygon||n.polyline||n.object||n.circle||n.location||n.place||(n.location=!0),s.eventOptions=n},e}())},t.prototype.onHoverEvent=function(t,e){if(!this.mapView.getBuildingSelectionIconManager().onHover(t))return this.onEvent(t,e,u.MapEvent.hover);this.mapView.hideInfoWindow()},t.prototype.onClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.click)},t.prototype.onLongClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.longClick)},t.prototype.onRightClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.rightClick)},t.prototype.onDoubleClickEvent=function(t,e){return this.onEvent(t,e,u.MapEvent.dblClick)},t.prototype.onDragEvent=function(t,e,n){if(t==u.MapEvent.dragStart||t==u.MapEvent.drag||t==u.MapEvent.dragEnd){var s=this.events.get(t)||[];if(0!=s.length){var f={};if(n instanceof h.MapObject?(s=s.filter(function(t){return t.eventOptions.object}),f.object=n):n instanceof c.Marker?(s=s.filter(function(t){return t.eventOptions.marker}),f.marker=n):n instanceof r.Polyline?(s=s.filter(function(t){return t.eventOptions.polyline}),f.polyline=n):n instanceof o.Polygon?(s=s.filter(function(t){return t.eventOptions.polygon}),f.polygon=n):n instanceof a.Circle&&(s=s.filter(function(t){return t.eventOptions.circle}),f.circle=n),0!=s.length){var p=this.mapView.getCurrentMousePosition(e),d=new i.Point(p.x,p.y),g=l.MapUtils.pixelToPoint(d);f.location=this.mapView.screenCoordinateToLatLng(p),f.point=g,f.pixel=d,f.xa=e,s.forEach(function(t){return t.eventCallBack(f)})}}}else console.error("Invalid event")},t.prototype.queryMapObjectAndAnnotation=function(t,e,n,s){var u=this.mapView.getCurrentMousePosition(n),f=this.mapView.screenCoordinateToLatLng(u),p=new i.Point(u.x,u.y),d=l.MapUtils.pixelToPoint(p),g=this.mapView.queryMapObjectAndAnnotation(e);if(g instanceof c.Marker){var m=(t||[]).filter(function(t){return t.eventOptions.marker}),y=g;this.mapView.showInfoWindow(y.getId()),m&&0!=m.length&&y.getMap()&&m.forEach(function(t){return t.eventCallBack({marker:y,point:d,pixel:p,xa:n,location:f})})}else if(g instanceof r.Polyline){var v=(t||[]).filter(function(t){return t.eventOptions.polyline});v&&0!=v.length&&v.forEach(function(t){return t.eventCallBack({polyline:g,point:d,pixel:p,xa:n,location:f})})}else if(g instanceof o.Polygon){var b=(t||[]).filter(function(t){return t.eventOptions.polygon});b&&0!=b.length&&b.forEach(function(t){return t.eventCallBack({polygon:g,point:d,pixel:p,xa:n,location:f})})}else if(g instanceof a.Circle){var _=(t||[]).filter(function(t){return t.eventOptions.circle});_&&0!=_.length&&_.forEach(function(t){return t.eventCallBack({circle:g,point:d,pixel:p,xa:n,location:f})})}else if(g instanceof h.MapObject){var w=(t||[]).filter(function(t){return t.eventOptions.object});w&&0!=w.length&&w.forEach(function(t){return t.eventCallBack({object:g,point:d,pixel:p,xa:n,location:f})})}return null!=g},t.prototype.queryPlace=function(t,e,n,r,o){var a=this.mapView.getCurrentMousePosition(n),s=this.mapView.screenCoordinateToLatLng(a),u=new i.Point(a.x,a.y),h=l.MapUtils.pixelToPoint(u),c=this.mapView.queryFeature(e);if(null!=c&&c.getType()==f.GeometryType.Point&&!(o&&!this.mapView.getFeatureManager().hasFeature(c.getId())||!o&&this.mapView.getFeatureManager().hasFeature(c.getId()))){var d=(t||[]).filter(function(t){return t.eventOptions.place}),g=c.getProperties(),m=new p.Place({id:c.getId(),name:g.get("name"),icon:g.get("icon"),location:[g.get("lng"),g.get("lat")]});return d&&d.forEach(function(t){return t.eventCallBack({place:m,point:h,pixel:u,xa:n,location:s})}),!0}return!1},t.prototype.queryGeoJsonFeature=function(t,e,n,r){var o=this.mapView.getCurrentMousePosition(n),a=this.mapView.screenCoordinateToLatLng(o),s=new i.Point(o.x,o.y),u=l.MapUtils.pixelToPoint(s),h=this.geoJsonEvents.get(r);if(h&&h.length>0){var c=this.mapView.getGeoJsonManager().queryFeature(e);if(c)return h.forEach(function(t){return t.eventCallBack({feature:c,point:u,pixel:s,xa:MouseEvent,location:a})}),!0}return!1},t.prototype.onEvent=function(t,e,n){var i=this.events.get(n);if(n==u.MapEvent.click)this.mapView.hideInfoWindow();else if(null==i||0==i.length)return!1;return this.mapView.mapState.is3dMode()?this.queryPlace(i,t,e,n,!0)||this.queryMapObjectAndAnnotation(i,t,e,n)||this.queryGeoJsonFeature(i,t,e,n):this.queryPlace(i,t,e,n,!0)||this.queryMapObjectAndAnnotation(i,t,e,n)||this.queryGeoJsonFeature(i,t,e,n)||this.queryPlace(i,t,e,n,!1)},t.prototype.notify=function(t,e,n){var r=this,o=this.events.get(t);if(o&&Array.isArray(o)&&0!==o.length)switch(t){case u.MapEvent.hover:case u.MapEvent.click:case u.MapEvent.rightClick:case u.MapEvent.dblClick:case u.MapEvent.longClick:case u.MapEvent.dragStart:case u.MapEvent.drag:case u.MapEvent.dragEnd:case u.MapEvent.mouseMove:case u.MapEvent.mouseOut:case u.MapEvent.mouseOver:var a=(o||[]).filter(function(t){return t.eventOptions.location});if(0==a.length)return;var h=this.mapView.getCurrentMousePosition(e),c=new i.Point(h.x,h.y),f=l.MapUtils.pixelToPoint(c);a.forEach(function(t){return t.eventCallBack({location:r.mapView.screenCoordinateToLatLng(h),point:f,pixel:c,xa:e})});break;case u.MapEvent.cameraWillChange:var p=this.mapView.getCamera();o.filter(function(t){return t.eventOptions.location}).forEach(function(t){return t.eventCallBack({camera:new s.CameraPosition(p.getTarget(),p.getTilt(),p.getBearing(),p.getZoom()),gesture:n})});break;case u.MapEvent.cameraChanging:case u.MapEvent.idle:var d=this.mapView.getCamera();o.filter(function(t){return t.eventOptions.location}).forEach(function(t){return t.eventCallBack({camera:new s.CameraPosition(d.getTarget(),d.getTilt(),d.getBearing(),d.getZoom())})});break;case u.MapEvent.modeChanged:o.filter(function(t){return t.eventOptions.location}).forEach(function(t){return t.eventCallBack({is3DMode:r.mapView.mapSettings.is3dMode()})});break;case u.MapEvent.tilesLoaded:case u.MapEvent.boundsChanged:default:o.filter(function(t){return t.eventOptions.location}).forEach(function(t){return t.eventCallBack()})}},t.prototype.destroy=function(){this.events.clear()},t.defaultEventOptions={marker:!1,polygon:!1,polyline:!1,circle:!1,object:!1,location:!1,place:!1},t}();e.MapsEventManager=g},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(87),o=n(18),a=function(t){function e(e,n,i){var r=t.call(this,o.Kind.ANNOTAION,e,i)||this;return r.annotationManager=n,r.annotationManager.addTile(r),r}return i(e,t),e.prototype.destroy=function(){this.layerDatas.forEach(function(t){return t.destroy()}),this.annotationManager.removeTile(this)},e}(r.GeometryTile);e.AnnotationTile=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(36),r=n(37),o=n(31),a=n(25),s=n(0),l=n(19),u=n(35),h=n(74),c=n(13),f=n(6),p=n(9),d=function(){function t(t,e,n,i,r){this.gl=t,this.mapState=n,this.mouseEventHandler=i,this.buildings=new Map,this.hiddenBuildings=new Map,this.invalidatedBuildings=new Map,this.models=new Map,this.textures=new Map,this.buildingTaskManager=e,this.modelRequestsMap=new Map,this.textureRequestsMap=new Map,this.setBuildingLayerDirty=function(){},this.requestRender=r,this.modelBuildingsMap=new Map,this.unhiddenBuildings=[],this.retainHiddenBuildingIds=[]}return t.prototype.hasBuilding=function(t){return this.buildings.has(t)},t.prototype.getBuilding=function(t){return this.buildings.has(t)?this.buildings.get(t):null},t.prototype.getHiddenBuilding=function(t){var e=this.hiddenBuildings.get(t);return e||null},t.prototype.addBuildingWithData=function(t,e,n,i){var a=e.getBuildingType();if((a==o.BuildingType.Extrude||a==o.BuildingType.ExternalExtrude)&&!this.buildings.has(t)){var s=this.invalidatedBuildings.get(t);if(s)return this.buildings.set(t,s),this.invalidatedBuildings.delete(t),this.setBuildingLayerDirty(),void e.destroy();var l=new r.Model(this.gl),u=[].concat.apply([],n);l.init3dObject(u,i);var h=e.getTextureName(),c=this.textures.get(h);null!=c?(c.retain(),e.setTexture(c)):null!=h&&(p.Color.isValid(h)?e.setTexture(this.loadTextureFromColor(h)):e.setTexture(this.requestTexture(h,e.getTextureData()))),e.setModel(l),e.setHighestPosition(e.getLocation()),e.notifyModelDownloaded(),e.retain(),this.buildings.set(t,e),this.setBuildingLayerDirty()}},t.prototype.addBuilding=function(t,e){var n=e.getBuildingType();if(n!=o.BuildingType.Extrude&&n!=o.BuildingType.ExternalExtrude&&!this.buildings.has(t)){var i=this.invalidatedBuildings.get(t);if(i)return this.buildings.set(t,i),this.invalidatedBuildings.delete(t),this.setBuildingLayerDirty(),void e.destroy();e.retain();var a=e.getObjName(),s=this.models.get(a);if(null!=s){s.retain(),e.setModel(s);var l=this.modelBuildingsMap.get(a);l?l.push(e):(e.highestModelPosition=s.getHighestModelPosition(),this.updateBuildingHeight(e))}else{var u=e.getObjData();if(null!=u){var c=new r.Model(this.gl);c.retain(),this.models.set(a,c),e.setModel(c);var f=h.ObjModelLoader.loadModel(u);if(null!=f&&f.length>0){var d=f[0].highestPosition;c.setHighestModelPosition(d),c.minX=f[0].minX,c.minY=f[0].minY,c.minZ=f[0].minZ,c.maxX=f[0].maxX,c.maxY=f[0].maxY,c.maxZ=f[0].maxZ,e.highestModelPosition=d,this.updateBuildingHeight(e),c.init3dObject(f[0].data),e.updateScaledMatrix(this.mapState),this.requestRender()}}else null!=a&&(this.modelBuildingsMap.set(a,[e]),e.setModel(this.requestModel(a)))}var g=e.getTextureName(),m=this.textures.get(g);null!=m?(m.retain(),e.setTexture(m)):null!=g&&(p.Color.isValid(g)?e.setTexture(this.loadTextureFromColor(g)):e.setTexture(this.requestTexture(g,e.getTextureData()))),this.buildings.set(t,e),this.setBuildingLayerDirty()}},t.prototype.setHiddenObject=function(t){var e=this.buildings.get(t);e?(this.hiddenBuildings.set(t,e),this.deleteBuilding(t)):this.retainHiddenBuildingIds.push(t)},t.prototype.setUnhiddenObject=function(t){var e=this.hiddenBuildings.get(t);e?(this.unhiddenBuildings.push(e),this.hiddenBuildings.delete(t)):console.warn("No hidden builing with id : "+t+" to unhide !")},t.prototype.dirty=function(){return this.unhiddenBuildings.length>0},t.prototype.removeAllResources=function(){var t=this;this.invalidatedBuildings.forEach(function(t){return t.destroy()}),this.buildings.forEach(function(t){return t.destroy()}),this.models.forEach(function(t){return t.destroy()}),this.textures.forEach(function(t){return t.destroy()}),this.buildings.clear(),this.invalidatedBuildings.clear(),this.models.clear(),this.textures.clear(),this.modelRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.modelRequestsMap.clear(),this.textureRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.textureRequestsMap.clear()},t.prototype.increaseBuildingReference=function(t){var e=this.buildings.get(t);null!=e?e.retain():console.warn("Can not find any building with id: "+t+" to increase reference !")},t.prototype.decreaseBuildingReference=function(t){var e=this.buildings.get(t);if(null!=e){if(1==e.reference&&this.mouseEventHandler.isHandling)this.invalidatedBuildings.set(e.getId(),e),this.buildings.delete(t);else if(e.release(),!e.reference){var n=e.getBuildingType();if(n!=o.BuildingType.Extrude&&n!=o.BuildingType.ExternalExtrude){var i=e.getObjName();this.decreaseModelReference(i)}var r=e.getTextureName();this.decreaseTextureReference(r),this.buildings.delete(t)}this.setBuildingLayerDirty()}},t.prototype.decreaseTextureReference=function(t){if(null!=t){var e=this.textures.get(t);if(null!=e){if(e.release(),!e.reference){var n=this.textureRequestsMap.get(t);n&&(this.buildingTaskManager.cancelTask(n),this.textureRequestsMap.delete(t)),this.textures.delete(t)}}else console.error("Can not find texture with id: "+t+" for building !")}},t.prototype.decreaseModelReference=function(t){var e=this.models.get(t);if(null!=e){if(e.release(),!e.reference){var n=this.modelRequestsMap.get(t);null!=n&&(this.buildingTaskManager.cancelTask(n),this.modelRequestsMap.delete(t)),this.models.delete(t)}}else console.error("Can not find model with id: "+t+" for building !")},t.prototype.removeBuildings=function(t){var e=this;Array.from(this.buildings.values()).filter(function(e){return null==t||t(e)}).forEach(function(t){e.deleteBuilding(t.getId())})},t.prototype.removeHiddenBuildings=function(){this.hiddenBuildings.clear(),this.retainHiddenBuildingIds=[]},t.prototype.update=function(){var t=this;if(this.retainHiddenBuildingIds.length>0)for(var e=0;e<this.retainHiddenBuildingIds.length;++e){var n=this.retainHiddenBuildingIds[e],i=this.buildings.get(n);i&&(this.hiddenBuildings.set(n,i),this.deleteBuilding(n),this.retainHiddenBuildingIds.splice(e,1))}this.mouseEventHandler.isHandling||0==this.invalidatedBuildings.size||(this.invalidatedBuildings.forEach(function(e){if(e.release(),e.reference)console.warn("The reference must be 0 now...");else{var n=e.getBuildingType();if(n!=o.BuildingType.Extrude&&n!=o.BuildingType.ExternalExtrude){var i=e.getObjName();t.decreaseModelReference(i)}var r=e.getTextureName();t.decreaseTextureReference(r)}}),this.invalidatedBuildings.clear())},t.prototype.deleteBuilding=function(t){var e=this.buildings.get(t);if(null!=e){var n=e.getBuildingType();if(n!=o.BuildingType.Extrude&&n!=o.BuildingType.ExternalExtrude){var i=e.getObjName();this.decreaseModelReference(i)}var r=e.getTextureName();this.decreaseTextureReference(r),e.destroy(),this.buildings.delete(t),this.setBuildingLayerDirty()}},t.prototype.requestModel=function(t){var e=this;if(null==t)return console.error("You do not set Url for Model. Please set first !"),null;var n=new r.Model(this.gl);n.retain(),this.models.set(t,n);var i=null;i=a.UrlUtils.isUrlRequest(t)?t:a.UrlUtils.getBuildingDataUrl(s.MapConstants.baseModelRequestUrl,t,l.MapSettings.getAccessKey());var o=new u.RequestTask(u.Resource.Model);return o.url=i,o.completion=function(i){if(null!=i.data){var r=i.data[0].highestPosition;n.init3dObjectFormArrayBuffer(i.data[0].data),n.setHighestModelPosition(r),n.minX=i.data[0].minX,n.minY=i.data[0].minY,n.minZ=i.data[0].minZ,n.maxX=i.data[0].maxX,n.maxY=i.data[0].maxY,n.maxZ=i.data[0].maxZ;var o=e.modelBuildingsMap.get(t);o&&(o.forEach(function(t){t.highestModelPosition=r,e.updateBuildingHeight(t),t.updateScaledMatrix(e.mapState)}),e.modelBuildingsMap.delete(t)),e.modelRequestsMap.delete(t),e.requestRender()}},this.modelRequestsMap.set(t,o),this.buildingTaskManager.postTask(o),n},t.prototype.loadTextureFromColor=function(t){if(null!=t){var e=new i.Texture(this.gl);return e.retain(),this.textures.set(t,e),e.loadColor(p.Color.fromHex(t)),e}},t.prototype.requestTexture=function(t,e){var n=this,r=new i.Texture(this.gl);if(r.retain(),this.textures.set(t,r),e)r.loadImage(e,this.requestRender);else{var o=null;if(null==t)return r=c.ResourceManager.getInstance(this.gl).getTexture(c.TextureEnum.WHITE_TEXTURE);o=a.UrlUtils.isUrlRequest(t)?t:a.UrlUtils.getBuildingDataUrl(s.MapConstants.baseTextureRequestUrl,t,l.MapSettings.getAccessKey());var h=new u.RequestTask(u.Resource.Texture);h.url=o,h.completion=function(e){if(null!=e.data){r.loadImageFromArrayBuffer(e.data.data,e.data.width,e.data.height,!0,function(){n.textureRequestsMap.delete(t),n.requestRender()})}},this.textureRequestsMap.set(t,h),this.buildingTaskManager.postTask(h)}return r},t.prototype.updateBuildingHeight=function(t){var e=t.highestModelPosition;if(e){var n=t.getLocation(),i=t.getBearing()*s.MathConstants.deg2Rad,r=t.getScale(),o=f.ProjectionMercator.convertToMeterFromLatLng(n);o.y-=Math.cos(i)*e.z*r.y-Math.sin(i)*e.x*r.x,o.x+=Math.cos(i)*e.x*r.x+Math.sin(i)*e.z*r.y,t.setHighestPosition(f.ProjectionMercator.convertToLatLngFromMeter(o)),t.setHeight(e.y*r.z),t.notifyModelDownloaded()}},t.prototype.setColor=function(t,e){var n=this.buildings.get(t);if(null!=n){this.decreaseTextureReference(n.getTextureName());var i=this.textures.get(e);null!=i?(i.retain(),n.setTexture(i)):n.setTexture(this.loadTextureFromColor(e)),n.setTextureName(e),n.setTextureData(null)}},t.prototype.setTextureName=function(t,e){var n=this.buildings.get(t);if(null!=n){this.decreaseTextureReference(n.getTextureName());var i=this.textures.get(e);null!=i?(i.retain(),n.setTexture(i)):n.setTexture(this.requestTexture(e,null)),n.setTextureName(e),n.setTextureData(null)}},t.prototype.setTextureData=function(t,e){var n=this.buildings.get(t);if(null!=n){this.decreaseTextureReference(n.getTextureName());var i=this.textures.get(e.reuseId);if(null!=i)i.retain(),n.setTexture(i),n.setTextureName(e.reuseId);else{var r=e.reuseId||n.getId();n.setTexture(this.requestTexture(r,e.data)),n.setTextureName(r)}}},t.prototype.setCoordinates=function(t,e,n){var i=this.buildings.get(t);if(null!=i){var o=i.getModel();o&&o.destroy(),o=new r.Model(this.gl);var a=[].concat.apply([],n.vertices);o.init3dObject(a,n.indices),i.setModel(o),i.setCoordinates(e)}},t}();e.BuildingResourceManager=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(244),r=n(246),o=n(2),a=n(0),s=n(119),l=n(247),u=n(35),h=function(){function t(t,e,n){this._particleSystems=[],this.weatherTaskManager=n,this.mapState=e,this._liveMode=!1,this._weather=s.Weather.Sunny,this._particlePool=new l.ParticlePool;var o=new i.ParticleRain(t,this._particlePool);o.init(),this._particleSystems.push(o);var a=new r.ParticleSnow(t,this._particlePool);a.init(),this._particleSystems.push(a),this._lastTime=NaN}return t.prototype.setWeather=function(t){t===this._weather||this._liveMode&&t===s.Weather.Live||(t==s.Weather.Live?(this._liveMode=!0,this._lastTimeGetLive=Date.now(),this._lastLocationGetLive=this.mapState.getTarget(),this.getLiveInfomation()):this._liveMode=!1,t<s.Weather.Sunny&&this._particleSystems[t].cleanup(),this._weather=t,this._lastTime=NaN)},t.prototype.setWeatherFromLive=function(t){t<s.Weather.Sunny&&this._particleSystems[t].cleanup(),this._weather=t,this._lastTime=NaN},t.prototype.getWeather=function(){return this._weather},t.prototype.dirty=function(){return this.mapState.is3dMode()&&(this._liveMode||this.getWeather()!=s.Weather.None&&this.getWeather()!=s.Weather.Sunny&&this.getWeather()!=s.Weather.Cloudy)},t.prototype.getLiveInfomation=function(){var e=this,n=a.MapConstants.getWeatherDataUrl(this.mapState.getTarget().lat,this.mapState.getTarget().lng);this.requestTask&&this.weatherTaskManager.cancelTask(this.requestTask),this.requestTask=new u.RequestTask(u.Resource.Json);var i=this.requestTask;i.url=n,i.completion=function(n){null!=n.data&&null!=n.data.result&&null!=n.data.result.type?e.setWeatherFromLive(t.convertToWeather(n.data.result.type)):console.error("Can not get weather from server because response data invalid !")},this.weatherTaskManager.postTask(i)},t.prototype.update=function(){if(this.dirty()){if(this._weather<s.Weather.Sunny){var t=Date.now(),e=isNaN(this._lastTime)?0:t-this._lastTime;this._lastTime=t,this._particleSystems[this._weather].update(e/1e3)}if(this._liveMode){t=Date.now();var n=this.mapState.getTarget();(n.distanceTo(this._lastLocationGetLive)>a.WeatherConstants.refreshDistance||t-this._lastTimeGetLive>a.WeatherConstants.refreshTime)&&(this._lastLocationGetLive=n,this._lastTimeGetLive=t,this.getLiveInfomation())}}},t.prototype.render=function(t){this.dirty()&&this._weather<s.Weather.Sunny&&this._particleSystems[this._weather].render(t)},t.prototype.resize=function(t,e){for(var n=0;n<s.Weather.Sunny;++n){var i=0;n==s.Weather.Rainy&&(i=Math.abs(Math.tan(a.ParticleConstants.rainParticleRotation*a.MathConstants.deg2Rad))*e);var r=t+i;this._particleSystems[n].spawnRect={width:r,height:2},this._particleSystems[n].emitterPosition=new o.Vector2(t/2-i/2,0),this._particleSystems[n].lifetimeFunc=function(n){return n.position.y>e||n.position.x>t}}},t.convertToWeather=function(t){var e=NaN;switch(t){case 0:e=s.Weather.Sunny;break;case 1:e=s.Weather.Rainy;break;case 2:e=s.Weather.Snowy;break;case 3:e=s.Weather.Cloudy;break;default:e=s.Weather.None}return e},t.prototype.destroy=function(){for(var t=0;t<s.Weather.Sunny;++t)this._particleSystems[t].destroy();for(;0!=this._particleSystems.length;)this._particleSystems.pop();this._particleSystems=null,this._particlePool.destroy(),this._particlePool=null},t}();e.WeatherManager=h},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(118),o=n(13),a=n(2),s=n(0),l=function(t){function e(e,n){var i=o.ResourceManager.getInstance(e),r=i.getShader(o.ShaderEnum.PARTICLE_SHADER),a=i.getTexture(o.TextureEnum.RAIN_TEXTURE);return t.call(this,e,r,a,n)||this}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:s.ParticleConstants.rainFrequency,maxParticles:1e3,acceleration:new a.Vector2(0,1e3).rotateBy(s.ParticleConstants.rainParticleRotation),minSpeed:0,maxSpeed:1e3,minScale:.35,maxScale:.35,maxRotation:s.ParticleConstants.rainParticleRotation,minRotation:s.ParticleConstants.rainParticleRotation})},e}(r.ParticleSystemQuad);e.ParticleRain=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=function(){function t(t){this._particlePool=t,this._acceleration=null,this._frequency=1,this._maxParticles=1e3,this._minSpeed=0,this._maxSpeed=0,this._minScale=1,this._maxScale=1,this._minLifetime=0,this._maxLifetime=0,this._minRotation=0,this._maxRotation=0,this._minRotationSpeed=0,this._maxRotationSpeed=0,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._emitterPosition=new i.Vector2(0,0),this._activeParticlesFirst=null,this._activeParticlesLast=null,this._spawnRect=null,this._spawnTimer=0,this._particleCount=0}return t.prototype.init=function(t){this.cleanup(),t.frequency&&(this._frequency=t.frequency),t.maxParticles&&(this._maxParticles=t.maxParticles>0?t.maxParticles:1e3);var e=t.acceleration;e&&(e.x||e.y)&&(this._acceleration=new i.Vector2(e.x,e.y)),t.minSpeed&&(this._minSpeed=t.minSpeed),t.maxSpeed&&(this._maxSpeed=t.maxSpeed),t.minScale&&(this._minScale=t.minScale),t.maxScale&&(this._maxScale=t.maxScale),t.maxRotation&&(this._maxRotation=t.maxRotation),t.minRotation&&(this._minRotation=t.minRotation),t.minRotationSpeed&&(this._minRotationSpeed=t.minRotationSpeed),t.maxRotationSpeed&&(this._maxRotationSpeed=t.maxRotationSpeed),t.minLifetime&&(this._minLifetime=t.minLifetime),t.maxLifetime&&(this._maxLifetime=t.maxLifetime),t.extraData&&(this._extraData=t.extraData),t.updateFunc&&(this._updateFunc=t.updateFunc),t.lifetimeFunc&&(this._lifetimeFunc=t.lifetimeFunc),t.spawnRect&&(this._spawnRect=t.spawnRect),this._spawnTimer=0},t.prototype.update=function(e){var n,r;for(n=this._activeParticlesFirst;n;n=r)r=n.next,n.update(e);for(this._spawnTimer-=e<0?0:e;this._spawnTimer<=0;)if(this._particleCount>=this._maxParticles)this._spawnTimer+=this._frequency;else{var o=void 0;o=this._lifetimeFunc?0:Math.random()*(this._maxLifetime-this._minLifetime)+this._minLifetime;var a=this._emitterPosition.x,s=this._emitterPosition.y,l=this._particlePool.acquire(this);if(l.acceleration=this._acceleration?new i.Vector2(this._acceleration.x,this._acceleration.y):null,l.scale=(this._maxScale-this._minScale)*Math.random()+this._minScale,l.maxLife=o,l.lifetimeFunc=this._lifetimeFunc,l.velocity=new i.Vector2(0,(this._maxSpeed-this._minSpeed)*Math.random()+this._minSpeed),l.rotation=(this._maxRotation-this._minRotation)*Math.random()+this._minRotation,l.rotationSpeed=(this._maxRotationSpeed-this._minRotationSpeed)*Math.random()+this._minRotationSpeed,l.extraData=t.deepClone(this._extraData),l.updateFunc=this._updateFunc,this._spawnRect&&this._spawnRect.width&&this._spawnRect.height){var u=Math.random()*this._spawnRect.width,h=Math.random()*this._spawnRect.height;l.position=new i.Vector2(a+u-this._spawnRect.width/2,s+h-this._spawnRect.height/2)}else l.position=new i.Vector2(a,s);l.init(),this._activeParticlesLast?(this._activeParticlesLast.next=l,l.prev=this._activeParticlesLast,this._activeParticlesLast=l):this._activeParticlesLast=this._activeParticlesFirst=l,++this._particleCount,this._spawnTimer+=this._frequency}},t.prototype.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t==this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t==this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),this._particlePool.release(t),--this._particleCount},t.prototype.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t);this._activeParticlesFirst=this._activeParticlesLast=null,this._particleCount=0},t.prototype.destroy=function(){this.cleanup(),this._particlePool=null,this._lifetimeFunc=null,this._spawnRect=null,this._extraData=null,this._updateFunc=null},Object.defineProperty(t.prototype,"particleCount",{get:function(){return this._particleCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"emitterPosition",{set:function(t){this._emitterPosition=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spawnRect",{set:function(t){this._spawnRect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),t.deepClone=function(t){var e={};for(var n in t)e[n]=t[n];return e},t}();e.ParticleSystem=r},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(118),o=n(13),a=n(2),s=n(0),l=function(t){function e(e,n){var i=o.ResourceManager.getInstance(e),r=i.getShader(o.ShaderEnum.PARTICLE_SHADER),a=i.getTexture(o.TextureEnum.SNOW_TEXTURE);return t.call(this,e,r,a,n)||this}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:s.ParticleConstants.snowFrequency,maxParticles:1e3,acceleration:new a.Vector2(0,50),minSpeed:50,maxSpeed:200,minScale:.25,maxScale:.35,maxRotation:0,minRotation:0,minRotationSpeed:0,maxRotationSpeed:200,extraData:{counter:0},updateFunc:function(t,e){t.acceleration&&(t.velocity.y+=t.acceleration.y*e),0!==t.rotationSpeed&&(t.rotation+=t.rotationSpeed*e),t.extraData.counter+=4,t.position.x+=2*Math.cos(t.extraData.counter*s.MathConstants.deg2Rad),t.position.y+=t.velocity.y*e}})},e}(r.ParticleSystemQuad);e.ParticleSnow=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(248),r=function(){function t(){}return t.prototype.acquire=function(t){var e;return this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null,e.emitter=t):e=new i.Particle(t),e},t.prototype.release=function(t){t.prev=null,t.next=this._poolFirst,this._poolFirst=t},t.prototype.destroy=function(){for(var t,e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=null},t}();e.ParticlePool=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=function(){function t(t){this._emitter=t,this._position=new i.Vector2(0,0),this._scale=1,this._velocity=new i.Vector2(0,0),this._rotation=0,this._rotationSpeed=0,this._acceleration=null,this._extraData=null,this._updateFunc=null,this._maxLife=0,this._age=0}return t.prototype.update=function(t){if(this._age+=t,this._lifetimeFunc){if(this._lifetimeFunc(this))return void this.kill()}else if(this._age>=this._maxLife||this._age<0)return void this.kill();this._updateFunc?this._updateFunc(this,t):(this._acceleration&&(this._velocity.x+=this._acceleration.x*t,this._velocity.y+=this._acceleration.y*t),0!==this._rotationSpeed&&(this._rotation+=this._rotationSpeed*t),this._position.x+=this._velocity.x*t,this._position.y+=this._velocity.y*t)},t.prototype.init=function(){this._age=0,this._velocity=this._velocity.rotateBy(this._rotation)},t.prototype.destroy=function(){this._emitter=null,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._next=null,this._prev=null},t.prototype.kill=function(){this._emitter.recycle(this)},Object.defineProperty(t.prototype,"emitter",{set:function(t){this._emitter=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationSpeed",{get:function(){return this._rotationSpeed},set:function(t){this._rotationSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLife",{set:function(t){this._maxLife=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateFunc",{set:function(t){this._updateFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceleration",{get:function(){return this._acceleration},set:function(t){this._acceleration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraData",{get:function(){return this._extraData},set:function(t){this._extraData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){return this._prev},set:function(t){this._prev=t},enumerable:!0,configurable:!0}),t}();e.Particle=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(250),r=n(251),o=n(14),a=n(12),s=n(9),l=function(){function t(t){this._lastUpdateTime=0,this._sunLight=new r.DirectionalLight(s.Color.fromHex("FFFFFF"),new o.Vector3(0,0,1)),this._timeEffectManager=t,this._oldTimeEffect=this._timeEffectManager.getTimeEffect()}return t.prototype.update=function(t){var e=(new Date).getTime();if(!(e-this._lastUpdateTime<6e4&&this._oldTimeEffect==this._timeEffectManager.getTimeEffect())){this._lastUpdateTime=e,this._oldTimeEffect=this._timeEffectManager.getTimeEffect();var n=i.getPosition(this._timeEffectManager.getTime(),t.lat,t.lng),r=-1*n.azimuth,s=a.MathUtils.clamp(Math.abs(n.altitude),Math.PI/6,Math.PI/2);this._sunLight.lightColor=this._timeEffectManager.getBuildingColor(),this._sunLight.lightPosition=new o.Vector3(Math.cos(s)*Math.sin(r),Math.cos(s)*Math.cos(r),Math.sin(s)),this._onLightPositionChanged&&this._onLightPositionChanged()}},t.prototype.setOnLightPositionChanged=function(t){this._onLightPositionChanged=t},Object.defineProperty(t.prototype,"sunLight",{get:function(){return this._sunLight},enumerable:!0,configurable:!0}),t}();e.LightingManager=l},function(t,e,n){!function(){"use strict";var e=Math.PI,n=Math.sin,i=Math.cos,r=Math.tan,o=Math.asin,a=Math.atan2,s=Math.acos,l=e/180,u=864e5,h=2440588,c=2451545;function f(t){return new Date((t+.5-h)*u)}function p(t){return function(t){return t.valueOf()/u-.5+h}(t)-c}var d=23.4397*l;function g(t,e){return a(n(t)*i(d)-r(e)*n(d),i(t))}function m(t,e){return o(n(e)*i(d)+i(e)*n(d)*n(t))}function y(t,e,o){return a(n(t),i(t)*n(e)-r(o)*i(e))}function v(t,e,r){return o(n(e)*n(r)+i(e)*i(r)*i(t))}function b(t,e){return l*(280.16+360.9856235*t)-e}function _(t){return l*(357.5291+.98560028*t)}function w(t){return t+l*(1.9148*n(t)+.02*n(2*t)+3e-4*n(3*t))+102.9372*l+e}function M(t){var e=w(_(t));return{dec:m(e,0),ra:g(e,0)}}var x={getPosition:function(t,e,n){var i=l*-n,r=l*e,o=p(t),a=M(o),s=b(o,i)-a.ra;return{azimuth:y(s,r,a.dec),altitude:v(s,r,a.dec)}}},A=x.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];x.addTime=function(t,e,n){A.push([t,e,n])};var T=9e-4;function S(t,n,i){return T+(t+n)/(2*e)+i}function E(t,e,i){return c+t+.0053*n(e)-.0069*n(2*i)}function C(t,e,r,o,a,l,u){return E(S(function(t,e,r){return s((n(t)-n(e)*n(r))/(i(e)*i(r)))}(t,r,o),e,a),l,u)}function L(t){var e=l*(134.963+13.064993*t),r=l*(93.272+13.22935*t),o=l*(218.316+13.176396*t)+6.289*l*n(e),a=5.128*l*n(r),s=385001-20905*i(e);return{ra:g(o,a),dec:m(o,a),dist:s}}function P(t,e){return new Date(t.valueOf()+e*u/24)}x.getTimes=function(t,n,i){var r,o,a,s,u,h=l*-i,c=l*n,d=function(t,n){return Math.round(t-T-n/(2*e))}(p(t),h),g=S(0,h,d),y=_(g),v=w(y),b=m(v,0),M=E(g,y,v),x={solarNoon:f(M),nadir:f(M-.5)};for(r=0,o=A.length;r<o;r+=1)u=M-((s=C((a=A[r])[0]*l,h,c,b,d,y,v))-M),x[a[1]]=f(u),x[a[2]]=f(s);return x},x.getMoonPosition=function(t,e,o){var s=l*-o,u=l*e,h=p(t),c=L(h),f=b(h,s)-c.ra,d=v(f,u,c.dec),g=a(n(f),r(u)*i(c.dec)-n(c.dec)*i(f));return d+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(d),{azimuth:y(f,u,c.dec),altitude:d,distance:c.dist,parallacticAngle:g}},x.getMoonIllumination=function(t){var e=p(t||new Date),r=M(e),o=L(e),l=s(n(r.dec)*n(o.dec)+i(r.dec)*i(o.dec)*i(r.ra-o.ra)),u=a(149598e3*n(l),o.dist-149598e3*i(l)),h=a(i(r.dec)*n(r.ra-o.ra),n(r.dec)*i(o.dec)-i(r.dec)*n(o.dec)*i(r.ra-o.ra));return{fraction:(1+i(u))/2,phase:.5+.5*u*(h<0?-1:1)/Math.PI,angle:h}},x.getMoonTimes=function(t,e,n,i){var r=new Date(t);i?r.setUTCHours(0,0,0,0):r.setHours(0,0,0,0);for(var o,a,s,u,h,c,f,p,d,g,m,y,v,b=.133*l,_=x.getMoonPosition(r,e,n).altitude-b,w=1;w<=24&&(o=x.getMoonPosition(P(r,w),e,n).altitude-b,p=((h=(_+(a=x.getMoonPosition(P(r,w+1),e,n).altitude-b))/2-o)*(f=-(c=(a-_)/2)/(2*h))+c)*f+o,g=0,(d=c*c-4*h*o)>=0&&(m=f-(v=Math.sqrt(d)/(2*Math.abs(h))),y=f+v,Math.abs(m)<=1&&g++,Math.abs(y)<=1&&g++,m<-1&&(m=y)),1===g?_<0?s=w+m:u=w+m:2===g&&(s=w+(p<0?y:m),u=w+(p<0?m:y)),!s||!u);w+=2)_=a;var M={};return s&&(M.rise=P(r,s)),u&&(M.set=P(r,u)),s||u||(M[p>0?"alwaysUp":"alwaysDown"]=!0),M},t.exports=x}()},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(e,n){var i=t.call(this,e)||this;return i._lightPosition=n,i}return i(e,t),Object.defineProperty(e.prototype,"lightPosition",{get:function(){return this._lightPosition},set:function(t){this._lightPosition=t},enumerable:!0,configurable:!0}),e}(n(252).Light);e.DirectionalLight=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this._lightColor=t}return Object.defineProperty(t.prototype,"lightColor",{get:function(){return this._lightColor},set:function(t){this._lightColor=t},enumerable:!0,configurable:!0}),t}();e.Light=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(117),r=n(11),o=n(14),a=n(1),s=n(0),l=n(9),u=function(){function t(t,e,n){this._gl=t,this._directionalLight=e,this._mapState=n,this._lightProjectionMatrix=r.Matrix4.ortho(-10,10,-10,10,-10,20),this.resize(n.screenWidth,n.screenHeight)}return t.prototype.bind=function(){this._frameBuffer.bind(),this._gl.viewport(0,0,this._width,this._height),this._gl.clearColor(1,1,1,1),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT);var t=l.Color.fromHex(this._mapState.is3dMode()?s.MapConstants.mapBackgroundColor3D:s.MapConstants.mapBackgroundColor2D);this._gl.clearColor(t.red,t.green,t.blue,1)},t.prototype.unbind=function(){this._frameBuffer.unbind(),this._gl.viewport(0,0,this._mapState.screenWidth,this._mapState.screenHeight)},t.prototype.clear=function(){this.bind(),this.unbind()},t.prototype.getLightViewProjectionMatrix=function(){return this._lightViewProjectionMatrix},t.prototype.getShadowMapTexture=function(){return this._frameBuffer.colorTexture},t.prototype.resize=function(t,e){this._width=1.5*t,this._height=1.5*e,this._frameBuffer&&this._frameBuffer.destroy(),this._frameBuffer=new i.FrameBuffer(this._gl,this._width,this._height),this.updateMatrices(),this.clear()},t.prototype.updateMatrices=function(){var t=a.MapUtils.getTileSize(),e=s.CameraConstants.height*Math.tan(s.CameraConstants.fov/2)*t/this._mapState.screenHeight/(t/2),n=r.Matrix4.lookAt(this._directionalLight.lightPosition,new o.Vector3(0,0,0),1,new o.Vector3(0,1,0));n=r.Matrix4.scale(e,e,e).concat(n),this._lightViewProjectionMatrix=n.concat(this._lightProjectionMatrix)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.renderDebug=function(){this._frameBuffer.drawDebug()},t.prototype.destroy=function(){this._frameBuffer.destroy(),this._frameBuffer=null,this._directionalLight=null,this._gl=null,this._mapState=null,this._lightViewProjectionMatrix=null,this._lightProjectionMatrix=null},t}();e.ShadowMap=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(75),r=n(0),o=n(9),a=function(){function t(t){this._timeArray=[r.TimeConstants.morningTime,r.TimeConstants.noonTime,r.TimeConstants.afterNoonTime,r.TimeConstants.eveningTime],this.defaultTimeByString="Noon",this.mapState=t,this._timeEffect=i.TimeEffect.Noon}return t.prototype.dirty=function(){return this.mapState.is3dMode()&&this._timeEffect==i.TimeEffect.Live},t.prototype.getTimeEffect=function(){return this._timeEffect},t.prototype.getTime=function(){return this._timeEffect==i.TimeEffect.Live||null==this._time?(new Date).getTime():this._time},t.prototype.setTimeEffect=function(t){if(null!=t){if(this._timeEffect!=t){this._timeEffect=t;var e=new Date;switch(t){case i.TimeEffect.Live:this._time=null;break;case i.TimeEffect.Morning:this._time=e.setHours(r.TimeConstants.morningTime,0,0,0);break;case i.TimeEffect.Noon:case i.TimeEffect.None:this._time=e.setHours(r.TimeConstants.noonTime,0,0,0);break;case i.TimeEffect.AfterNoon:this._time=e.setHours(r.TimeConstants.afterNoonTime,0,0,0);break;case i.TimeEffect.Evening:this._time=e.setHours(r.TimeConstants.eveningTime,0,0,0)}}}else console.error("TimeEffect value is invalid, please set again !")},t.prototype.getSkyColor=function(){if(this._timeEffect==i.TimeEffect.None)return r.ColorConstants.getSkyColor(this.defaultTimeByString);var e=null,n=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case i.TimeEffect.Live:e=this.getSkyColorByTime();break;case i.TimeEffect.Morning:case i.TimeEffect.AfterNoon:case i.TimeEffect.Evening:e=r.ColorConstants.getSkyColor(n);break;default:e=r.ColorConstants.getSkyColor(this.defaultTimeByString)}return e},t.prototype.getFogColor=function(){if(this._timeEffect==i.TimeEffect.None)return r.ColorConstants.getFogColor(this.defaultTimeByString);var e=null,n=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case i.TimeEffect.Live:e=this.getFogColorByTime();break;case i.TimeEffect.Morning:case i.TimeEffect.Noon:case i.TimeEffect.AfterNoon:case i.TimeEffect.Evening:e=r.ColorConstants.getFogColor(n);break;default:e=r.ColorConstants.getFogColor(this.defaultTimeByString)}return e},t.prototype.getSkyColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),n=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){n=o.Color.mix(r.ColorConstants.getSkyColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a)),r.ColorConstants.getSkyColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==n&&e>r.TimeConstants.eveningTime||null==n&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getSkyColor(t.getStringByTimeEffect(i.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),n=o.Color.mix(r.ColorConstants.getSkyColor("Morning"),r.ColorConstants.getSkyColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return n},t.prototype.getFogColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),n=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){n=o.Color.mix(r.ColorConstants.getFogColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a)),r.ColorConstants.getFogColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==n&&e>r.TimeConstants.eveningTime||null==n&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getFogColor(t.getStringByTimeEffect(i.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),n=o.Color.mix(r.ColorConstants.getFogColor("Morning"),r.ColorConstants.getFogColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return n},t.getStringByTimeEffect=function(t){switch(t){case i.TimeEffect.Live:return"Live";case i.TimeEffect.Morning:return"Morning";case i.TimeEffect.Noon:return"Noon";case i.TimeEffect.AfterNoon:return"AfterNoon";case i.TimeEffect.Evening:return"Evening";default:return null}},t.prototype.isEveningTime=function(){var t=new Date(this.getTime()).getHours();return t>=r.TimeConstants.eveningTime||t<r.TimeConstants.morningTime},t.prototype.getBuildingColor=function(){if(this._timeEffect==i.TimeEffect.None)return r.ColorConstants.getSkyColor(this.defaultTimeByString);var e=null,n=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case i.TimeEffect.Live:e=this.getLightColorByTime();break;case i.TimeEffect.Morning:case i.TimeEffect.AfterNoon:case i.TimeEffect.Evening:e=r.ColorConstants.getLightColor(n);break;default:e=r.ColorConstants.getLightColor(this.defaultTimeByString)}return e},t.prototype.getLightColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),n=null,a=0;a<this._timeArray.length-1;++a)if(e>this._timeArray[a]&&e<=this._timeArray[a+1]){n=o.Color.mix(r.ColorConstants.getLightColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a)),r.ColorConstants.getLightColor(t.getStringByTimeEffect(i.TimeEffect.Morning+a+1)),(this._timeArray[a+1]-e)/(this._timeArray[a+1]-this._timeArray[a]));break}if(null==n&&e>r.TimeConstants.eveningTime||null==n&&e<=r.TimeConstants.morningTime){if(e>=r.TimeConstants.eveningTime||e<r.TimeConstants.morningTime-2)return r.ColorConstants.getLightColor(t.getStringByTimeEffect(i.TimeEffect.Evening));var s=e;e<=r.TimeConstants.morningTime&&(s+=24),n=o.Color.mix(r.ColorConstants.getSkyColor("Morning"),r.ColorConstants.getSkyColor("Evening"),(s-r.TimeConstants.eveningTime)/(24-(r.TimeConstants.eveningTime-r.TimeConstants.morningTime)))}return n},t}();e.TimeEffectManager=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return t.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},t.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n++){var r=i[n];if(r.id===t)return void(r.cancelled=!0)}},t.prototype.run=function(){this._currentlyRunning&&console.log("Task is currently running");var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e++){var i=n[e];if(!i.cancelled&&(i.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},t.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]},t}();e.TaskQueue=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(84),o=n(11),a=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.getViewMatrix=function(){return this.viewMatrix},e.prototype.updateMatrices=function(t){this.viewMatrix=o.Matrix4.translate(0,1-2*t.getSkyRatio(),-1),this.mvpMatrix=this.viewMatrix.concat(t.getProjectionMatrix())},e.prototype.destroy=function(){},e}(r.Object3D);e.SkyObject=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),r=n(10),o=function(){function t(t,e){this.gl=t,this.timeEffectManager=e}return t.prototype.render=function(t,e){if(null!=t&&null!=t.getMvpMatrix()){this.gl.enable(this.gl.DEPTH_TEST);var n=i.ResourceManager.getInstance(this.gl),o=n.getShader(i.ShaderEnum.SKY_SHARDER),a=n.getModel(i.ModelEnum.SKY_MODEL);o.bind();var s=1-2*e.getSkyRatio(),l=s+e.screenHeight/e.screenHeight/2,u=this.timeEffectManager.getSkyColor(),h=this.timeEffectManager.getFogColor();o.setUniforms([new r.UniformInfo("u_lowerLimit","1f",s),new r.UniformInfo("u_upperLimit","1f",l),new r.UniformInfo("u_viewMatrix","matrix",t.getViewMatrix()),new r.UniformInfo("u_mvpMatrix","matrix",t.getMvpMatrix()),new r.UniformInfo("u_skyColor","3fv",u.rgbBuffer()),new r.UniformInfo("u_fogColor","3fv",h.rgbBuffer())]),a.bind(),o.setAttributes(a.attributeInfos),a.render(this.gl.TRIANGLES),a.unbind(),this.gl.disable(this.gl.DEPTH_TEST)}else console.warn("Can not render because skyObject is null !")},t}();e.SkyRenderer=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this._shadowMap=t,this._enableShadowEffect=!1,this._enableWaterEffect=!1}return Object.defineProperty(t.prototype,"enableWaterEffect",{get:function(){return this._enableWaterEffect},set:function(t){this._enableWaterEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableShadowEffect",{get:function(){return this._enableShadowEffect},set:function(t){this._enableShadowEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowMap",{get:function(){return this._shadowMap},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e){this._shadowMap.resize(t,e)},t.prototype.dirty=function(){return this.enableWaterEffect},t.prototype.destroy=function(){this._shadowMap.destroy(),this._shadowMap=null},t}();e.EffectManager=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(55),r=n(7),o=n(93),a=n(41),s=n(8),l=n(11),u=n(10),h=n(13),c=n(1),f=n(21),p=n(0),d=function(){function t(t,e,n){this._position=t,this._elevation=e,this._buildingInformation=n}return Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"elevation",{get:function(){return this._elevation},set:function(t){this._elevation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buildingInformation",{get:function(){return this._buildingInformation},set:function(t){this._buildingInformation=t},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t,e){this.selectionBuildingIdIconMap=new Map,this.mapView=e,this.gl=t,this.iconSelectionWidth=16*c.MapUtils.pixelScale,this.iconSelectionHeight=20*c.MapUtils.pixelScale,this.iconSelectionTexture=f.SymbolResourceManager.getInstance(this.gl).acquire(p.SymbolConstants.selectionSymbol),this.iconSelectionAnchor=new r.Point(.5,1),this.iconSelelectionWindowAnchor=new r.Point(.5,0)}return t.prototype.addBuilding=function(t){var e=new d(t.getLocation(),t.getElevation()+t.getHeight(),t.getName());this.selectionBuildingIdIconMap.set(t.getId(),e)},t.prototype.updateBuilding=function(t){var e=this.selectionBuildingIdIconMap.get(t.getId());e&&(e.position=t.getLocation(),e.buildingInformation=t.getName(),e.elevation=t.getElevation()+t.getHeight())},t.prototype.removeBuilding=function(t){this.selectionBuildingIdIconMap.delete(t)||console.warn("selection symbol does not exist- buildingId: "+t)},t.prototype.onHover=function(t){var e=this,n=Array.from(this.selectionBuildingIdIconMap.values()).some(function(n){return!!i.CollisionUtils.pointIntersectsSymbol(new r.Point(t.x,t.y),n.position,n.elevation,e.iconSelectionWidth,e.iconSelectionHeight,e.iconSelectionAnchor,e.mapView.mapState)&&(e.showSelectionSymbolInfoWindow(n),!0)});return n||this.deselectInfoWindow(),n},t.prototype.deselectInfoWindow=function(){this.selectedSymbol=null,this.infoContentsContainer&&(this.infoWindowContainer.style.visibility="hidden")},t.prototype.render=function(t){var e=this,n=h.ResourceManager.getInstance(this.gl),i=n.getShader(h.ShaderEnum.SYMBOL_SHADER),r=n.getModel(h.ModelEnum.SYMBOL_MODEL);i.bind(),r.bind(),i.setAttributes(r.attributeInfos);var o=t.cameraPosition,a=t.getScreenSize();Array.from(this.selectionBuildingIdIconMap.values()).forEach(function(n){var h=e.mapView.mapState.is3dMode()?n.elevation:0,c=s.GeometryUtils.latLngToScreenCoordinate(n.position,h,o,a),f=l.Matrix4.translate(c.x,c.y,0);f=l.Matrix4.translate((.5-e.iconSelectionAnchor.x)*e.iconSelectionWidth,(.5-e.iconSelectionAnchor.y)*e.iconSelectionHeight,0).concat(f);var p=(f=l.Matrix4.scale(e.iconSelectionWidth/2,e.iconSelectionHeight/2,1).concat(f)).concat(t.getOrthoProjectionMatrix());i.setUniforms([new u.UniformInfo("u_mvpMatrix","matrix",p),new u.UniformInfo("u_texture","texture",e.iconSelectionTexture)]),r.render(e.gl.TRIANGLES)}),r.unbind(),this.updateInfoWindowPosition()},t.prototype.destroy=function(){this.selectionBuildingIdIconMap.clear(),this.selectionBuildingIdIconMap=null,this.mapView=null,this.selectedSymbolInfoWindow=null,this.infoWindowContainer=null,this.infoContentsContainer=null,this.selectedSymbol=null,this.iconSelectionTexture=null,f.SymbolResourceManager.getInstance(this.gl).release(p.SymbolConstants.selectionSymbol)},t.prototype.updateInfoWindowPosition=function(){if(this.selectedSymbol){var t=this.selectedSymbolInfoWindow.getPosition(this.selectedSymbol.position,this.selectedSymbol.elevation,this.iconSelectionWidth,this.iconSelectionHeight,this.iconSelectionAnchor,this.mapView.mapState),e=t.x,n=t.y,i=this.infoWindowContainer.style;i.top=n.toString()+"px",i.left=e.toString()+"px","hidden"==i.visibility&&(i.visibility="visible")}},t.prototype.showSelectionSymbolInfoWindow=function(t){this.selectedSymbol=t;var e=this.getInfoWindowHTMLElement(t.buildingInformation);this.selectedSymbolInfoWindow=new o.InfoWindow(e,this.iconSelelectionWindowAnchor),this.updateInfoWindowPosition()},t.prototype.getInfoWindowHTMLElement=function(t){return this.infoContentsContainer||(this.infoContentsContainer||(this.infoWindowContainer=a.DOMUtils.create("div","mf-info-window-container",this.mapView.getMapContainer())),this.infoContentsContainer=a.DOMUtils.create("div","mf-info-window-content mf-scrollbar",this.infoWindowContainer)),this.infoContentsContainer.innerHTML="<p> "+t+" </p>",this.infoContentsContainer},t}();e.BuildingIconSelectionManager=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),r=n(80),o=n(34),a=n(8),s=n(6),l=n(2),u=n(20),h=n(0),c=n(35),f=n(25),p=n(19),d=n(74),g=n(261),m=n(4),y=n(7),v=n(262),b=function(){function t(t){this._coverPoints=null,this._points=null,this._hasBounds=!1,this._mapObject=t,this.updateBounds(),this._hasBounds=!1}return t.prototype.updateBoundsFromLatLngBounds=function(t){var e=t.getSouthwest(),n=t.getNortheast();if(!this._boundingBox){var i=this._mapObject.getScale();if(i>0){var r=this.mapObject.getMap().mapView.mapState.getScale(),o=s.ProjectionMercator.projectScale(e,r),a=s.ProjectionMercator.projectScale(n,r),u=s.ProjectionMercator.projectScale(this.mapObject.getLocation(),r),h=new l.Vector2(a.x-u.x,u.y-a.y),c=new l.Vector2(u.x-o.x,o.y-u.y),f=new l.Vector2(u.x+i*h.x,u.y-i*h.y),p=new l.Vector2(u.x-i*c.x,u.y+i*c.y);n=s.ProjectionMercator.unproject(f,r),e=s.ProjectionMercator.unproject(p,r)}}this._minX=e.lng,this._minY=e.lat,this._maxX=n.lng,this._maxY=n.lat,this._hasBounds=!0},t.prototype.updateCoverPoints=function(t){if(null!=t&&0!=t.length&&(t.sort(function(t,e){return t.y==e.y?t.x-e.x:t.y-e.y}),t=t.filter(function(t,e,n){return 0==e||t.x!=n[e-1].x||t.y!=n[e-1].y}),this._points=t),null!=this._points&&0!=this._points.length){for(var e=this._mapObject.getBearing(),n=this._mapObject.getScale(),i=s.ProjectionMercator.convertToMeterFromLatLng(this._mapObject.getLocation()),r=[],o=this._points.map(function(t){return new y.Point(t.x,t.y)}),a=0;a<o.length;++a){if(0!=e){var u=o[a].x,h=o[a].y;o[a].x=(u*Math.cos(e*Math.PI/180)+h*Math.sin(e*Math.PI/180))*n,o[a].y=(u*Math.sin(e*Math.PI/180)-h*Math.cos(e*Math.PI/180))*n}else o[a].x=o[a].x*n,o[a].y=-o[a].y*n;var c=s.ProjectionMercator.convertToLatLngFromMeter(new l.Vector2(i.x+o[a].x,i.y+o[a].y));r.push(c)}this._coverPoints=r}},t.prototype.updateBounds=function(t){this._boundingBox=t;var e=0,n=0,i=0,r=0;if(this._boundingBox){var o=this.mapObject.getScale();e=this._boundingBox.minX*o,n=this._boundingBox.minY*o,i=this._boundingBox.maxX*o,r=this._boundingBox.maxY*o;var a=-this.mapObject.getBearing();if(0!=a){var h=new l.Vector2(i,n),c=new l.Vector2(e,r),f=new l.Vector2(i,r),p=new l.Vector2(e,n);c=new l.Vector2(c.x*Math.cos(a*Math.PI/180)-c.y*Math.sin(a*Math.PI/180),c.x*Math.sin(a*Math.PI/180)+c.y*Math.cos(a*Math.PI/180)),h=new l.Vector2(h.x*Math.cos(a*Math.PI/180)-h.y*Math.sin(a*Math.PI/180),h.x*Math.sin(a*Math.PI/180)+h.y*Math.cos(a*Math.PI/180)),f=new l.Vector2(f.x*Math.cos(a*Math.PI/180)-f.y*Math.sin(a*Math.PI/180),f.x*Math.sin(a*Math.PI/180)+f.y*Math.cos(a*Math.PI/180)),p=new l.Vector2(p.x*Math.cos(a*Math.PI/180)-p.y*Math.sin(a*Math.PI/180),p.x*Math.sin(a*Math.PI/180)+p.y*Math.cos(a*Math.PI/180)),e=Math.min(c.x,h.x,f.x,p.x),i=Math.max(c.x,h.x,f.x,p.x),n=Math.min(c.y,h.y,f.y,p.y),r=Math.max(c.y,h.y,f.y,p.y)}}var d=this._mapObject.getLocation(),g=s.ProjectionMercator.convertToMeterFromLatLng(d),m=new l.Vector2(g.x+e,g.y-r),y=new l.Vector2(g.x+i,g.y-n),v=new u.LatLngBounds(s.ProjectionMercator.convertToLatLngFromMeter(m),s.ProjectionMercator.convertToLatLngFromMeter(y));this.updateBoundsFromLatLngBounds(v)},Object.defineProperty(t.prototype,"mapObject",{get:function(){return this._mapObject},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasBounds",{get:function(){return this._hasBounds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objectBounds",{get:function(){return this._boundingBox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coverPoints",{get:function(){return this._coverPoints},enumerable:!0,configurable:!0}),t}(),_=function(){function t(t,e,n,r){this.buildingResourceManager=t,this.mapState=e,this.modelTaskManager=n,this.mapObjectTree=i(),this.mapObjects=new Map,this.modelRequestsMap=new Map,this.requestRender=r}return t.prototype.setTileManager=function(t){this.tileManager=t},t.prototype.addMapObject=function(t){var e=this;if(this.mapObjects.get(t.getId()))console.warn("Can not add 2 map objects have the same id");else{var n=new b(t);this.mapObjects.set(t.getId(),n);var i=t.getObj();if(i)if("string"==typeof i)this.requestModel(n);else{var r=d.ObjModelLoader.loadModel(i.data);null!=r&&r.length>0?(this.onDataModelAvailable(r[0],t),this.mapObjectTree.insert(n),this.requestRender()):console.warn("Invalid object data for custom building id: "+t.getId())}else{var o=t.getCoordinates(),a=new u.LatLngBounds;o.forEach(function(t){a.extend(t)}),n.updateBoundsFromLatLngBounds(a),this.tileCover(n,function(n){if(n.isInitialized()){var i=e.getJsonForMapObject(t);e.tileManager.addBuildings([i]),n.getBuildings().push(i)}},function(n){var i=e.getJsonForMapObject(t);n.getBuildings().push(i)}),this.mapObjectTree.insert(n),this.requestRender()}}},t.prototype.getMapObjects=function(){return this.mapObjects},t.prototype.removeMapObject=function(t){var e=this,n=this.mapObjects.get(t);if(n){if(n.hasBounds)this.tileCover(n,function(n){n.isInitialized()&&(n.addBuildings(n.getBuildings().filter(function(e){return e.id!=t})),e.buildingResourceManager.decreaseBuildingReference(t))},function(e){e.addBuildings(e.getBuildings().filter(function(e){return e.id!=t}))});else{var i=n.mapObject.getObj();if("string"!=typeof i)return void console.error("objName type must be string");var r=this.modelRequestsMap.get(i);r?this.modelTaskManager.cancelTask(r):console.error("Request task null"),this.modelRequestsMap.delete(i)}this.mapObjectTree.remove(n),this.mapObjects.delete(t)}else console.warn("Can not remove non exist map object- id: "+t)},t.prototype.getJsonForMapObject=function(t){var e=t.getCoordinates();return{id:t.getId(),name:t.getName(),location:t.getLocation(),scale:t.getScale(),bearing:t.getBearing(),elevation:t.getElevation(),draggable:t.isDraggable(),model:{type:e.length>0?"ExternalExtrude":"External",obj:t.getObj(),texture:t.getTexture(),coordinates:e,height:t.getHeight()}}},t.prototype.getObjectsForTile=function(t){var e=this,n=a.GeometryUtils.tileCoordinateToLatLngBounds(t),i={minX:n.getSouthwest().lng,minY:n.getSouthwest().lat,maxX:n.getNortheast().lng,maxY:n.getNortheast().lat},o=t.getX(),s=t.getY(),l=t.getZoom(),u=this.mapObjectTree.search(i);return u&&0!=u.length?u.filter(function(t){var n=r.tiles(e.createFeatureData(t),{min_zoom:l,max_zoom:l});if(n&&n.length>0)for(var i=0;i<n.length;++i){var a=n[i];if(a[0]==o&&a[1]==s)return!0}return!1}).map(function(t){return t.mapObject}):[]},t.prototype.destroy=function(){var t=this;this.modelRequestsMap.forEach(function(e){t.modelTaskManager.cancelTask(e)}),this.modelRequestsMap.clear(),this.mapObjects.clear(),this.mapObjectTree.clear(),this.mapObjects=null,this.buildingResourceManager=null,this.tileManager=null,this.mapState=null,this.modelRequestsMap=null,this.modelTaskManager=null},t.prototype.requestModel=function(t){var e=this,n=t.mapObject.getObj();if("string"==typeof n)if(null!=n){var i=f.UrlUtils.isUrlRequest(n)?n:f.UrlUtils.getBuildingDataUrl(h.MapConstants.baseModelRequestUrl,n,p.MapSettings.getAccessKey()),r=new c.RequestTask(c.Resource.Model);r.url=i,r.completion=function(i){null!=i.data?(e.onDataModelAvailable(i.data[0],t.mapObject),t.mapObject.onModelLoaded&&t.mapObject.onModelLoaded(),e.mapObjectTree.insert(t),e.requestRender()):console.warn("Fail to load model for custom building: "+n),e.modelRequestsMap.delete(n)},this.modelRequestsMap.set(n,r),this.modelTaskManager.postTask(r)}else console.error("You do not set Url for Model. Please set it first!");else console.error("Obj name type must be string")},t.prototype.onDataModelAvailable=function(t,e){var n=this;if(0!=t.minX||0!=t.minY||0!=t.maxX||0!=t.maxY){var i=this.mapObjects.get(e.getId());i.updateBounds(new g.BoundingBox(t.minX,t.minY,t.maxX,t.maxY));for(var r=t.data instanceof ArrayBuffer?new Float32Array(t.data):t.data,o=[],a=0;a<(r instanceof Float32Array?r.byteLength/4:r.length)-8;a+=8){var s=new y.Point(r[a],r[a+2]);o.push(s)}i.updateCoverPoints(o),this.tileCover(i,function(t){if(t.isInitialized()){var i=n.getJsonForMapObject(e);n.tileManager.addBuildings([i]),t.getBuildings().push(i)}},function(t){var i=n.getJsonForMapObject(e);t.getBuildings().push(i)})}},t.prototype.updateBounds=function(t,e,n,i){var r=this;if(e.hasBounds){var o=0;this.tileCover(e,function(t){t.isInitialized()&&(t.addBuildings(t.getBuildings().filter(function(t){return t.id!=e.mapObject.getId()})),++o)},function(t){t.addBuildings(t.getBuildings().filter(function(t){return t.id!=e.mapObject.getId()}))}),this.mapObjectTree.remove(e);var a=e.mapObject.getCoordinates();if(a.length>0){if(null!=n){var s=e.mapObject.getLocation(),l=s.lng-n.lng,h=s.lat-n.lat,c=[];a.forEach(function(t){c.push(new m.LatLng(t.lat+h,t.lng+l))}),e.mapObject.coordinates=c,a=c}null!=i&&(e.mapObject.coordinates=i,a=i);var f=new u.LatLngBounds;a.forEach(function(t){f.extend(t)}),e.updateBoundsFromLatLngBounds(f)}else e.updateCoverPoints(null);this.mapObjectTree.insert(e),this.tileCover(e,function(t){if(t.isInitialized()){var n=r.getJsonForMapObject(e.mapObject);r.tileManager.addBuildings([n]),t.getBuildings().push(n)}},function(t){var n=r.getJsonForMapObject(e.mapObject);t.getBuildings().push(n)});for(var p=0;p<o;++p)this.buildingResourceManager.decreaseBuildingReference(t);this.buildingResourceManager.setBuildingLayerDirty()}},t.prototype.updateMapObjectCoordinates=function(t,e){var n=this.mapObjects.get(t);null!=n?this.updateBounds(t,n,null,e):console.warn("Can not set position non-exist map object- id: "+t)},t.prototype.updateMapObjectLocation=function(t,e){var n=this.mapObjects.get(t);if(null!=n){var i=n.mapObject.getLocation();n.mapObject.location=e,this.updateBounds(t,n,i,null)}else console.warn("Can not set position non-exist map object- id: "+t)},t.prototype.updateMapObjectScale=function(t){var e=this.mapObjects.get(t);null!=e?this.updateBounds(t,e,null,null):console.warn("Can not set scale non-exist map object- id: "+t)},t.prototype.updateBuildingDataForTiles=function(t){var e=this,n=this.mapObjects.get(t);n?n.hasBounds&&this.tileCover(n,function(i){var r=i.getBuildings().findIndex(function(e){return e.id==t});-1!=r&&(i.getBuildings()[r]=e.getJsonForMapObject(n.mapObject))},function(i){var r=i.getBuildings().findIndex(function(e){return e.id==t});-1!=r&&(i.getBuildings()[r]=e.getJsonForMapObject(n.mapObject))}):console.warn("indexedMapObject for id: "+t)},t.prototype.tileCover=function(t,e,n){for(var i=function(i){var s=r.tiles(a.createFeatureData(t),{min_zoom:i,max_zoom:i}),l=a.tileManager.getTiles(),u=a.tileManager.getTileCache();s&&s.forEach(function(t){var i=new o.TileCoordinate(t[0],t[1],t[2],!0).toString(),r=l.get(i);if(r){var a=r.tile;e(a)}var s=u.get(i);s&&n(a=s)})},a=this,s=h.MapConstants.defaultMinZoom3d;s<=this.mapState.getMaxNativeZoom();++s)i(s)},t.prototype.createFeatureData=function(t){var e,n=[],i=t.coverPoints;if(i){for(var r=0;r<i.length;++r)n.push([i[r].lng,i[r].lat]);e={type:"MultiPoint",properties:{},coordinates:n}}else{var o=t.mapObject.getCoverCoordinates();o.forEach(function(t){n.push([t.lng,t.lat])}),n.push([o[0].lng,o[0].lat]),e={type:"Polygon",properties:{},coordinates:[n]}}return e},t.prototype.getBoundsCoordinates=function(t){var e=[],n=t.coverPoints;if(n){for(var i=0;i<n.length;++i)e.push(n[i]);e=v.ConvexHull.makeHull(e)}else{t.mapObject.getCoverCoordinates().forEach(function(t){e.push(t)})}return e},t}();e.CustomBuildingManager=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,i){this._minX=t,this._minY=e,this._maxX=n,this._maxY=i}return Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}();e.BoundingBox=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.makeHullPresorted=function(t){if(t.length<=1)return t.slice();for(var e=[],n=0;n<t.length;n++){for(var i=t[n];e.length>=2;){var r=e[e.length-1],o=e[e.length-2];if(!((r.lng-o.lng)*(i.lat-o.lat)>=(r.lat-o.lat)*(i.lng-o.lng)))break;e.pop()}e.push(i)}e.pop();var a=[];for(n=t.length-1;n>=0;n--){for(i=t[n];a.length>=2;){r=a[a.length-1],o=a[a.length-2];if(!((r.lng-o.lng)*(i.lat-o.lat)>=(r.lat-o.lat)*(i.lng-o.lng)))break;a.pop()}a.push(i)}return a.pop(),1==e.length&&1==a.length&&e[0].lng==a[0].lng&&e[0].lat==a[0].lat?e:e.concat(a)},t.POINT_COMPARATOR=function(t,e){return t.lng<e.lng?-1:t.lng>e.lng?1:t.lat<e.lat?-1:t.lat>e.lat?1:0},t.makeHull=function(e){var n=e.slice();return n.sort(t.POINT_COMPARATOR),t.makeHullPresorted(n)},t}();e.ConvexHull=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(120),r=n(43),o=n(264),a=n(5),s=n(0),l=n(86),u=n(34),h=n(26),c=n(91),f=n(61),p=n(62),d=n(4),g=n(15),m=n(83),y=n(8),v=n(6),b=n(7),_=n(55),w=n(1),M=n(76),x=n(88),A=function(){function t(t,e,n,i){this._id=t,this._coordinate=e,this._properties=n,this._order=i,this._minX=e.lng,this._minY=e.lat,this._maxX=e.lng,this._maxY=e.lat}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}(),T=function(){function t(t){this.pointTree=r(),this.tiles=new Map,this.features=new o,this.mapView=t,this.dirty=!1}return t.prototype.update=function(){var t=this;this.dirty&&(this.tiles.forEach(function(e){var n=t.getTileData(e.getTileCoordinate());t.updateRenderTile(n,e),e.setData(n)}),this.dirty=!1)},t.prototype.addFeature=function(t){var e=t instanceof M.Data.Feature?t:new M.Data.Feature(t.id,t.geometry,t.properties),n=e.getId();return this.features.push("string"==typeof n?n:n.toString(),e),this.reloadIndexer(),e},t.prototype.removeFeature=function(t){if(null!=t){var e=t.getId();e&&this.features.remove("string"==typeof e?e:e.toString())&&this.reloadIndexer()}},t.prototype.removeAllFeatures=function(){this.features.clear(),this.reloadIndexer()},t.prototype.addGeoJson=function(t){var e=this,n=[];return JSON.parse(t).features.forEach(function(t){var i=[],r=[],o=t.geometry.type,a=null;if("Point"===o){var s=t.geometry.coordinates;a=new M.Data.Point(s)}else if("MultiPoint"===o){var l=[];t.geometry.coordinates.forEach(function(t){l.push(d.LatLng.convert(t))}),a=new M.Data.MultiPoint(l)}else if("Polygon"===o){for(var u=t.geometry.coordinates,h=0;h<u.length;++h){u[h].forEach(function(t){i.push(d.LatLng.convert(t))}),r.push(new M.Data.LinearRing(i)),i=[]}a=new M.Data.Polygon(r)}else if("MultiPolygon"===o){var c=[];t.geometry.coordinates.forEach(function(t){for(var e=[],n=function(n){var i=[];t[n].forEach(function(t){i.push(d.LatLng.convert(t))}),e.push(new M.Data.LinearRing(i))},i=0;i<t.length;++i)n(i);c.push(new M.Data.Polygon(e))}),a=new M.Data.MultiPolygon(c)}else if("LineString"===o)t.geometry.coordinates.forEach(function(t){i.push(d.LatLng.convert(t))}),a=new M.Data.LineString(i);else{if("MultiLineString"!==o)return void console.warn("Geometry type not supported: "+o);var f=[];t.geometry.coordinates.forEach(function(t){var e=[];t.forEach(function(t){e.push(d.LatLng.convert(t))}),f.push(new M.Data.LineString(e))}),a=new M.Data.MultiLineString(f)}var p=t.id?"string"==typeof t.id?t.id:t.id.toString():m.UUID.generate();if(e.features.get(p))console.warn("Feature id already exist! This feature will be ignored: "+p);else{var g=new M.Data.Feature(p,a,t.properties);e.features.push(p,g),n.push(g)}}),this.reloadIndexer(),n},t.prototype.addTile=function(t){var e=t.getTileCoordinate(),n=this.getTileData(e);this.updateRenderTile(n,t),t.setData(n),this.tiles.set(e.toString(),t)},t.prototype.removeTile=function(t){var e=this,n=this.tiles.get(t.toString());if(n){var i=n.getTileData();if(null!=i){var r=i.getLayerIds(),o=n.getTileCoordinate().toString();r.forEach(function(t){var n=e.mapView.getLayer(t);null!=n&&(n.getLayerType()==a.LayerType.GEOJSON&&n.removeRenderTile(o))})}n.destroy(),this.tiles.delete(n.getTileCoordinate().toString())}},t.prototype.removeAllTiles=function(){var t=this;Array.from(this.tiles.values()).forEach(function(e){return t.removeTile(e.tileCoordinate)})},t.prototype.queryFeature=function(t){var e=this.mapView.mapState,n=y.GeometryUtils.screenCoordinateToLatLng(t,e.cameraPosition,e.getScreenSize());if(!n.valid())return null;var i=u.TileCoordinate.fromLatLng(n,e.getZoom(),e.is3dMode()),r=1,o=e.getMaxNativeZoom();if(e.getZoom()>o&&(i=u.TileCoordinate.fromLatLng(n,e.getMaxNativeZoom(),e.is3dMode()),r=Math.pow(2,Math.round(e.getZoom())-o)),this.tiles.has(i.toString())){var a=y.GeometryUtils.tileCoordinateToLatLngBounds(i),l={minX:a.getSouthwest().lng,minY:a.getSouthwest().lat,maxX:a.getNortheast().lng,maxY:a.getNortheast().lat},h=this.pointTree.search(l);h.sort(function(t,e){return e.order-t.order});for(var c=0;c<h.length;++c){var f=h[c],p=s.MapConstants.pointGeoJsonAnchor,d=p[0],g=p[1];if(_.CollisionUtils.pointIntersectsSymbol(new b.Point(t.x,t.y),f.coordinate,0,s.MapConstants.pointGeoJsonWidth,s.MapConstants.pointGeoJsonHeight,new b.Point(d,g),e))return this.features.get(f.id)}var m=this.tiles.get(i.toString()).getTileData();if(null==m||0==m.getLayerIds().length)return null;var w=e.scale,M=i.getX(),x=i.getY(),A=y.GeometryUtils.pixelCoordinateToVectorTileCoordinate(v.ProjectionMercator.projectScale(n,w),M,x,r),T=this.queryShapeAnnotationInternal(new b.Point(A.x,A.y),m);if(T)return T}return null},t.prototype.queryShapeAnnotationInternal=function(t,e){var n=w.MapUtils.getTileSize(),i=e.getLayerIds();i.sort();for(var r=e.getLayerIds().length,o=this.mapView.mapState,a=0;a<r;++a)for(var s=i[a],l=e.getLayer(s),u=function(e){var i=l.getFeature(e),r=i.getType();if(!(i instanceof h.VectorTileFeature)||r==g.GeometryType.Point||r==g.GeometryType.Unknown)return"continue";var a=i,u=a.getGeometries().geometryCoordinates;if(null==c.mapView.getLayer(s))return console.error("There is problem while querying shape annotation"),{value:null};if(r==g.GeometryType.LineString){var f=(i.properties.get("stroke-width")||x.LineLayerData.defaultStrokeWidth)*w.MapUtils.pixelScale/2;o.getZoom()>o.getMaxNativeZoom()&&(f/=Math.pow(2,Math.round(o.getZoom())-o.getMaxNativeZoom()));var p=[];if(u.forEach(function(t){var e=[];t.forEach(function(t){return e.push(new b.Point(t[0],t[1]))}),p.push(e)}),f*=w.MapUtils.pixelScale,_.CollisionUtils.pointIntersectsBufferedMultiLine(t,p,f/n))return{value:c.features.get(a.getId())}}else if(r==g.GeometryType.Polygon){for(var d=!1,m=function(e){var n=[];if(u[e].forEach(function(t){return n.push(new b.Point(t[0],t[1]))}),0==e){if(!(d=_.CollisionUtils.polygonIntersectsPolygon([t],n)))return"break"}else if(_.CollisionUtils.polygonIntersectsPolygon([t],n))return d=!1,"break"},y=0;y<u.length;++y){if("break"===m(y))break}if(d)return{value:c.features.get(a.getId())}}},c=this,f=l.featureCount()-1;f>=0;--f){var p=u(f);if("object"==typeof p)return p.value}return null},t.prototype.updateRenderTile=function(t,e){var n=this;if(null!=t){var i=e.getTileCoordinate(),r=i.toString();t.getLayerIds().forEach(function(t){var o=n.mapView.getLayer(t);if(null!=o){var s=o.getLayerType(),l=new f.RenderTile(p.UnwrappedTileCoordinate.createWithXYZoom(i.getX(),i.getY(),i.getZoom()),e);if(s==a.LayerType.GEOJSON)o.addRenderTile(r,l)}})}},t.prototype.reloadIndexer=function(){var e=this,n={type:"FeatureCollection",features:[]};this.pointTree.clear();var r=0;this.features.each(function(t,i){var o=i.getGeometry().getType(),a=i.getProperties(),s=[],l=!1,u=[];if("Point"===o){var h=i.getGeometry();e.pointTree.insert(new A(t,h.get(),a,r++))}else if("MultiPoint"===o){i.getGeometry().forEachLatLng(function(n){e.pointTree.insert(new A(t,n,a,r++))})}else if("Polygon"===o){for(var c=i.getGeometry(),f=function(t){var e=[];c.getAt(t).elements.forEach(function(t){return e.push([t.lng,t.lat])}),s.push(e)},p=0;p<c.getLength();++p)f(p);(null==a||!a["stroke-width"]||a["stroke-width"]>0)&&(l=!0,u=s)}else if("MultiPolygon"===o){var d=i.getGeometry(),g=d.getLength();(null==a||!a["stroke-width"]||a["stroke-width"]>0)&&(l=!0);for(p=0;p<g;++p){for(var m=[],y=(c=d.getAt(p),function(t){var e=[];c.getAt(t).elements.forEach(function(t){return e.push([t.lng,t.lat])}),m.push(e)}),v=0;v<c.getLength();++v)y(v);l&&m.forEach(function(t){return u.push(t)});var b={type:"Feature",id:i.getId(),properties:a,geometry:{type:"Polygon",coordinates:m}};n.features.push(b)}}else if("LineString"===o)i.getGeometry().forEachLatLng(function(t){s.push([t.lng,t.lat])});else{if("MultiLineString"!==o)throw new Error("Not reachable");var _=i.getGeometry(),w=(g=_.getLength(),function(t){var e=[];_.getAt(t).forEachLatLng(function(t){e.push([t.lng,t.lat])}),s.push(e)});for(p=0;p<g;++p)w(p)}if("MultiPolygon"!==o&&"Point"!==o){b={type:"Feature",id:i.getId(),properties:a,geometry:{type:o,coordinates:s}};n.features.push(b)}if(l){var M="#555555",x=1;a&&(M=a.stroke||"#555555",x=a["stroke-opacity"]?a["stroke-opacity"]:1);for(p=0;p<u.length;++p){var T=u[p],S={type:"Feature",id:i.getId(),properties:{"fill-outlined":!0,stroke:M,"stroke-opacity":x},geometry:{type:"LineString",coordinates:T}};n.features.push(S)}}}),this.geoJsonIndexer=i.default(JSON.parse(JSON.stringify(n,null,2)),t.geojsonvtOptions),this.dirty=!0,this.mapView.dirty=!0;var o=[];Array.from(this.tiles.values()).forEach(function(t){return o.push(new l.VectorTile(t.tileCoordinate,t.gl))}),this.removeAllTiles(),o.forEach(function(t){return e.addTile(t)})},t.prototype.getTileData=function(e){if(0==this.features.size())return null;var n=new h.VectorTileData,i=this.geoJsonIndexer.getTile(e.getZoom(),e.getX(),e.getY());null!=i&&null!=i.features&&i.features.forEach(function(e){var i=e.type,r=new c.GeometryCollection(e.geometry),o=new Map,a=e.tags;for(var s in a)o.set(s,a[s]);var l=n.addLayer(t.geoJsonLayerId);i===g.GeometryType.Polygon?l.addFeature(e.id,i,r,o):i===g.GeometryType.LineString&&(o.has("fill-outlined"),l.addFeature(e.id,i,r,o))});var r=y.GeometryUtils.tileCoordinateToLatLngBounds(e),o={minX:r.getSouthwest().lng,minY:r.getSouthwest().lat,maxX:r.getNortheast().lng,maxY:r.getNortheast().lat},a=this.pointTree.search(o),s=n.addLayer(t.geoJsonLayerId);return a.sort(function(t,e){return t.order-e.order}),a.forEach(function(t){var e=new Map;e.set("coordinate-lat",t.coordinate.lat),e.set("coordinate-lng",t.coordinate.lng),s.addFeature(t.id,g.GeometryType.Point,null,e)}),n},t.geojsonvtOptions={maxZoom:s.MapConstants.defaultMaxNativeZoom,buffer:0,extent:s.MapConstants.tileExtend,tolerance:4},t.geoJsonLayerId="3.maplink.geojson.layer",t}();e.GeoJsonManager=T},function(t,e){!function(e){"use strict";function n(t){this._map=t}function i(){throw new Error("Cannot write to an immutable view of LinkedMap")}function r(){this.clear()}["size","get","headKey","head","tailKey","tail","each","nextKey","next","previousKey","previous","keys","values","toObject","toString"].forEach(function(t){n.prototype[t]=function(){var e=Array.prototype.slice.apply(arguments);return this._map[t].apply(this._map,e)}}),["unshift","push","shift","pop","remove","clear"].forEach(function(t){n.prototype[t]=i}),n.prototype.immutableView=function(){return this},r.prototype._add=function(t,e){var n=this._map[t];return n?(n.value=e,null):(n={key:t,value:e,next:null,prev:null},this._map[t]=n,this._size++,n)},r.prototype.size=function(){return this._size},r.prototype.get=function(t){return(this._map[t]||{}).value||null},r.prototype.headKey=function(){return(this._head||{}).key||null},r.prototype.tailKey=function(){return(this._tail||this._head||{}).key||null},r.prototype.head=function(){return(this._head||{}).value||null},r.prototype.tail=function(){return(this._tail||this._head||{}).value||null},r.prototype.unshift=function(t,e){var n=this._add(t,e);n&&(this._head?this._tail?(n.next=this._head,this._head.prev=n,this._head=n):(this._tail=this._head,this._head=n,this._head.next=this._tail,this._tail.prev=this._head):this._head=n)},r.prototype.push=function(t,e){var n=this._add(t,e);n&&(this._head?this._tail?(this._tail.next=n,n.prev=this._tail,this._tail=n):(this._tail=n,this._tail.prev=this._head,this._head.next=this._tail):this._head=n)},r.prototype._remove=function(t){return t&&this._head?(delete this._map[t.key],this._size--,t===this._head?this._tail?this._head.next===this._tail?(this._head.next=this._tail.prev=null,this._head=this._tail,this._tail=null):(this._head=this._head.next,this._head.prev=null):this._head=null:t===this._tail?this._head.next==this._tail?this._tail.prev=this._head.next=this._tail=null:(this._tail=this._tail.prev,this._tail.next=null):(t.prev.next=t.next,t.next.prev=t.prev),t.next=t.prev=null,t.value):null},r.prototype.shift=function(){return this._remove(this._head)},r.prototype.pop=function(){return this._remove(this._tail||this._head)},r.prototype.remove=function(t){return this._remove(this._map[t])},r.prototype.each=function(t,e,n){"function"==typeof t&&(n=e,e=t,t=!1);for(var i=t&&this._tail||this._head;i&&!1!==e.call(n,i.key,i.value);)i=t?i.prev:i.next},r.prototype.nextKey=function(t,e){var n=this._map[t];return n?(n=n.next)?n.key:e&&this._head?this._head.key:null:null},r.prototype.next=function(t,e){return this.get(this.nextKey(t,e))},r.prototype.previousKey=function(t,e){var n=this._map[t];return n?(n=n.prev)?n.key:e&&(this._tail||this._head)?(this._tail||this._head).key:null:null},r.prototype.previous=function(t,e){return this.get(this.previousKey(t,e))},r.prototype.clear=function(){this._map={},this._size=0,this._head=null,this._tail=null},r.prototype.keys=function(){var t=[];return this.each(function(e){t.push(e)}),t},r.prototype.values=function(){var t=[];return this.each(function(e,n){t.push(n)}),t},r.prototype.immutableView=function(){return new n(this)},r.prototype.toObject=function(){var t={};return this.each(function(e,n){t[e]=n}),t},r.prototype.toString=function(){return"LinkedMap[size="+this.size()+"]"},void 0!==t&&void 0!==t.exports?t.exports=r:e.LinkedMap=r}(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),r=n(8),o=n(2),a=n(4),s=n(0),l=n(1),u=n(21),h=n(44),c=n(27),f=n(55),p=n(7),d=n(15),g=function(){function t(t,e,n){this.gl=t,this.collisionIndex=i(),this.visibleFeatures=new Set,this.mapSettings=n,this.mapState=e,this.features=new Map,u.SymbolResourceManager.getInstance(t).acquire(s.SymbolConstants.placeSelectedSymbol)}return t.prototype.getFeatures=function(){return this.features},t.prototype.setSelectedFeature=function(t){this.selectedFeatureId=t,this.updatePlacement()},t.prototype.getSelectedFeature=function(){return this.selectedFeatureId},t.prototype.updatePlacement=function(){var t=this;this.collisionIndex.clear();var e=[],n=[],i=[],r=null;this.features.forEach(function(o){var a=o.feature;if(null!=a){var l=a.getProperties(),u=a.getId(),h=null==r&&u===t.selectedFeatureId;l.set("selected",h),h?r=a:!0===l.get("userFeature")?(i.push(a),u==s.MapConstants.placeSelectedIdPrefix+t.selectedFeatureId&&(l.set("selected",!0),null!=r&&r.getProperties().set("selected",!1),r=a)):t.visibleFeatures.has(u)?e.push(a):n.push(a)}}),this.visibleFeatures.clear(),r&&(!0===r.getProperties().get("userFeature")?this.placeUserFeatures([r]):this.placeFeatures([r])),this.placeUserFeatures(i),this.placeFeatures(e),this.placeFeatures(n)},t.prototype.queryFeature=function(t){var e=this,n={minX:t.x,minY:t.y,maxX:t.x,maxY:t.y},i=this.collisionIndex.search(n);if(null==i||i.length<=0)return null;for(var u=i.map(function(t){return e.features.get(t.id).feature}).filter(function(t){return null!=t&&t.getType()==d.GeometryType.Point}).sort(function(t,e){var n=t.getProperties().get("renderOrder")||-1;return(e.getProperties().get("renderOrder")||-1)-n}),g=this.mapState.cameraPosition,m=this.mapState.getScreenSize(),y=0;y<u.length;++y){var v=u[y],b=v.getProperties(),_=a.LatLng.convert([b.get("lng"),b.get("lat")]),w=s.MapConstants.placeWidth*l.MapUtils.pixelScale,M=s.MapConstants.placeHeight*l.MapUtils.pixelScale,x=f.CollisionUtils.pointIntersectsSymbol(new p.Point(t.x,t.y),_,0,w,M,s.MapConstants.placeAnchor,this.mapState);if(x)return v;var A=r.GeometryUtils.latLngToScreenCoordinate(_,0,g,m),T=new c.MarkerLabel({text:b.get("name"),fontSize:s.MapConstants.placeFontSize,fontWeight:s.MapConstants.placeFontWeight,line:s.MapConstants.placeNumLine,maxWidth:s.MapConstants.placeMaxWidth}),S=h.TextLabelResourceManager.getInstance(this.gl).acquire(T),E=new o.Vector2(A.x+w/2+S.width/2+1,A.y-M/2);if(x=f.CollisionUtils.pointIntersectsSymbol(new p.Point(t.x,t.y),r.GeometryUtils.screenCoordinateToLatLng(E,g,m),0,S.width,S.height,new p.Point(.5,.5),this.mapState),h.TextLabelResourceManager.getInstance(this.gl).release(T),x)return v}return null},t.prototype.addFeatures=function(t){var e=this;null!=t&&0!=t.length&&(t.forEach(function(t){var n=t.getId(),i=e.features.get(n);null!=i?(i.feature=t,++i.reference):e.features.set(n,{feature:t,reference:1})}),this.updatePlacement())},t.prototype.removeFeatures=function(t){var e=this;null!=t&&0!=t.length&&(t.forEach(function(t){var n=e.features.get(t);null==n||(--n.reference,n.reference<=0&&e.features.delete(t))}),this.updatePlacement())},t.prototype.placeUserFeatures=function(t){var e=this,n=this.mapState.cameraPosition,i=this.mapState.getScreenSize();t.forEach(function(t){var o=t.getProperties();if(!0===o.get("userFeature")){o.set("symbolVisible",!0);var u=new a.LatLng(o.get("lat"),o.get("lng")),h=o.get("selected"),c=(!0===h?s.MapConstants.placeSelectedWidth:s.MapConstants.placeWidth)*l.MapUtils.pixelScale,f=(!0===h?s.MapConstants.placeSelectedHeight:s.MapConstants.placeHeight)*l.MapUtils.pixelScale,p=r.GeometryUtils.latLngToScreenCoordinate(u,0,n,i),d=p.x-c/2,g=p.x+c/2,m=p.y-f,y=p.y,v={id:t.getId(),minX:d,maxX:g,minY:m,maxY:y};e.collisionIndex.insert(v)}}),t.forEach(function(t){var u=t.getProperties();u.set("textVisible",!1);var f=u.get("name");if(null!=f){var p=new c.MarkerLabel({text:f,fontSize:s.MapConstants.placeFontSize,fontWeight:s.MapConstants.placeFontWeight,line:s.MapConstants.placeNumLine,maxWidth:s.MapConstants.placeMaxWidth}),d=p.getFontSize(),g=h.TextLabelResourceManager.getInstance(e.gl).acquire(p).width;h.TextLabelResourceManager.getInstance(e.gl).release(p);var m=u.get("selected"),y=!0===m?s.MapConstants.placeSelectedWidth:s.MapConstants.placeWidth*l.MapUtils.pixelScale,v=!0===m?s.MapConstants.placeSelectedHeight:s.MapConstants.placeHeight*l.MapUtils.pixelScale,b=new a.LatLng(u.get("lat"),u.get("lng")),_=r.GeometryUtils.latLngToScreenCoordinate(b,0,n,i),w=new o.Vector2(_.x+y/2+g/2+1,_.y-v/2),M=w.x-g/2,x=w.x+g/2,A=w.y-d/2,T=w.y+d/2,S=e.collisionIndex.search({minX:M,maxX:x,minY:A,maxY:T});return m||!S||0==S.length?(u.set("textVisible",!0),void e.collisionIndex.insert({id:t.getId(),minX:M,maxX:x,minY:A,maxY:T})):void 0}})},t.prototype.placeFeatures=function(t){var e=this,n=this.mapState.cameraPosition,i=this.mapState.getScreenSize();t.forEach(function(t){var u=t.getProperties();if(!(!0===u.get("userFeature"))&&t.getId()!=e.selectedFeatureId){u.set("textVisible",!1),u.set("symbolVisible",!1);var f=(u.get("types")||"").split(",");if(e.isInFilterPlacesTypes(f)){var p=new a.LatLng(u.get("lat"),u.get("lng")),d=5*l.MapUtils.pixelScale,g=u.get("selected"),m=!0===g?s.MapConstants.placeSelectedWidth:s.MapConstants.placeWidth*l.MapUtils.pixelScale,y=!0===g?s.MapConstants.placeSelectedHeight:s.MapConstants.placeHeight*l.MapUtils.pixelScale,v=r.GeometryUtils.latLngToScreenCoordinate(p,0,n,i),b=v.x-m/2-d,_=v.x+m/2+d,w=v.y-y-d,M=v.y+d,x=e.collisionIndex.search({minX:b,maxX:_,minY:w,maxY:M});if(!x||0==x.length){var A=t.getId(),T={id:A,minX:b,maxX:_,minY:w,maxY:M};u.set("symbolVisible",!0),e.visibleFeatures.add(A);var S=u.get("name");if(null!=S){var E=new c.MarkerLabel({text:S,fontSize:s.MapConstants.placeFontSize,fontWeight:s.MapConstants.placeFontWeight,line:s.MapConstants.placeNumLine,maxWidth:s.MapConstants.placeMaxWidth}),C=E.getFontSize(),L=h.TextLabelResourceManager.getInstance(e.gl).acquire(E).width;h.TextLabelResourceManager.getInstance(e.gl).release(E);var P=new o.Vector2(v.x+m/2+L/2+1,v.y-y/2);if(b=P.x-L/2-d,_=P.x+L/2+d,w=P.y-C/2-d,M=P.y+C/2+d,!(x=e.collisionIndex.search({minX:b,maxX:_,minY:w,maxY:M}))||0==x.length)return u.set("textVisible",!0),e.collisionIndex.insert(T),void e.collisionIndex.insert({id:A,minX:b,maxX:_,minY:w,maxY:M});e.collisionIndex.insert(T),u.set("textVisible",!1)}else e.collisionIndex.insert(T)}}}})},t.prototype.isInFilterPlacesTypes=function(t){var e=this.mapSettings.filterPlaceTypes;return null==e||null==e.length||e.length<1||!(null==t||t.length<=0)&&e.some(function(e){return-1!==t.indexOf(e)})},t}();e.Placement=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),r=n(34),o=n(8),a=n(4),s=n(25),l=n(0),u=n(19),h=n(21),c=n(44),f=n(27),p=function(){function t(t,e,n){this.gl=t,this.featuresTree=i(),this.features=new Map,this.tileManager=e,this.mapState=n}return t.prototype.hasFeature=function(t){return this.features.has(t)},t.prototype.addFeature=function(t){if(this.features.has(t.getId()))console.error("Feature id exist: "+t.getId());else{var e=t.getProperties(),n=e.get("lat"),i=e.get("lng"),o=e.get("name");if(null!=o){var p=new f.MarkerLabel({text:o,fontSize:l.MapConstants.placeFontSize,fontWeight:l.MapConstants.placeFontWeight,line:l.MapConstants.placeNumLine,maxWidth:l.MapConstants.placeMaxWidth});c.TextLabelResourceManager.getInstance(this.gl).acquire(p)}var d=e.get("url")||l.MapConstants.placeDefaultIcon,g=s.UrlUtils.getIconRequestUrl(l.MapConstants.userIconRequestUrl,d,u.MapSettings.getAccessKey());h.SymbolResourceManager.getInstance(this.gl).acquire(g);var m=r.TileCoordinate.fromLatLng(new a.LatLng(n,i),this.mapState.getZoom(),this.mapState.is3dMode()),y={feature:t,minX:i,maxX:i,minY:n,maxY:n};this.featuresTree.insert(y),this.features.set(t.getId(),y),this.tileManager.reloadTileData(m)}},t.prototype.removeFeature=function(t){var e=this.features.get(t);if(null!=e){var n=e.feature.getProperties(),i=n.get("lat"),o=n.get("lng"),p=n.get("name");if(null!=p){var d=new f.MarkerLabel({text:p,fontSize:l.MapConstants.placeFontSize,fontWeight:l.MapConstants.placeFontWeight,line:l.MapConstants.placeNumLine,maxWidth:l.MapConstants.placeMaxWidth});c.TextLabelResourceManager.getInstance(this.gl).release(d)}var g=n.get("icon")||l.MapConstants.placeDefaultIcon,m=s.UrlUtils.getIconRequestUrl(l.MapConstants.userIconRequestUrl,g,u.MapSettings.getAccessKey());h.SymbolResourceManager.getInstance(this.gl).release(m);var y=r.TileCoordinate.fromLatLng(new a.LatLng(i,o),this.mapState.getZoom(),this.mapState.is3dMode());this.featuresTree.remove(e),this.features.delete(t),this.tileManager.reloadTileData(y)}else!t.startsWith(l.MapConstants.placeSelectedIdPrefix)&&console.warn("Feature id not found: "+t)},t.prototype.queryFeatures=function(t){var e=o.GeometryUtils.tileCoordinateToLatLngBounds(t),n={minX:e.getSouthwest().lng,minY:e.getSouthwest().lat,maxX:e.getNortheast().lng,maxY:e.getNortheast().lat},i=[];return this.featuresTree.search(n).forEach(function(t){t.feature.getProperties().set("userFeature",!0),i.push(t.feature)}),i},t}();e.FeatureManager=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(32),r=n(4),o=n(1),a=n(20),s=n(0),l=n(288),u=n(27),h=n(51),c=function(){function t(e,n){if(void 0===e&&(e=[]),this.clusters=[],this.events=[],null==e||0==e.length)throw Error("Markers list can not be null or empty");this.markers=e,this.markerClusterMap=new Map;var i={};o.MapUtils.extendOptions(i,t.defaultMarkerClusterOptions,n);for(var r=0,a=i;r<a.length;r++){if(null==a[r])throw Error("Parameters can not be null")}i.radius=i.radius*o.MapUtils.pixelScale,this.zoomOnClick=i.zoomOnClick,this.superCluster=new l.default(i);var s=this.getFeatures();this.superCluster.load(s)}return t.prototype.setMap=function(e){var n=this;if(this.map!==e&&(this.map&&(this.events.forEach(function(t){return t.remove()}),this.events=[],this.markers.forEach(function(t){return t.setMap(null)}),this.removeMarkerClusters()),this.map=e,this.map)){this.updateCluster(this.map.getCamera().getZoom());var i=this.map.addListener("markerClick",function(e){if("mouseup"==e.xa.type&&n.zoomOnClick){var i=e.marker,r=n.markerClusterMap.get(i.getId());if(null!=r){for(var o=n.superCluster.getLeaves(r,s.MapConstants.clusterMaxPointCount),l=new a.LatLngBounds,u=0,h=o;u<h.length;u++){var c=h[u];l.extend([c.geometry.coordinates[0],c.geometry.coordinates[1]])}var f=n.map.mapView.getCameraPositionForLatLngBounds(l,{top:0,left:0,right:0,bottom:0});n.map.fitBounds(l,t.defaultPadding,{animate:!0}),n.updateCluster(f.getZoom())}}}),r=this.map.addListener("idle",function(){var t=n.map.mapView.mapState;(t.isZoomIn()||t.isZoomOut()||t.isFlyingTo())&&n.updateCluster(n.map.getCamera().getZoom())});this.events.push(i),this.events.push(r)}},t.prototype.setZoomOnClick=function(t){null!=t?this.zoomOnClick=t:console.warn("Parameter zoomOnClick can not be null")},t.prototype.updateCluster=function(t){this.removeMarkerClusters();var e=this.map.mapView.getBounds();if(null!=e){var n=[e.getSouthwest().lng,e.getSouthwest().lat,e.getNortheast().lng,e.getNortheast().lat],i=this.superCluster.getClusters(n,t);this.update(i)}},t.prototype.removeMarkerClusters=function(){this.clusters.forEach(function(t){return t.setMap(null)}),this.clusters=[]},t.prototype.update=function(t){var e=this;for(var n in t)if(null!=t[n].id){var o=this.superCluster.getLeaves(t[n].id,s.MapConstants.clusterMaxPointCount),a=15*(o.length.toString().length-1),l=50+a,c=50+a,f=new h.Icon(l,c,"markerClusterIcon"),p=new i.Marker({position:r.LatLng.convert(t[n].geometry.coordinates),icon:f,label:new u.MarkerLabel({text:o.length.toString(),fontSize:13,color:"#000000",haloColor:"#b22525"})});p.setMap(this.map),this.clusters.push(p),this.markerClusterMap.set(p.getId(),t[n].id),o.forEach(function(t){return e.markers[t.properties.index].setMap(null)})}else{this.markers[t[n].properties.index].setMap(this.map)}},t.prototype.getFeatures=function(){var t=[];return this.markers.forEach(function(e,n){var i={type:"Feature",properties:{index:n},geometry:{type:"Point",coordinates:[]}};i.geometry.coordinates.push(e.getPosition().lng),i.geometry.coordinates.push(e.getPosition().lat),t.push(i)}),t},t.defaultMarkerClusterOptions={minZoom:0,maxZoom:22,radius:100,zoomOnClick:!0},t.defaultPadding={top:10,bottom:10,left:10,right:10},t}();e.MarkerClusterer=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4),o=n(7),a=n(1),s=function(){function t(t){this.map=t}return t.prototype.fromLatLngToScreen=function(t,e){void 0===e&&(e=0);var n=this.map.mapView.latLngToScreenCoordinate(r.LatLng.convert(t),e);return a.MapUtils.pixelToPoint(new o.Point(n.x,n.y))},t.prototype.fromScreenToLatLng=function(t,e){void 0===e&&(e=0);var n=o.Point.convert(t),r=a.MapUtils.pointToPixel(n);return this.map.mapView.screenCoordinateToLatLng(new i.Vector2(r.x,r.y),e)},t}();e.Projection=s},function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(20),o=n(1),a=n(0),s=function(t){function e(n){var i=t.call(this)||this,a={};return o.MapUtils.extendOptions(a,e.defaultTileArea,n),i.bounds=r.LatLngBounds.convert(a.bounds),i.url=a.url,i.minZoom=a.minZoom,i.maxZoom=a.maxZoom,i}return i(e,t),e.prototype.getBounds=function(){return null==this.bounds?null:new r.LatLngBounds(this.bounds.getSouthwest(),this.bounds.getNortheast())},e.prototype.getUrl=function(){return this.url},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setBounds=function(t){null!=t?(this.bounds=r.LatLngBounds.convert(t),null!=this.map&&this.map.mapView.reload()):console.warn("Parameter bounds can not be null")},e.prototype.setMinZoom=function(t){null!=t?this.minZoom!=t&&(this.minZoom=t,null!=this.map&&this.map.mapView.reload()):console.warn("Parameter minZoom can not be null")},e.prototype.setMaxZoom=function(t){null!=t?this.maxZoom!=t&&(this.maxZoom=t,null!=this.map&&this.map.mapView.reload()):console.warn("Parameter maxZoom can not be null")},e.prototype.setUrl=function(t){null!=t?this.url!=t&&(this.url=t,null!=this.map&&this.map.mapView.reload()):console.warn("Parameter url can not be null")},e.prototype.setMap=function(t){this.map!==t&&(null!=this.map&&(this.map.mapView.removeTileArea(this.id),this.id=-1),this.map=t,null!=this.map&&(this.id=this.map.mapView.addTileArea(this)))},e.defaultTileArea={url:a.MapConstants.baseMapUrl,minZoom:a.MapConstants.defaultMinZoom,maxZoom:a.MapConstants.defaultMaxZoom},e}(n(38).Annotation);e.TileArea=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(273),o=function(){function t(t){this._path=[],this._path=t.map(function(t){return i.LatLng.convert(t)})}return t.prototype.setPath=function(t){this._path=t.map(function(t){return i.LatLng.convert(t)})},t.prototype.addPath=function(t){var e=this;t.forEach(function(t){return e._path.push(i.LatLng.convert(t))})},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=0;e<this._path.length-1;++e)t+=r.SphericalUtil.computeDistanceBetween(this._path[e],this._path[e+1]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"perimeter",{get:function(){if(this._path.length<3)return 0;var t=this.length;return t+=r.SphericalUtil.computeDistanceBetween(this._path[0],this._path[this._path.length-1])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return r.SphericalUtil.computeArea(this._path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){if(0==this._path.length)return null;for(var t=new i.LatLng(0,0),e=0;e<this._path.length;++e)t.lat+=this._path[e].lat,t.lng+=this._path[e].lng;return t.lat/=this._path.length,t.lng/=this._path.length,t},enumerable:!0,configurable:!0}),t}();e.Measure=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),r=n(0),o=function(){function t(){}return t.computeDistanceBetweenHelper=function(t,e){var n=i.MathUtils.toRadians(t.lat),r=i.MathUtils.toRadians(t.lng),o=i.MathUtils.toRadians(e.lat),a=i.MathUtils.toRadians(e.lng);return 2*Math.asin(Math.sqrt(Math.pow(Math.sin((n-o)/2),2)+Math.cos(n)*Math.cos(o)*Math.pow(Math.sin((r-a)/2),2)))},t.sphericalExcess=function(e,n,i){for(var r=[e,n,i,e],o=[],a=0,s=0;s<3;s++)o[s]=t.computeDistanceBetweenHelper(r[s],r[s+1]),a+=o[s];var l=a/2,u=Math.tan(l/2);for(s=0;s<3;s++)u*=Math.tan((l-o[s])/2);return 4*Math.atan(Math.sqrt(Math.abs(u)))},t.sphericalSign=function(t,e,n){var r=[t,e,n].map(function(t){var e=i.MathUtils.toRadians(t.lat),n=i.MathUtils.toRadians(t.lng);return[Math.cos(e)*Math.cos(n),Math.cos(e)*Math.sin(n),Math.sin(e)]});return 0<r[0][0]*r[1][1]*r[2][2]+r[1][0]*r[2][1]*r[0][2]+r[2][0]*r[0][1]*r[1][2]-r[0][0]*r[2][1]*r[1][2]-r[1][0]*r[0][1]*r[2][2]-r[2][0]*r[1][1]*r[0][2]?1:-1},t.computeSphericalExcess=function(e,n,i){return t.sphericalExcess(e,n,i)*t.sphericalSign(e,n,i)},t.computeSignedArea=function(e){if(e.length<3)return 0;for(var n=0,i=1;i<e.length-1;++i)n+=t.computeSphericalExcess(e[0],e[i],e[i+1]);return n*r.MapConstants.radiusEarthMeters*r.MapConstants.radiusEarthMeters},t.computeDistanceBetween=function(e,n){return t.computeDistanceBetweenHelper(e,n)*r.MapConstants.radiusEarthMeters},t.computeArea=function(e){return Math.abs(t.computeSignedArea(e))},t}();e.SphericalUtil=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(6),o=n(12),a=n(2),s=function(){function t(t){this.coordinates=[],this.coordinates=t.map(function(t){return i.LatLng.convert(t)})}return t.prototype.setCoordinates=function(t){this.coordinates=t.map(function(t){return i.LatLng.convert(t)})},t.prototype.addCoordinates=function(t){var e=this;t.forEach(function(t){return e.coordinates.push(i.LatLng.convert(t))})},t.prototype.rotate=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=1)return this.coordinates.slice();var n=null;n=null!=e?i.LatLng.convert(n):this.center;var s=r.ProjectionMercator.convertToMeterFromLatLng(n),l=[],u=o.MathUtils.toRadians(t);return this.coordinates.forEach(function(t){var e=r.ProjectionMercator.convertToMeterFromLatLng(t);e.x-=s.x,e.y-=s.y;var n=e.x,i=e.y;e.x=n*Math.cos(u)-i*Math.sin(u),e.y=n*Math.sin(u)+i*Math.cos(u),l.push(r.ProjectionMercator.convertToLatLngFromMeter(new a.Vector2(s.x+e.x,s.y+e.y)))}),l},t.prototype.translate=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=0)return[];var n=i.LatLng.convert(t),r=null;r=null!=e?i.LatLng.convert(e):this.center;var o=[],a=n.lng-r.lng,s=n.lat-r.lat;return this.coordinates.forEach(function(t){o.push(new i.LatLng(t.lat+s,t.lng+a))}),o},t.prototype.scale=function(t,e){if(void 0===e&&(e=null),this.coordinates.length<=1)return this.coordinates.slice();var n=null;n=null!=e?i.LatLng.convert(e):this.center;var o=r.ProjectionMercator.convertToMeterFromLatLng(n),s=[];return this.coordinates.forEach(function(e){var n=r.ProjectionMercator.convertToMeterFromLatLng(e);n.x-=o.x,n.y-=o.y,n.x*=t,n.y*=t,s.push(r.ProjectionMercator.convertToLatLngFromMeter(new a.Vector2(o.x+n.x,o.y+n.y)))}),s},Object.defineProperty(t.prototype,"center",{get:function(){if(0==this.coordinates.length)return null;for(var t=new i.LatLng(0,0),e=0;e<this.coordinates.length;++e)t.lat+=this.coordinates[e].lat,t.lng+=this.coordinates[e].lng;return t.lat/=this.coordinates.length,t.lng/=this.coordinates.length,t},enumerable:!0,configurable:!0}),t}();e.CoordinateTransformer=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function i(t,e,n,o,a,s){if(a-o<=n)return;const l=o+a>>1;!function t(e,n,i,o,a,s){for(;a>o;){if(a-o>600){const r=a-o+1,l=i-o+1,u=Math.log(r),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(r-h)/r)*(l-r/2<0?-1:1),f=Math.max(o,Math.floor(i-l*h/r+c)),p=Math.min(a,Math.floor(i+(r-l)*h/r+c));t(e,n,i,f,p,s)}const l=n[2*i+s];let u=o,h=a;for(r(e,n,o,i),n[2*a+s]>l&&r(e,n,o,a);u<h;){for(r(e,n,u,h),u++,h--;n[2*u+s]<l;)u++;for(;n[2*h+s]>l;)h--}n[2*o+s]===l?r(e,n,o,h):r(e,n,++h,a),h<=i&&(o=h+1),i<=h&&(a=h-1)}}(t,e,l,o,a,s%2),i(t,e,n,o,l-1,s+1),i(t,e,n,l+1,a,s+1)}function r(t,e,n,i){o(t,n,i),o(e,2*n,2*i),o(e,2*n+1,2*i+1)}function o(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function a(t,e,n,i){const r=t-n,o=e-i;return r*r+o*o}n.r(e);const s=t=>t[0],l=t=>t[1];class u{constructor(t,e=s,n=l,r=64,o=Float64Array){this.nodeSize=r,this.points=t;const a=t.length<65536?Uint16Array:Uint32Array,u=this.ids=new a(t.length),h=this.coords=new o(2*t.length);for(let i=0;i<t.length;i++)u[i]=i,h[2*i]=e(t[i]),h[2*i+1]=n(t[i]);i(u,h,r,0,u.length-1,0)}range(t,e,n,i){return function(t,e,n,i,r,o,a){const s=[0,t.length-1,0],l=[];let u,h;for(;s.length;){const c=s.pop(),f=s.pop(),p=s.pop();if(f-p<=a){for(let a=p;a<=f;a++)u=e[2*a],h=e[2*a+1],u>=n&&u<=r&&h>=i&&h<=o&&l.push(t[a]);continue}const d=Math.floor((p+f)/2);u=e[2*d],h=e[2*d+1],u>=n&&u<=r&&h>=i&&h<=o&&l.push(t[d]);const g=(c+1)%2;(0===c?n<=u:i<=h)&&(s.push(p),s.push(d-1),s.push(g)),(0===c?r>=u:o>=h)&&(s.push(d+1),s.push(f),s.push(g))}return l}(this.ids,this.coords,t,e,n,i,this.nodeSize)}within(t,e,n){return function(t,e,n,i,r,o){const s=[0,t.length-1,0],l=[],u=r*r;for(;s.length;){const h=s.pop(),c=s.pop(),f=s.pop();if(c-f<=o){for(let r=f;r<=c;r++)a(e[2*r],e[2*r+1],n,i)<=u&&l.push(t[r]);continue}const p=Math.floor((f+c)/2),d=e[2*p],g=e[2*p+1];a(d,g,n,i)<=u&&l.push(t[p]);const m=(h+1)%2;(0===h?n-r<=d:i-r<=g)&&(s.push(f),s.push(p-1),s.push(m)),(0===h?n+r>=d:i+r>=g)&&(s.push(p+1),s.push(c),s.push(m))}return l}(this.ids,this.coords,t,e,n,this.nodeSize)}}n.d(e,"default",function(){return c});const h={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:t=>t};class c{constructor(t){this.options=v(Object.create(h),t),this.trees=new Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:n,maxZoom:i,nodeSize:r}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let a=[];for(let e=0;e<t.length;e++)t[e].geometry&&a.push(p(t[e],e));this.trees[i+1]=new u(a,b,_,r,Float32Array),e&&console.timeEnd(o);for(let t=i;t>=n;t--){const n=+Date.now();a=this._cluster(a,t),this.trees[t]=new u(a,b,_,r,Float32Array),e&&console.log("z%d: %d clusters in %dms",t,a.length,+Date.now()-n)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,i,180,o],e),a=this.getClusters([-180,i,r,o],e);return t.concat(a)}const a=this.trees[this._limitZoom(e)],s=a.range(m(n),y(o),m(r),y(i)),l=[];for(const t of s){const e=a.points[t];l.push(e.numPoints?d(e):this.points[e.index])}return l}getChildren(t){const e=t>>5,n=t%32,i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const o=r.points[e];if(!o)throw new Error(i);const a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=r.within(o.x,o.y,a),l=[];for(const e of s){const n=r.points[e];n.parentId===t&&l.push(n.numPoints?d(n):this.points[n.index])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){e=e||10,n=n||0;const i=[];return this._appendLeaves(i,t,e,n,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:o,radius:a}=this.options,s=a/o,l=(n-s)/r,u=(n+1+s)/r,h={features:[]};return this._addTileFeatures(i.range((e-s)/r,l,(e+1+s)/r,u),i.points,e,n,r,h),0===e&&this._addTileFeatures(i.range(1-s/r,l,1,u),i.points,r,n,r,h),e===r-1&&this._addTileFeatures(i.range(0,l,s/r,u),i.points,-1,n,r,h),h.features.length?h:null}getClusterExpansionZoom(t){let e=t%32-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,r){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?r+o.point_count<=i?r+=o.point_count:r=this._appendLeaves(t,o.cluster_id,n,i,r):r<i?r++:t.push(e),t.length===n)break}return r}_addTileFeatures(t,e,n,i,r,o){for(const a of t){const t=e[a],s={type:1,geometry:[[Math.round(this.options.extent*(t.x*r-n)),Math.round(this.options.extent*(t.y*r-i))]],tags:t.numPoints?g(t):this.points[t.index].properties},l=t.numPoints?t.id:this.points[t.index].id;void 0!==l&&(s.id=l),o.features.push(s)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))}_cluster(t,e){const n=[],{radius:i,extent:r,reduce:o}=this.options,a=i/(r*Math.pow(2,e));for(let i=0;i<t.length;i++){const r=t[i];if(r.zoom<=e)continue;r.zoom=e;const s=this.trees[e+1],l=s.within(r.x,r.y,a);let u=r.numPoints||1,h=r.x*u,c=r.y*u;const p=o?this._map(r,!0):null,d=(i<<5)+(e+1);for(const t of l){const n=s.points[t];if(n.zoom<=e)continue;n.zoom=e;const i=n.numPoints||1;h+=n.x*i,c+=n.y*i,u+=i,n.parentId=d,o&&o(p,this._map(n))}1===u?n.push(r):(r.parentId=d,n.push(f(h/u,c/u,d,u,p)))}return n}_map(t,e){if(t.numPoints)return e?v({},t.properties):t.properties;const n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?v({},i):i}}function f(t,e,n,i,r){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:i,properties:r}}function p(t,e){const[n,i]=t.geometry.coordinates;return{x:m(n),y:y(i),zoom:1/0,index:e,parentId:-1}}function d(t){return{type:"Feature",id:t.id,properties:g(t),geometry:{type:"Point",coordinates:[function(t){return 360*(t-.5)}(t.x),function(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}(t.y)]}}}function g(t){const e=t.numPoints,n=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?`${Math.round(e/100)/10}k`:e;return v(v({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function m(t){return t/360+.5}function y(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function v(t,e){for(const n in e)t[n]=e[n];return t}function b(t){return t.x}function _(t){return t.y}}]);
//# sourceMappingURL=map4dsdk@1.4.0.prod.js.map